
/*
 *   This file is part of 6502.ts, an emulator for 6502 based systems built
 *   in Typescript.
 *
 *   Copyright (C) 2014 - 2018 Christian Speckner & contributors
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   Please go to the project's github page at
 *
 *   https://github.com/6502ts/6502.ts
 *
 *   for more details and for a copy of the GNU General Public License v2.
 */

!function s(a,o,u){function c(e,t){if(!o[e]){if(!a[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(l)return l(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var n=o[e]={exports:{}};a[e][0].call(n.exports,function(t){return c(a[e][1][t]||t)},n,n.exports,s,a,o,u)}return o[e].exports}for(var l="function"==typeof require&&require,t=0;t<u.length;t++)c(u[t]);return c}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(){this._queue=[],this._pending=!1}return t.prototype.isLocked=function(){return this._pending},t.prototype.acquire=function(){var e=this,t=new Promise(function(t){return e._queue.push(t)});return this._pending||this._dispatchNext(),t},t.prototype.runExclusive=function(r){return this.acquire().then(function(e){var t;try{t=r()}catch(t){throw e(),t}return Promise.resolve(t).then(function(t){return e(),t},function(t){throw e(),t})})},t.prototype._dispatchNext=function(){0<this._queue.length?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},t}();r.default=i},{}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./Mutex");r.Mutex=i.default},{"./Mutex":1}],3:[function(t,e,r){},{}],4:[function(t,e,r){arguments[4][3][0].apply(r,arguments)},{dup:3}],5:[function(t,e,r){"use strict";var i=[];function n(t){return i[t]||(i[t]=function(t){for(var e="return function dispatcher"+t+"(payload) {\n",r=[],i=[],n=0;n<t;n++)r.push("cb"+n),i.push("ctx"+n),e+="    cb"+n+"(payload, ctx"+n+");\n";return e+="};",new(Function.bind.apply(Function,[void 0].concat(r.concat(i),[e])))}(t)),i[t]}i[0]=function(){return function(){}},i[1]=function(e,r){return void 0===r?e:function(t){e(t,r)}};var s=function(){function t(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return t.prototype.addHandler=function(t,e){return this.isHandlerAttached(t,e)||(this._handlers.push(t),this._contexts.push(e),this._createDispatcher(),this._updateHasHandlers()),this},t.prototype.removeHandler=function(t,e){var r=this._getHandlerIndex(t,e);return void 0!==r&&(this._handlers.splice(r,1),this._contexts.splice(r,1),this._createDispatcher(),this._updateHasHandlers()),this},t.prototype.isHandlerAttached=function(t,e){return void 0!==this._getHandlerIndex(t,e)},t.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},t.prototype._getHandlerIndex=function(t,e){var r,i=this._handlers.length;for(r=0;r<i&&(this._handlers[r]!==t||this._contexts[r]!==e);r++);return r<i?r:void 0},t.prototype._createDispatcher=function(){this.dispatch=n(this._handlers.length).apply(this,this._handlers.concat(this._contexts))},t}();Object.defineProperty(r,"__esModule",{value:!0}),r.default=s},{}],6:[function(t,e,r){"use strict";var i=t("./Event");r.Event=i.default},{"./Event":5}],7:[function(t,e,c){(function(n){function s(t,e){for(var r=0,i=t.length-1;0<=i;i--){var n=t[i];"."===n?t.splice(i,1):".."===n?(t.splice(i,1),r++):r&&(t.splice(i,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function a(t,e){if(t.filter)return t.filter(e);for(var r=[],i=0;i<t.length;i++)e(t[i],i,t)&&r.push(t[i]);return r}c.resolve=function(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){var i=0<=r?arguments[r]:n.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,e="/"===i.charAt(0))}return(e?"/":"")+(t=s(a(t.split("/"),function(t){return!!t}),!e).join("/"))||"."},c.normalize=function(t){var e=c.isAbsolute(t),r="/"===i(t,-1);return(t=s(a(t.split("/"),function(t){return!!t}),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t},c.isAbsolute=function(t){return"/"===t.charAt(0)},c.join=function(){var t=Array.prototype.slice.call(arguments,0);return c.normalize(a(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},c.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;0<=r&&""===t[r];r--);return r<e?[]:t.slice(e,r-e+1)}t=c.resolve(t).substr(1),e=c.resolve(e).substr(1);for(var i=r(t.split("/")),n=r(e.split("/")),s=Math.min(i.length,n.length),a=s,o=0;o<s;o++)if(i[o]!==n[o]){a=o;break}var u=[];for(o=a;o<i.length;o++)u.push("..");return(u=u.concat(n.slice(a))).join("/")},c.sep="/",c.delimiter=":",c.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),r=47===e,i=-1,n=!0,s=t.length-1;1<=s;--s)if(47===(e=t.charCodeAt(s))){if(!n){i=s;break}}else n=!1;return-1===i?r?"/":".":r&&1===i?"/":t.slice(0,i)},c.basename=function(t,e){var r=function(t){"string"!=typeof t&&(t+="");var e,r=0,i=-1,n=!0;for(e=t.length-1;0<=e;--e)if(47===t.charCodeAt(e)){if(!n){r=e+1;break}}else-1===i&&(n=!1,i=e+1);return-1===i?"":t.slice(r,i)}(t);return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},c.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,r=0,i=-1,n=!0,s=0,a=t.length-1;0<=a;--a){var o=t.charCodeAt(a);if(47===o){if(n)continue;r=a+1;break}-1===i&&(n=!1,i=a+1),46===o?-1===e?e=a:1!==s&&(s=1):-1!==e&&(s=-1)}return-1===e||-1===i||0===s||1===s&&e===i-1&&e===r+1?"":t.slice(e,i)};var i="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:8}],8:[function(t,e,r){var i,n,s=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var c,l=[],h=!1,_=-1;function d(){h&&c&&(h=!1,c.length?l=c.concat(l):_=-1,l.length&&f())}function f(){if(!h){var t=u(d);h=!0;for(var e=l.length;e;){for(c=l,l=[];++_<e;)c&&c[_].run();_=-1,e=l.length}c=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||h||u(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],9:[function(t,e,r){var i=t("./lib/alea"),n=t("./lib/xor128"),s=t("./lib/xorwow"),a=t("./lib/xorshift7"),o=t("./lib/xor4096"),u=t("./lib/tychei"),c=t("./seedrandom");c.alea=i,c.xor128=n,c.xorwow=s,c.xorshift7=a,c.xor4096=o,c.tychei=u,e.exports=c},{"./lib/alea":10,"./lib/tychei":11,"./lib/xor128":12,"./lib/xor4096":13,"./lib/xorshift7":14,"./lib/xorwow":15,"./seedrandom":16}],10:[function(t,e,r){!function(t,e,r){function s(t){var i,e=this,r=(i=4022871197,function(t){t=t.toString();for(var e=0;e<t.length;e++){var r=.02519603282416938*(i+=t.charCodeAt(e));r-=i=r>>>0,i=(r*=i)>>>0,i+=4294967296*(r-=i)}return 2.3283064365386963e-10*(i>>>0)});e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var r=new s(t),i=e&&e.state,n=r.next;return n.int32=function(){return 4294967296*r.next()|0},n.double=function(){return n()+11102230246251565e-32*(2097152*n()|0)},n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.alea=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],11:[function(t,e,r){!function(t,e,r){function s(t){var n=this,e="";n.next=function(){var t=n.b,e=n.c,r=n.d,i=n.a;return t=t<<25^t>>>7^e,e=e-r|0,r=r<<24^r>>>8^i,i=i-t|0,n.b=t=t<<20^t>>>12^e,n.c=e=e-r|0,n.d=r<<16^e>>>16^i,n.a=i-t|0},n.a=0,n.b=0,n.c=-1640531527,n.d=1367130551,t===Math.floor(t)?(n.a=t/4294967296|0,n.b=0|t):e+=t;for(var r=0;r<e.length+20;r++)n.b^=0|e.charCodeAt(r),n.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var r=new s(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],12:[function(t,e,r){!function(t,e,r){function s(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var r=new s(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],13:[function(t,e,r){!function(t,e,r){function s(t){var s=this;s.next=function(){var t,e,r=s.w,i=s.X,n=s.i;return s.w=r=r+1640531527|0,e=i[n+34&127],t=i[n=n+1&127],e^=e<<13,t^=t<<17,e^=e>>>15,t^=t>>>12,e=i[n]=e^t,s.i=n,e+(r^r>>>16)|0},function(t,e){var r,i,n,s,a,o=[],u=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,u=Math.max(u,e.length)),n=0,s=-32;s<u;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,0<=s&&(a=a+1640531527|0,n=0==(r=o[127&s]^=i+a)?n+1:0);for(128<=n&&(o[127&(e&&e.length||0)]=-1),n=127,s=512;0<s;--s)i=o[n+34&127],r=o[n=n+1&127],i^=i<<13,r^=r<<17,i^=i>>>15,r^=r>>>12,o[n]=i^r;t.w=a,t.X=o,t.i=n}(s,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var r=new s(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&(i.X&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],14:[function(t,e,r){!function(t,e,r){function s(t){var n=this;n.next=function(){var t,e,r=n.x,i=n.i;return t=r[i],e=(t^=t>>>7)^t<<24,e^=(t=r[i+1&7])^t>>>10,e^=(t=r[i+3&7])^t>>>3,e^=(t=r[i+4&7])^t<<7,t=r[i+7&7],e^=(t^=t<<13)^t<<9,r[i]=e,n.i=i+1&7,e},function(t,e){var r,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,r=0;r<e.length;++r)i[7&r]=i[7&r]<<15^e.charCodeAt(r)+i[r+1&7]<<13;for(;i.length<8;)i.push(0);for(r=0;r<8&&0===i[r];++r);for(8==r?i[7]=-1:i[r],t.x=i,t.i=0,r=256;0<r;--r)t.next()}(n,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var r=new s(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&(i.x&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],15:[function(t,e,r){!function(t,e,r){function s(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,t===((e.v=0)|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),i==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var r=new s(t),i=e&&e.state,n=function(){return(r.next()>>>0)/4294967296};return n.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=r.next,n.quick=n,i&&("object"==typeof i&&a(i,r),n.state=function(){return a(r,{})}),n}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],16:[function(Jf,Kf,Lf){!function(Mf,Nf){var Xf,Of=eval("this"),Pf=256,Tf=Nf.pow(Pf,6),Uf=Nf.pow(2,52),Vf=2*Uf,Wf=Pf-1;function Yf(t,e,r){var i=[],n=ag(function t(e,r){var i,n=[],s=typeof e;if(r&&"object"==s)for(i in e)try{n.push(t(e[i],r-1))}catch(t){}return n.length?n:"string"==s?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,cg(Mf)]:null==t?function(){try{var t;return Xf&&(t=Xf.randomBytes)?t=t(Pf):(t=new Uint8Array(Pf),(Of.crypto||Of.msCrypto).getRandomValues(t)),cg(t)}catch(t){var e=Of.navigator,r=e&&e.plugins;return[+new Date,Of,r,Of.screen,cg(Mf)]}}():t,3),i),s=new Zf(i),a=function(){for(var t=s.g(6),e=Tf,r=0;t<Uf;)t=(t+r)*Pf,e*=Pf,r=s.g(1);for(;Vf<=t;)t/=2,e/=2,r>>>=1;return(t+r)/e};return a.int32=function(){return 0|s.g(4)},a.quick=function(){return s.g(4)/4294967296},a.double=a,ag(cg(s.S),Mf),(e.pass||r||function(t,e,r,i){return i&&(i.S&&$f(i,s),t.state=function(){return $f(s,{})}),r?(Nf.random=t,e):t})(a,n,"global"in e?e.global:this==Nf,e.state)}function Zf(t){var e,r=t.length,a=this,i=0,n=a.i=a.j=0,s=a.S=[];for(r||(t=[r++]);i<Pf;)s[i]=i++;for(i=0;i<Pf;i++)s[i]=s[n=Wf&n+t[i%r]+(e=s[i])],s[n]=e;(a.g=function(t){for(var e,r=0,i=a.i,n=a.j,s=a.S;t--;)e=s[i=Wf&i+1],r=r*Pf+s[Wf&(s[i]=s[n=Wf&n+e])+(s[n]=e)];return a.i=i,a.j=n,r})(Pf)}function $f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function ag(t,e){for(var r,i=t+"",n=0;n<i.length;)e[Wf&n]=Wf&(r^=19*e[Wf&n])+i.charCodeAt(n++);return cg(e)}function cg(t){return String.fromCharCode.apply(0,t)}if(Nf.seedrandom=Yf,ag(Nf.random(),Mf),"object"==typeof Kf&&Kf.exports){Kf.exports=Yf;try{Xf=Jf("crypto")}catch(t){}}else"function"==typeof define&&define.amd&&define(function(){return Yf})}([],Math)},{crypto:3}],17:[function(t,e,r){var i,n;i=this,n=function(){"use strict";var i=function(){return this||(0,eval)("this")}(),t=!(i.navigator&&/Trident|Edge/.test(i.navigator.userAgent)),e=1,r=!1,n={};function s(t){var e=Array.prototype.slice.call(arguments,1),r=e.length;return r?1===r?function(){return t.call(void 0,e[0])}:2===r?function(){return t.call(void 0,e[0],e[1])}:3===r?function(){return t.call(void 0,e[0],e[1],e[2])}:function(){return t.apply(void 0,e)}:function(){return t.call(void 0)}}function a(t){return n[e]=s.apply(void 0,t),e++}function o(t){delete n[t]}function u(t){if(r)i.setTimeout(s(u,t),0);else{var e=n[t];if(e){r=!0;try{e()}finally{o(t),r=!1}}}}function c(){var t=function(){var t=a(arguments);return i.setTimeout(s(u,t),0),t};return t.usePolifill="setTimeout",t}var l=Object.freeze({init:c,canUse:function(){return"setTimeout"in i}});var h=[Object.freeze({init:function(){var t=function(){var t=a(arguments);return i.process.nextTick(s(u,t)),t};return t.usePolifill="nextTick",t},canUse:function(){return"[object process]"===Object.prototype.toString.call(i.process)}}),Object.freeze({init:function(){var e="setImmediate$"+Math.random()+"$",t=function(t){t.source===i&&"string"==typeof t.data&&0===t.data.indexOf(e)&&u(Number(t.data.slice(e.length)))};i.addEventListener?i.addEventListener("message",t,!1):i.attachEvent("onmessage",t);var r=function(){var t=a(arguments);return i.postMessage(e+t,"*"),t};return r.usePolifill="postMessage",r},canUse:function(){if(i.importScripts||!i.postMessage)return!1;if(i.navigator&&/Chrome/.test(i.navigator.userAgent))return!1;var t=!0,e=i.onmessage;return i.onmessage=function(){t=!1},i.postMessage("","*"),i.onmessage=e,t}}),Object.freeze({init:function(){var e=new i.MessageChannel;e.port1.onmessage=function(t){u(Number(t.data))};var t=function(){var t=a(arguments);return e.port2.postMessage(t),t};return t.usePolifill="messageChannel",t},canUse:function(){return Boolean(i.MessageChannel)}}),Object.freeze({init:function(){var r=i.document.documentElement,t=function(){var t=a(arguments),e=i.document.createElement("script");return e.onreadystatechange=function(){u(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e),t};return t.usePolifill="readyStateChange",t},canUse:function(){return i.document&&"onreadystatechange"in i.document.createElement("script")}})],_=t?i.setImmediate||i.msSetImmediate||function(t,e){for(var r=0;r<t.length;r++){var i=t[r];if(i.canUse())return i.init()}return e.init()}(h,l):c(),d=t&&(i.clearImmediate||i.msClearImmediate)||o;return{setImmediate:_,clearImmediate:d,polifill:function(){i.setImmediate!==_&&(i.setImmediate=_,i.msSetImmediate=_,i.clearImmediate=d,i.msClearImmediate=d)}}},"object"==typeof r&&void 0!==e?e.exports=n():"function"==typeof define&&define.amd?define(n):i.immediate=n()},{}],18:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./native/thumbulator"),s=function(){function t(t,e){void 0===e&&(e={}),this._module=null,this._options=null,this._options=i.__assign({stopAddress:0},e),this._module=n(this._getApi(t,this._options)),this.enableDebug(!1)}return t.prototype.init=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return this._module._set_stop_address(this._options.stopAddress),[2]})})},t.prototype.ping=function(){return this._module.ccall("ping","string",[],[])},t.prototype.run=function(t){return this._module._run(t)},t.prototype.abort=function(){this._module._abort_run()},t.prototype.enableDebug=function(t){this._module._enable_debug(t?1:0)},t.prototype.reset=function(){this._module._reset()},t.prototype.readRegister=function(t){if(t<0||15<t)throw new Error("illegal thumb register "+t);return this._module._read_register(t)},t.prototype.writeRegister=function(t,e){if(t<0||15<t)throw new Error("illegal thumb register "+t);this._module._write_register(t,e)},t.prototype._getApi=function(r,t){var e=t.printer||function(t){return console.log("thumbulator: "+t)};return{print:e,printErr:e,trapOnInstructionFetch:t.trapOnInstructionFetch||function(){return 0},trapOnBx32:t.trapOnBx32||function(){return 3},busRead16:r.read16,busRead32:r.read32||function(t){return 65535&r.read16(t)|r.read16(t+2)<<16},busWrite16:r.write16,busWrite32:r.write32||function(t,e){return r.write16(t,65535&e),r.write16(t+2,e>>>16)}}},t}();r.default=s},{"./native/thumbulator":19,tslib:20}],19:[function(require,module,exports){(function(process){var Module=function(Module){Module=Module||{};var Module=Module,Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1,nodeFS,nodePath;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE)Module.print||(Module.print=console.log),Module.printErr||(Module.printErr=console.warn),Module.read=function(t,e){nodeFS||(nodeFS=require("fs")),nodePath||(nodePath=require("path")),t=nodePath.normalize(t);var r=nodeFS.readFileSync(t);return e?r:r.toString()},Module.readBinary=function(t){var e=Module.read(t,!0);return e.buffer||(e=new Uint8Array(e)),assert(e.buffer),e},Module.load=function(t){globalEval(read(t))},Module.thisProgram||(1<process.argv.length?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),Module.inspect=function(){return"[Emscripten Module object]"};else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available"},Module.readBinary=function(t){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(t));var e=read(t,"binary");return assert("object"==typeof e),e},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments),"function"==typeof quit&&(Module.quit=function(t,e){quit(t)});else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),Module.readAsync=function(t,e,r){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?e(i.response):r()},i.onerror=r,i.send(null)},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(t){console.log(t)}),Module.printErr||(Module.printErr=function(t){console.warn(t)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(t){dump(t)}:function(t){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),void 0===Module.setWindowTitle&&(Module.setWindowTitle=function(t){document.title=t})}function globalEval(t){eval.call(null,t)}for(var key in!Module.load&&Module.read&&(Module.load=function(t){globalEval(Module.read(t))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.quit||(Module.quit=function(t,e){throw e}),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[],moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var Runtime={setTempRet0:function(t){return tempRet0=t},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(t){STACKTOP=t},getNativeTypeSize:function(t){switch(t){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===t[t.length-1])return Runtime.QUANTUM_SIZE;if("i"!==t[0])return 0;var e=parseInt(t.substr(1));return assert(e%8==0),e/8}},getNativeFieldSize:function(t){return Math.max(Runtime.getNativeTypeSize(t),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(t,e){return"double"===e||"i64"===e?7&t&&(assert(4==(7&t)),t+=4):assert(0==(3&t)),t},getAlignSize:function(t,e,r){return r||"i64"!=t&&"double"!=t?t?Math.min(e||(t?Runtime.getNativeFieldSize(t):0),Runtime.QUANTUM_SIZE):Math.min(e,8):8},dynCall:function(t,e,r){return r&&r.length?Module["dynCall_"+t].apply(null,[e].concat(r)):Module["dynCall_"+t].call(null,e)},functionPointers:[],addFunction:function(t){for(var e=0;e<Runtime.functionPointers.length;e++)if(!Runtime.functionPointers[e])return Runtime.functionPointers[e]=t,2*(1+e);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(t){Runtime.functionPointers[(t-2)/2]=null},warnOnce:function(t){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[t]||(Runtime.warnOnce.shown[t]=1,Module.printErr(t))},funcWrappers:{},getFuncWrapper:function(e,r){if(e){assert(r),Runtime.funcWrappers[r]||(Runtime.funcWrappers[r]={});var t=Runtime.funcWrappers[r];return t[e]||(1===r.length?t[e]=function(){return Runtime.dynCall(r,e)}:2===r.length?t[e]=function(t){return Runtime.dynCall(r,e,[t])}:t[e]=function(){return Runtime.dynCall(r,e,Array.prototype.slice.call(arguments))}),t[e]}},getCompilerSetting:function(t){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(t){var e=STACKTOP;return STACKTOP=(STACKTOP=STACKTOP+t|0)+15&-16,e},staticAlloc:function(t){var e=STATICTOP;return STATICTOP=(STATICTOP=STATICTOP+t|0)+15&-16,e},dynamicAlloc:function(t){var e=HEAP32[DYNAMICTOP_PTR>>2],r=-16&(e+t+15|0);if((HEAP32[DYNAMICTOP_PTR>>2]=r,TOTAL_MEMORY<=r)&&!enlargeMemory())return HEAP32[DYNAMICTOP_PTR>>2]=e,0;return e},alignMemory:function(t,e){return t=Math.ceil(t/(e||16))*(e||16)},makeBigInt:function(t,e,r){return r?+(t>>>0)+4294967296*+(e>>>0):+(t>>>0)+4294967296*+(0|e)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=0,EXITSTATUS=0,cwrap,ccall;function assert(t,e){t||abort("Assertion failed: "+e)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(t){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(t,e,r,i){switch("*"===(r=r||"i8").charAt(r.length-1)&&(r="i32"),r){case"i1":case"i8":HEAP8[t>>0]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":tempI64=[e>>>0,(tempDouble=e,1<=+Math_abs(tempDouble)?0<tempDouble?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[t>>2]=tempI64[0],HEAP32[t+4>>2]=tempI64[1];break;case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;default:abort("invalid type for setValue: "+r)}}function getValue(t,e,r){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return HEAP8[t>>0];case"i16":return HEAP16[t>>1];case"i32":case"i64":return HEAP32[t>>2];case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];default:abort("invalid type for setValue: "+e)}return null}!function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(t){var e=Runtime.stackAlloc(t.length);return writeArrayToMemory(t,e),e},stringToC:function(t){var e=0;if(null!=t&&0!==t){var r=1+(t.length<<2);stringToUTF8(t,e=Runtime.stackAlloc(r),r)}return e}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(t,e,r,i,n){var s=getCFunc(t),a=[],o=0;if(i)for(var u=0;u<i.length;u++){var c=toC[r[u]];a[u]=c?(0===o&&(o=Runtime.stackSave()),c(i[u])):i[u]}var l=s.apply(null,a);if("string"===e&&(l=Pointer_stringify(l)),0!==o){if(n&&n.async)return void EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(o)});Runtime.stackRestore(o)}return l};var sourceRegex=/^function\s*[a-zA-Z$_0-9]*\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(t){var e=t.toString().match(sourceRegex).slice(1);return{arguments:e[0],body:e[1],returnValue:e[2]}}var JSsource=null;function ensureJSsource(){if(!JSsource)for(var t in JSsource={},JSfuncs)JSfuncs.hasOwnProperty(t)&&(JSsource[t]=parseJSFunc(JSfuncs[t]))}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(t){return"number"===t}),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(t,e){return"$"+e}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){ensureJSsource(),funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"=("+convertCode.returnValue+");"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(ensureJSsource(),funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.ccall=ccall,Module.cwrap=cwrap,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(t,e,r,i){var n,s;s="number"==typeof t?(n=!0,t):(n=!1,t.length);var a,o="string"==typeof e?e:null;if(a=r==ALLOC_NONE?i:["function"==typeof _malloc?_malloc:Runtime.staticAlloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===r?ALLOC_STATIC:r](Math.max(s,o?1:e.length)),n){var u;i=a;for(assert(0==(3&a)),u=a+(-4&s);i<u;i+=4)HEAP32[i>>2]=0;for(u=a+s;i<u;)HEAP8[i++>>0]=0;return a}if("i8"===o)return t.subarray||t.slice?HEAPU8.set(t,a):HEAPU8.set(new Uint8Array(t),a),a;for(var c,l,h,_=0;_<s;){var d=t[_];"function"==typeof d&&(d=Runtime.getFunctionIndex(d)),0!==(c=o||e[_])?("i64"==c&&(c="i32"),setValue(a+_,d,c),h!==c&&(l=Runtime.getNativeTypeSize(c),h=c),_+=l):_++}return a}function getMemory(t){return staticSealed?runtimeInitialized?_malloc(t):Runtime.dynamicAlloc(t):Runtime.staticAlloc(t)}function Pointer_stringify(t,e){if(0===e||!t)return"";for(var r,i=0,n=0;i|=r=HEAPU8[t+n>>0],(0!=r||e)&&(n++,!e||n!=e););e||(e=n);var s="";if(i<128){for(var a;0<e;)a=String.fromCharCode.apply(String,HEAPU8.subarray(t,t+Math.min(e,1024))),s=s?s+a:a,t+=1024,e-=1024;return s}return Module.UTF8ToString(t)}function AsciiToString(t){for(var e="";;){var r=HEAP8[t++>>0];if(!r)return e;e+=String.fromCharCode(r)}}function stringToAscii(t,e){return writeAsciiToMemory(t,e,!1)}Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.getMemory=getMemory,Module.Pointer_stringify=Pointer_stringify,Module.AsciiToString=AsciiToString,Module.stringToAscii=stringToAscii;var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(t,e){for(var r=e;t[r];)++r;if(16<r-e&&t.subarray&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,r));for(var i,n,s,a,o,u="";;){if(!(i=t[e++]))return u;if(128&i)if(n=63&t[e++],192!=(224&i))if(s=63&t[e++],(i=224==(240&i)?(15&i)<<12|n<<6|s:(a=63&t[e++],240==(248&i)?(7&i)<<18|n<<12|s<<6|a:(o=63&t[e++],248==(252&i)?(3&i)<<24|n<<18|s<<12|a<<6|o:(1&i)<<30|n<<24|s<<18|a<<12|o<<6|63&t[e++])))<65536)u+=String.fromCharCode(i);else{var c=i-65536;u+=String.fromCharCode(55296|c>>10,56320|1023&c)}else u+=String.fromCharCode((31&i)<<6|n);else u+=String.fromCharCode(i)}}function UTF8ToString(t){return UTF8ArrayToString(HEAPU8,t)}function stringToUTF8Array(t,e,r,i){if(!(0<i))return 0;for(var n=r,s=r+i-1,a=0;a<t.length;++a){var o=t.charCodeAt(a);if(55296<=o&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),o<=127){if(s<=r)break;e[r++]=o}else if(o<=2047){if(s<=r+1)break;e[r++]=192|o>>6,e[r++]=128|63&o}else if(o<=65535){if(s<=r+2)break;e[r++]=224|o>>12,e[r++]=128|o>>6&63,e[r++]=128|63&o}else if(o<=2097151){if(s<=r+3)break;e[r++]=240|o>>18,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o}else if(o<=67108863){if(s<=r+4)break;e[r++]=248|o>>24,e[r++]=128|o>>18&63,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o}else{if(s<=r+5)break;e[r++]=252|o>>30,e[r++]=128|o>>24&63,e[r++]=128|o>>18&63,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o}}return e[r]=0,r-n}function stringToUTF8(t,e,r){return stringToUTF8Array(t,HEAPU8,e,r)}function lengthBytesUTF8(t){for(var e=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);55296<=i&&i<=57343&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++r)),i<=127?++e:e+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return e}Module.UTF8ArrayToString=UTF8ArrayToString,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8Array=stringToUTF8Array,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8;var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR;function demangle(t){var e=Module.___cxa_demangle||Module.__cxa_demangle;if(e){try{var r=t.substr(1),i=lengthBytesUTF8(r)+1,n=_malloc(i);stringToUTF8(r,n,i);var s=_malloc(4),a=e(n,0,0,s);if(0===getValue(s,"i32")&&a)return Pointer_stringify(a)}catch(t){}finally{n&&_free(n),s&&_free(s),a&&_free(a)}return t}return Runtime.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),t}function demangleAll(t){return t.replace(/__Z[\w\d_]+/g,function(t){var e=demangle(t);return t===e?t:t+" ["+e+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function stackTrace(){var t=jsStackTrace();return Module.extraStackTrace&&(t+="\n"+Module.extraStackTrace()),demangleAll(t)}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or (4) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){abortOnCannotGrowMemory()}Module.stackTrace=stackTrace,STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1;var TOTAL_STACK=Module.TOTAL_STACK||10240,TOTAL_MEMORY=Module.TOTAL_MEMORY||16777216;function getTotalMemory(){return TOTAL_MEMORY}if(TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")"),buffer=Module.buffer?Module.buffer:new ArrayBuffer(TOTAL_MEMORY),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(t){for(;0<t.length;){var e=t.shift();if("function"!=typeof e){var r=e.func;"number"==typeof r?void 0===e.arg?Module.dynCall_v(r):Module.dynCall_vi(r,e.arg):r(void 0===e.arg?null:e.arg)}else e()}}Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(t){__ATPRERUN__.unshift(t)}function addOnInit(t){__ATINIT__.unshift(t)}function addOnPreMain(t){__ATMAIN__.unshift(t)}function addOnExit(t){__ATEXIT__.unshift(t)}function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}function intArrayFromString(t,e,r){var i=0<r?r:lengthBytesUTF8(t)+1,n=new Array(i),s=stringToUTF8Array(t,n,0,n.length);return e&&(n.length=s),n}function intArrayToString(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];255<i&&(i&=255),e.push(String.fromCharCode(i))}return e.join("")}function writeStringToMemory(t,e,r){var i,n;Runtime.warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!"),r&&(n=e+lengthBytesUTF8(t),i=HEAP8[n]),stringToUTF8(t,e,1/0),r&&(HEAP8[n]=i)}function writeArrayToMemory(t,e){HEAP8.set(t,e)}function writeAsciiToMemory(t,e,r){for(var i=0;i<t.length;++i)HEAP8[e++>>0]=t.charCodeAt(i);r||(HEAP8[e>>0]=0)}Module.addOnPreRun=addOnPreRun,Module.addOnInit=addOnInit,Module.addOnPreMain=addOnPreMain,Module.addOnExit=addOnExit,Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(t,e){var r=65535&t,i=65535&e;return r*i+((t>>>16)*i+r*(e>>>16)<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(t){t>>>=0;for(var e=0;e<32;e++)if(t&1<<31-e)return e;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Math.trunc=Math.trunc;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(t){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var ASM_CONSTS=[function(t){return Module.trapOnInstructionFetch(t)},function(t){return Module.busRead32(t)},function(t,e){Module.busWrite32(t,e)},function(t){return Module.busRead16(t)},function(t,e){return Module.trapOnBx32(t,e)},function(t,e){Module.busWrite16(t,e)}];function _emscripten_asm_const_ii(t,e){return ASM_CONSTS[t](e)}function _emscripten_asm_const_iii(t,e,r){return ASM_CONSTS[t](e,r)}STATIC_BASE=Runtime.GLOBAL_BASE,STATICTOP=STATIC_BASE+5312,__ATINIT__.push(),allocate([12,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,189,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,156,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,104,117,109,98,117,108,97,116,111,114,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,49,54,40,36,48,41,59,32,125,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,51,50,40,36,48,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,49,54,40,36,48,44,32,36,49,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,51,50,40,36,48,44,32,36,49,41,59,32,125,0,112,99,32,104,97,115,32,108,115,98,105,116,32,115,101,116,32,48,120,37,48,56,88,10,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,116,114,97,112,79,110,73,110,115,116,114,117,99,116,105,111,110,70,101,116,99,104,40,36,48,41,59,32,125,0,45,45,45,32,48,120,37,48,56,88,58,32,48,120,37,48,52,88,32,0,97,100,99,32,114,37,117,44,114,37,117,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,100,100,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,97,100,100,32,114,37,117,44,114,37,117,10,0,97,100,100,32,112,99,44,46,46,46,32,112,114,111,100,117,99,101,100,32,97,110,32,97,114,109,32,97,100,100,114,101,115,115,32,48,120,37,48,56,88,32,48,120,37,48,56,88,10,0,97,100,100,32,114,37,117,44,80,67,44,35,48,120,37,48,50,88,10,0,97,100,100,32,114,37,117,44,83,80,44,35,48,120,37,48,50,88,10,0,97,100,100,32,83,80,44,35,48,120,37,48,50,88,10,0,97,110,100,115,32,114,37,117,44,114,37,117,10,0,97,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,115,114,115,32,114,37,117,44,114,37,117,10,0,98,101,113,32,48,120,37,48,56,88,10,0,98,110,101,32,48,120,37,48,56,88,10,0,98,99,115,32,48,120,37,48,56,88,10,0,98,99,99,32,48,120,37,48,56,88,10,0,98,109,105,32,48,120,37,48,56,88,10,0,98,112,108,32,48,120,37,48,56,88,10,0,98,118,115,32,48,120,37,48,56,88,10,0,98,118,99,32,48,120,37,48,56,88,10,0,98,104,105,32,48,120,37,48,56,88,10,0,98,108,115,32,48,120,37,48,56,88,10,0,98,103,101,32,48,120,37,48,56,88,10,0,98,108,116,32,48,120,37,48,56,88,10,0,98,103,116,32,48,120,37,48,56,88,10,0,98,108,101,32,48,120,37,48,56,88,10,0,66,32,48,120,37,48,56,88,10,0,98,105,99,115,32,114,37,117,44,114,37,117,10,0,98,107,112,116,32,48,120,37,48,50,88,10,0,98,108,32,48,120,37,48,56,88,10,0,98,108,120,32,114,37,117,10,0,99,97,110,110,111,116,32,98,114,97,110,99,104,32,116,111,32,97,114,109,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,98,120,32,114,37,117,10,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,116,114,97,112,79,110,66,120,51,50,40,36,48,44,32,36,49,41,59,32,125,0,99,109,110,115,32,114,37,117,44,114,37,117,10,0,99,109,112,32,114,37,117,44,35,48,120,37,48,50,88,10,0,99,109,112,115,32,114,37,117,44,114,37,117,10,0,99,112,115,32,84,79,68,79,10,0,99,112,121,32,114,37,117,44,114,37,117,10,0,101,111,114,115,32,114,37,117,44,114,37,117,10,0,108,100,109,105,97,32,114,37,117,33,44,123,0,114,37,117,0,125,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,32,114,37,117,44,91,80,67,43,35,48,120,37,88,93,32,0,59,64,32,48,120,37,88,10,0,108,100,114,32,114,37,117,44,91,83,80,43,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,115,108,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,108,115,32,114,37,117,44,114,37,117,10,0,108,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,114,115,32,114,37,117,44,114,37,117,10,0,109,111,118,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,109,111,118,115,32,114,37,117,44,114,37,117,10,0,109,111,118,32,114,37,117,44,114,37,117,10,0,109,117,108,115,32,114,37,117,44,114,37,117,10,0,109,118,110,115,32,114,37,117,44,114,37,117,10,0,110,101,103,115,32,114,37,117,44,114,37,117,10,0,111,114,114,115,32,114,37,117,44,114,37,117,10,0,112,111,112,32,123,0,112,99,0,112,111,112,32,123,114,99,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,112,117,115,104,32,123,0,108,114,0,112,117,115,104,32,123,108,114,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,114,101,118,32,114,37,117,44,114,37,117,10,0,114,101,118,49,54,32,114,37,117,44,114,37,117,10,0,114,101,118,115,104,32,114,37,117,44,114,37,117,10,0,114,111,114,115,32,114,37,117,44,114,37,117,10,0,115,98,99,32,114,37,117,44,114,37,117,10,0,115,101,116,101,110,100,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,10,0,115,116,109,105,97,32,114,37,117,33,44,123,0,115,116,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,32,114,37,117,44,91,83,80,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,115,117,98,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,115,117,98,32,83,80,44,35,48,120,37,48,50,88,10,0,115,119,105,32,48,120,37,48,50,88,10,0,10,10,115,119,105,32,48,120,37,48,50,88,10,0,115,120,116,98,32,114,37,117,44,114,37,117,10,0,115,120,116,104,32,114,37,117,44,114,37,117,10,0,116,115,116,32,114,37,117,44,114,37,117,10,0,117,120,116,98,32,114,37,117,44,114,37,117,10,0,117,120,116,104,32,114,37,117,44,114,37,117,10,0,105,110,118,97,108,105,100,32,105,110,115,116,114,117,99,116,105,111,110,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,46,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=STATICTOP;function _emscripten_memcpy_big(t,e,r){return HEAPU8.set(HEAPU8.subarray(e,e+r),t),t}STATICTOP+=16;var SYSCALLS={varargs:0,get:function(t){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var t=SYSCALLS.get(),e=SYSCALLS.get();return assert(0<=t?0===e:-1===e),t},getZero:function(){assert(0===SYSCALLS.get())}};function ___syscall6(t,e){SYSCALLS.varargs=e;try{var r=SYSCALLS.getStreamFromFD();return FS.close(r),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||abort(t),-t.errno}}var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_STATIC);function ___setErrNo(t){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=t),t}function __exit(t){Module.exit(t)}function _exit(t){__exit(t)}function ___syscall140(t,e){SYSCALLS.varargs=e;try{var r=SYSCALLS.getStreamFromFD(),i=(SYSCALLS.get(),SYSCALLS.get()),n=SYSCALLS.get(),s=SYSCALLS.get(),a=i;return FS.llseek(r,a,s),HEAP32[n>>2]=r.position,r.getdents&&0===a&&0===s&&(r.getdents=null),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||abort(t),-t.errno}}function ___syscall146(t,e){SYSCALLS.varargs=e;try{var r=SYSCALLS.get(),i=SYSCALLS.get(),n=SYSCALLS.get(),s=0;___syscall146.buffer||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(t,e){var r=___syscall146.buffers[t];assert(r),0===e||10===e?((1===t?Module.print:Module.printErr)(UTF8ArrayToString(r,0)),r.length=0):r.push(e)});for(var a=0;a<n;a++){for(var o=HEAP32[i+8*a>>2],u=HEAP32[i+(8*a+4)>>2],c=0;c<u;c++)___syscall146.printChar(r,HEAPU8[o+c]);s+=u}return s}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||abort(t),-t.errno}}function invoke_ii(t,e){try{return Module.dynCall_ii(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;Module.setThrew(1,0)}}function invoke_iiii(t,e,r,i){try{return Module.dynCall_iiii(t,e,r,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;Module.setThrew(1,0)}}__ATEXIT__.push(function(){var t=Module._fflush;t&&t(0);var e=___syscall146.printChar;if(e){var r=___syscall146.buffers;r[1].length&&e(1,10),r[2].length&&e(2,10)}}),DYNAMICTOP_PTR=allocate(1,"i32",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=Runtime.alignMemory(STACK_MAX),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0,Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_ii:invoke_ii,invoke_iiii:invoke_iiii,_emscripten_asm_const_ii:_emscripten_asm_const_ii,___syscall6:___syscall6,___setErrNo:___setErrNo,___syscall146:___syscall146,_emscripten_memcpy_big:_emscripten_memcpy_big,___syscall140:___syscall140,_exit:_exit,__exit:__exit,_emscripten_asm_const_iii:_emscripten_asm_const_iii,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,cttz_i8:cttz_i8};var asm=function(t,e,r){"use asm";var A=new t.Int8Array(r);var v=new t.Int16Array(r);var M=new t.Int32Array(r);var P=new t.Uint8Array(r);var i=new t.Uint16Array(r);var n=new t.Uint32Array(r);var l=new t.Float32Array(r);var k=new t.Float64Array(r);var s=e.DYNAMICTOP_PTR|0;var a=e.tempDoublePtr|0;var o=e.ABORT|0;var S=e.STACKTOP|0;var u=e.STACK_MAX|0;var c=e.cttz_i8|0;var h=0;var _=0;var d=0;var f=0;var p=t.NaN,m=t.Infinity;var g=0,b=0,y=0,w=0,C=0.0;var T=0;var I=t.Math.floor;var E=t.Math.abs;var R=t.Math.sqrt;var x=t.Math.pow;var O=t.Math.cos;var B=t.Math.sin;var F=t.Math.tan;var L=t.Math.acos;var D=t.Math.asin;var H=t.Math.atan;var U=t.Math.atan2;var N=t.Math.exp;var j=t.Math.log;var W=t.Math.ceil;var V=t.Math.imul;var z=t.Math.min;var Q=t.Math.max;var q=t.Math.clz32;var Y=e.abort;var K=e.assert;var G=e.enlargeMemory;var J=e.getTotalMemory;var X=e.abortOnCannotGrowMemory;var $=e.invoke_ii;var Z=e.invoke_iiii;var tt=e._emscripten_asm_const_ii;var et=e.___syscall6;var rt=e.___setErrNo;var it=e.___syscall146;var nt=e._emscripten_memcpy_big;var st=e.___syscall140;var at=e._exit;var ot=e.__exit;var ut=e._emscripten_asm_const_iii;var ct=0.0;function lt(t){t=t|0;var e=0;e=S;S=S+t|0;S=S+15&-16;return e|0}function ht(){return S|0}function _t(t){t=t|0;S=t}function dt(t,e){t=t|0;e=e|0;S=t;u=e}function ft(t,e){t=t|0;e=e|0;if(!h){h=t;_=e}}function pt(t){t=t|0;T=t}function mt(){return T|0}function gt(t){t=t|0;M[1162]=t;return}function bt(){return 380}function yt(t){t=t|0;var e=0,r=0,i=0,n=0,s=0;M[1163]=0;if(!t){n=0;return n|0}else{e=0;r=0}while(1){s=Mt()|0;r=(s|0)==0?r:s;i=(M[1163]|0)!=0;e=e+1|0;if(i|(s|0)==0^1)break;if(e>>>0>=t>>>0){e=0;n=5;break}}if((n|0)==5)return e|0;s=i?10:r;return s|0}function vt(){M[1163]=1;return}function kt(t){t=t|0;A[5300]=t;return}function wt(t){t=t|0;var e=0,r=0;r=S;S=S+16|0;e=M[4668+((t&15)<<2)>>2]|0;if((t&15|0)!=15){S=r;return e|0}if(e&1|0){t=M[2]|0;M[r>>2]=e;Kt(t,520,r)|0}e=e&-2;S=r;return e|0}function Ct(t,e){t=t|0;e=e|0;M[4668+((t&15)<<2)>>2]=(t&15|0)==15?e&-2:e;return}function At(){M[1164]=4;M[1165]=0;M[1166]=0;M[1183]=0;M[1184]=0;return 0}function Mt(){var t=0,e=0,r=0,i=0,n=0,s=0,a=0,o=0,u=0,c=0;c=S;S=S+4848|0;e=M[1182]|0;if(e&1|0){u=M[2]|0;M[c>>2]=e;Kt(u,520,c)|0}t=M[1162]|0;if(!t){t=tt(0,(e&-2)+-2|0)|0;if(t|0){u=t;S=c;return u|0}}else if(((e&-2)+-2|0)==(t|0)){u=20;S=c;return u|0}if((e&-2)>>>0>4026531839&(M[1183]|0)!=0){M[1183]=0;u=M[1180]|0;M[1167]=tt(1,u|0)|0;M[1168]=tt(1,u+4|0)|0;M[1169]=tt(1,u+8|0)|0;M[1170]=tt(1,u+12|0)|0;M[1179]=tt(1,u+16|0)|0;M[1181]=tt(1,u+20|0)|0;r=tt(1,u+24|0)|0;M[1184]=tt(1,u+28|0)|0;M[1180]=u+32}else r=e&-2;t=M[1164]|0;do{if(t&1){e=M[1166]|0;if(!e){M[1166]=M[1165];M[1164]=t|65536;t=t|65536;break}else{M[1166]=e+-1;break}}}while(0);if((t&3|0)==3)if((t&65536|0)!=0&(M[1183]|0)==0){i=M[1180]|0;e=M[1184]|0;t:do{if((i+-4&-268435456|0)==-536870912)switch((i+536813548|0)>>>2|i+536813548<<30|0){case 0:{M[1164]=e&65543;if((t&1|0)!=0|(e&1|0)==0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=e&16777215;break t}case 2:{M[1166]=e&16777215;break t}case 3:break t;default:break t}else ut(2,i+-4|0,e|0)|0}while(0);t:do{if((i+-8&-268435456|0)==-536870912)switch((i+536813544|0)>>>2|i+536813544<<30|0){case 0:{u=M[1164]|0;M[1164]=r&65543;if((r&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=r&16777215;break t}case 2:{M[1166]=r&16777215;break t}case 3:break t;default:break t}else ut(2,i+-8|0,r|0)|0}while(0);t=M[1181]|0;t:do{if((i+-12&-268435456|0)==-536870912)switch((i+536813540|0)>>>2|i+536813540<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-12|0,t|0)|0}while(0);t=M[1179]|0;t:do{if((i+-16&-268435456|0)==-536870912)switch((i+536813536|0)>>>2|i+536813536<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-16|0,t|0)|0}while(0);t=M[1170]|0;t:do{if((i+-20&-268435456|0)==-536870912)switch((i+536813532|0)>>>2|i+536813532<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-20|0,t|0)|0}while(0);t=M[1169]|0;t:do{if((i+-24&-268435456|0)==-536870912)switch((i+536813528|0)>>>2|i+536813528<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-24|0,t|0)|0}while(0);t=M[1168]|0;t:do{if((i+-28&-268435456|0)==-536870912)switch((i+536813524|0)>>>2|i+536813524<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-28|0,t|0)|0}while(0);t=M[1167]|0;t:do{if((i+-32&-268435456|0)==-536870912)switch((i+536813520|0)>>>2|i+536813520<<30|0){case 0:{u=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}else ut(2,i+-32|0,t|0)|0}while(0);M[1180]=i+-32;r=(tt(1,60)|0)+2|0;M[1181]=-7;M[1183]=1}n=r+-2|0;u=tt(3,n|0)|0;s=r+2|0;M[1182]=s&-2;if(A[5300]|0){i=M[2]|0;M[c+8>>2]=n;M[c+8+4>>2]=u;Kt(i,591,c+8|0)|0}if((u&65472|0)==16704){if(A[5300]|0){o=M[2]|0;M[c+16>>2]=u&7;M[c+16+4>>2]=u>>>3&7;Kt(o,611,c+16|0)|0}e=M[4668+((u&7)<<2)>>2]|0;r=M[4668+((u>>>3&7)<<2)>>2]|0;o=M[1184]|0;M[4668+((u&7)<<2)>>2]=r+e+(o>>>29&1);t=(r+e+(o>>>29&1)|0)<0?o|-2147483648:o&2147483647;t=(r+e+(o>>>29&1)|0)==0?t|1073741824:t&-1073741825;M[1184]=t;if(!(t&536870912)){u=((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)|0)>>>31)&2|0)==0?t&-536870913:t|536870912;M[1184]=(((r&2147483647)+(e&2147483647)|0)>>>31|0)==(((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}else{u=(((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)+1|0)>>>31)|0)&2|0)==0?t&-536870913:t|536870912;M[1184]=(((r&2147483647)+(e&2147483647)+1|0)>>>31|0)==(((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)+1|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}}if((u&65024|0)==7168)if(u>>>6&7|0){if(A[5300]|0){o=M[2]|0;M[c+24>>2]=u&7;M[c+24+4>>2]=u>>>3&7;M[c+24+8>>2]=u>>>6&7;Kt(o,624,c+24|0)|0}a=M[4668+((u>>>3&7)<<2)>>2]|0;M[4668+((u&7)<<2)>>2]=a+(u>>>6&7);o=M[1184]|0;o=(a+(u>>>6&7)|0)<0?o|-2147483648:o&2147483647;o=(a+(u>>>6&7)|0)==0?o|1073741824:o&-1073741825;o=((((a&2147483647)+(u>>>6&7)|0)>>>31)+(a>>>31)&2|0)==0?o&-536870913:o|536870912;M[1184]=(((a&2147483647)+(u>>>6&7)|0)>>>31|0)==(((((a&2147483647)+(u>>>6&7)|0)>>>31)+(a>>>31)|0)>>>1|0)?o&-268435457:o|268435456;u=0;S=c;return u|0}if((u&63488|0)==12288){if(A[5300]|0){o=M[2]|0;M[c+40>>2]=u>>>8&7;M[c+40+4>>2]=u&255;Kt(o,644,c+40|0)|0}a=M[4668+((u>>>8&7)<<2)>>2]|0;M[4668+((u>>>8&7)<<2)>>2]=a+(u&255);o=M[1184]|0;o=(a+(u&255)|0)<0?o|-2147483648:o&2147483647;o=(a+(u&255)|0)==0?o|1073741824:o&-1073741825;o=((((a&2147483647)+(u&255)|0)>>>31)+(a>>>31)&2|0)==0?o&-536870913:o|536870912;M[1184]=(((a&2147483647)+(u&255)|0)>>>31|0)==(((((a&2147483647)+(u&255)|0)>>>31)+(a>>>31)|0)>>>1|0)?o&-268435457:o|268435456;u=0;S=c;return u|0}if((u&65024|0)==6144){if(A[5300]|0){o=M[2]|0;M[c+48>>2]=u&7;M[c+48+4>>2]=u>>>3&7;M[c+48+8>>2]=u>>>6&7;Kt(o,662,c+48|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]|0;a=M[4668+((u>>>6&7)<<2)>>2]|0;M[4668+((u&7)<<2)>>2]=a+o;u=M[1184]|0;u=(a+o|0)<0?u|-2147483648:u&2147483647;u=(a+o|0)==0?u|1073741824:u&-1073741825;u=((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+(o&2147483647)|0)>>>31|0)==(((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}if((u&65280|0)==17408){if(A[5300]|0){o=M[2]|0;M[c+64>>2]=u>>>4&8|u&7;M[c+64+4>>2]=u>>>3&15;Kt(o,680,c+64|0)|0}t=M[4668+((u>>>4&8|u&7)<<2)>>2]|0;if((u>>>4&8|u&7|0)==15){if(t&1|0){o=M[2]|0;M[c+72>>2]=t;Kt(o,520,c+72|0)|0}t=t&-2}e=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(e&1|0){o=M[2]|0;M[c+80>>2]=e;Kt(o,520,c+80|0)|0}e=e&-2}t=e+t|0;do{if((u>>>4&8|u&7|0)==15)if(!(t&1)){o=M[2]|0;M[c+88>>2]=s;M[c+88+4>>2]=t;Kt(o,693,c+88|0)|0;at(1)}else{a=t+2&-2;break}else a=t}while(0);M[4668+((u>>>4&8|u&7)<<2)>>2]=(u>>>4&8|u&7|0)==15?a&-2:a;u=0;S=c;return u|0}t=1;e=(u&63488)<<16>>16;if(t)switch(e|0){case-24576:{if(A[5300]|0){o=M[2]|0;M[c+96>>2]=u>>>8&7;M[c+96+4>>2]=u<<2&1020;Kt(o,743,c+96|0)|0}t=M[1182]|0;if(t&1|0){o=M[2]|0;M[c+104>>2]=t;Kt(o,520,c+104|0)|0}M[4668+((u>>>8&7)<<2)>>2]=(t&-4)+(u<<2&1020);u=0;S=c;return u|0}case-22528:{if(A[5300]|0){o=M[2]|0;M[c+112>>2]=u>>>8&7;M[c+112+4>>2]=u<<2&1020;Kt(o,763,c+112|0)|0}M[4668+((u>>>8&7)<<2)>>2]=(M[1180]|0)+(u<<2&1020);u=0;S=c;return u|0}default:t=1}if(t)switch(e|0){default:{if((u&65408|0)==45056){if(A[5300]|0){o=M[2]|0;M[c+120>>2]=u<<2&508;Kt(o,783,c+120|0)|0}M[1180]=(M[1180]|0)+(u<<2&508);u=0;S=c;return u|0}if((u&65472|0)==16384){if(A[5300]|0){o=M[2]|0;M[c+128>>2]=u&7;M[c+128+4>>2]=u>>>3&7;Kt(o,799,c+128|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]&M[4668+((u&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;S=c;return u|0}if((u&63488|0)==4096){if(A[5300]|0){o=M[2]|0;M[c+136>>2]=u&7;M[c+136+4>>2]=u>>>3&7;M[c+136+8>>2]=u>>>6&31;Kt(o,813,c+136|0)|0}t=M[4668+((u>>>3&7)<<2)>>2]|0;do{if(!(u>>>6&31)){r=M[1184]|0;if((t|0)<0){M[1184]=r|536870912;e=-1;t=r|536870912;break}else{M[1184]=r&-536870913;e=0;t=r&-536870913;break}}else{o=M[1184]|0;o=t&1<<(u>>>6&31)+-1|0?o|536870912:o&-536870913;M[1184]=o;e=((t|0)<0?-1<<32-(u>>>6&31):0)|t>>>(u>>>6&31);t=o}}while(0);M[4668+((u&7)<<2)>>2]=e;u=(e|0)<0?t|-2147483648:t&2147483647;M[1184]=(e|0)==0?u|1073741824:u&-1073741825;u=0;S=c;return u|0}if((u&65472|0)==16640){if(A[5300]|0){o=M[2]|0;M[c+152>>2]=u&7;M[c+152+4>>2]=u>>>3&7;Kt(o,833,c+152|0)|0}e=M[4668+((u&7)<<2)>>2]|0;t=M[4668+((u>>>3&7)<<2)>>2]&255;do{if(!t)t=M[1184]|0;else{if(t>>>0<32){o=M[1184]|0;o=1<<t+-1&e|0?o|536870912:o&-536870913;M[1184]=o;e=((e|0)<0?-1<<32-t:0)|e>>>t;t=o;break}t=M[1184]|0;if((e|0)<0){M[1184]=t|536870912;e=-1;t=t|536870912;break}else{M[1184]=t&-536870913;e=0;t=t&-536870913;break}}}while(0);M[4668+((u&7)<<2)>>2]=e;u=(e|0)<0?t|-2147483648:t&2147483647;M[1184]=(e|0)==0?u|1073741824:u&-1073741825;u=0;S=c;return u|0}t:do{if((u&61440|0)==53248){e=(((u&128|0)==0?u&255:u|-256)<<1)+s|0;do{switch(u>>>8&15){case 0:{if(A[5300]|0){u=M[2]|0;M[c+160>>2]=e+-1;Kt(u,847,c+160|0)|0}if(!(M[1184]&1073741824)){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 1:{if(A[5300]|0){u=M[2]|0;M[c+168>>2]=e+-1;Kt(u,859,c+168|0)|0}if(M[1184]&1073741824|0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 2:{if(A[5300]|0){u=M[2]|0;M[c+176>>2]=e+-1;Kt(u,871,c+176|0)|0}if(!(M[1184]&536870912)){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 3:{if(A[5300]|0){u=M[2]|0;M[c+184>>2]=e+-1;Kt(u,883,c+184|0)|0}if(M[1184]&536870912|0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 4:{if(A[5300]|0){u=M[2]|0;M[c+192>>2]=e+-1;Kt(u,895,c+192|0)|0}if((M[1184]|0)>=0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 5:{if(A[5300]|0){u=M[2]|0;M[c+200>>2]=e+-1;Kt(u,907,c+200|0)|0}if((M[1184]|0)<0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 6:{if(A[5300]|0){u=M[2]|0;M[c+208>>2]=e+-1;Kt(u,919,c+208|0)|0}if(!(M[1184]&268435456)){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 7:{if(A[5300]|0){u=M[2]|0;M[c+216>>2]=e+-1;Kt(u,931,c+216|0)|0}if(M[1184]&268435456|0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 8:{if(A[5300]|0){u=M[2]|0;M[c+224>>2]=e+-1;Kt(u,943,c+224|0)|0}if((M[1184]&1610612736|0)!=536870912){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 9:{if(A[5300]|0){u=M[2]|0;M[c+232>>2]=e+-1;Kt(u,955,c+232|0)|0}if((M[1184]&1610612736|0)==536870912){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 10:{if(A[5300]|0){u=M[2]|0;M[c+240>>2]=e+-1;Kt(u,967,c+240|0)|0}t=M[1184]&-1879048192;e:do{if((t|0)<0){switch(t|0){case-1879048192:break e;default:o=0}S=c;return o|0}else{switch(t|0){case 0:break e;default:o=0}S=c;return o|0}}while(0);M[1182]=e+2&-2;u=0;S=c;return u|0}case 11:{if(A[5300]|0){u=M[2]|0;M[c+248>>2]=e+-1;Kt(u,979,c+248|0)|0}u=M[1184]|0;if(!((u&268435456|0?(u|0)<0?0:(u&268435456)>>>28:(u|0)<0?1:(u&268435456)>>>28)|0)){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 12:{if(A[5300]|0){u=M[2]|0;M[c+256>>2]=e+-1;Kt(u,991,c+256|0)|0}u=M[1184]|0;if(u&1073741824|0?1:(((u&-1879048192|0)==0?(u&-1879048192|0)==-1879048192?2:1:(u&-1879048192|0)==-1879048192&1)|0)==0){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}case 13:{if(A[5300]|0){u=M[2]|0;M[c+264>>2]=e+-1;Kt(u,1003,c+264|0)|0}u=M[1184]|0;if(((u&268435456|0?(u|0)<0?0:(u&268435456)>>>28:(u|0)<0?1:(u&268435456)>>>28)|0)==(0-(u>>>30&1)|0)){u=0;S=c;return u|0}M[1182]=e+2&-2;u=0;S=c;return u|0}default:break t}}while(0)}}while(0);if((u&63488|0)==57344){t=(((u&1024|0)==0?u&2047:u|-2048)<<1)+s|0;if(A[5300]|0){u=M[2]|0;M[c+272>>2]=t+-1;Kt(u,1015,c+272|0)|0}M[1182]=t+2&-2;u=0;S=c;return u|0}if((u&65472|0)==17280){if(A[5300]|0){o=M[2]|0;M[c+280>>2]=u&7;M[c+280+4>>2]=u>>>3&7;Kt(o,1025,c+280|0)|0}o=M[4668+((u&7)<<2)>>2]&~M[4668+((u>>>3&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;S=c;return u|0}if((u&65280|0)==48640){o=M[2]|0;M[c+288>>2]=u&255;Kt(o,1039,c+288|0)|0;u=1;S=c;return u|0}t:do{if((u&57344|0)==57344){if((u&6144)<4096){switch(u&6144){case 2048:break;default:break t}t=(M[1181]|0)+(u<<1&4094)&-4|2;if(A[5300]|0){u=M[2]|0;M[c+304>>2]=t+-3;Kt(u,1052,c+304|0)|0}M[1181]=r|1;M[1182]=t;u=0;S=c;return u|0}switch(u&6144){case 4096:{if(A[5300]|0)pe(10,M[2]|0)|0;M[1181]=(((u&1024|0)==0?u&2047:u|1046528)<<12)+s;u=0;S=c;return u|0}case 6144:{t=(M[1181]|0)+(u<<1&4094)|0;if(A[5300]|0){u=M[2]|0;M[c+296>>2]=t+-1;Kt(u,1052,c+296|0)|0}M[1181]=r|1;M[1182]=t+2&-2;u=0;S=c;return u|0}default:break t}}}while(0);t=(A[5300]|0)!=0;e=1;i=(u&65415)<<16>>16;if(e)switch(i|0){case 18304:{if(t){o=M[2]|0;M[c+312>>2]=u>>>3&15;Kt(o,1063,c+312|0)|0}t=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(t&1|0){o=M[2]|0;M[c+320>>2]=t;Kt(o,520,c+320|0)|0}t=t&-2}t=t+2|0;if(!(t&1)){o=M[2]|0;M[c+328>>2]=s;M[c+328+4>>2]=u;Kt(o,1072,c+328|0)|0;u=2;S=c;return u|0}else{M[1181]=r|1;M[1182]=t&-2;u=0;S=c;return u|0}}case 18176:{if(t){o=M[2]|0;M[c+336>>2]=u>>>3&15;Kt(o,1108,c+336|0)|0}t=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(t&1|0){u=M[2]|0;M[c+344>>2]=t;Kt(u,520,c+344|0)|0}t=t&-2}t=t+2|0;if(t&1|0){M[1182]=t&-2;u=0;S=c;return u|0}t=ut(4,n|0,t|0)|0;if(t|0){u=t;S=c;return u|0}M[1182]=(M[1181]|0)+2&-2;u=0;S=c;return u|0}default:e=1}if(e)switch(i|0){default:{if((u&65472|0)==17088){if(t){o=M[2]|0;M[c+352>>2]=u&7;M[c+352+4>>2]=u>>>3&7;Kt(o,1154,c+352|0)|0}o=M[4668+((u&7)<<2)>>2]|0;a=M[4668+((u>>>3&7)<<2)>>2]|0;u=M[1184]|0;u=(a+o|0)<0?u|-2147483648:u&2147483647;u=(a+o|0)==0?u|1073741824:u&-1073741825;u=((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+(o&2147483647)|0)>>>31|0)==(((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}if((u&63488|0)==10240){if(t){o=M[2]|0;M[c+360>>2]=u>>>8&7;M[c+360+4>>2]=u&255;Kt(o,1168,c+360|0)|0}a=M[4668+((u>>>8&7)<<2)>>2]|0;o=M[1184]|0;o=(a-(u&255)|0)<0?o|-2147483648:o&2147483647;o=(a-(u&255)|0)==0?o|1073741824:o&-1073741825;o=(((a>>>31)+1+((-2147483648-(u&255)+(a&2147483647)|0)>>>31)|0)&2|0)==0?o&-536870913:o|536870912;M[1184]=((-2147483648-(u&255)+(a&2147483647)|0)>>>31|0)==(((a>>>31)+1+((-2147483648-(u&255)+(a&2147483647)|0)>>>31)|0)>>>1&1|0)?o&-268435457:o|268435456;u=0;S=c;return u|0}if((u&65472|0)==17024){if(t){o=M[2]|0;M[c+368>>2]=u&7;M[c+368+4>>2]=u>>>3&7;Kt(o,1185,c+368|0)|0}a=M[4668+((u&7)<<2)>>2]|0;o=M[4668+((u>>>3&7)<<2)>>2]|0;u=M[1184]|0;u=(a-o|0)<0?u|-2147483648:u&2147483647;u=(a-o|0)==0?u|1073741824:u&-1073741825;u=(((~o>>>31)+(a>>>31)+(((a&2147483647)+1+(~o&2147483647)|0)>>>31)|0)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+1+(~o&2147483647)|0)>>>31|0)==(((~o>>>31)+(a>>>31)+(((a&2147483647)+1+(~o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}if((u&65280|0)==17664){if(t){o=M[2]|0;M[c+376>>2]=u>>>4&8|u&7;M[c+376+4>>2]=u>>>3&15;Kt(o,1185,c+376|0)|0}t=M[4668+((u>>>4&8|u&7)<<2)>>2]|0;if((u>>>4&8|u&7|0)==15){if(t&1|0){o=M[2]|0;M[c+384>>2]=t;Kt(o,520,c+384|0)|0}e=t&-2}else e=t;t=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(t&1|0){u=M[2]|0;M[c+392>>2]=t;Kt(u,520,c+392|0)|0}t=t&-2}o=e-t|0;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;u=(o|0)==0?u|1073741824:u&-1073741825;o=~t;a=((e&2147483647)+1+(o&2147483647)|0)>>>31;o=(o>>>31)+(e>>>31)+a|0;u=(o&2|0)==0?u&-536870913:u|536870912;M[1184]=(a|0)==(o>>>1&1|0)?u&-268435457:u|268435456;u=0;S=c;return u|0}if((u&65512|0)==46688&t)Ht(1199,9,1,M[2]|0)|0;t=1;e=(u&65472)<<16>>16;if(t)switch(e|0){case 17920:{if(A[5300]|0){o=M[2]|0;M[c+400>>2]=u&7;M[c+400+4>>2]=u>>>3&7;Kt(o,1209,c+400|0)|0}M[4668+((u&7)<<2)>>2]=M[4668+((u>>>3&7)<<2)>>2];u=0;S=c;return u|0}case 16448:{if(A[5300]|0){o=M[2]|0;M[c+408>>2]=u&7;M[c+408+4>>2]=u>>>3&7;Kt(o,1222,c+408|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]^M[4668+((u&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;S=c;return u|0}default:t=1}if(t)switch(e|0){default:{t:do{if((u&63488)<<16>>16<26624){switch((u&63488)<<16>>16){case-14336:break;default:break t}if(!(A[5300]|0))e=u&1;else{e=M[2]|0;M[c+416>>2]=u>>>8&7;Kt(e,1236,c+416|0)|0;if(!(u&1))t=0;else{M[c+424>>2]=0;Kt(e,1249,c+424|0)|0;t=1}if(u&2){if(t|0)pe(44,e)|0;M[c+1176>>2]=1;Kt(e,1249,c+1176|0)|0;t=t+1|0}if(u&4){if(t|0)pe(44,e)|0;M[c+1184>>2]=2;Kt(e,1249,c+1184|0)|0;t=t+1|0}if(u&8){if(t|0)pe(44,e)|0;M[c+1192>>2]=3;Kt(e,1249,c+1192|0)|0;t=t+1|0}if(u&16){if(t|0)pe(44,e)|0;M[c+1200>>2]=4;Kt(e,1249,c+1200|0)|0;t=t+1|0}if(u&32){if(t|0)pe(44,e)|0;M[c+1208>>2]=5;Kt(e,1249,c+1208|0)|0;t=t+1|0}if(u&64){if(t|0)pe(44,e)|0;M[c+1216>>2]=6;Kt(e,1249,c+1216|0)|0;t=t+1|0}if(u&128|0){if(t|0)pe(44,e)|0;M[c+1224>>2]=7;Kt(e,1249,c+1224|0)|0}Ht(1253,2,1,e)|0;e=u&1}t=M[4668+((u>>>8&7)<<2)>>2]|0;if(e){M[1167]=tt(1,t|0)|0;t=t+4|0}if(u&2){M[1168]=tt(1,t|0)|0;t=t+4|0}if(u&4){M[1169]=tt(1,t|0)|0;t=t+4|0}if(u&8){M[1170]=tt(1,t|0)|0;t=t+4|0}if(u&16){M[1171]=tt(1,t|0)|0;t=t+4|0}if(u&32){M[1172]=tt(1,t|0)|0;t=t+4|0}if(u&64){M[1173]=tt(1,t|0)|0;t=t+4|0}if(u&128){M[1174]=tt(1,t|0)|0;t=t+4|0}if(1<<(u>>>8&7)&u|0){u=0;S=c;return u|0}M[4668+((u>>>8&7)<<2)>>2]=t;u=0;S=c;return u|0}else{switch((u&63488)<<16>>16){case 26624:break;default:break t}if(A[5300]|0){o=M[2]|0;M[c+432>>2]=u&7;M[c+432+4>>2]=u>>>3&7;M[c+432+8>>2]=u>>>4&124;Kt(o,1256,c+432|0)|0}M[4668+((u&7)<<2)>>2]=tt(1,(M[4668+((u>>>3&7)<<2)>>2]|0)+(u>>>4&124)|0)|0;u=0;S=c;return u|0}}while(0);if((u&65024|0)==22528){if(A[5300]|0){o=M[2]|0;M[c+448>>2]=u&7;M[c+448+4>>2]=u>>>3&7;M[c+448+8>>2]=u>>>6&7;Kt(o,1277,c+448|0)|0}M[4668+((u&7)<<2)>>2]=tt(1,(M[4668+((u>>>6&7)<<2)>>2]|0)+(M[4668+((u>>>3&7)<<2)>>2]|0)|0)|0;u=0;S=c;return u|0}t:do{if((u&63488)<<16>>16<18432){switch((u&63488)<<16>>16){case-26624:break;default:break t}if(A[5300]|0){o=M[2]|0;M[c+488>>2]=u>>>8&7;M[c+488+4>>2]=u<<2&1020;Kt(o,1325,c+488|0)|0}M[4668+((u>>>8&7)<<2)>>2]=tt(1,(M[1180]|0)+(u<<2&1020)|0)|0;u=0;S=c;return u|0}else{if((u&63488)<<16>>16>=30720){switch((u&63488)<<16>>16){case 30720:break;default:break t}if(A[5300]|0){o=M[2]|0;M[c+496>>2]=u&7;M[c+496+4>>2]=u>>>3&7;M[c+496+8>>2]=u>>>6&31;Kt(o,1345,c+496|0)|0}a=M[4668+((u>>>3&7)<<2)>>2]|0;o=tt(3,a+(u>>>6&31)&-2|0)|0;M[4668+((u&7)<<2)>>2]=((a+(u>>>6)&1|0)==0?o:o>>>8)&255;u=0;S=c;return u|0}switch((u&63488)<<16>>16){case 18432:break;default:break t}if(A[5300]|0){o=M[2]|0;M[c+464>>2]=u>>>8&7;M[c+464+4>>2]=u<<2&1020;Kt(o,1296,c+464|0)|0}t=M[1182]|0;if(t&1|0){o=M[2]|0;M[c+472>>2]=t;Kt(o,520,c+472|0)|0}if(A[5300]|0){o=M[2]|0;M[c+480>>2]=(t&-4)+(u<<2&1020);Kt(o,1316,c+480|0)|0}M[4668+((u>>>8&7)<<2)>>2]=tt(1,(t&-4)+(u<<2&1020)|0)|0;u=0;S=c;return u|0}}while(0);M[c+1368>>2]=o;M[c+3472>>2]=n;M[c+3496>>2]=u;M[c+3504>>2]=s;M[c+4792>>2]=0;M[c+4796>>2]=0;Oe(c);w=M[c+4792>>2]|0;g=M[c+4796>>2]|0;C=+l[c+4796>>2];M[c+4792>>2]=0;M[c+4796>>2]=0;if((w|0)==6)return g|0}}}}}}return 0}function Pt(t){t=t|0;var e=0,r=0,i=0,n=0,s=0,a=0,o=0,u=0,c=0,l=0,h=0,_=0,d=0;d=S;S=S+16|0;do{if(t>>>0<245){h=t>>>0<11?16:t+11&-8;c=M[1185]|0;if(c>>>(h>>>3)&3|0){t=4780+((c>>>(h>>>3)&1^1)+(h>>>3)<<1<<2)|0;e=M[t+8>>2]|0;r=M[e+8>>2]|0;if((t|0)==(r|0))M[1185]=c&~(1<<(c>>>(h>>>3)&1^1)+(h>>>3));else{M[r+12>>2]=t;M[t+8>>2]=r}_=(c>>>(h>>>3)&1^1)+(h>>>3)<<3;M[e+4>>2]=_|3;M[e+_+4>>2]=M[e+_+4>>2]|1;_=e+8|0;S=d;return _|0}l=M[1187]|0;if(h>>>0>l>>>0){if(c>>>(h>>>3)|0){t=c>>>(h>>>3)<<(h>>>3)&(2<<(h>>>3)|0-(2<<(h>>>3)));n=((t&0-t)+-1|0)>>>(((t&0-t)+-1|0)>>>12&16);i=n>>>(n>>>5&8)>>>(n>>>(n>>>5&8)>>>2&4);i=(n>>>5&8|((t&0-t)+-1|0)>>>12&16|n>>>(n>>>5&8)>>>2&4|i>>>1&2|i>>>(i>>>1&2)>>>1&1)+(i>>>(i>>>1&2)>>>(i>>>(i>>>1&2)>>>1&1))|0;n=M[4780+(i<<1<<2)+8>>2]|0;t=M[n+8>>2]|0;if((4780+(i<<1<<2)|0)==(t|0)){M[1185]=c&~(1<<i);t=c&~(1<<i)}else{M[t+12>>2]=4780+(i<<1<<2);M[4780+(i<<1<<2)+8>>2]=t;t=c}M[n+4>>2]=h|3;M[n+h+4>>2]=(i<<3)-h|1;M[n+h+((i<<3)-h)>>2]=(i<<3)-h;if(l|0){r=M[1190]|0;if(!(t&1<<(l>>>3))){M[1185]=t|1<<(l>>>3);t=4780+(l>>>3<<1<<2)|0;e=4780+(l>>>3<<1<<2)+8|0}else{t=M[4780+(l>>>3<<1<<2)+8>>2]|0;e=4780+(l>>>3<<1<<2)+8|0}M[e>>2]=r;M[t+12>>2]=r;M[r+8>>2]=t;M[r+12>>2]=4780+(l>>>3<<1<<2)}M[1187]=(i<<3)-h;M[1190]=n+h;_=n+8|0;S=d;return _|0}u=M[1186]|0;if(u){e=((u&0-u)+-1|0)>>>(((u&0-u)+-1|0)>>>12&16);t=e>>>(e>>>5&8)>>>(e>>>(e>>>5&8)>>>2&4);t=M[5044+((e>>>5&8|((u&0-u)+-1|0)>>>12&16|e>>>(e>>>5&8)>>>2&4|t>>>1&2|t>>>(t>>>1&2)>>>1&1)+(t>>>(t>>>1&2)>>>(t>>>(t>>>1&2)>>>1&1))<<2)>>2]|0;e=(M[t+4>>2]&-8)-h|0;r=M[t+16+(((M[t+16>>2]|0)==0&1)<<2)>>2]|0;if(!r){o=t;s=e}else{do{a=(M[r+4>>2]&-8)-h|0;o=a>>>0<e>>>0;e=o?a:e;t=o?r:t;r=M[r+16+(((M[r+16>>2]|0)==0&1)<<2)>>2]|0}while((r|0)!=0);o=t;s=e}a=o+h|0;if(o>>>0<a>>>0){n=M[o+24>>2]|0;t=M[o+12>>2]|0;do{if((t|0)==(o|0)){e=o+20|0;t=M[e>>2]|0;if(!t){e=o+16|0;t=M[e>>2]|0;if(!t){e=0;break}}while(1){r=t+20|0;i=M[r>>2]|0;if(i|0){t=i;e=r;continue}r=t+16|0;i=M[r>>2]|0;if(!i)break;else{t=i;e=r}}M[e>>2]=0;e=t}else{e=M[o+8>>2]|0;M[e+12>>2]=t;M[t+8>>2]=e;e=t}}while(0);do{if(n|0){t=M[o+28>>2]|0;if((o|0)==(M[5044+(t<<2)>>2]|0)){M[5044+(t<<2)>>2]=e;if(!e){M[1186]=u&~(1<<t);break}}else{M[n+16+(((M[n+16>>2]|0)!=(o|0)&1)<<2)>>2]=e;if(!e)break}M[e+24>>2]=n;t=M[o+16>>2]|0;if(t|0){M[e+16>>2]=t;M[t+24>>2]=e}t=M[o+20>>2]|0;if(t|0){M[e+20>>2]=t;M[t+24>>2]=e}}}while(0);if(s>>>0<16){_=s+h|0;M[o+4>>2]=_|3;_=o+_+4|0;M[_>>2]=M[_>>2]|1}else{M[o+4>>2]=h|3;M[a+4>>2]=s|1;M[a+s>>2]=s;if(l|0){r=M[1190]|0;if(!(c&1<<(l>>>3))){M[1185]=c|1<<(l>>>3);t=4780+(l>>>3<<1<<2)|0;e=4780+(l>>>3<<1<<2)+8|0}else{t=M[4780+(l>>>3<<1<<2)+8>>2]|0;e=4780+(l>>>3<<1<<2)+8|0}M[e>>2]=r;M[t+12>>2]=r;M[r+8>>2]=t;M[r+12>>2]=4780+(l>>>3<<1<<2)}M[1187]=s;M[1190]=a}_=o+8|0;S=d;return _|0}}}}else if(t>>>0>4294967231)h=-1;else{h=t+11&-8;u=M[1186]|0;if(u){if(!((t+11|0)>>>8))a=0;else if(h>>>0>16777215)a=31;else{a=(t+11|0)>>>8<<((((t+11|0)>>>8)+1048320|0)>>>16&8);a=14-((a+520192|0)>>>16&4|(((t+11|0)>>>8)+1048320|0)>>>16&8|((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)+(a<<((a+520192|0)>>>16&4)<<(((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;a=h>>>(a+7|0)&1|a<<1}e=M[5044+(a<<2)>>2]|0;t:do{if(!e){e=0;t=0;r=0-h|0;_=57}else{t=0;r=0-h|0;s=h<<((a|0)==31?0:25-(a>>>1)|0);n=0;while(1){i=(M[e+4>>2]&-8)-h|0;if(i>>>0<r>>>0)if(!i){t=e;r=0;i=e;_=61;break t}else{t=e;r=i}i=M[e+20>>2]|0;e=M[e+16+(s>>>31<<2)>>2]|0;n=(i|0)==0|(i|0)==(e|0)?n:i;i=(e|0)==0;if(i){e=n;_=57;break}else s=s<<((i^1)&1)}}}while(0);if((_|0)==57){if((e|0)==0&(t|0)==0){t=2<<a;if(!(u&(t|0-t)))break;c=(u&(t|0-t)&0-(u&(t|0-t)))+-1|0;l=c>>>(c>>>12&16)>>>(c>>>(c>>>12&16)>>>5&8);e=l>>>(l>>>2&4)>>>(l>>>(l>>>2&4)>>>1&2);t=0;e=M[5044+((c>>>(c>>>12&16)>>>5&8|c>>>12&16|l>>>2&4|l>>>(l>>>2&4)>>>1&2|e>>>1&1)+(e>>>(e>>>1&1))<<2)>>2]|0}if(!e){o=t;s=r}else{i=e;_=61}}if((_|0)==61)while(1){_=0;e=(M[i+4>>2]&-8)-h|0;l=e>>>0<r>>>0;e=l?e:r;t=l?i:t;i=M[i+16+(((M[i+16>>2]|0)==0&1)<<2)>>2]|0;if(!i){o=t;s=e;break}else{r=e;_=61}}if(o)if(s>>>0<((M[1187]|0)-h|0)>>>0){a=o+h|0;if(o>>>0>=a>>>0){_=0;S=d;return _|0}n=M[o+24>>2]|0;t=M[o+12>>2]|0;do{if((t|0)==(o|0)){e=o+20|0;t=M[e>>2]|0;if(!t){e=o+16|0;t=M[e>>2]|0;if(!t){t=0;break}}while(1){r=t+20|0;i=M[r>>2]|0;if(i|0){t=i;e=r;continue}r=t+16|0;i=M[r>>2]|0;if(!i)break;else{t=i;e=r}}M[e>>2]=0}else{_=M[o+8>>2]|0;M[_+12>>2]=t;M[t+8>>2]=_}}while(0);do{if(!n)i=u;else{e=M[o+28>>2]|0;if((o|0)==(M[5044+(e<<2)>>2]|0)){M[5044+(e<<2)>>2]=t;if(!t){M[1186]=u&~(1<<e);i=u&~(1<<e);break}}else{M[n+16+(((M[n+16>>2]|0)!=(o|0)&1)<<2)>>2]=t;if(!t){i=u;break}}M[t+24>>2]=n;e=M[o+16>>2]|0;if(e|0){M[t+16>>2]=e;M[e+24>>2]=t}e=M[o+20>>2]|0;if(!e)i=u;else{M[t+20>>2]=e;M[e+24>>2]=t;i=u}}}while(0);do{if(s>>>0<16){_=s+h|0;M[o+4>>2]=_|3;_=o+_+4|0;M[_>>2]=M[_>>2]|1}else{M[o+4>>2]=h|3;M[a+4>>2]=s|1;M[a+s>>2]=s;r=s>>>3;if(s>>>0<256){t=M[1185]|0;if(!(t&1<<r)){M[1185]=t|1<<r;t=4780+(r<<1<<2)|0;e=4780+(r<<1<<2)+8|0}else{t=M[4780+(r<<1<<2)+8>>2]|0;e=4780+(r<<1<<2)+8|0}M[e>>2]=a;M[t+12>>2]=a;M[a+8>>2]=t;M[a+12>>2]=4780+(r<<1<<2);break}t=s>>>8;if(!t)t=0;else if(s>>>0>16777215)t=31;else{_=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);t=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(_+245760|0)>>>16&2)+(_<<((_+245760|0)>>>16&2)>>>15)|0;t=s>>>(t+7|0)&1|t<<1}r=5044+(t<<2)|0;M[a+28>>2]=t;M[a+16+4>>2]=0;M[a+16>>2]=0;e=1<<t;if(!(i&e)){M[1186]=i|e;M[r>>2]=a;M[a+24>>2]=r;M[a+12>>2]=a;M[a+8>>2]=a;break}e=s<<((t|0)==31?0:25-(t>>>1)|0);r=M[r>>2]|0;while(1){if((M[r+4>>2]&-8|0)==(s|0)){_=97;break}i=r+16+(e>>>31<<2)|0;t=M[i>>2]|0;if(!t){_=96;break}else{e=e<<1;r=t}}if((_|0)==96){M[i>>2]=a;M[a+24>>2]=r;M[a+12>>2]=a;M[a+8>>2]=a;break}else if((_|0)==97){h=r+8|0;_=M[h>>2]|0;M[_+12>>2]=a;M[h>>2]=a;M[a+8>>2]=_;M[a+12>>2]=r;M[a+24>>2]=0;break}}}while(0);_=o+8|0;S=d;return _|0}}}}while(0);r=M[1187]|0;if(r>>>0>=h>>>0){t=r-h|0;e=M[1190]|0;if(t>>>0>15){_=e+h|0;M[1190]=_;M[1187]=t;M[_+4>>2]=t|1;M[_+t>>2]=t;M[e+4>>2]=h|3}else{M[1187]=0;M[1190]=0;M[e+4>>2]=r|3;M[e+r+4>>2]=M[e+r+4>>2]|1}_=e+8|0;S=d;return _|0}s=M[1188]|0;if(s>>>0>h>>>0){c=s-h|0;M[1188]=c;_=M[1191]|0;l=_+h|0;M[1191]=l;M[l+4>>2]=c|1;M[_+4>>2]=h|3;_=_+8|0;S=d;return _|0}if(!(M[1303]|0)){M[1305]=4096;M[1304]=4096;M[1306]=-1;M[1307]=-1;M[1308]=0;M[1296]=0;M[d>>2]=d&-16^1431655768;M[1303]=d&-16^1431655768;t=4096}else t=M[1305]|0;a=h+48|0;o=h+47|0;c=t+o|0;u=0-t|0;if((c&u)>>>0<=h>>>0){_=0;S=d;return _|0}t=M[1295]|0;if(t|0){l=M[1293]|0;if((l+(c&u)|0)>>>0<=l>>>0?1:(l+(c&u)|0)>>>0>t>>>0){_=0;S=d;return _|0}}t:do{if(!(M[1296]&4)){r=M[1191]|0;e:do{if(!r)_=118;else{t=5188;while(1){e=M[t>>2]|0;if(e>>>0<=r>>>0){n=t+4|0;if((e+(M[n>>2]|0)|0)>>>0>r>>>0)break}t=M[t+8>>2]|0;if(!t){_=118;break e}}if((c-s&u)>>>0<2147483647){i=Pe(c-s&u|0)|0;if((i|0)==((M[t>>2]|0)+(M[n>>2]|0)|0))if((i|0)==(-1|0))t=c-s&u;else{s=c-s&u;_=135;break t}else{r=c-s&u;_=126}}else t=0}}while(0);do{if((_|0)==118){n=Pe(0)|0;if((n|0)==(-1|0))t=0;else{r=M[1304]|0;r=((r+-1&n|0)==0?0:(r+-1+n&0-r)-n|0)+(c&u)|0;t=M[1293]|0;if(r>>>0>h>>>0&r>>>0<2147483647){e=M[1295]|0;if(e|0)if((r+t|0)>>>0<=t>>>0|(r+t|0)>>>0>e>>>0){t=0;break}i=Pe(r|0)|0;if((i|0)==(n|0)){s=r;i=n;_=135;break t}else _=126}else t=0}}}while(0);do{if((_|0)==126){e=0-r|0;if(!(a>>>0>r>>>0&(r>>>0<2147483647&(i|0)!=(-1|0))))if((i|0)==(-1|0)){t=0;break}else{s=r;_=135;break t}t=M[1305]|0;t=o-r+t&0-t;if(t>>>0>=2147483647){s=r;_=135;break t}if((Pe(t|0)|0)==(-1|0)){Pe(e|0)|0;t=0;break}else{s=t+r|0;_=135;break t}}}while(0);M[1296]=M[1296]|4;_=133}else{t=0;_=133}}while(0);if((_|0)==133)if((c&u)>>>0<2147483647){i=Pe(c&u|0)|0;e=Pe(0)|0;r=(e-i|0)>>>0>(h+40|0)>>>0;if(!((i|0)==(-1|0)|r^1|i>>>0<e>>>0&((i|0)!=(-1|0)&(e|0)!=(-1|0))^1)){s=r?e-i|0:t;_=135}}if((_|0)==135){t=(M[1293]|0)+s|0;M[1293]=t;if(t>>>0>(M[1294]|0)>>>0)M[1294]=t;a=M[1191]|0;do{if(!a){_=M[1189]|0;if((_|0)==0|i>>>0<_>>>0)M[1189]=i;M[1297]=i;M[1298]=s;M[1300]=0;M[1194]=M[1303];M[1193]=-1;t=0;do{_=4780+(t<<1<<2)|0;M[_+12>>2]=_;M[_+8>>2]=_;t=t+1|0}while((t|0)!=32);_=i+8|0;_=(_&7|0)==0?0:0-_&7;l=i+_|0;_=s+-40-_|0;M[1191]=l;M[1188]=_;M[l+4>>2]=_|1;M[l+_+4>>2]=40;M[1192]=M[1307]}else{t=5188;do{e=M[t>>2]|0;r=t+4|0;n=M[r>>2]|0;if((i|0)==(e+n|0)){_=145;break}t=M[t+8>>2]|0}while((t|0)!=0);if((_|0)==145)if(!(M[t+12>>2]&8))if(a>>>0<i>>>0&a>>>0>=e>>>0){M[r>>2]=n+s;l=(a+8&7|0)==0?0:0-(a+8)&7;_=(M[1188]|0)+(s-l)|0;M[1191]=a+l;M[1188]=_;M[a+l+4>>2]=_|1;M[a+l+_+4>>2]=40;M[1192]=M[1307];break}if(i>>>0<(M[1189]|0)>>>0)M[1189]=i;e=i+s|0;t=5188;do{if((M[t>>2]|0)==(e|0)){_=153;break}t=M[t+8>>2]|0}while((t|0)!=0);if((_|0)==153)if(!(M[t+12>>2]&8)){M[t>>2]=i;c=t+4|0;M[c>>2]=(M[c>>2]|0)+s;c=i+8|0;c=i+((c&7|0)==0?0:0-c&7)|0;t=e+((e+8&7|0)==0?0:0-(e+8)&7)|0;u=c+h|0;o=t-c-h|0;M[c+4>>2]=h|3;do{if((t|0)==(a|0)){_=(M[1188]|0)+o|0;M[1188]=_;M[1191]=u;M[u+4>>2]=_|1}else{if((t|0)==(M[1190]|0)){_=(M[1187]|0)+o|0;M[1187]=_;M[1190]=u;M[u+4>>2]=_|1;M[u+_>>2]=_;break}a=M[t+4>>2]|0;if((a&3|0)==1){t:do{if(a>>>0<256){e=M[t+8>>2]|0;r=M[t+12>>2]|0;if((r|0)==(e|0)){M[1185]=M[1185]&~(1<<(a>>>3));break}else{M[e+12>>2]=r;M[r+8>>2]=e;break}}else{s=M[t+24>>2]|0;e=M[t+12>>2]|0;do{if((e|0)==(t|0)){e=M[t+16+4>>2]|0;if(!e){e=M[t+16>>2]|0;if(!e){e=0;break}else n=t+16|0}else n=t+16+4|0;while(1){r=e+20|0;i=M[r>>2]|0;if(i|0){e=i;n=r;continue}r=e+16|0;i=M[r>>2]|0;if(!i)break;else{e=i;n=r}}M[n>>2]=0}else{_=M[t+8>>2]|0;M[_+12>>2]=e;M[e+8>>2]=_}}while(0);if(!s)break;r=M[t+28>>2]|0;do{if((t|0)==(M[5044+(r<<2)>>2]|0)){M[5044+(r<<2)>>2]=e;if(e|0)break;M[1186]=M[1186]&~(1<<r);break t}else{M[s+16+(((M[s+16>>2]|0)!=(t|0)&1)<<2)>>2]=e;if(!e)break t}}while(0);M[e+24>>2]=s;r=M[t+16>>2]|0;if(r|0){M[e+16>>2]=r;M[r+24>>2]=e}r=M[t+16+4>>2]|0;if(!r)break;M[e+20>>2]=r;M[r+24>>2]=e}}while(0);t=t+(a&-8)|0;n=(a&-8)+o|0}else n=o;r=t+4|0;M[r>>2]=M[r>>2]&-2;M[u+4>>2]=n|1;M[u+n>>2]=n;r=n>>>3;if(n>>>0<256){t=M[1185]|0;if(!(t&1<<r)){M[1185]=t|1<<r;t=4780+(r<<1<<2)|0;e=4780+(r<<1<<2)+8|0}else{t=M[4780+(r<<1<<2)+8>>2]|0;e=4780+(r<<1<<2)+8|0}M[e>>2]=u;M[t+12>>2]=u;M[u+8>>2]=t;M[u+12>>2]=4780+(r<<1<<2);break}t=n>>>8;do{if(!t)t=0;else{if(n>>>0>16777215){t=31;break}_=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);t=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(_+245760|0)>>>16&2)+(_<<((_+245760|0)>>>16&2)>>>15)|0;t=n>>>(t+7|0)&1|t<<1}}while(0);i=5044+(t<<2)|0;M[u+28>>2]=t;M[u+16+4>>2]=0;M[u+16>>2]=0;e=M[1186]|0;r=1<<t;if(!(e&r)){M[1186]=e|r;M[i>>2]=u;M[u+24>>2]=i;M[u+12>>2]=u;M[u+8>>2]=u;break}e=n<<((t|0)==31?0:25-(t>>>1)|0);r=M[i>>2]|0;while(1){if((M[r+4>>2]&-8|0)==(n|0)){_=194;break}i=r+16+(e>>>31<<2)|0;t=M[i>>2]|0;if(!t){_=193;break}else{e=e<<1;r=t}}if((_|0)==193){M[i>>2]=u;M[u+24>>2]=r;M[u+12>>2]=u;M[u+8>>2]=u;break}else if((_|0)==194){h=r+8|0;_=M[h>>2]|0;M[_+12>>2]=u;M[h>>2]=u;M[u+8>>2]=_;M[u+12>>2]=r;M[u+24>>2]=0;break}}}while(0);_=c+8|0;S=d;return _|0}e=5188;while(1){t=M[e>>2]|0;if(t>>>0<=a>>>0){r=t+(M[e+4>>2]|0)|0;if(r>>>0>a>>>0)break}e=M[e+8>>2]|0}n=r+-47+((r+-47+8&7|0)==0?0:0-(r+-47+8)&7)|0;n=n>>>0<(a+16|0)>>>0?a:n;t=i+8|0;t=(t&7|0)==0?0:0-t&7;_=i+t|0;t=s+-40-t|0;M[1191]=_;M[1188]=t;M[_+4>>2]=t|1;M[_+t+4>>2]=40;M[1192]=M[1307];M[n+4>>2]=27;M[n+8>>2]=M[1297];M[n+8+4>>2]=M[1298];M[n+8+8>>2]=M[1299];M[n+8+12>>2]=M[1300];M[1297]=i;M[1298]=s;M[1300]=0;M[1299]=n+8;t=n+24|0;do{_=t;t=t+4|0;M[t>>2]=7}while((_+8|0)>>>0<r>>>0);if((n|0)!=(a|0)){M[n+4>>2]=M[n+4>>2]&-2;M[a+4>>2]=n-a|1;M[n>>2]=n-a;if((n-a|0)>>>0<256){r=4780+((n-a|0)>>>3<<1<<2)|0;t=M[1185]|0;if(!(t&1<<((n-a|0)>>>3))){M[1185]=t|1<<((n-a|0)>>>3);t=r;e=r+8|0}else{t=M[r+8>>2]|0;e=r+8|0}M[e>>2]=a;M[t+12>>2]=a;M[a+8>>2]=t;M[a+12>>2]=r;break}if(!((n-a|0)>>>8))t=0;else if((n-a|0)>>>0>16777215)t=31;else{t=(n-a|0)>>>8<<((((n-a|0)>>>8)+1048320|0)>>>16&8);t=14-((t+520192|0)>>>16&4|(((n-a|0)>>>8)+1048320|0)>>>16&8|((t<<((t+520192|0)>>>16&4))+245760|0)>>>16&2)+(t<<((t+520192|0)>>>16&4)<<(((t<<((t+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;t=(n-a|0)>>>(t+7|0)&1|t<<1}i=5044+(t<<2)|0;M[a+28>>2]=t;M[a+20>>2]=0;M[a+16>>2]=0;e=M[1186]|0;r=1<<t;if(!(e&r)){M[1186]=e|r;M[i>>2]=a;M[a+24>>2]=i;M[a+12>>2]=a;M[a+8>>2]=a;break}e=n-a<<((t|0)==31?0:25-(t>>>1)|0);r=M[i>>2]|0;while(1){if((M[r+4>>2]&-8|0)==(n-a|0)){_=216;break}i=r+16+(e>>>31<<2)|0;t=M[i>>2]|0;if(!t){_=215;break}else{e=e<<1;r=t}}if((_|0)==215){M[i>>2]=a;M[a+24>>2]=r;M[a+12>>2]=a;M[a+8>>2]=a;break}else if((_|0)==216){l=r+8|0;_=M[l>>2]|0;M[_+12>>2]=a;M[l>>2]=a;M[a+8>>2]=_;M[a+12>>2]=r;M[a+24>>2]=0;break}}}}while(0);t=M[1188]|0;if(t>>>0>h>>>0){c=t-h|0;M[1188]=c;_=M[1191]|0;l=_+h|0;M[1191]=l;M[l+4>>2]=c|1;M[_+4>>2]=h|3;_=_+8|0;S=d;return _|0}}M[(Ot()|0)>>2]=12;_=0;S=d;return _|0}function St(t){t=t|0;var e=0,r=0,i=0,n=0,s=0,a=0,o=0,u=0;if(!t)return;e=M[1189]|0;r=M[t+-4>>2]|0;u=t+-8+(r&-8)|0;do{if(!(r&1)){i=M[t+-8>>2]|0;if(!(r&3))return;a=t+-8+(0-i)|0;s=i+(r&-8)|0;if(a>>>0<e>>>0)return;if((a|0)==(M[1190]|0)){t=M[u+4>>2]|0;if((t&3|0)!=3){o=a;e=s;break}M[1187]=s;M[u+4>>2]=t&-2;M[a+4>>2]=s|1;M[a+s>>2]=s;return}if(i>>>0<256){t=M[a+8>>2]|0;e=M[a+12>>2]|0;if((e|0)==(t|0)){M[1185]=M[1185]&~(1<<(i>>>3));o=a;e=s;break}else{M[t+12>>2]=e;M[e+8>>2]=t;o=a;e=s;break}}n=M[a+24>>2]|0;t=M[a+12>>2]|0;do{if((t|0)==(a|0)){t=M[a+16+4>>2]|0;if(!t){t=M[a+16>>2]|0;if(!t){t=0;break}else i=a+16|0}else i=a+16+4|0;while(1){e=t+20|0;r=M[e>>2]|0;if(r|0){t=r;i=e;continue}e=t+16|0;r=M[e>>2]|0;if(!r)break;else{t=r;i=e}}M[i>>2]=0}else{o=M[a+8>>2]|0;M[o+12>>2]=t;M[t+8>>2]=o}}while(0);if(!n){o=a;e=s}else{e=M[a+28>>2]|0;if((a|0)==(M[5044+(e<<2)>>2]|0)){M[5044+(e<<2)>>2]=t;if(!t){M[1186]=M[1186]&~(1<<e);o=a;e=s;break}}else{M[n+16+(((M[n+16>>2]|0)!=(a|0)&1)<<2)>>2]=t;if(!t){o=a;e=s;break}}M[t+24>>2]=n;e=M[a+16>>2]|0;if(e|0){M[t+16>>2]=e;M[e+24>>2]=t}e=M[a+16+4>>2]|0;if(!e){o=a;e=s}else{M[t+20>>2]=e;M[e+24>>2]=t;o=a;e=s}}}else{o=t+-8|0;e=r&-8;a=t+-8|0}}while(0);if(a>>>0>=u>>>0)return;r=M[u+4>>2]|0;if(!(r&1))return;if(!(r&2)){t=M[1190]|0;if((u|0)==(M[1191]|0)){u=(M[1188]|0)+e|0;M[1188]=u;M[1191]=o;M[o+4>>2]=u|1;if((o|0)!=(t|0))return;M[1190]=0;M[1187]=0;return}if((u|0)==(t|0)){u=(M[1187]|0)+e|0;M[1187]=u;M[1190]=a;M[o+4>>2]=u|1;M[a+u>>2]=u;return}n=(r&-8)+e|0;do{if(r>>>0<256){e=M[u+8>>2]|0;t=M[u+12>>2]|0;if((t|0)==(e|0)){M[1185]=M[1185]&~(1<<(r>>>3));break}else{M[e+12>>2]=t;M[t+8>>2]=e;break}}else{s=M[u+24>>2]|0;t=M[u+12>>2]|0;do{if((t|0)==(u|0)){t=M[u+16+4>>2]|0;if(!t){t=M[u+16>>2]|0;if(!t){e=0;break}else i=u+16|0}else i=u+16+4|0;while(1){e=t+20|0;r=M[e>>2]|0;if(r|0){t=r;i=e;continue}e=t+16|0;r=M[e>>2]|0;if(!r)break;else{t=r;i=e}}M[i>>2]=0;e=t}else{e=M[u+8>>2]|0;M[e+12>>2]=t;M[t+8>>2]=e;e=t}}while(0);if(s|0){t=M[u+28>>2]|0;if((u|0)==(M[5044+(t<<2)>>2]|0)){M[5044+(t<<2)>>2]=e;if(!e){M[1186]=M[1186]&~(1<<t);break}}else{M[s+16+(((M[s+16>>2]|0)!=(u|0)&1)<<2)>>2]=e;if(!e)break}M[e+24>>2]=s;t=M[u+16>>2]|0;if(t|0){M[e+16>>2]=t;M[t+24>>2]=e}t=M[u+16+4>>2]|0;if(t|0){M[e+20>>2]=t;M[t+24>>2]=e}}}}while(0);M[o+4>>2]=n|1;M[a+n>>2]=n;if((o|0)==(M[1190]|0)){M[1187]=n;return}}else{M[u+4>>2]=r&-2;M[o+4>>2]=e|1;M[a+e>>2]=e;n=e}r=n>>>3;if(n>>>0<256){t=M[1185]|0;if(!(t&1<<r)){M[1185]=t|1<<r;t=4780+(r<<1<<2)|0;e=4780+(r<<1<<2)+8|0}else{t=M[4780+(r<<1<<2)+8>>2]|0;e=4780+(r<<1<<2)+8|0}M[e>>2]=o;M[t+12>>2]=o;M[o+8>>2]=t;M[o+12>>2]=4780+(r<<1<<2);return}t=n>>>8;if(!t)t=0;else if(n>>>0>16777215)t=31;else{u=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);t=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(u+245760|0)>>>16&2)+(u<<((u+245760|0)>>>16&2)>>>15)|0;t=n>>>(t+7|0)&1|t<<1}i=5044+(t<<2)|0;M[o+28>>2]=t;M[o+20>>2]=0;M[o+16>>2]=0;e=M[1186]|0;r=1<<t;do{if(!(e&r)){M[1186]=e|r;M[i>>2]=o;M[o+24>>2]=i;M[o+12>>2]=o;M[o+8>>2]=o}else{e=n<<((t|0)==31?0:25-(t>>>1)|0);r=M[i>>2]|0;while(1){if((M[r+4>>2]&-8|0)==(n|0)){t=73;break}i=r+16+(e>>>31<<2)|0;t=M[i>>2]|0;if(!t){t=72;break}else{e=e<<1;r=t}}if((t|0)==72){M[i>>2]=o;M[o+24>>2]=r;M[o+12>>2]=o;M[o+8>>2]=o;break}else if((t|0)==73){a=r+8|0;u=M[a>>2]|0;M[u+12>>2]=o;M[a>>2]=o;M[o+8>>2]=u;M[o+12>>2]=r;M[o+24>>2]=0;break}}}while(0);u=(M[1193]|0)+-1|0;M[1193]=u;if(!u)t=5196;else return;while(1){t=M[t>>2]|0;if(!t)break;else t=t+8|0}M[1193]=-1;return}function Tt(){return 5236}function It(t){t=t|0;var e=0;e=S;S=S+16|0;M[e>>2]=Lt(M[t+60>>2]|0)|0;t=xt(et(6,e|0)|0)|0;S=e;return t|0}function Et(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0,a=0,o=0,u=0,c=0;o=S;S=S+48|0;i=M[t+28>>2]|0;M[o+32>>2]=i;i=(M[t+20>>2]|0)-i|0;M[o+32+4>>2]=i;M[o+32+8>>2]=e;M[o+32+12>>2]=r;M[o>>2]=M[t+60>>2];M[o+4>>2]=o+32;M[o+8>>2]=2;n=xt(it(146,o|0)|0)|0;t:do{if((i+r|0)==(n|0))a=3;else{e=2;s=i+r|0;i=o+32|0;while(1){if((n|0)<0)break;s=s-n|0;u=M[i+4>>2]|0;c=n>>>0>u>>>0;i=c?i+8|0:i;e=(c<<31>>31)+e|0;u=n-(c?u:0)|0;M[i>>2]=(M[i>>2]|0)+u;M[i+4>>2]=(M[i+4>>2]|0)-u;M[o+16>>2]=M[t+60>>2];M[o+16+4>>2]=i;M[o+16+8>>2]=e;n=xt(it(146,o+16|0)|0)|0;if((s|0)==(n|0)){a=3;break t}}M[t+16>>2]=0;M[t+28>>2]=0;M[t+20>>2]=0;M[t>>2]=M[t>>2]|32;if((e|0)==2)r=0;else r=r-(M[i+4>>2]|0)|0}}while(0);if((a|0)==3){c=M[t+44>>2]|0;M[t+16>>2]=c+(M[t+48>>2]|0);M[t+28>>2]=c;M[t+20>>2]=c}S=o;return r|0}function Rt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0;i=S;S=S+32|0;M[i>>2]=M[t+60>>2];M[i+4>>2]=0;M[i+8>>2]=e;M[i+12>>2]=i+20;M[i+16>>2]=r;if((xt(st(140,i|0)|0)|0)<0){M[i+20>>2]=-1;t=-1}else t=M[i+20>>2]|0;S=i;return t|0}function xt(t){t=t|0;if(t>>>0>4294963200){M[(Ot()|0)>>2]=0-t;t=-1}return t|0}function Ot(){return(Bt()|0)+64|0}function Bt(){return Ft()|0}function Ft(){return 136}function Lt(t){t=t|0;return t|0}function Dt(t,e){t=t|0;e=e|0;var r=0,i=0;r=A[t>>0]|0;i=A[e>>0]|0;if(r<<24>>24==0?1:r<<24>>24!=i<<24>>24)t=i;else{do{t=t+1|0;e=e+1|0;r=A[t>>0]|0;i=A[e>>0]|0}while(!(r<<24>>24==0?1:r<<24>>24!=i<<24>>24));t=i}return(r&255)-(t&255)|0}function Ht(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;var n=0,s=0;n=V(r,e)|0;r=(e|0)==0?0:r;if((M[i+76>>2]|0)>-1){s=(Nt(i)|0)==0;t=Vt(t,n,i)|0;if(!s)Ut(i)}else t=Vt(t,n,i)|0;if((t|0)!=(n|0))r=(t>>>0)/(e>>>0)|0;return r|0}function Ut(t){t=t|0;return}function Nt(t){t=t|0;return 0}function jt(t,e){t=t|0;e=e|0;var r=0,i=0,n=0,s=0;s=S;S=S+16|0;A[s>>0]=e;r=M[t+16>>2]|0;if(!r)if(!(Wt(t)|0)){i=M[t+16>>2]|0;n=4}else r=-1;else{i=r;n=4}do{if((n|0)==4){r=M[t+20>>2]|0;if(r>>>0<i>>>0)if((e&255|0)!=(A[t+75>>0]|0)){M[t+20>>2]=r+1;A[r>>0]=e;r=e&255;break}if((Fe[M[t+36>>2]&3](t,s,1)|0)==1)r=P[s>>0]|0;else r=-1}}while(0);S=s;return r|0}function Wt(t){t=t|0;var e=0;e=A[t+74>>0]|0;A[t+74>>0]=e+255|e;e=M[t>>2]|0;if(!(e&8)){M[t+8>>2]=0;M[t+4>>2]=0;e=M[t+44>>2]|0;M[t+28>>2]=e;M[t+20>>2]=e;M[t+16>>2]=e+(M[t+48>>2]|0);t=0}else{M[t>>2]=e|32;t=-1}return t|0}function Vt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0,a=0;i=M[r+16>>2]|0;if(!i)if(!(Wt(r)|0)){n=M[r+16>>2]|0;s=5}else i=0;else{n=i;s=5}t:do{if((s|0)==5){i=M[r+20>>2]|0;if((n-i|0)>>>0<e>>>0){i=Fe[M[r+36>>2]&3](r,t,e)|0;break}e:do{if((A[r+75>>0]|0)>-1){s=e;while(1){if(!s){a=0;n=t;break e}n=s+-1|0;if((A[t+n>>0]|0)==10)break;else s=n}i=Fe[M[r+36>>2]&3](r,t,s)|0;if(i>>>0<s>>>0)break t;a=s;n=t+s|0;e=e-s|0;i=M[r+20>>2]|0}else{a=0;n=t}}while(0);we(i|0,n|0,e|0)|0;M[r+20>>2]=(M[r+20>>2]|0)+e;i=a+e|0}}while(0);return i|0}function zt(t,e){t=t|0;e=e|0;if(!e)e=0;else e=Qt(M[e>>2]|0,M[e+4>>2]|0,t)|0;return(e|0?e:t)|0}function Qt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0,a=0,o=0,u=0,c=0,l=0,h=0;h=(M[t>>2]|0)+1794895138|0;i=qt(M[t+8>>2]|0,h)|0;u=qt(M[t+12>>2]|0,h)|0;l=qt(M[t+16>>2]|0,h)|0;t:do{if(i>>>0<e>>>2>>>0)if(u>>>0<(e-(i<<2)|0)>>>0&l>>>0<(e-(i<<2)|0)>>>0)if(!((l|u)&3)){o=0;while(1){a=i>>>1;c=o+a|0;n=qt(M[t+((c<<1)+(u>>>2)<<2)>>2]|0,h)|0;s=qt(M[t+((c<<1)+(u>>>2)+1<<2)>>2]|0,h)|0;if(!(s>>>0<e>>>0&n>>>0<(e-s|0)>>>0)){i=0;break t}if(A[t+(s+n)>>0]|0){i=0;break t}n=Dt(r,t+s|0)|0;if(!n)break;if((i|0)==1){i=0;break t}else{o=(n|0)<0?o:c;i=(n|0)<0?a:i-a|0}}n=qt(M[t+((c<<1)+(l>>>2)<<2)>>2]|0,h)|0;i=qt(M[t+((c<<1)+(l>>>2)+1<<2)>>2]|0,h)|0;if(i>>>0<e>>>0&n>>>0<(e-i|0)>>>0)i=(A[t+(i+n)>>0]|0)==0?t+i|0:0;else i=0}else i=0;else i=0;else i=0}while(0);return i|0}function qt(t,e){t=t|0;e=e|0;var r=0;r=Te(t|0)|0;return((e|0)==0?t:r)|0}function Yt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0;t:do{if((r|0)!=0&(t&3|0)!=0){i=t;t=r;while(1){if((A[i>>0]|0)==(e&255)<<24>>24){n=6;break t}i=i+1|0;r=t+-1|0;if((r|0)!=0&(i&3|0)!=0)t=r;else{t=r;r=(r|0)!=0;n=5;break}}}else{i=t;t=r;r=(r|0)!=0;n=5}}while(0);if((n|0)==5)if(r)n=6;else t=0;t:do{if((n|0)==6)if((A[i>>0]|0)!=(e&255)<<24>>24){r=V(e&255,16843009)|0;e:do{if(t>>>0>3)while(1){s=M[i>>2]^r;if((s&-2139062144^-2139062144)&s+-16843009|0)break;i=i+4|0;t=t+-4|0;if(t>>>0<=3){n=11;break e}}else n=11}while(0);if((n|0)==11)if(!t){t=0;break}while(1){if((A[i>>0]|0)==(e&255)<<24>>24)break t;i=i+1|0;t=t+-1|0;if(!t){t=0;break}}}}while(0);return(t|0?i:0)|0}function Kt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0;i=S;S=S+16|0;M[i>>2]=r;r=Gt(t,e,i)|0;S=i;return r|0}function Gt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0,a=0;a=S;S=S+224|0;i=a+80|0;n=i+40|0;do{M[i>>2]=0;i=i+4|0}while((i|0)<(n|0));M[a+120>>2]=M[r>>2];if((Jt(0,e,a+120|0,a,a+80|0)|0)<0)r=-1;else{if((M[t+76>>2]|0)>-1)s=Nt(t)|0;else s=0;n=M[t>>2]|0;if((A[t+74>>0]|0)<1)M[t>>2]=n&-33;if(!(M[t+48>>2]|0)){i=M[t+44>>2]|0;M[t+44>>2]=a+136;M[t+28>>2]=a+136;M[t+20>>2]=a+136;M[t+48>>2]=80;M[t+16>>2]=a+136+80;r=Jt(t,e,a+120|0,a,a+80|0)|0;if(i){Fe[M[t+36>>2]&3](t,0,0)|0;r=(M[t+20>>2]|0)==0?-1:r;M[t+44>>2]=i;M[t+48>>2]=0;M[t+16>>2]=0;M[t+28>>2]=0;M[t+20>>2]=0}}else r=Jt(t,e,a+120|0,a,a+80|0)|0;i=M[t>>2]|0;M[t>>2]=i|n&32;if(s|0)Ut(t);r=(i&32|0)==0?r:-1}S=a;return r|0}function Jt(t,e,r,i,n){t=t|0;e=e|0;r=r|0;i=i|0;n=n|0;var s=0,a=0,o=0,u=0,c=0,l=0,h=0,_=0,d=0,f=0,p=0,m=0,g=0,b=0,y=0;b=S;S=S+64|0;M[b+16>>2]=e;g=b+24+40|0;a=0;s=0;l=0;t:while(1){do{if((s|0)>-1)if((a|0)>(2147483647-s|0)){M[(Ot()|0)>>2]=75;s=-1;break}else{s=a+s|0;break}}while(0);a=A[e>>0]|0;if(!(a<<24>>24)){m=87;break}else o=e;e:while(1){switch(a<<24>>24){case 37:{a=o;m=9;break e}case 0:{a=o;break e}default:{}}p=o+1|0;M[b+16>>2]=p;a=A[p>>0]|0;o=p}e:do{if((m|0)==9)while(1){m=0;if((A[o+1>>0]|0)!=37)break e;a=a+1|0;o=o+2|0;M[b+16>>2]=o;if((A[o>>0]|0)==37)m=9;else break}}while(0);a=a-e|0;if(t|0)Xt(t,e,a);if(a|0){e=o;continue}u=o+1|0;a=(A[u>>0]|0)+-48|0;if(a>>>0<10){p=(A[o+2>>0]|0)==36;d=p?a:-1;l=p?1:l;u=p?o+3|0:u}else d=-1;M[b+16>>2]=u;a=A[u>>0]|0;e:do{if(((a<<24>>24)+-32|0)>>>0<32){o=0;h=a;c=(a<<24>>24)+-32|0;while(1){a=1<<c;if(!(a&75913)){a=h;break e}o=a|o;u=u+1|0;M[b+16>>2]=u;a=A[u>>0]|0;c=(a<<24>>24)+-32|0;if(c>>>0>=32)break;else h=a}}else o=0}while(0);if(a<<24>>24==42){c=u+1|0;a=(A[c>>0]|0)+-48|0;if(a>>>0<10)if((A[u+2>>0]|0)==36){M[n+(a<<2)>>2]=10;a=M[i+((A[c>>0]|0)+-48<<3)>>2]|0;l=1;u=u+3|0}else m=23;else m=23;if((m|0)==23){m=0;if(l|0){s=-1;break}if(t|0){l=(M[r>>2]|0)+(4-1)&~(4-1);a=M[l>>2]|0;M[r>>2]=l+4;l=0;u=c}else{a=0;l=0;u=c}}M[b+16>>2]=u;f=(a|0)<0;a=f?0-a|0:a;f=f?o|8192:o}else{a=$t(b+16|0)|0;if((a|0)<0){s=-1;break}f=o;u=M[b+16>>2]|0}do{if((A[u>>0]|0)==46){if((A[u+1>>0]|0)!=42){M[b+16>>2]=u+1;o=$t(b+16|0)|0;u=M[b+16>>2]|0;break}c=u+2|0;o=(A[c>>0]|0)+-48|0;if(o>>>0<10)if((A[u+3>>0]|0)==36){M[n+(o<<2)>>2]=10;o=M[i+((A[c>>0]|0)+-48<<3)>>2]|0;u=u+4|0;M[b+16>>2]=u;break}if(l|0){s=-1;break t}if(t|0){p=(M[r>>2]|0)+(4-1)&~(4-1);o=M[p>>2]|0;M[r>>2]=p+4}else o=0;M[b+16>>2]=c;u=c}else o=-1}while(0);_=0;while(1){if(((A[u>>0]|0)+-65|0)>>>0>57){s=-1;break t}p=u+1|0;M[b+16>>2]=p;c=A[(A[u>>0]|0)+-65+(2221+(_*58|0))>>0]|0;if(((c&255)+-1|0)>>>0<8){_=c&255;u=p}else break}if(!(c<<24>>24)){s=-1;break}h=(d|0)>-1;do{if(c<<24>>24==19)if(h){s=-1;break t}else m=49;else{if(h){M[n+(d<<2)>>2]=c&255;d=i+(d<<3)|0;m=M[d+4>>2]|0;M[b>>2]=M[d>>2];M[b+4>>2]=m;m=49;break}if(!t){s=0;break t}Zt(b,c&255,r)}}while(0);if((m|0)==49){m=0;if(!t){a=0;e=p;continue}}u=A[u>>0]|0;u=(_|0)!=0&(u&15|0)==3?u&-33:u;d=f&-65537;f=(f&8192|0)==0?f:d;e:do{switch(u|0){case 110:switch((_&255)<<24>>24){case 0:{M[M[b>>2]>>2]=s;a=0;e=p;continue t}case 1:{M[M[b>>2]>>2]=s;a=0;e=p;continue t}case 2:{a=M[b>>2]|0;M[a>>2]=s;M[a+4>>2]=((s|0)<0)<<31>>31;a=0;e=p;continue t}case 3:{v[M[b>>2]>>1]=s;a=0;e=p;continue t}case 4:{A[M[b>>2]>>0]=s;a=0;e=p;continue t}case 6:{M[M[b>>2]>>2]=s;a=0;e=p;continue t}case 7:{a=M[b>>2]|0;M[a>>2]=s;M[a+4>>2]=((s|0)<0)<<31>>31;a=0;e=p;continue t}default:{a=0;e=p;continue t}}case 112:{u=120;o=o>>>0>8?o:8;e=f|8;m=61;break}case 88:case 120:{e=f;m=61;break}case 111:{e=M[b>>2]|0;u=M[b+4>>2]|0;d=ee(e,u,g)|0;_=d;c=0;h=2685;o=(f&8|0)==0|(o|0)>(g-d|0)?o:g-d+1|0;d=f;m=67;break}case 105:case 100:{e=M[b>>2]|0;u=M[b+4>>2]|0;if((u|0)<0){e=ge(0,0,e|0,u|0)|0;u=T;M[b>>2]=e;M[b+4>>2]=u;c=1;h=2685;m=66;break e}else{c=(f&2049|0)!=0&1;h=(f&2048|0)==0?(f&1|0)==0?2685:2687:2686;m=66;break e}}case 117:{c=0;h=2685;e=M[b>>2]|0;u=M[b+4>>2]|0;m=66;break}case 99:{A[b+24+39>>0]=M[b>>2];e=b+24+39|0;c=0;h=2685;_=g;u=1;o=d;break}case 109:{u=ie(M[(Ot()|0)>>2]|0)|0;m=71;break}case 115:{u=M[b>>2]|0;u=u|0?u:2695;m=71;break}case 67:{M[b+8>>2]=M[b>>2];M[b+8+4>>2]=0;M[b>>2]=b+8;_=-1;u=b+8|0;m=75;break}case 83:{e=M[b>>2]|0;if(!o){ne(t,32,a,0,f);e=0;m=84}else{_=o;u=e;m=75}break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{a=ae(t,+k[b>>3],a,o,f,u)|0;e=p;continue t}default:{c=0;h=2685;_=g;u=o;o=f}}}while(0);e:do{if((m|0)==61){y=M[b>>2]|0;f=M[b+4>>2]|0;_=te(y,f,g,u&32)|0;h=(e&8|0)==0|(y|0)==0&(f|0)==0;c=h?0:2;h=h?2685:2685+(u>>4)|0;d=e;e=y;u=f;m=67}else if((m|0)==66){_=re(e,u,g)|0;d=f;m=67}else if((m|0)==71){m=0;y=Yt(u,0,o)|0;e=u;c=0;h=2685;_=(y|0)==0?u+o|0:y;u=(y|0)==0?o:y-u|0;o=d}else if((m|0)==75){m=0;h=u;e=0;o=0;while(1){c=M[h>>2]|0;if(!c)break;o=se(b+20|0,c)|0;if((o|0)<0|o>>>0>(_-e|0)>>>0)break;e=o+e|0;if(_>>>0>e>>>0)h=h+4|0;else break}if((o|0)<0){s=-1;break t}ne(t,32,a,e,f);if(!e){e=0;m=84}else{c=0;while(1){o=M[u>>2]|0;if(!o){m=84;break e}o=se(b+20|0,o)|0;c=o+c|0;if((c|0)>(e|0)){m=84;break e}Xt(t,b+20|0,o);if(c>>>0>=e>>>0){m=84;break}else u=u+4|0}}}}while(0);if((m|0)==67){m=0;u=(e|0)!=0|(u|0)!=0;y=(o|0)!=0|u;u=((u^1)&1)+(g-_)|0;e=y?_:g;_=g;u=y?(o|0)>(u|0)?o:u:o;o=(o|0)>-1?d&-65537:d}else if((m|0)==84){m=0;ne(t,32,a,e,f^8192);a=(a|0)>(e|0)?a:e;e=p;continue}f=_-e|0;d=(u|0)<(f|0)?f:u;y=d+c|0;a=(a|0)<(y|0)?y:a;ne(t,32,a,y,o);Xt(t,h,c);ne(t,48,a,y,o^65536);ne(t,48,d,f,0);Xt(t,e,f);ne(t,32,a,y,o^8192);e=p}t:do{if((m|0)==87)if(!t)if(!l)s=0;else{s=1;while(1){e=M[n+(s<<2)>>2]|0;if(!e)break;Zt(i+(s<<3)|0,e,r);s=s+1|0;if((s|0)>=10){s=1;break t}}while(1){if(M[n+(s<<2)>>2]|0){s=-1;break t}s=s+1|0;if((s|0)>=10){s=1;break}}}}while(0);S=b;return s|0}function Xt(t,e,r){t=t|0;e=e|0;r=r|0;if(!(M[t>>2]&32))Vt(e,r,t)|0;return}function $t(t){t=t|0;var e=0,r=0,i=0;r=M[t>>2]|0;i=(A[r>>0]|0)+-48|0;if(i>>>0<10){e=0;do{e=i+(e*10|0)|0;r=r+1|0;M[t>>2]=r;i=(A[r>>0]|0)+-48|0}while(i>>>0<10)}else e=0;return e|0}function Zt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0.0;t:do{if(e>>>0<=20)do{switch(e|0){case 9:{i=(M[r>>2]|0)+(4-1)&~(4-1);e=M[i>>2]|0;M[r>>2]=i+4;M[t>>2]=e;break t}case 10:{e=(M[r>>2]|0)+(4-1)&~(4-1);i=M[e>>2]|0;M[r>>2]=e+4;M[t>>2]=i;M[t+4>>2]=((i|0)<0)<<31>>31;break t}case 11:{e=(M[r>>2]|0)+(4-1)&~(4-1);i=M[e>>2]|0;M[r>>2]=e+4;M[t>>2]=i;M[t+4>>2]=0;break t}case 12:{n=(M[r>>2]|0)+(8-1)&~(8-1);e=M[n>>2]|0;i=M[n+4>>2]|0;M[r>>2]=n+8;M[t>>2]=e;M[t+4>>2]=i;break t}case 13:{i=(M[r>>2]|0)+(4-1)&~(4-1);n=M[i>>2]|0;M[r>>2]=i+4;M[t>>2]=(n&65535)<<16>>16;M[t+4>>2]=(((n&65535)<<16>>16|0)<0)<<31>>31;break t}case 14:{i=(M[r>>2]|0)+(4-1)&~(4-1);n=M[i>>2]|0;M[r>>2]=i+4;M[t>>2]=n&65535;M[t+4>>2]=0;break t}case 15:{i=(M[r>>2]|0)+(4-1)&~(4-1);n=M[i>>2]|0;M[r>>2]=i+4;M[t>>2]=(n&255)<<24>>24;M[t+4>>2]=(((n&255)<<24>>24|0)<0)<<31>>31;break t}case 16:{i=(M[r>>2]|0)+(4-1)&~(4-1);n=M[i>>2]|0;M[r>>2]=i+4;M[t>>2]=n&255;M[t+4>>2]=0;break t}case 17:{n=(M[r>>2]|0)+(8-1)&~(8-1);s=+k[n>>3];M[r>>2]=n+8;k[t>>3]=s;break t}case 18:{n=(M[r>>2]|0)+(8-1)&~(8-1);s=+k[n>>3];M[r>>2]=n+8;k[t>>3]=s;break t}default:break t}}while(0)}while(0);return}function te(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;if(!((t|0)==0&(e|0)==0))do{r=r+-1|0;A[r>>0]=P[2737+(t&15)>>0]|0|i;t=ve(t|0,e|0,4)|0;e=T}while(!((t|0)==0&(e|0)==0));return r|0}function ee(t,e,r){t=t|0;e=e|0;r=r|0;if(!((t|0)==0&(e|0)==0))do{r=r+-1|0;A[r>>0]=t&7|48;t=ve(t|0,e|0,3)|0;e=T}while(!((t|0)==0&(e|0)==0));return r|0}function re(t,e,r){t=t|0;e=e|0;r=r|0;var i=0;if(e>>>0>0|(e|0)==0&t>>>0>4294967295){while(1){i=Se(t|0,e|0,10,0)|0;r=r+-1|0;A[r>>0]=i&255|48;i=t;t=Me(t|0,e|0,10,0)|0;if(!(e>>>0>9|(e|0)==9&i>>>0>4294967295))break;else e=T}e=t}else e=t;if(e)while(1){r=r+-1|0;A[r>>0]=(e>>>0)%10|0|48;if(e>>>0<10)break;else e=(e>>>0)/10|0}return r|0}function ie(t){t=t|0;return de(t,M[(_e()|0)+188>>2]|0)|0}function ne(t,e,r,i,n){t=t|0;e=e|0;r=r|0;i=i|0;n=n|0;var s=0;s=S;S=S+256|0;if((r|0)>(i|0)&(n&73728|0)==0){ye(s|0,e|0,((r-i|0)>>>0<256?r-i|0:256)|0)|0;if((r-i|0)>>>0>255){e=r-i|0;do{Xt(t,s,256);e=e+-256|0}while(e>>>0>255);e=r-i&255}else e=r-i|0;Xt(t,s,e)}S=s;return}function se(t,e){t=t|0;e=e|0;if(!t)t=0;else t=le(t,e,0)|0;return t|0}function ae(t,e,r,i,n,s){t=t|0;e=+e;r=r|0;i=i|0;n=n|0;s=s|0;var a=0,o=0,u=0,c=0,l=0,h=0.0,_=0,d=0,f=0,p=0,m=0,g=0,b=0,y=0,v=0,k=0,w=0,C=0;C=S;S=S+560|0;w=C+524|0;M[C>>2]=0;k=C+512+12|0;oe(e)|0;if((T|0)<0){e=-e;y=1;b=2702}else{y=(n&2049|0)!=0&1;b=(n&2048|0)==0?(n&1|0)==0?2703:2708:2705}oe(e)|0;v=T&2146435072;do{if(v>>>0<2146435072|(v|0)==2146435072&0<0){h=+ue(e,C)*2.0;if(h!=0.0)M[C>>2]=(M[C>>2]|0)+-1;if((s|32|0)==97){l=(s&32|0)==0?b:b+9|0;c=y|2;do{if(i>>>0>11|(12-i|0)==0)e=h;else{e=8.0;a=12-i|0;do{a=a+-1|0;e=e*16.0}while((a|0)!=0);if((A[l>>0]|0)==45){e=-(e+(-h-e));break}else{e=h+e-e;break}}}while(0);o=M[C>>2]|0;a=(o|0)<0?0-o|0:o;a=re(a,((a|0)<0)<<31>>31,k)|0;if((a|0)==(k|0)){A[C+512+11>>0]=48;a=C+512+11|0}A[a+-1>>0]=(o>>31&2)+43;u=a+-2|0;A[u>>0]=s+15;a=C+524|0;do{v=~~e;o=a+1|0;A[a>>0]=P[2737+v>>0]|s&32;e=(e-+(v|0))*16.0;if((o-w|0)==1)if((n&8|0)==0&((i|0)<1&e==0.0))a=o;else{A[o>>0]=46;a=a+2|0}else a=o}while(e!=0.0);w=a-w|0;a=(i|0)!=0&(w+-2|0)<(i|0)?i+2|0:w;ne(t,32,r,k-u+c+a|0,n);Xt(t,l,c);ne(t,48,r,k-u+c+a|0,n^65536);Xt(t,C+524|0,w);ne(t,48,a-w|0,0,0);Xt(t,u,k-u|0);ne(t,32,r,k-u+c+a|0,n^8192);a=k-u+c+a|0;break}o=(i|0)<0?6:i;if(h!=0.0){c=(M[C>>2]|0)+-28|0;M[C>>2]=c;e=h*268435456.0}else{e=h;c=M[C>>2]|0}v=(c|0)<0?C+8|0:C+8+288|0;a=v;do{g=~~e>>>0;M[a>>2]=g;a=a+4|0;e=(e-+(g>>>0))*1.0e9}while(e!=0.0);if((c|0)>0){u=v;do{i=(c|0)<29?c:29;c=a+-4|0;if(c>>>0>=u>>>0){l=0;do{m=ke(M[c>>2]|0,0,i|0)|0;m=be(m|0,T|0,l|0,0)|0;g=T;p=Se(m|0,g|0,1e9,0)|0;M[c>>2]=p;l=Me(m|0,g|0,1e9,0)|0;c=c+-4|0}while(c>>>0>=u>>>0);if(l){u=u+-4|0;M[u>>2]=l}}while(1){if(a>>>0<=u>>>0)break;c=a+-4|0;if(!(M[c>>2]|0))a=c;else break}c=(M[C>>2]|0)-i|0;M[C>>2]=c}while((c|0)>0)}else u=v;if((c|0)<0)do{i=0-c|0;i=(i|0)<9?i:9;if(u>>>0<a>>>0){l=0;c=u;do{g=M[c>>2]|0;M[c>>2]=(g>>>i)+l;l=V(g&(1<<i)+-1,1e9>>>i)|0;c=c+4|0}while(c>>>0<a>>>0);u=(M[u>>2]|0)==0?u+4|0:u;if(l){M[a>>2]=l;a=a+4|0}}else u=(M[u>>2]|0)==0?u+4|0:u;c=(s|32|0)==102?v:u;a=(a-c>>2|0)>(((o+25|0)/9|0)+1|0)?c+(((o+25|0)/9|0)+1<<2)|0:a;c=(M[C>>2]|0)+i|0;M[C>>2]=c}while((c|0)<0);if(u>>>0<a>>>0){c=(v-u>>2)*9|0;i=M[u>>2]|0;if(i>>>0<10)f=c;else{l=10;do{l=l*10|0;c=c+1|0}while(i>>>0>=l>>>0);f=c}}else f=0;l=o-((s|32|0)!=102?f:0)+(((o|0)!=0&(s|32|0)==103)<<31>>31)|0;if((l|0)<(((a-v>>2)*9|0)+-9|0)){c=v+4+(((l+9216|0)/9|0)+-1024<<2)|0;if((((l+9216|0)%9|0)+1|0)<9){i=((l+9216|0)%9|0)+1|0;l=10;do{l=l*10|0;i=i+1|0}while((i|0)!=9)}else l=10;_=M[c>>2]|0;d=(_>>>0)%(l>>>0)|0;i=(c+4|0)==(a|0);if(i&(d|0)==0)l=f;else{h=(((_>>>0)/(l>>>0)|0)&1|0)==0?9007199254740992.0:9007199254740994.0;g=(l|0)/2|0;e=d>>>0<g>>>0?.5:i&(d|0)==(g|0)?1.0:1.5;if(y){g=(A[b>>0]|0)==45;e=g?-e:e;h=g?-h:h}M[c>>2]=_-d;if(h+e!=h){g=_-d+l|0;M[c>>2]=g;if(g>>>0>999999999)while(1){l=c+-4|0;M[c>>2]=0;if(l>>>0<u>>>0){u=u+-4|0;M[u>>2]=0}g=(M[l>>2]|0)+1|0;M[l>>2]=g;if(g>>>0>999999999)c=l;else{c=l;break}}l=(v-u>>2)*9|0;_=M[u>>2]|0;if(_>>>0>=10){i=10;do{i=i*10|0;l=l+1|0}while(_>>>0>=i>>>0)}}else l=f}m=c+4|0;a=a>>>0>m>>>0?m:a;m=u}else{l=f;m=u}g=a;while(1){if(g>>>0<=m>>>0){p=0;break}a=g+-4|0;if(!(M[a>>2]|0))g=a;else{p=1;break}}_=0-l|0;do{if((s|32|0)==103){if((l|0)>-5?((((o|0)!=0^1)&1)+o|0)>(l|0):0){i=s+-1|0;o=(((o|0)!=0^1)&1)+o+-1-l|0}else{i=s+-2|0;o=(((o|0)!=0^1)&1)+o+-1|0}if(!(n&8)){if(p){c=M[g+-4>>2]|0;if(!c)a=9;else if(!((c>>>0)%10|0)){a=0;u=10;do{u=u*10|0;a=a+1|0}while(!((c>>>0)%(u>>>0)|0|0))}else a=0}else a=9;u=((g-v>>2)*9|0)+-9|0;if((i|32|0)==102){c=u-a|0;c=(c|0)>0?c:0;o=(o|0)<(c|0)?o:c;c=0;break}else{c=u+l-a|0;c=(c|0)>0?c:0;o=(o|0)<(c|0)?o:c;c=0;break}}else c=n&8}else{i=s;c=n&8}}while(0);f=o|c;u=(i|32|0)==102;if(u){d=0;a=(l|0)>0?l:0}else{a=(l|0)<0?_:l;a=re(a,((a|0)<0)<<31>>31,k)|0;if((k-a|0)<2)do{a=a+-1|0;A[a>>0]=48}while((k-a|0)<2);A[a+-1>>0]=(l>>31&2)+43;a=a+-2|0;A[a>>0]=i;d=a;a=k-a|0}a=y+1+o+((f|0)!=0&1)+a|0;ne(t,32,r,a,n);Xt(t,b,y);ne(t,48,r,a,n^65536);if(u){l=m>>>0>v>>>0?v:m;c=l;do{u=re(M[c>>2]|0,0,C+524+9|0)|0;if((c|0)==(l|0)){if((u|0)==(C+524+9|0)){A[C+524+8>>0]=48;u=C+524+8|0}}else if(u>>>0>(C+524|0)>>>0){ye(C+524|0,48,u-w|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}Xt(t,u,C+524+9-u|0);c=c+4|0}while(c>>>0<=v>>>0);if(f|0)Xt(t,2753,1);if(c>>>0<g>>>0&(o|0)>0)while(1){u=re(M[c>>2]|0,0,C+524+9|0)|0;if(u>>>0>(C+524|0)>>>0){ye(C+524|0,48,u-w|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}Xt(t,u,(o|0)<9?o:9);c=c+4|0;u=o+-9|0;if(!(c>>>0<g>>>0&(o|0)>9)){o=u;break}else o=u}ne(t,48,o+9|0,9,0)}else{_=p?g:m+4|0;if((o|0)>-1){i=(c|0)==0;l=m;do{u=re(M[l>>2]|0,0,C+524+9|0)|0;if((u|0)==(C+524+9|0)){A[C+524+8>>0]=48;u=C+524+8|0}do{if((l|0)==(m|0)){c=u+1|0;Xt(t,u,1);if(i&(o|0)<1){u=c;break}Xt(t,2753,1);u=c}else{if(u>>>0<=(C+524|0)>>>0)break;ye(C+524|0,48,u+(0-w)|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}}while(0);v=C+524+9-u|0;Xt(t,u,(o|0)>(v|0)?v:o);o=o-v|0;l=l+4|0}while(l>>>0<_>>>0&(o|0)>-1)}ne(t,48,o+18|0,18,0);Xt(t,d,k-d|0)}ne(t,32,r,a,n^8192)}else{a=y+3|0;ne(t,32,r,a,n&-65537);Xt(t,b,y);Xt(t,e!=e|0.0!=0.0?s&32|0?2729:2733:s&32|0?2721:2725,3);ne(t,32,r,a,n^8192)}}while(0);S=C;return((a|0)<(r|0)?r:a)|0}function oe(t){t=+t;var e=0;k[a>>3]=t;e=M[a>>2]|0;T=M[a+4>>2]|0;return e|0}function ue(t,e){t=+t;e=e|0;return+ +ce(t,e)}function ce(t,e){t=+t;e=e|0;var r=0,i=0,n=0;k[a>>3]=t;r=M[a>>2]|0;i=M[a+4>>2]|0;n=ve(r|0,i|0,52)|0;switch(n&2047){case 0:{if(t!=0.0){t=+ce(t*18446744073709551616.0,e);r=(M[e>>2]|0)+-64|0}else r=0;M[e>>2]=r;break}case 2047:break;default:{M[e>>2]=(n&2047)+-1022;M[a>>2]=r;M[a+4>>2]=i&-2146435073|1071644672;t=+k[a>>3]}}return+t}function le(t,e,r){t=t|0;e=e|0;r=r|0;do{if(!t)t=1;else{if(e>>>0<128){A[t>>0]=e;t=1;break}if(!(M[M[(he()|0)+188>>2]>>2]|0))if((e&-128|0)==57216){A[t>>0]=e;t=1;break}else{M[(Ot()|0)>>2]=84;t=-1;break}if(e>>>0<2048){A[t>>0]=e>>>6|192;A[t+1>>0]=e&63|128;t=2;break}if(e>>>0<55296|(e&-8192|0)==57344){A[t>>0]=e>>>12|224;A[t+1>>0]=e>>>6&63|128;A[t+2>>0]=e&63|128;t=3;break}if((e+-65536|0)>>>0<1048576){A[t>>0]=e>>>18|240;A[t+1>>0]=e>>>12&63|128;A[t+2>>0]=e>>>6&63|128;A[t+3>>0]=e&63|128;t=4;break}else{M[(Ot()|0)>>2]=84;t=-1;break}}}while(0);return t|0}function he(){return Ft()|0}function _e(){return Ft()|0}function de(t,e){t=t|0;e=e|0;var r=0,i=0;i=0;while(1){if((P[2755+i>>0]|0)==(t|0)){t=2;break}r=i+1|0;if((r|0)==87){r=2843;i=87;t=5;break}else i=r}if((t|0)==2)if(!i)r=2843;else{r=2843;t=5}if((t|0)==5)while(1){do{t=r;r=r+1|0}while((A[t>>0]|0)!=0);i=i+-1|0;if(!i)break;else t=5}return fe(r,M[e+20>>2]|0)|0}function fe(t,e){t=t|0;e=e|0;return zt(t,e)|0}function pe(t,e){t=t|0;e=e|0;var r=0,i=0;if((M[e+76>>2]|0)<0)i=3;else if(!(Nt(e)|0))i=3;else{if((t&255|0)==(A[e+75>>0]|0))i=10;else{r=M[e+20>>2]|0;if(r>>>0<(M[e+16>>2]|0)>>>0){M[e+20>>2]=r+1;A[r>>0]=t;r=t&255}else i=10}if((i|0)==10)r=jt(e,t)|0;Ut(e)}do{if((i|0)==3){if((t&255|0)!=(A[e+75>>0]|0)){r=M[e+20>>2]|0;if(r>>>0<(M[e+16>>2]|0)>>>0){M[e+20>>2]=r+1;A[r>>0]=t;r=t&255;break}}r=jt(e,t)|0}}while(0);return r|0}function me(){}function ge(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;i=e-i-(r>>>0>t>>>0|0)>>>0;return(T=i,t-r>>>0|0)|0}function be(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;return(T=e+i+(t+r>>>0>>>0<t>>>0|0)>>>0,t+r>>>0|0)|0}function ye(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0;i=t+r|0;e=e&255;if((r|0)>=67){while(t&3){A[t>>0]=e;t=t+1|0}n=e|e<<8|e<<16|e<<24;while((t|0)<=((i&-4)-64|0)){M[t>>2]=n;M[t+4>>2]=n;M[t+8>>2]=n;M[t+12>>2]=n;M[t+16>>2]=n;M[t+20>>2]=n;M[t+24>>2]=n;M[t+28>>2]=n;M[t+32>>2]=n;M[t+36>>2]=n;M[t+40>>2]=n;M[t+44>>2]=n;M[t+48>>2]=n;M[t+52>>2]=n;M[t+56>>2]=n;M[t+60>>2]=n;t=t+64|0}while((t|0)<(i&-4|0)){M[t>>2]=n;t=t+4|0}}while((t|0)<(i|0)){A[t>>0]=e;t=t+1|0}return i-r|0}function ve(t,e,r){t=t|0;e=e|0;r=r|0;if((r|0)<32){T=e>>>r;return t>>>r|(e&(1<<r)-1)<<32-r}T=0;return e>>>r-32|0}function ke(t,e,r){t=t|0;e=e|0;r=r|0;if((r|0)<32){T=e<<r|(t&(1<<r)-1<<32-r)>>>32-r;return t<<r}T=t<<r-32;return 0}function we(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,n=0,s=0;if((r|0)>=8192)return nt(t|0,e|0,r|0)|0;s=t|0;n=t+r|0;if((t&3)==(e&3)){while(t&3){if(!r)return s|0;A[t>>0]=A[e>>0]|0;t=t+1|0;e=e+1|0;r=r-1|0}r=n&-4|0;i=r-64|0;while((t|0)<=(i|0)){M[t>>2]=M[e>>2];M[t+4>>2]=M[e+4>>2];M[t+8>>2]=M[e+8>>2];M[t+12>>2]=M[e+12>>2];M[t+16>>2]=M[e+16>>2];M[t+20>>2]=M[e+20>>2];M[t+24>>2]=M[e+24>>2];M[t+28>>2]=M[e+28>>2];M[t+32>>2]=M[e+32>>2];M[t+36>>2]=M[e+36>>2];M[t+40>>2]=M[e+40>>2];M[t+44>>2]=M[e+44>>2];M[t+48>>2]=M[e+48>>2];M[t+52>>2]=M[e+52>>2];M[t+56>>2]=M[e+56>>2];M[t+60>>2]=M[e+60>>2];t=t+64|0;e=e+64|0}while((t|0)<(r|0)){M[t>>2]=M[e>>2];t=t+4|0;e=e+4|0}}else{r=n-4|0;while((t|0)<(r|0)){A[t>>0]=A[e>>0]|0;A[t+1>>0]=A[e+1>>0]|0;A[t+2>>0]=A[e+2>>0]|0;A[t+3>>0]=A[e+3>>0]|0;t=t+4|0;e=e+4|0}}while((t|0)<(n|0)){A[t>>0]=A[e>>0]|0;t=t+1|0;e=e+1|0}return s|0}function Ce(t){t=t|0;var e=0;e=A[c+(t&255)>>0]|0;if((e|0)<8)return e|0;e=A[c+(t>>8&255)>>0]|0;if((e|0)<8)return e+8|0;e=A[c+(t>>16&255)>>0]|0;if((e|0)<8)return e+16|0;return(A[c+(t>>>24)>>0]|0)+24|0}function Ae(t,e,r,i,n){t=t|0;e=e|0;r=r|0;i=i|0;n=n|0;var s=0,a=0,o=0,u=0,c=0,l=0,h=0,_=0,d=0,f=0;if(!e)if(!i){if(n|0){M[n>>2]=(t>>>0)%(r>>>0);M[n+4>>2]=0}i=0;n=(t>>>0)/(r>>>0)>>>0;return(T=i,n)|0}else{if(!n){i=0;n=0;return(T=i,n)|0}M[n>>2]=t|0;M[n+4>>2]=e&0;i=0;n=0;return(T=i,n)|0}do{if(!r){if(!i){if(n|0){M[n>>2]=(e>>>0)%(r>>>0);M[n+4>>2]=0}i=0;n=(e>>>0)/(r>>>0)>>>0;return(T=i,n)|0}if(!t){if(n|0){M[n>>2]=0;M[n+4>>2]=(e>>>0)%(i>>>0)}r=0;n=(e>>>0)/(i>>>0)>>>0;return(T=r,n)|0}if(!(i-1&i)){if(n|0){M[n>>2]=t|0;M[n+4>>2]=i-1&e|e&0}r=0;n=e>>>((Ce(i|0)|0)>>>0);return(T=r,n)|0}a=(q(i|0)|0)-(q(e|0)|0)|0;if(a>>>0<=30){_=a+1|0;o=e<<31-a|t>>>((a+1|0)>>>0);h=e>>>((a+1|0)>>>0);s=0;a=t<<31-a;break}if(!n){i=0;n=0;return(T=i,n)|0}M[n>>2]=t|0;M[n+4>>2]=e|e&0;i=0;n=0;return(T=i,n)|0}else{if(i|0){a=(q(i|0)|0)-(q(e|0)|0)|0;if(a>>>0<=31){_=a+1|0;o=t>>>((a+1|0)>>>0)&a-31>>31|e<<31-a;h=e>>>((a+1|0)>>>0)&a-31>>31;s=0;a=t<<31-a;break}if(!n){i=0;n=0;return(T=i,n)|0}M[n>>2]=t|0;M[n+4>>2]=e|e&0;i=0;n=0;return(T=i,n)|0}if(r-1&r|0){a=(q(r|0)|0)+33-(q(e|0)|0)|0;_=a;o=32-a-1>>31&e>>>((a-32|0)>>>0)|(e<<32-a|t>>>(a>>>0))&a-32>>31;h=a-32>>31&e>>>(a>>>0);s=t<<64-a&32-a>>31;a=(e<<64-a|t>>>((a-32|0)>>>0))&32-a>>31|t<<32-a&a-33>>31;break}if(n|0){M[n>>2]=r-1&t;M[n+4>>2]=0}if((r|0)==1){i=e|e&0;n=t|0|0;return(T=i,n)|0}else{n=Ce(r|0)|0;i=e>>>(n>>>0)|0;n=e<<32-n|t>>>(n>>>0)|0;return(T=i,n)|0}}}while(0);if(!_){u=a;e=h;t=0;a=0}else{c=be(r|0|0,i|i&0|0,-1,-1)|0;l=T;u=a;e=h;t=_;a=0;do{f=u;u=s>>>31|u<<1;s=a|s<<1;f=o<<1|f>>>31|0;d=o>>>31|e<<1|0;ge(c|0,l|0,f|0,d|0)|0;_=T;h=_>>31|((_|0)<0?-1:0)<<1;a=h&1;o=ge(f|0,d|0,h&(r|0)|0,(((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1)&(i|i&0)|0)|0;e=T;t=t-1|0}while((t|0)!=0);t=0}if(n|0){M[n>>2]=o;M[n+4>>2]=e}d=(s|0)>>>31|u<<1|(0<<1|s>>>31)&0|t;f=(s<<1|0>>>31)&-2|a;return(T=d,f)|0}function Me(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;return Ae(t,e,r,i,0)|0}function Pe(t){t=t|0;var e=0,r=0;r=t+15&-16|0;e=M[s>>2]|0;t=e+r|0;if((r|0)>0&(t|0)<(e|0)|(t|0)<0){X()|0;rt(12);return-1}M[s>>2]=t;if((t|0)>(J()|0))if(!(G()|0)){M[s>>2]=e;rt(12);return-1}return e|0}function Se(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;var n=0;n=S;S=S+16|0;Ae(t,e,r,i,n|0)|0;S=n;return(T=M[n+4>>2]|0,M[n>>2]|0)|0}function Te(t){t=t|0;return(t&255)<<24|(t>>8&255)<<16|(t>>16&255)<<8|t>>>24|0}function Ie(t,e){t=t|0;e=e|0;return Be[t&1](e|0)|0}function Ee(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;return Fe[t&3](e|0,r|0,i|0)|0}function Re(t){t=t|0;Y(0);return 0}function xe(t,e,r){t=t|0;e=e|0;r=r|0;Y(1);return 0}function Oe(t){t=t|0;var e=0,r=0,i=0,n=0,s=0,a=0,o=0,u=0,c=0,l=0,h=0,_=0;i=M[t+1368>>2]|0;n=M[t+3472>>2]|0;_=M[t+3496>>2]|0;h=M[t+3504>>2]|0;t:{if((_&65024|0)==23552){if(A[5300]|0){h=M[2]|0;M[t+512>>2]=_&7;M[t+512+4>>2]=_>>>3&7;M[t+512+8>>2]=_>>>6&7;Kt(h,1367,t+512|0)|0}h=(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0;i=tt(3,h&-2|0)|0;M[4668+((_&7)<<2)>>2]=((h&1|0)==0?i:i>>>8)&255;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&63488|0)==34816){if(A[5300]|0){h=M[2]|0;M[t+528>>2]=_&7;M[t+528+4>>2]=_>>>3&7;M[t+528+8>>2]=_>>>5&62;Kt(h,1387,t+528|0)|0}M[4668+((_&7)<<2)>>2]=(tt(3,(M[4668+((_>>>3&7)<<2)>>2]|0)+(_>>>5&62)|0)|0)&65535;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}e=1;r=(_&65024)<<16>>16;if(e)switch(r|0){case 23040:{if(A[5300]|0){h=M[2]|0;M[t+544>>2]=_&7;M[t+544+4>>2]=_>>>3&7;M[t+544+8>>2]=_>>>6&7;Kt(h,1409,t+544|0)|0}M[4668+((_&7)<<2)>>2]=(tt(3,(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0)|0)&65535;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 22016:{if(A[5300]|0){h=M[2]|0;M[t+560>>2]=_&7;M[t+560+4>>2]=_>>>3&7;M[t+560+8>>2]=_>>>6&7;Kt(h,1429,t+560|0)|0}h=(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0;i=tt(3,h&-2|0)|0;i=(h&1|0)==0?i:i>>>8;M[4668+((_&7)<<2)>>2]=(i&128|0)==0?i&255:i|-256;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 24064:{if(A[5300]|0){h=M[2]|0;M[t+576>>2]=_&7;M[t+576+4>>2]=_>>>3&7;M[t+576+8>>2]=_>>>6&7;Kt(h,1450,t+576|0)|0}i=tt(3,(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0)|0;M[4668+((_&7)<<2)>>2]=(i&32768|0)==0?i&65535:i|-65536;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:e=1}if(e)switch(r|0){default:{if(!(_&63488)){if(A[5300]|0){h=M[2]|0;M[t+592>>2]=_&7;M[t+592+4>>2]=_>>>3&7;M[t+592+8>>2]=_>>>6&31;Kt(h,1471,t+592|0)|0}e=M[4668+((_>>>3&7)<<2)>>2]|0;if(!(_>>>6&31))r=M[1184]|0;else{r=M[1184]|0;r=e&1<<32-(_>>>6&31)|0?r|536870912:r&-536870913;M[1184]=r;e=e<<(_>>>6&31)}M[4668+((_&7)<<2)>>2]=e;i=(e|0)<0?r|-2147483648:r&2147483647;M[1184]=(e|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65472|0)==16512){if(A[5300]|0){h=M[2]|0;M[t+608>>2]=_&7;M[t+608+4>>2]=_>>>3&7;Kt(h,1491,t+608|0)|0}e=M[4668+((_&7)<<2)>>2]|0;r=M[4668+((_>>>3&7)<<2)>>2]&255;do{if(!r)r=M[1184]|0;else{if(r>>>0<32){h=M[1184]|0;h=1<<32-r&e|0?h|536870912:h&-536870913;M[1184]=h;e=e<<r;r=h;break}if((r|0)==32){r=M[1184]|0;r=e&1|0?r|536870912:r&-536870913;M[1184]=r;e=0;break}else{r=M[1184]&-536870913;M[1184]=r;e=0;break}}}while(0);M[4668+((_&7)<<2)>>2]=e;i=(e|0)<0?r|-2147483648:r&2147483647;M[1184]=(e|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&63488|0)==2048){if(A[5300]|0){h=M[2]|0;M[t+616>>2]=_&7;M[t+616+4>>2]=_>>>3&7;M[t+616+8>>2]=_>>>6&31;Kt(h,1505,t+616|0)|0}e=M[4668+((_>>>3&7)<<2)>>2]|0;if(!(_>>>6&31)){r=M[1184]|0;r=(e|0)<0?r|536870912:r&-536870913;M[1184]=r;e=0}else{r=M[1184]|0;r=e&1<<(_>>>6&31)+-1|0?r|536870912:r&-536870913;M[1184]=r;e=e>>>(_>>>6&31)}M[4668+((_&7)<<2)>>2]=e;i=(e|0)<0?r|-2147483648:r&2147483647;M[1184]=(e|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65472|0)==16576){if(A[5300]|0){h=M[2]|0;M[t+632>>2]=_&7;M[t+632+4>>2]=_>>>3&7;Kt(h,1525,t+632|0)|0}e=M[4668+((_&7)<<2)>>2]|0;r=M[4668+((_>>>3&7)<<2)>>2]&255;do{if(!r)r=M[1184]|0;else{if(r>>>0<32){h=M[1184]|0;h=1<<r+-1&e|0?h|536870912:h&-536870913;M[1184]=h;e=e>>>r;r=h;break}if((r|0)==32){r=M[1184]|0;r=(e|0)<0?r|536870912:r&-536870913;M[1184]=r;e=0;break}else{r=M[1184]&-536870913;M[1184]=r;e=0;break}}}while(0);M[4668+((_&7)<<2)>>2]=e;i=(e|0)<0?r|-2147483648:r&2147483647;M[1184]=(e|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&63488|0)==8192){if(A[5300]|0){h=M[2]|0;M[t+640>>2]=_>>>8&7;M[t+640+4>>2]=_&255;Kt(h,1539,t+640|0)|0}M[4668+((_>>>8&7)<<2)>>2]=_&255;i=M[1184]&1073741823;M[1184]=(_&255|0)==0?i|1073741824:i;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65472|0)==7168){if(A[5300]|0){h=M[2]|0;M[t+648>>2]=_&7;M[t+648+4>>2]=_>>>3&7;Kt(h,1557,t+648|0)|0}h=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=h;i=M[1184]|0;i=(h|0)<0?i|-2147483648:i&2147483647;M[1184]=((h|0)==0?i|1073741824:i&-1879048193)&-805306369;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65280|0)==17920){if(A[5300]|0){h=M[2]|0;M[t+656>>2]=_>>>4&8|_&7;M[t+656+4>>2]=_>>>3&15;Kt(h,1571,t+656|0)|0}e=M[4668+((_>>>3&15)<<2)>>2]|0;if((_>>>3&15|0)==15){if(e&1|0){h=M[2]|0;M[t+664>>2]=e;Kt(h,520,t+664|0)|0}e=e&-2}M[4668+((_>>>4&8|_&7)<<2)>>2]=(_>>>4&8|_&7|0)==15?((_>>>4&8|_&7|0)==15?e+2|0:e)&-2:e;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}e=1;r=((_&65472)+-16960|0)>>>6&67108863|0;if(e)switch(r|0){case 4:{if(A[5300]|0){h=M[2]|0;M[t+672>>2]=_&7;M[t+672+4>>2]=_>>>3&7;Kt(h,1584,t+672|0)|0}h=V(M[4668+((_>>>3&7)<<2)>>2]|0,M[4668+((_&7)<<2)>>2]|0)|0;M[4668+((_&7)<<2)>>2]=h;i=M[1184]|0;i=(h|0)<0?i|-2147483648:i&2147483647;M[1184]=(h|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 6:{if(A[5300]|0){h=M[2]|0;M[t+680>>2]=_&7;M[t+680+4>>2]=_>>>3&7;Kt(h,1598,t+680|0)|0}h=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=~h;i=M[1184]|0;i=(h|0)>-1?i|-2147483648:i&2147483647;M[1184]=(h|0)==-1?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 0:{if(A[5300]|0){h=M[2]|0;M[t+688>>2]=_&7;M[t+688+4>>2]=_>>>3&7;Kt(h,1612,t+688|0)|0}h=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=0-h;i=M[1184]|0;i=(0-h|0)<0?i|-2147483648:i&2147483647;i=(h|0)==0?i|1073741824:i&-1073741825;i=(((((~h&2147483647)+1|0)>>>31)+(~h>>>31)|0)&2|0)==0?i&-536870913:i|536870912;M[1184]=(((~h&2147483647)+1|0)>>>31|0)==(((((~h&2147483647)+1|0)>>>31)+(~h>>>31)|0)>>>1|0)?i&-268435457:i|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 3:{if(A[5300]|0){h=M[2]|0;M[t+696>>2]=_&7;M[t+696+4>>2]=_>>>3&7;Kt(h,1626,t+696|0)|0}h=M[4668+((_>>>3&7)<<2)>>2]|M[4668+((_&7)<<2)>>2];M[4668+((_&7)<<2)>>2]=h;i=M[1184]|0;i=(h|0)<0?i|-2147483648:i&2147483647;M[1184]=(h|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:e=1}if(e)switch(r|0){default:{e=1;r=(_&65024)<<16>>16;if(e)switch(r|0){case-17408:{if(!(A[5300]|0))r=_&1;else{r=M[2]|0;Ht(1640,5,1,r)|0;if(!(_&1))e=0;else{M[t+704>>2]=0;Kt(r,1249,t+704|0)|0;e=1}if(_&2){if(e|0)pe(44,r)|0;M[t+1064>>2]=1;Kt(r,1249,t+1064|0)|0;e=e+1|0}if(_&4){if(e|0)pe(44,r)|0;M[t+1072>>2]=2;Kt(r,1249,t+1072|0)|0;e=e+1|0}if(_&8){if(e|0)pe(44,r)|0;M[t+1080>>2]=3;Kt(r,1249,t+1080|0)|0;e=e+1|0}if(_&16){if(e|0)pe(44,r)|0;M[t+1088>>2]=4;Kt(r,1249,t+1088|0)|0;e=e+1|0}if(_&32){if(e|0)pe(44,r)|0;M[t+1096>>2]=5;Kt(r,1249,t+1096|0)|0;e=e+1|0}if(_&64){if(e|0)pe(44,r)|0;M[t+1104>>2]=6;Kt(r,1249,t+1104|0)|0;e=e+1|0}if(_&128){if(e|0)pe(44,r)|0;M[t+1112>>2]=7;Kt(r,1249,t+1112|0)|0;e=e+1|0}if(_&256|0){if(e|0)pe(44,r)|0;Ht(1646,2,1,r)|0}Ht(1253,2,1,r)|0;r=_&1}e=M[1180]|0;if(r){M[1167]=tt(1,e|0)|0;e=e+4|0}if(_&2){M[1168]=tt(1,e|0)|0;e=e+4|0}if(_&4){M[1169]=tt(1,e|0)|0;e=e+4|0}if(_&8){M[1170]=tt(1,e|0)|0;e=e+4|0}if(_&16){M[1171]=tt(1,e|0)|0;e=e+4|0}if(_&32){M[1172]=tt(1,e|0)|0;e=e+4|0}if(_&64){M[1173]=tt(1,e|0)|0;e=e+4|0}if(_&128){M[1174]=tt(1,e|0)|0;e=e+4|0}if(_&256){r=tt(1,e|0)|0;if(!(r&1)){_=M[2]|0;M[t+712>>2]=h;M[t+712+4>>2]=r;Kt(_,1649,t+712|0)|0;r=r&-2}M[1182]=r+2&-2;e=e+4|0}M[1180]=e;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case-19456:{l=M[2]|0;if(!(A[5300]|0)){e=_&2;r=_&4;i=_&8;n=_&16;s=_&32;a=_&64;o=_&128;c=_&256;u=_&1}else{Ht(1703,6,1,l)|0;if(!(_&1))e=0;else{M[t+720>>2]=0;Kt(l,1249,t+720|0)|0;e=1}if(_&2){if(e|0)pe(44,l)|0;M[t+1120>>2]=1;Kt(l,1249,t+1120|0)|0;e=e+1|0}if(_&4){if(e|0)pe(44,l)|0;M[t+1128>>2]=2;Kt(l,1249,t+1128|0)|0;e=e+1|0}if(_&8){if(e|0)pe(44,l)|0;M[t+1136>>2]=3;Kt(l,1249,t+1136|0)|0;e=e+1|0}if(_&16){if(e|0)pe(44,l)|0;M[t+1144>>2]=4;Kt(l,1249,t+1144|0)|0;e=e+1|0}if(_&32){if(e|0)pe(44,l)|0;M[t+1152>>2]=5;Kt(l,1249,t+1152|0)|0;e=e+1|0}if(_&64){if(e|0)pe(44,l)|0;M[t+1160>>2]=6;Kt(l,1249,t+1160|0)|0;e=e+1|0}if(_&128){if(e|0)pe(44,l)|0;M[t+1168>>2]=7;Kt(l,1249,t+1168|0)|0;e=e+1|0}if(_&256|0){if(e|0)pe(44,l)|0;Ht(1710,2,1,l)|0}Ht(1253,2,1,l)|0;e=_&2;r=_&4;i=_&8;n=_&16;s=_&32;a=_&64;o=_&128;c=_&256;u=_&1}s=(M[1180]|0)-((o>>>7)+((a>>>6)+((s>>>5)+((n>>>4)+((i>>>3)+((r>>>2)+((e>>>1)+u))))))+(c>>>8)<<2)|0;e=s;i=0;n=1;while(1){if(!(n&_))r=e;else{r=M[4668+(i<<2)>>2]|0;e:do{if((e&-268435456|0)==-536870912){u=e+536813552|0;switch(u>>>2|u<<30|0){case 0:{u=M[1164]|0;M[1164]=r&65543;if((r&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=r&16777215;break e}case 2:{M[1166]=r&16777215;break e}case 3:break e;default:break e}}else ut(2,e|0,r|0)|0}while(0);r=e+4|0}i=i+1|0;if((i|0)==8)break;else{e=r;n=n<<1&254}}do{if(c|0){e=M[1181]|0;e:do{if((r&-268435456|0)==-536870912){_=r+536813552|0;switch(_>>>2|_<<30|0){case 0:{_=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(_&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}}else ut(2,r|0,e|0)|0}while(0);if(e&1|0)break;M[t+728>>2]=h;M[t+728+4>>2]=e;Kt(l,1713,t+728|0)|0}}while(0);M[1180]=s;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:e=1}if(e)switch(r|0){default:{e:do{if((_&65472)<<16>>16<-17728)switch((_&65472)<<16>>16){case-17920:{if(A[5300]|0){h=M[2]|0;M[t+736>>2]=_&7;M[t+736+4>>2]=_>>>3&7;Kt(h,1768,t+736|0)|0}M[4668+((_&7)<<2)>>2]=Te(M[4668+((_>>>3&7)<<2)>>2]|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case-17856:{if(A[5300]|0){h=M[2]|0;M[t+744>>2]=_&7;M[t+744+4>>2]=_>>>3&7;Kt(h,1781,t+744|0)|0}i=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=i<<8&65280|i>>>8&255|i>>>16<<24|i>>>24<<16;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:break e}else{if((_&65472)<<16>>16<16768){switch((_&65472)<<16>>16){case-17728:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+752>>2]=_&7;M[t+752+4>>2]=_>>>3&7;Kt(h,1796,t+752|0)|0}i=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=(i<<8&32768|0)==0?i<<8&65280|i>>>8&255:i<<8&65280|i>>>8&255|-65536;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}switch((_&65472)<<16>>16){case 16832:break;case 16768:{if(A[5300]|0){h=M[2]|0;M[t+768>>2]=_&7;M[t+768+4>>2]=_>>>3&7;Kt(h,1825,t+768|0)|0}r=M[4668+((_&7)<<2)>>2]|0;i=M[4668+((_>>>3&7)<<2)>>2]|0;h=M[1184]|0;M[4668+((_&7)<<2)>>2]=r-i+-1+(h>>>29&1);e=(r-i+-1+(h>>>29&1)|0)<0?h|-2147483648:h&2147483647;e=(r-i+-1+(h>>>29&1)|0)==0?e|1073741824:e&-1073741825;M[1184]=e;if(!(e&536870912)){_=(((~i>>>31)+(r>>>31)+(((~i&2147483647)+(r&2147483647)|0)>>>31)|0)&2|0)==0?e&-536870913:e|536870912;M[1184]=(((~i&2147483647)+(r&2147483647)|0)>>>31|0)==(((~i>>>31)+(r>>>31)+(((~i&2147483647)+(r&2147483647)|0)>>>31)|0)>>>1&1|0)?_&-268435457:_|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}else{_=(((~i>>>31)+(r>>>31)+(((~i&2147483647)+(r&2147483647)+1|0)>>>31)|0)&2|0)==0?e&-536870913:e|536870912;M[1184]=(((~i&2147483647)+(r&2147483647)+1|0)>>>31|0)==(((~i>>>31)+(r>>>31)+(((~i&2147483647)+(r&2147483647)+1|0)>>>31)|0)>>>1&1|0)?_&-268435457:_|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}default:break e}if(A[5300]|0){h=M[2]|0;M[t+760>>2]=_&7;M[t+760+4>>2]=_>>>3&7;Kt(h,1811,t+760|0)|0}e=M[4668+((_&7)<<2)>>2]|0;r=M[4668+((_>>>3&7)<<2)>>2]|0;do{if(!(r&255))r=M[1184]|0;else if(!(r&31)){r=M[1184]|0;r=(e|0)<0?r|536870912:r&-536870913;M[1184]=r;break}else{h=M[1184]|0;h=1<<(r&31)+-1&e|0?h|536870912:h&-536870913;M[1184]=h;e=e<<32-(r&31)|e>>>(r&31);r=h;break}}while(0);M[4668+((_&7)<<2)>>2]=e;i=(e|0)<0?r|-2147483648:r&2147483647;M[1184]=(e|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}while(0);if((_&65527|0)==46672){Ht(1838,23,1,M[2]|0)|0;i=1;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}e:do{if((_&63488)<<16>>16<24576){switch((_&63488)<<16>>16){case-16384:break;default:break e}if(A[5300]|0){r=M[2]|0;M[t+776>>2]=_>>>8&7;Kt(r,1862,t+776|0)|0;if(!(_&1))e=0;else{M[t+784>>2]=0;Kt(r,1249,t+784|0)|0;e=1}if(_&2){if(e|0)pe(44,r)|0;M[t+1008>>2]=1;Kt(r,1249,t+1008|0)|0;e=e+1|0}if(_&4){if(e|0)pe(44,r)|0;M[t+1016>>2]=2;Kt(r,1249,t+1016|0)|0;e=e+1|0}if(_&8){if(e|0)pe(44,r)|0;M[t+1024>>2]=3;Kt(r,1249,t+1024|0)|0;e=e+1|0}if(_&16){if(e|0)pe(44,r)|0;M[t+1032>>2]=4;Kt(r,1249,t+1032|0)|0;e=e+1|0}if(_&32){if(e|0)pe(44,r)|0;M[t+1040>>2]=5;Kt(r,1249,t+1040|0)|0;e=e+1|0}if(_&64){if(e|0)pe(44,r)|0;M[t+1048>>2]=6;Kt(r,1249,t+1048|0)|0;e=e+1|0}if(_&128|0){if(e|0)pe(44,r)|0;M[t+1056>>2]=7;Kt(r,1249,t+1056|0)|0}Ht(1253,2,1,r)|0}i=1;n=0;e=M[4668+((_>>>8&7)<<2)>>2]|0;while(1){if(i&_){r=M[4668+(n<<2)>>2]|0;r:do{if((e&-268435456|0)==-536870912){h=e+536813552|0;switch(h>>>2|h<<30|0){case 0:{h=M[1164]|0;M[1164]=r&65543;if((r&1|0)==0|(h&1|0)!=0)break r;M[1166]=M[1165];break r}case 1:{M[1165]=r&16777215;break r}case 2:{M[1166]=r&16777215;break r}case 3:break r;default:break r}}else ut(2,e|0,r|0)|0}while(0);e=e+4|0}n=n+1|0;if((n|0)==8)break;else i=i<<1&254}M[4668+((_>>>8&7)<<2)>>2]=e;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}else{switch((_&63488)<<16>>16){case 24576:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+792>>2]=_&7;M[t+792+4>>2]=_>>>3&7;M[t+792+8>>2]=_>>>4&124;Kt(h,1875,t+792|0)|0}r=(M[4668+((_>>>3&7)<<2)>>2]|0)+(_>>>4&124)|0;e=M[4668+((_&7)<<2)>>2]|0;if((r&-268435456|0)!=-536870912){ut(2,r|0,e|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}switch((r+536813552|0)>>>2|r+536813552<<30|0){case 0:{_=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(_&1|0)!=0){i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}M[1166]=M[1165];i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 1:{M[1165]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 2:{M[1166]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 3:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}}}while(0);if((_&65024|0)==20480){if(A[5300]|0){h=M[2]|0;M[t+808>>2]=_&7;M[t+808+4>>2]=_>>>3&7;M[t+808+8>>2]=_>>>6&7;Kt(h,1896,t+808|0)|0}r=(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0;e=M[4668+((_&7)<<2)>>2]|0;if((r&-268435456|0)!=-536870912){ut(2,r|0,e|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}switch((r+536813552|0)>>>2|r+536813552<<30|0){case 0:{_=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(_&1|0)!=0){i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}M[1166]=M[1165];i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 1:{M[1165]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 2:{M[1166]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 3:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}}e:do{if((_&63488)<<16>>16<28672){switch((_&63488)<<16>>16){case-28672:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+824>>2]=_>>>8&7;M[t+824+4>>2]=_<<2&1020;Kt(h,1915,t+824|0)|0}r=(M[1180]|0)+(_<<2&1020)|0;e=M[4668+((_>>>8&7)<<2)>>2]|0;if((r&-268435456|0)!=-536870912){ut(2,r|0,e|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}switch((r+536813552|0)>>>2|r+536813552<<30|0){case 0:{_=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(_&1|0)!=0){i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}M[1166]=M[1165];i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 1:{M[1165]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 2:{M[1166]=e&16777215;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case 3:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:{i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}}else{switch((_&63488)<<16>>16){case 28672:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+832>>2]=_&7;M[t+832+4>>2]=_>>>3&7;M[t+832+8>>2]=_>>>6&31;Kt(h,1935,t+832|0)|0}i=M[4668+((_>>>3&7)<<2)>>2]|0;e=M[4668+((_&7)<<2)>>2]|0;r=tt(3,i+(_>>>6&31)&-2|0)|0;if(!(i+(_>>>6)&1))e=r&65280|e&255;else e=r&255|e<<8;ut(5,i+(_>>>6&31)&-2|0,e&65535|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}while(0);if((_&65024|0)==21504){if(A[5300]|0){h=M[2]|0;M[t+848>>2]=_&7;M[t+848+4>>2]=_>>>3&7;M[t+848+8>>2]=_>>>6&7;Kt(h,1957,t+848|0)|0}i=(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0;e=M[4668+((_&7)<<2)>>2]|0;r=tt(3,i&-2|0)|0;if(!(i&1))e=r&65280|e&255;else e=r&255|e<<8;ut(5,i&-2|0,e&65535|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&63488|0)==32768){if(A[5300]|0){h=M[2]|0;M[t+864>>2]=_&7;M[t+864+4>>2]=_>>>3&7;M[t+864+8>>2]=_>>>5&62;Kt(h,1977,t+864|0)|0}ut(5,(M[4668+((_>>>3&7)<<2)>>2]|0)+(_>>>5&62)|0,M[4668+((_&7)<<2)>>2]&65535|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}e:do{if((_&65024)<<16>>16<20992){switch((_&65024)<<16>>16){case 7680:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+896>>2]=_&7;M[t+896+4>>2]=_>>>3&7;M[t+896+8>>2]=_>>>6&7;Kt(h,2019,t+896|0)|0}h=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=h-(_>>>6&7);i=M[1184]|0;i=(h-(_>>>6&7)|0)<0?i|-2147483648:i&2147483647;i=(h-(_>>>6&7)|0)==0?i|1073741824:i&-1073741825;i=(((h>>>31)+1+((((_>>>6|2147483640)^7)+1+(h&2147483647)|0)>>>31)|0)&2|0)==0?i&-536870913:i|536870912;M[1184]=((((_>>>6|2147483640)^7)+1+(h&2147483647)|0)>>>31|0)==(((h>>>31)+1+((((_>>>6|2147483640)^7)+1+(h&2147483647)|0)>>>31)|0)>>>1&1|0)?i&-268435457:i|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}else{switch((_&65024)<<16>>16){case 20992:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+880>>2]=_&7;M[t+880+4>>2]=_>>>3&7;M[t+880+8>>2]=_>>>6&7;Kt(h,1999,t+880|0)|0}ut(5,(M[4668+((_>>>6&7)<<2)>>2]|0)+(M[4668+((_>>>3&7)<<2)>>2]|0)|0,M[4668+((_&7)<<2)>>2]&65535|0)|0;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}while(0);if((_&63488|0)==14336){if(A[5300]|0){h=M[2]|0;M[t+912>>2]=_>>>8&7;M[t+912+4>>2]=_&255;Kt(h,2039,t+912|0)|0}h=M[4668+((_>>>8&7)<<2)>>2]|0;M[4668+((_>>>8&7)<<2)>>2]=h-(_&255);i=M[1184]|0;i=(h-(_&255)|0)<0?i|-2147483648:i&2147483647;i=(h-(_&255)|0)==0?i|1073741824:i&-1073741825;i=(((h>>>31)+1+((-2147483648-(_&255)+(h&2147483647)|0)>>>31)|0)&2|0)==0?i&-536870913:i|536870912;M[1184]=((-2147483648-(_&255)+(h&2147483647)|0)>>>31|0)==(((h>>>31)+1+((-2147483648-(_&255)+(h&2147483647)|0)>>>31)|0)>>>1&1|0)?i&-268435457:i|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65024|0)==6656){if(A[5300]|0){h=M[2]|0;M[t+920>>2]=_&7;M[t+920+4>>2]=_>>>3&7;M[t+920+8>>2]=_>>>6&7;Kt(h,2057,t+920|0)|0}l=M[4668+((_>>>3&7)<<2)>>2]|0;h=M[4668+((_>>>6&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=l-h;i=M[1184]|0;i=(l-h|0)<0?i|-2147483648:i&2147483647;i=(l-h|0)==0?i|1073741824:i&-1073741825;i=(((~h>>>31)+(l>>>31)+(((l&2147483647)+1+(~h&2147483647)|0)>>>31)|0)&2|0)==0?i&-536870913:i|536870912;M[1184]=(((l&2147483647)+1+(~h&2147483647)|0)>>>31|0)==(((~h>>>31)+(l>>>31)+(((l&2147483647)+1+(~h&2147483647)|0)>>>31)|0)>>>1&1|0)?i&-268435457:i|268435456;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65408|0)==45184){if(A[5300]|0){h=M[2]|0;M[t+936>>2]=_<<2&508;Kt(h,2075,t+936|0)|0}M[1180]=(M[1180]|0)-(_<<2&508);i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65280|0)==57088){if(A[5300]|0){h=M[2]|0;M[t+944>>2]=_&255;Kt(h,2091,t+944|0)|0}if((_&255|0)==204){M[1167]=M[1184];i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}else{i=M[2]|0;M[t+952>>2]=_&255;Kt(i,2103,t+952|0)|0;i=1;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}e:do{if((_&65472)<<16>>16<-19840)switch((_&65472)<<16>>16){case-19904:{if(A[5300]|0){h=M[2]|0;M[t+960>>2]=_&7;M[t+960+4>>2]=_>>>3&7;Kt(h,2117,t+960|0)|0}i=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=(i&128|0)==0?i&255:i|-256;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}case-19968:{if(A[5300]|0){h=M[2]|0;M[t+968>>2]=_&7;M[t+968+4>>2]=_>>>3&7;Kt(h,2131,t+968|0)|0}i=M[4668+((_>>>3&7)<<2)>>2]|0;M[4668+((_&7)<<2)>>2]=(i&32768|0)==0?i&65535:i|-65536;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}default:break e}else{if((_&65472)<<16>>16<-19776){switch((_&65472)<<16>>16){case-19840:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+992>>2]=_&7;M[t+992+4>>2]=_>>>3&7;Kt(h,2172,t+992|0)|0}M[4668+((_&7)<<2)>>2]=M[4668+((_>>>3&7)<<2)>>2]&65535;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}if((_&65472)<<16>>16<16896){switch((_&65472)<<16>>16){case-19776:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+984>>2]=_&7;M[t+984+4>>2]=_>>>3&7;Kt(h,2158,t+984|0)|0}M[4668+((_&7)<<2)>>2]=M[4668+((_>>>3&7)<<2)>>2]&255;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}else{switch((_&65472)<<16>>16){case 16896:break;default:break e}if(A[5300]|0){h=M[2]|0;M[t+976>>2]=_&7;M[t+976+4>>2]=_>>>3&7;Kt(h,2145,t+976|0)|0}_=M[4668+((_>>>3&7)<<2)>>2]&M[4668+((_&7)<<2)>>2];i=M[1184]|0;i=(_|0)<0?i|-2147483648:i&2147483647;M[1184]=(_|0)==0?i|1073741824:i&-1073741825;i=0;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}}while(0);i=M[2]|0;M[t+1e3>>2]=n;M[t+1e3+4>>2]=_;Kt(i,2186,t+1e3|0)|0;i=1;S=t;M[t+4792>>2]=6;M[t+4796>>2]=i|0;break t}}}}}}}M[t+1368>>2]=i}var Be=[Re,It];var Fe=[xe,Et,Rt,xe];return{_llvm_bswap_i32:Te,_enable_debug:kt,stackSave:ht,_i64Subtract:ge,___udivdi3:Me,setThrew:ft,_bitshift64Lshr:ve,_read_register:wt,_bitshift64Shl:ke,_memset:ye,_sbrk:Pe,_memcpy:we,stackAlloc:lt,___uremdi3:Se,_run:yt,_abort_run:vt,setTempRet0:pt,_i64Add:be,dynCall_iiii:Ee,dynCall_ii:Ie,_ping:bt,_emscripten_get_global_libc:Tt,_free:St,___errno_location:Ot,_set_stop_address:gt,runPostSets:me,getTempRet0:mt,_write_register:Ct,stackRestore:_t,_malloc:Pt,establishStackSpace:dt,_reset:At}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),_enable_debug=Module._enable_debug=asm._enable_debug,stackSave=Module.stackSave=asm.stackSave,_i64Subtract=Module._i64Subtract=asm._i64Subtract,___udivdi3=Module.___udivdi3=asm.___udivdi3,getTempRet0=Module.getTempRet0=asm.getTempRet0,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_read_register=Module._read_register=asm._read_register,_bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl,_memset=Module._memset=asm._memset,_sbrk=Module._sbrk=asm._sbrk,_memcpy=Module._memcpy=asm._memcpy,___errno_location=Module.___errno_location=asm.___errno_location,___uremdi3=Module.___uremdi3=asm.___uremdi3,stackAlloc=Module.stackAlloc=asm.stackAlloc,_run=Module._run=asm._run,_abort_run=Module._abort_run=asm._abort_run,setTempRet0=Module.setTempRet0=asm.setTempRet0,_i64Add=Module._i64Add=asm._i64Add,_ping=Module._ping=asm._ping,_emscripten_get_global_libc=Module._emscripten_get_global_libc=asm._emscripten_get_global_libc,_set_stop_address=Module._set_stop_address=asm._set_stop_address,_llvm_bswap_i32=Module._llvm_bswap_i32=asm._llvm_bswap_i32,_free=Module._free=asm._free,runPostSets=Module.runPostSets=asm.runPostSets,setThrew=Module.setThrew=asm.setThrew,establishStackSpace=Module.establishStackSpace=asm.establishStackSpace,_write_register=Module._write_register=asm._write_register,stackRestore=Module.stackRestore=asm.stackRestore,_malloc=Module._malloc=asm._malloc,_reset=Module._reset=asm._reset,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,initialStackTop;function ExitStatus(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}Runtime.stackAlloc=Module.stackAlloc,Runtime.stackSave=Module.stackSave,Runtime.stackRestore=Module.stackRestore,Runtime.establishStackSpace=Module.establishStackSpace,Runtime.setTempRet0=Module.setTempRet0,Runtime.getTempRet0=Module.getTempRet0,Module.asm=asm,Module.then=function(t){if(Module.calledRun)t(Module);else{var e=Module.onRuntimeInitialized;Module.onRuntimeInitialized=function(){e&&e(),t(Module)}}return Module},ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var preloadStartTime=null,calledMain=!1;function run(t){function e(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(t),postRun()))}t=t||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),0<runDependencies||(preRun(),0<runDependencies||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}function exit(t,e){e&&Module.noExitRuntime||(Module.noExitRuntime||(ABORT=!0,EXITSTATUS=t,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(t)),ENVIRONMENT_IS_NODE&&process.exit(t),Module.quit(t,new ExitStatus(t)))}dependenciesFulfilled=function t(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=t)},Module.callMain=Module.callMain=function(t){t=t||[],ensureInitRuntime();var e=t.length+1;function r(){for(var t=0;t<3;t++)i.push(0)}var i=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];r();for(var n=0;n<e-1;n+=1)i.push(allocate(intArrayFromString(t[n]),"i8",ALLOC_NORMAL)),r();i.push(0),i=allocate(i,"i32",ALLOC_NORMAL);try{exit(Module._main(e,i,0),!0)}catch(t){if(t instanceof ExitStatus)return;if("SimulateInfiniteLoop"==t)return void(Module.noExitRuntime=!0);var s=t;t&&"object"==typeof t&&t.stack&&(s=[t,t.stack]),Module.printErr("exception thrown: "+s),Module.quit(1,t)}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit;var abortDecorators=[];function abort(e){Module.onAbort&&Module.onAbort(e),e=void 0!==e?(Module.print(e),Module.printErr(e),JSON.stringify(e)):"",ABORT=!0,EXITSTATUS=1;var r="abort("+e+") at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw abortDecorators&&abortDecorators.forEach(function(t){r=t(r,e)}),r}if(Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();var shouldRunNow=!1;return Module.noInitialRun&&(shouldRunNow=!1),Module.noExitRuntime=!0,run(),Module};"object"==typeof module&&module.exports&&(module.exports=Module),module.exports=Module}).call(this,require("_process"))},{_process:8,fs:4,path:7}],20:[function(t,i,e){(function(t){var e,r,n,s,a,o,u,c,l,h,_,d,f,p,m,g,b,y,v;!function(e){var n="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:{};function r(r,i){return r!==n&&("function"==typeof Object.create?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0),function(t,e){return r[t]=i?i(t,e):e}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(t){e(r(n,r(t)))}):"object"==typeof i&&"object"==typeof i.exports?e(r(n,r(i.exports))):e(r(n))}(function(t){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};e=function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},r=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},n=function(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&(r[i[n]]=t[i[n]])}return r},s=function(t,e,r,i){var n,s=arguments.length,a=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,i);else for(var o=t.length-1;0<=o;o--)(n=t[o])&&(a=(s<3?n(a):3<s?n(e,r,a):n(e,r))||a);return 3<s&&a&&Object.defineProperty(e,r,a),a},a=function(r,i){return function(t,e){i(t,e,r)}},o=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(s,a,o,u){return new(o||(o=Promise))(function(t,e){function r(t){try{n(u.next(t))}catch(t){e(t)}}function i(t){try{n(u.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new o(function(t){t(e.value)}).then(r,i)}n((u=u.apply(s,a||[])).next())})},c=function(r,i){var n,s,a,t,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(a=2&e[0]?s.return:e[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return o.label++,{value:e[1],done:!1};case 5:o.label++,s=e[1],e=[0];continue;case 7:e=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){o=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){o.label=e[1];break}if(6===e[0]&&o.label<a[1]){o.label=a[1],a=e;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(e);break}a[2]&&o.ops.pop(),o.trys.pop();continue}e=i.call(r,o)}catch(t){e=[6,t],s=0}finally{n=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},l=function(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])},h=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},_=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,s=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(i=s.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a},d=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_(arguments[e]));return t},f=function(t){return this instanceof f?(this.v=t,this):new f(t)},p=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(i){s[i]&&(n[i]=function(r){return new Promise(function(t,e){1<a.push([i,r,t,e])||o(i,r)})})}function o(t,e){try{(r=s[t](e)).value instanceof f?Promise.resolve(r.value.v).then(u,c):l(a[0][2],r)}catch(t){l(a[0][3],t)}var r}function u(t){o("next",t)}function c(t){o("throw",t)}function l(t,e){t(e),a.shift(),a.length&&o(a[0][0],a[0][1])}},m=function(i){var t,n;return t={},e("next"),e("throw",function(t){throw t}),e("return"),t[Symbol.iterator]=function(){return this},t;function e(e,r){t[e]=i[e]?function(t){return(n=!n)?{value:f(i[e](t)),done:"return"===e}:r?r(t):t}:r}},g=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=u[Symbol.asyncIterator];return e?e.call(u):(u=h(u),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=u[o]&&function(a){return new Promise(function(t,e){var r,i,n,s;a=u[o](a),r=t,i=e,n=a.done,s=a.value,Promise.resolve(s).then(function(t){r({value:t,done:n})},i)})}}},b=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},v=function(t){return t&&t.__esModule?t:{default:t}},t("__extends",e),t("__assign",r),t("__rest",n),t("__decorate",s),t("__param",a),t("__metadata",o),t("__awaiter",u),t("__generator",c),t("__exportStar",l),t("__values",h),t("__read",_),t("__spread",d),t("__await",f),t("__asyncGenerator",p),t("__asyncDelegator",m),t("__asyncValues",g),t("__makeTemplateObject",b),t("__importStar",y),t("__importDefault",v)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(t,e,r){"use strict";var i,n=t("microevent.ts"),a="resolve_transaction",o="reject_transaction";!function(t){var e;(e=t.MessageType||(t.MessageType={}))[e.signal=0]="signal",e[e.rpc=1]="rpc",e[e.internal=2]="internal";t.MessageType}((i=function(){function s(t,e){void 0===e&&(e=0),this._dispatch=t,this._rpcTimeout=e,this.error=new n.Event,this._rpcHandlers={},this._signalHandlers={},this._pendingTransactions={},this._nextTransactionId=0}return s.prototype.dispatch=function(t){var e=t;switch(e.type){case s.MessageType.signal:return this._handleSignal(e);case s.MessageType.rpc:return this._handeRpc(e);case s.MessageType.internal:return this._handleInternal(e);default:this._raiseError("invalid message type "+e.type)}},s.prototype.rpc=function(t,e,r){var i=this,n=this._nextTransactionId++;return this._dispatch({type:s.MessageType.rpc,transactionId:n,id:t,payload:e},r||void 0),new Promise(function(t,e){var r=i._pendingTransactions[n]={id:n,resolve:t,reject:e};0<i._rpcTimeout&&(i._pendingTransactions[n].timeoutHandle=setTimeout(function(){return i._transactionTimeout(r)},i._rpcTimeout))})},s.prototype.signal=function(t,e,r){return this._dispatch({type:s.MessageType.signal,id:t,payload:e},r||void 0),this},s.prototype.registerRpcHandler=function(t,e){if(this._rpcHandlers[t])throw new Error("rpc handler for "+t+" already registered");return this._rpcHandlers[t]=e,this},s.prototype.registerSignalHandler=function(t,e){return this._signalHandlers[t]||(this._signalHandlers[t]=[]),this._signalHandlers[t].push(e),this},s.prototype.deregisterRpcHandler=function(t,e){return this._rpcHandlers[t]&&delete this._rpcHandlers[t],this},s.prototype.deregisterSignalHandler=function(t,e){return this._signalHandlers[t]&&(this._signalHandlers[t]=this._signalHandlers[t].filter(function(t){return e!==t})),this},s.prototype._raiseError=function(t){this.error.dispatch(new Error(t)),this._dispatch({type:s.MessageType.internal,id:"error",payload:t})},s.prototype._handleSignal=function(e){if(!this._signalHandlers[e.id])return this._raiseError("invalid signal "+e.id);this._signalHandlers[e.id].forEach(function(t){return t(e.payload)})},s.prototype._handeRpc=function(e){var r=this;if(!this._rpcHandlers[e.id])return this._raiseError("invalid rpc "+e.id);Promise.resolve(this._rpcHandlers[e.id](e.payload)).then(function(t){return r._dispatch({type:s.MessageType.internal,id:a,transactionId:e.transactionId,payload:t})},function(t){return r._dispatch({type:s.MessageType.internal,id:o,transactionId:e.transactionId,payload:t})})},s.prototype._handleInternal=function(t){switch(t.id){case a:if(!this._pendingTransactions[t.transactionId])return this._raiseError("no pending transaction with id "+t.transactionId);this._pendingTransactions[t.transactionId].resolve(t.payload),this._clearTransaction(this._pendingTransactions[t.transactionId]);break;case o:if(!this._pendingTransactions[t.transactionId])return this._raiseError("no pending transaction with id "+t.transactionId);this._pendingTransactions[t.transactionId].reject(t.payload),this._clearTransaction(this._pendingTransactions[t.transactionId]);break;case"error":this.error.dispatch(new Error("remote error: "+t.payload));break;default:this._raiseError("unhandled internal message "+t.id)}},s.prototype._transactionTimeout=function(t){t.reject("transaction timed out"),this._raiseError("transaction "+t.id+" timed out"),delete this._pendingTransactions[t.id]},s.prototype._clearTransaction=function(t){void 0!==t.timeoutHandle&&clearTimeout(t.timeoutHandle),delete this._pendingTransactions[t.id]},s}())||(i={})),Object.defineProperty(r,"__esModule",{value:!0}),r.default=i},{"microevent.ts":6}],22:[function(t,e,r){"use strict";var i=t("./RpcProvider");r.RpcProvider=i.default},{"./RpcProvider":21}],23:[function(t,e,r){"use strict";var i,n;Object.defineProperty(r,"__esModule",{value:!0}),n=function(t,e,r){this.reason=t,this.board=e,this.message=r},(i||(i={})).TrapPayload=n,r.default=i},{}],24:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("./Instruction"),i=t("./CpuInterface"),o=t("./ops");function n(t,e){t.p=e.readWord(65532)}function s(t,e,r){var i=t.p;t.nmi&&(r=65530),t.nmi=t.irq=!1,e.write(t.s+256,i>>>8&255),t.s=t.s+255&255,e.write(t.s+256,255&i),t.s=t.s+255&255,e.write(t.s+256,-17&t.flags),t.s=t.s+255&255,t.flags|=4,t.p=e.readWord(r)}function u(t,e){s(t,e,65534)}function c(t,e){s(t,e,65530)}r.opBoot=n,r.opIrq=u,r.opNmi=c;var l=function(){function t(t,e){this._bus=t,this._rng=e,this.executionState=0,this.state=new i.default.State,this._opCycles=0,this._instructionCallback=null,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._interuptCheck=0,this._halted=!1,this._operand=0,this._lastInstructionPointer=0,this._currentAddressingMode=12,this._dereference=!1,this.reset()}return t.prototype.setInterrupt=function(t){return this._interruptPending=t,this},t.prototype.isInterrupt=function(){return this._interruptPending},t.prototype.nmi=function(){return this._nmiPending=!0,this},t.prototype.halt=function(){return this._halted=!0,this},t.prototype.resume=function(){return this._halted=!1,this},t.prototype.isHalt=function(){return this._halted},t.prototype.setInvalidInstructionCallback=function(t){return this._invalidInstructionCallback=t,this},t.prototype.getInvalidInstructionCallback=function(){return this._invalidInstructionCallback},t.prototype.getLastInstructionPointer=function(){return this._lastInstructionPointer},t.prototype.reset=function(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._opCycles=7,this._interruptPending=!1,this._nmiPending=!1,this._instructionCallback=n,this},t.prototype.cycle=function(){if(this._halted)return this;switch(this.executionState){case 0:case 2:0==--this._opCycles&&(this._dereference&&(this._operand=this._bus.read(this._operand)),1===this._interuptCheck&&this._checkForInterrupts(),this._instructionCallback(this.state,this._bus,this._operand,this._currentAddressingMode),this.executionState=1,0===this._interuptCheck&&this._checkForInterrupts());break;case 1:if(this.state.nmi)return this._instructionCallback=c,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;if(this.state.irq)return this._instructionCallback=u,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;this._fetch()}return this},t.prototype._fetch=function(){var t,e,r=a.default.opcodes[this._bus.read(this.state.p)],i=r.addressingMode,n=!1,s=!1;switch(this._lastInstructionPointer=this.state.p,this._currentAddressingMode=i,this._interuptCheck=0,r.operation){case 0:this._opCycles=0,this._instructionCallback=o.opAdc,n=!0;break;case 1:this._opCycles=0,this._instructionCallback=o.opAnd,n=!0;break;case 2:0===i?(this._opCycles=1,this._instructionCallback=o.opAslAcc):(this._opCycles=3,this._instructionCallback=o.opAslMem,s=!0);break;case 3:1&this.state.flags?(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=o.opJmp,this._opCycles=0);break;case 4:1&this.state.flags?(this._instructionCallback=o.opJmp,this._opCycles=0):(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 5:2&this.state.flags?(this._instructionCallback=o.opJmp,this._opCycles=0):(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 6:this._opCycles=0,this._instructionCallback=o.opBit,n=!0;break;case 7:128&this.state.flags?(this._instructionCallback=o.opJmp,this._opCycles=0):(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 8:2&this.state.flags?(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=o.opJmp,this._opCycles=0);break;case 9:128&this.state.flags?(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=o.opJmp,this._opCycles=0);break;case 11:64&this.state.flags?(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=o.opJmp,this._opCycles=0);break;case 12:64&this.state.flags?(this._instructionCallback=o.opJmp,this._opCycles=0):(i=0,this._instructionCallback=o.opNop,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 10:this._opCycles=6,this._instructionCallback=o.opBrk,this._interuptCheck=1;break;case 13:this._opCycles=1,this._instructionCallback=o.opClc;break;case 14:this._opCycles=1,this._instructionCallback=o.opCld;break;case 15:this._opCycles=1,this._instructionCallback=o.opCli,this._interuptCheck=1;break;case 16:this._opCycles=1,this._instructionCallback=o.opClv;break;case 17:this._opCycles=0,this._instructionCallback=o.opCmp,n=!0;break;case 18:this._opCycles=0,this._instructionCallback=o.opCpx,n=!0;break;case 19:this._opCycles=0,this._instructionCallback=o.opCpy,n=!0;break;case 20:this._opCycles=3,this._instructionCallback=o.opDec,s=!0;break;case 21:this._opCycles=1,this._instructionCallback=o.opDex;break;case 22:this._opCycles=1,this._instructionCallback=o.opDey;break;case 23:this._opCycles=0,this._instructionCallback=o.opEor,n=!0;break;case 24:this._opCycles=3,this._instructionCallback=o.opInc,s=!0;break;case 25:this._opCycles=1,this._instructionCallback=o.opInx;break;case 26:this._opCycles=1,this._instructionCallback=o.opIny;break;case 27:this._opCycles=0,this._instructionCallback=o.opJmp;break;case 28:this._opCycles=5,this._instructionCallback=o.opJsr;break;case 29:this._opCycles=1===i?0:1,this._instructionCallback=o.opLda;break;case 30:this._opCycles=1===i?0:1,this._instructionCallback=o.opLdx;break;case 31:this._opCycles=1===i?0:1,this._instructionCallback=o.opLdy;break;case 32:0===i?(this._opCycles=1,this._instructionCallback=o.opLsrAcc):(this._opCycles=3,this._instructionCallback=o.opLsrMem,s=!0);break;case 33:this._opCycles=1,this._instructionCallback=o.opNop;break;case 56:case 57:n=!(this._opCycles=0),this._instructionCallback=o.opNop;break;case 34:this._opCycles=0,this._instructionCallback=o.opOra,n=!0;break;case 36:this._opCycles=2,this._instructionCallback=o.opPhp;break;case 35:this._opCycles=2,this._instructionCallback=o.opPha;break;case 37:this._opCycles=3,this._instructionCallback=o.opPla;break;case 38:this._opCycles=3,this._instructionCallback=o.opPlp,this._interuptCheck=1;break;case 39:0===i?(this._opCycles=1,this._instructionCallback=o.opRolAcc):(this._opCycles=3,this._instructionCallback=o.opRolMem,s=!0);break;case 40:0===i?(this._opCycles=1,this._instructionCallback=o.opRorAcc):(this._opCycles=3,this._instructionCallback=o.opRorMem,s=!0);break;case 41:this._opCycles=5,this._instructionCallback=o.opRti;break;case 42:this._opCycles=5,this._instructionCallback=o.opRts;break;case 43:this._opCycles=0,this._instructionCallback=o.opSbc,n=!0;break;case 44:this._opCycles=1,this._instructionCallback=o.opSec;break;case 45:this._opCycles=1,this._instructionCallback=o.opSed;break;case 46:this._opCycles=1,this._instructionCallback=o.opSei,this._interuptCheck=1;break;case 47:this._opCycles=1,this._instructionCallback=o.opSta,s=!0;break;case 48:this._opCycles=1,this._instructionCallback=o.opStx,s=!0;break;case 49:this._opCycles=1,this._instructionCallback=o.opSty,s=!0;break;case 50:this._opCycles=1,this._instructionCallback=o.opTax;break;case 51:this._opCycles=1,this._instructionCallback=o.opTay;break;case 52:this._opCycles=1,this._instructionCallback=o.opTsx;break;case 53:this._opCycles=1,this._instructionCallback=o.opTxa;break;case 54:this._opCycles=1,this._instructionCallback=o.opTxs;break;case 55:this._opCycles=1,this._instructionCallback=o.opTya;break;case 62:this._opCycles=0,this._instructionCallback=o.opArr;break;case 58:this._opCycles=0,this._instructionCallback=o.opAlr;break;case 59:this._opCycles=0,this._instructionCallback=o.opAxs;break;case 60:this._opCycles=3,this._instructionCallback=o.opDcp,s=!0;break;case 61:this._opCycles=0,this._instructionCallback=o.opLax,n=!0;break;case 63:this._opCycles=3,this._instructionCallback=o.opSlo,n=!(s=!0);break;case 64:this._opCycles=1,this._instructionCallback=o.opAax;break;case 65:this._opCycles=0,this._instructionCallback=o.opLar,n=!0;break;case 66:this._opCycles=3,this._instructionCallback=o.opIsc,s=!0;break;case 67:this._opCycles=0,this._instructionCallback=o.opAac;break;case 68:this._opCycles=0,this._instructionCallback=o.opAtx;break;case 69:s=!(n=!(this._opCycles=3)),this._instructionCallback=o.opRra;break;case 70:s=!(n=!(this._opCycles=3)),this._instructionCallback=o.opRla;break;default:return void(this._invalidInstructionCallback&&this._invalidInstructionCallback(this))}switch(this.state.p=this.state.p+1&65535,i){case 1:this._operand=this._bus.read(this.state.p),n=!1,this.state.p=this.state.p+1&65535,this._opCycles++;break;case 2:this._operand=this._bus.read(this.state.p),this.state.p=this.state.p+1&65535,this._opCycles++;break;case 3:this._operand=this._bus.readWord(this.state.p),this.state.p=this.state.p+2&65535,this._opCycles+=2;break;case 4:t=this._bus.readWord(this.state.p),this._operand=255==(255&t)?this._bus.read(t)+(this._bus.read(65280&t)<<8):this._bus.readWord(t),this.state.p=this.state.p+2&65535,this._opCycles+=4;break;case 5:t=128&(t=this._bus.read(this.state.p))?-(255&~(t-1)):t,this._operand=this.state.p+t+65537&65535,this.state.p=this.state.p+1&65535,this._opCycles+=(65280&this._operand)!=(65280&this.state.p)?3:2;break;case 6:e=this._bus.read(this.state.p),this._bus.read(e),this._operand=e+this.state.x&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 7:t=this._bus.readWord(this.state.p),this._operand=t+this.state.x&65535,(65280&this._operand)!=(65280&t)&&this._bus.read(65280&t|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&t)?3:2,this.state.p=this.state.p+2&65535;break;case 9:e=this._bus.read(this.state.p),this._bus.read(e),this._operand=e+this.state.y&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 10:t=this._bus.readWord(this.state.p),this._operand=t+this.state.y&65535,(65280&this._operand)!=(65280&t)&&this._bus.read(65280&t|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&t)?3:2,this.state.p=this.state.p+2&65535;break;case 8:e=this._bus.read(this.state.p),this._bus.read(e),t=e+this.state.x&255,this._operand=255===t?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(t),this._opCycles+=4,this.state.p=this.state.p+1&65535;break;case 11:t=255===(t=this._bus.read(this.state.p))?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(t),this._operand=t+this.state.y&65535,(65280&this._operand)!=(65280&t)&&this._bus.read(65280&t|255&this._operand),this._opCycles+=s||(65280&t)!=(65280&this._operand)?4:3,this.state.p=this.state.p+1&65535}(this._dereference=n)&&this._opCycles++,this.executionState=2},t.prototype._checkForInterrupts=function(){this._nmiPending&&(this.state.irq=!1,this.state.nmi=!0,this._nmiPending=!1),!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)},t}();r.default=l},{"./CpuInterface":25,"./Instruction":27,"./ops":29}],25:[function(t,e,r){"use strict";var i,n;Object.defineProperty(r,"__esModule",{value:!0}),n=function(){this.a=0,this.x=0,this.y=0,this.s=0,this.p=0,this.flags=0,this.irq=!1,this.nmi=!1},(i||(i={})).State=n,r.default=i},{}],26:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n,s=t("./StateMachineCpu"),a=t("./BatchedAccessCpu"),o=function(){function r(t){this._type=t}return r.prototype.create=function(t,e){switch(this._type){case r.Type.stateMachine:return new s.default(t,e);case r.Type.batchedAccess:return new a.default(t,e);default:throw new Error("invalid CPU type")}},r}();i=o||(o={}),(n=i.Type||(i.Type={}))[n.stateMachine=0]="stateMachine",n[n.batchedAccess=1]="batchedAccess",r.default=o},{"./BatchedAccessCpu":24,"./StateMachineCpu":28}],27:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n,o,s=function(){function t(t,e,r){void 0===r&&(r=e),this.operation=t,this.addressingMode=e,this.effectiveAddressingMode=r}return t.prototype.getSize=function(){switch(this.effectiveAddressingMode){case 1:case 2:case 6:case 9:case 8:case 11:case 5:return 2;case 3:case 7:case 10:case 4:return 3;default:return 1}},t}();r.default=s,i=s||(s={}),(n=i.OperationMap||(i.OperationMap={}))[n.adc=0]="adc",n[n.and=1]="and",n[n.asl=2]="asl",n[n.bcc=3]="bcc",n[n.bcs=4]="bcs",n[n.beq=5]="beq",n[n.bit=6]="bit",n[n.bmi=7]="bmi",n[n.bne=8]="bne",n[n.bpl=9]="bpl",n[n.brk=10]="brk",n[n.bvc=11]="bvc",n[n.bvs=12]="bvs",n[n.clc=13]="clc",n[n.cld=14]="cld",n[n.cli=15]="cli",n[n.clv=16]="clv",n[n.cmp=17]="cmp",n[n.cpx=18]="cpx",n[n.cpy=19]="cpy",n[n.dec=20]="dec",n[n.dex=21]="dex",n[n.dey=22]="dey",n[n.eor=23]="eor",n[n.inc=24]="inc",n[n.inx=25]="inx",n[n.iny=26]="iny",n[n.jmp=27]="jmp",n[n.jsr=28]="jsr",n[n.lda=29]="lda",n[n.ldx=30]="ldx",n[n.ldy=31]="ldy",n[n.lsr=32]="lsr",n[n.nop=33]="nop",n[n.ora=34]="ora",n[n.pha=35]="pha",n[n.php=36]="php",n[n.pla=37]="pla",n[n.plp=38]="plp",n[n.rol=39]="rol",n[n.ror=40]="ror",n[n.rti=41]="rti",n[n.rts=42]="rts",n[n.sbc=43]="sbc",n[n.sec=44]="sec",n[n.sed=45]="sed",n[n.sei=46]="sei",n[n.sta=47]="sta",n[n.stx=48]="stx",n[n.sty=49]="sty",n[n.tax=50]="tax",n[n.tay=51]="tay",n[n.tsx=52]="tsx",n[n.txa=53]="txa",n[n.txs=54]="txs",n[n.tya=55]="tya",n[n.dop=56]="dop",n[n.top=57]="top",n[n.alr=58]="alr",n[n.axs=59]="axs",n[n.dcp=60]="dcp",n[n.lax=61]="lax",n[n.arr=62]="arr",n[n.slo=63]="slo",n[n.aax=64]="aax",n[n.lar=65]="lar",n[n.isc=66]="isc",n[n.aac=67]="aac",n[n.atx=68]="atx",n[n.rra=69]="rra",n[n.rla=70]="rla",n[n.invalid=71]="invalid",i.opcodes=new Array(256),r.default=s,function(t){for(var e=0;e<256;e++)o.opcodes[e]=new o(71,12);var r,i,n;for(e=0;e<8;e++){switch(e){case 0:r=34;break;case 1:r=1;break;case 2:r=23;break;case 3:r=0;break;case 4:r=47;break;case 5:r=29;break;case 6:r=17;break;case 7:r=43}for(var s=0;s<8;s++){switch(s){case 0:i=8;break;case 1:i=2;break;case 2:i=1;break;case 3:i=3;break;case 4:i=11;break;case 5:i=6;break;case 6:i=10;break;case 7:i=7}47===r&&1===i&&(i=12),71!==r&&12!==i&&(n=e<<5|s<<2|1,o.opcodes[n]=new o(r,i))}}function a(t,e,r,i){if(71!==o.opcodes[t].operation)throw new Error("entry for opcode "+t+" already exists");o.opcodes[t]=new o(e,r,i)}a(6,2,2),a(10,2,0),a(14,2,3),a(22,2,6),a(30,2,7),a(38,39,2),a(42,39,0),a(46,39,3),a(54,39,6),a(62,39,7),a(70,32,2),a(74,32,0),a(78,32,3),a(86,32,6),a(94,32,7),a(102,40,2),a(106,40,0),a(110,40,3),a(118,40,6),a(126,40,7),a(134,48,2),a(142,48,3),a(150,48,9),a(162,30,1),a(166,30,2),a(174,30,3),a(182,30,9),a(190,30,10),a(198,20,2),a(206,20,3),a(214,20,6),a(222,20,7),a(230,24,2),a(238,24,3),a(246,24,6),a(254,24,7),a(36,6,2),a(44,6,3),a(76,27,3),a(108,27,4),a(132,49,2),a(140,49,3),a(148,49,6),a(160,31,1),a(164,31,2),a(172,31,3),a(180,31,6),a(188,31,7),a(192,19,1),a(196,19,2),a(204,19,3),a(224,18,1),a(228,18,2),a(236,18,3),a(16,9,5),a(48,7,5),a(80,11,5),a(112,12,5),a(144,3,5),a(176,4,5),a(208,8,5),a(240,5,5),a(0,10,0),a(32,28,0,3),a(64,41,0),a(96,42,0),a(8,36,0),a(40,38,0),a(72,35,0),a(104,37,0),a(136,22,0),a(168,51,0),a(200,26,0),a(232,25,0),a(24,13,0),a(56,44,0),a(88,15,0),a(120,46,0),a(152,55,0),a(184,16,0),a(216,14,0),a(248,45,0),a(138,53,0),a(154,54,0),a(170,50,0),a(186,52,0),a(202,21,0),a(234,33,0),a(26,33,0),a(58,33,0),a(90,33,0),a(122,33,0),a(218,33,0),a(250,33,0),a(4,56,2),a(20,56,6),a(52,56,6),a(68,56,2),a(84,56,6),a(100,56,2),a(116,56,6),a(128,56,1),a(130,56,1),a(137,56,1),a(194,56,1),a(212,56,6),a(226,56,1),a(244,56,6),a(12,57,3),a(28,57,7),a(60,57,7),a(92,57,7),a(124,57,7),a(220,57,7),a(252,57,7),a(235,43,1),a(75,58,1),a(203,59,1),a(199,60,2),a(215,60,6),a(207,60,3),a(223,60,7),a(219,60,10),a(195,60,8),a(211,60,11),a(167,61,2),a(183,61,9),a(175,61,3),a(191,61,10),a(163,61,8),a(179,61,11),a(107,62,1),a(7,63,2),a(23,63,6),a(15,63,3),a(31,63,7),a(27,63,10),a(3,63,8),a(19,63,11),a(135,64,2),a(151,64,9),a(131,64,8),a(143,64,3),a(187,65,10),a(231,66,2),a(247,66,6),a(239,66,3),a(255,66,7),a(251,66,10),a(227,66,8),a(243,66,11),a(11,67,1),a(43,67,1),a(171,68,1),a(103,69,2),a(119,69,6),a(111,69,3),a(127,69,7),a(123,69,10),a(99,69,8),a(115,69,11),a(39,70,2),a(55,70,6),a(47,70,3),a(63,70,7),a(59,70,10),a(35,70,8),a(51,70,11)}((o=s||(s={})).__init||(o.__init={})),r.default=s},{}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./CpuInterface"),s=t("./statemachine/vector"),a=t("./statemachine/Compiler"),i=function(){function t(t,e){this._bus=t,this._rng=e,this.executionState=0,this.state=new n.default.State,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._halt=!1,this._pollInterruptsAfterLastInstruction=!1,this._lastInstructionPointer=0,this._operations=new Array(255),this._opBoot=s.boot(this.state),this._opIrq=s.irq(this.state),this._opNmi=s.nmi(this.state);for(var r=new a.default(this.state),i=0;i<256;i++)this._operations[i]=r.compile(i);this.reset()}return t.prototype.reset=function(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._interruptPending=!1,this._nmiPending=!1,this._halt=!1,this._lastResult=this._opBoot.reset(void 0),this._lastInstructionPointer=0,this},t.prototype.setInterrupt=function(t){return this._interruptPending=t,this},t.prototype.isInterrupt=function(){return this._interruptPending},t.prototype.nmi=function(){return this._nmiPending=!0,this},t.prototype.halt=function(){return this._halt=!0,this},t.prototype.resume=function(){return this._halt=!1,this},t.prototype.isHalt=function(){return this._halt},t.prototype.setInvalidInstructionCallback=function(t){return this._invalidInstructionCallback=t,this},t.prototype.getInvalidInstructionCallback=function(){return this._invalidInstructionCallback},t.prototype.getLastInstructionPointer=function(){return this._lastInstructionPointer},t.prototype.cycle=function(){if(this._halt&&(!this._lastResult||0===this._lastResult.cycleType))return this;if(1===this.executionState)return this._fetch(),this;var t;switch(this._lastResult.cycleType){case 0:t=this._bus.read(this._lastResult.address);break;case 1:t=this._lastResult.value,this._bus.write(this._lastResult.address,t);break;default:throw new Error("invalid cycle type")}return this._lastResult.pollInterrupts&&(this._pollInterrupts(),this._lastResult.pollInterrupts=!1,this._pollInterruptsAfterLastInstruction=!1),this._lastResult=this._lastResult.nextStep(t),null===this._lastResult&&(this.executionState=1),this},t.prototype._fetch=function(){var t;this._pollInterruptsAfterLastInstruction&&this._pollInterrupts(),this._lastInstructionPointer=this.state.p;var e=this._bus.read(this.state.p);this.state.nmi?(t=this._opNmi,this._pollInterruptsAfterLastInstruction=!1):this.state.irq?(t=this._opIrq,this._pollInterruptsAfterLastInstruction=!1):(t=this._operations[e],this.state.p=this.state.p+1&65535,this._pollInterruptsAfterLastInstruction=!0),t?(this.executionState=2,this._lastResult=t.reset(void 0)):this._invalidInstructionCallback&&this._invalidInstructionCallback(this)},t.prototype._pollInterrupts=function(){if(this.state.irq=!1,this._nmiPending)return this.state.nmi=!0,void(this._nmiPending=!1);!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)},t}();r.default=i},{"./CpuInterface":25,"./statemachine/Compiler":30,"./statemachine/vector":54}],29:[function(t,e,r){"use strict";function i(t,e){t.s=t.s+1&255,t.flags=-17&(32|e.read(256+t.s))}function n(t,e){t.flags=-131&t.flags|128&e|(e?0:2)}function s(t,e,r){if(8&t.flags){var i=(15&r)+(15&t.a)+(1&t.flags),n=(r>>>4)+(t.a>>>4)+(9<i?1:0);t.a=i%10|n%10<<4,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|(9<n?1:0)}else{var s=t.a+r+(1&t.flags),a=255&s;t.flags=-196&t.flags|128&a|(a?0:2)|s>>>8|(~(r^t.a)&(a^r)&128)>>>1,t.a=a}}function a(t,e,r){t.a&=r,n(t,t.a)}function o(t,e,r){if(8&t.flags){var i=(15&t.a)-(15&r)-(1&~t.flags),n=(t.a>>>4)-(r>>>4)-(i<0?1:0);t.a=(i<0?10+i:i)|(n<0?10+n:n)<<4,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|(n<0?0:1)}else{r=255&~r;var s=t.a+r+(1&t.flags),a=255&s;t.flags=-196&t.flags|128&a|(a?0:2)|s>>>8|(~(r^t.a)&(a^r)&128)>>>1,t.a=a}}Object.defineProperty(r,"__esModule",{value:!0}),r.opAdc=s,r.opAnd=a,r.opAslAcc=function(t){var e=t.a;t.a=t.a<<1&255,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7},r.opAslMem=function(t,e,r){var i=e.read(r),n=i<<1&255;e.write(r,n),t.flags=-132&t.flags|128&n|(n?0:2)|i>>>7},r.opBit=function(t,e,r){t.flags=-195&t.flags|192&r|(r&t.a?0:2)},r.opBrk=function(t,e){var r=t.p+1&65535,i=65534;t.nmi&&(i=65530,t.nmi=!1),t.nmi=t.irq=!1,e.write(t.s+256,r>>>8&255),t.s=t.s+255&255,e.write(t.s+256,255&r),t.s=t.s+255&255,e.write(t.s+256,16|t.flags),t.s=t.s+255&255,t.flags|=4,t.p=e.readWord(i)},r.opClc=function(t){t.flags&=-2},r.opCld=function(t){t.flags&=-9},r.opCli=function(t){t.flags&=-5},r.opClv=function(t){t.flags&=-65},r.opCmp=function(t,e,r){var i=t.a+(255&~r)+1;t.flags=-132&t.flags|128&i|(255&i?0:2)|i>>>8},r.opCpx=function(t,e,r){var i=t.x+(255&~r)+1;t.flags=-132&t.flags|128&i|(255&i?0:2)|i>>>8},r.opCpy=function(t,e,r){var i=t.y+(255&~r)+1;t.flags=-132&t.flags|128&i|(255&i?0:2)|i>>>8},r.opDec=function(t,e,r){var i=e.read(r)+255&255;e.write(r,i),n(t,i)},r.opDex=function(t){t.x=t.x+255&255,n(t,t.x)},r.opEor=function(t,e,r){t.a=t.a^r,n(t,t.a)},r.opDey=function(t){t.y=t.y+255&255,n(t,t.y)},r.opInc=function(t,e,r){var i=e.read(r)+1&255;e.write(r,i),n(t,i)},r.opInx=function(t){t.x=t.x+1&255,n(t,t.x)},r.opIny=function(t){t.y=t.y+1&255,n(t,t.y)},r.opJmp=function(t,e,r){t.p=r},r.opJsr=function(t,e,r){var i=t.p+1&65535,n=e.read(t.p);e.read(256+t.s),e.write(256+t.s,i>>>8),t.s=t.s+255&255,e.write(256+t.s,255&i),t.s=t.s+255&255,t.p=n|e.read(t.p+1&65535)<<8},r.opLda=function(t,e,r,i){t.a=1===i?r:e.read(r),n(t,t.a)},r.opLdx=function(t,e,r,i){t.x=1===i?r:e.read(r),n(t,t.x)},r.opLdy=function(t,e,r,i){t.y=1===i?r:e.read(r),n(t,t.y)},r.opLsrAcc=function(t){var e=t.a;t.a=t.a>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e},r.opLsrMem=function(t,e,r){var i=e.read(r),n=i>>>1;e.write(r,n),t.flags=-132&t.flags|128&n|(n?0:2)|1&i},r.opNop=function(){},r.opOra=function(t,e,r){t.a|=r,n(t,t.a)},r.opPhp=function(t,e){e.write(256+t.s,16|t.flags),t.s=t.s+255&255},r.opPlp=function(t,e){i(t,e)},r.opPha=function(t,e){e.write(256+t.s,t.a),t.s=t.s+255&255},r.opPla=function(t,e){t.s=t.s+1&255,t.a=e.read(256+t.s),n(t,t.a)},r.opRolAcc=function(t){var e=t.a;t.a=t.a<<1&255|1&t.flags,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7},r.opRolMem=function(t,e,r){var i=e.read(r),n=i<<1&255|1&t.flags;e.write(r,n),t.flags=-132&t.flags|128&n|(n?0:2)|i>>>7},r.opRorAcc=function(t){var e=t.a;t.a=t.a>>>1|(1&t.flags)<<7,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e},r.opRorMem=function(t,e,r){var i=e.read(r),n=i>>>1|(1&t.flags)<<7;e.write(r,n),t.flags=-132&t.flags|128&n|(n?0:2)|1&i},r.opRti=function(t,e){var r;i(t,e),t.s=t.s+1&255,r=e.read(256+t.s),t.s=t.s+1&255,r|=e.read(256+t.s)<<8,t.p=r},r.opRts=function(t,e){var r;e.read(256+t.s),t.s=t.s+1&255,r=e.read(256+t.s),t.s=t.s+1&255,r+=e.read(256+t.s)<<8,t.p=r+1&65535},r.opSbc=o,r.opSec=function(t){t.flags|=1},r.opSed=function(t){t.flags|=8},r.opSei=function(t){t.flags|=4},r.opSta=function(t,e,r){e.write(r,t.a)},r.opStx=function(t,e,r){e.write(r,t.x)},r.opSty=function(t,e,r){e.write(r,t.y)},r.opTax=function(t){t.x=t.a,n(t,t.a)},r.opTay=function(t){t.y=t.a,n(t,t.a)},r.opTsx=function(t){t.x=t.s,n(t,t.x)},r.opTxa=function(t){t.a=t.x,n(t,t.a)},r.opTxs=function(t){t.s=t.x},r.opTya=function(t){t.a=t.y,n(t,t.a)},r.opAlr=function(t,e,r){var i=t.a&r;t.a=i>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&i},r.opAxs=function(t,e,r){var i=(t.a&t.x)+(255&~r)+1;t.x=255&i,t.flags=-132&t.flags|128&t.x|(255&t.x?0:2)|i>>>8},r.opDcp=function(t,e,r){var i=e.read(r)+255&255;e.write(r,i);var n=t.a+(255&~i)+1;t.flags=-132&t.flags|128&n|(255&n?0:2)|n>>>8},r.opLax=function(t,e,r){t.a=r,t.x=r,n(t,r)},r.opArr=function(t,e,r){t.a=(t.a&r)>>>1|(1&t.flags?128:0),t.flags=-196&t.flags|(64&t.a)>>>6|(t.a?0:2)|128&t.a|64&t.a^(32&t.a)<<1},r.opSlo=function(t,e,r){var i=e.read(r);t.flags=-2&t.flags|i>>>7,i=i<<1&255,e.write(r,i),t.a=t.a|i,n(t,t.a)},r.opAax=function(t,e,r){var i=t.x&t.a;e.write(r,i),n(t,i)},r.opLar=function(t,e,r){t.s=t.a=t.x=t.s&r,n(t,t.a)},r.opIsc=function(t,e,r){var i=e.read(r)+1&255;e.write(r,i),o(t,0,i)},r.opAac=function(t,e,r){t.a&=r,n(t,t.a),t.flags=-2&t.flags|(128&t.a)>>>7},r.opAtx=function(t,e,r){t.a&=r,t.x=t.a,n(t,t.a)},r.opRra=function(t,e,r){var i=e.read(r),n=i>>>1|(1&t.flags)<<7;e.write(r,n),t.flags=-2&t.flags|1&i,s(t,0,n)},r.opRla=function(t,e,r){var i=e.read(r),n=i<<1&255|1&t.flags;e.write(r,n),t.flags=-2&t.flags|i>>>7,a(t,0,n)}},{}],30:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../Instruction"),u=t("./addressing"),n=t("./instruction"),s=t("./ops"),c=t("./addressing/indirect"),a=t("./vector"),o=function(){function t(t){this._state=t}return t.prototype.compile=function(t){var e=i.default.opcodes[t];switch(e.operation){case 0:return this._createAddressing(e.addressingMode,s.adc,{deref:!0});case 1:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.a=e.a&t})},{deref:!0});case 2:return 0===e.addressingMode?n.nullaryOneCycle(this._state,s.aslImmediate):this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.aslRmw).reset,{writeOp:!0});case 6:return this._createAddressing(e.addressingMode,s.bit,{deref:!0});case 10:return a.brk(this._state);case 17:return this._createAddressing(e.addressingMode,function(t,e){return s.cmp(t,e,function(t){return t.a}),null},{deref:!0});case 18:return this._createAddressing(e.addressingMode,function(t,e){return s.cmp(t,e,function(t){return t.x}),null},{deref:!0});case 19:return this._createAddressing(e.addressingMode,function(t,e){return s.cmp(t,e,function(t){return t.y}),null},{deref:!0});case 20:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,function(t,e){return s.genRmw(t,e,function(t){return t-1&255})}).reset,{writeOp:!0});case 21:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.x=t.x-1&255})});case 22:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.y=t.y-1&255})});case 24:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,function(t,e){return s.genRmw(t,e,function(t){return t+1&255})}).reset,{writeOp:!0});case 25:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.x=t.x+1&255})});case 26:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.y=t.y+1&255})});case 23:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.a=e.a^t})},{deref:!0});case 27:return this._createAddressing(e.addressingMode,function(t,e){return e.p=t,null});case 28:return n.jsr(this._state);case 29:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.a=t})},{deref:!0});case 30:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.x=t})},{deref:!0});case 31:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.y=t})},{deref:!0});case 32:return 0===e.addressingMode?n.nullaryOneCycle(this._state,s.lsrImmediate):this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.lsrRmw).reset,{writeOp:!0});case 33:return n.nullaryOneCycle(this._state,function(){});case 34:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.a|=t})},{deref:!0});case 35:return n.push(this._state,function(t){return t.a});case 36:return n.push(this._state,function(t){return 16|t.flags});case 37:return n.pull(this._state,function(t,e){return s.genNullary(t,function(t){return t.a=e})});case 38:return n.pull(this._state,function(t,e){return t.flags=-17&(32|e)});case 39:return 0===e.addressingMode?n.nullaryOneCycle(this._state,s.rolImmediate):this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.rolRmw).reset,{writeOp:!0});case 40:return 0===e.addressingMode?n.nullaryOneCycle(this._state,s.rorImmediate):this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.rorRmw).reset,{writeOp:!0});case 41:return n.rti(this._state);case 42:return n.rts(this._state);case 43:return this._createAddressing(e.addressingMode,s.sbc,{deref:!0});case 48:return this._createAddressing(e.addressingMode,n.write(this._state,function(t){return t.x}).reset,{writeOp:!0});case 49:return this._createAddressing(e.addressingMode,n.write(this._state,function(t){return t.y}).reset,{writeOp:!0});case 50:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.x=t.a})});case 51:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.y=t.a})});case 52:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.x=t.s})});case 53:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.a=t.x})});case 54:return n.nullaryOneCycle(this._state,function(t){return t.s=t.x});case 55:return n.nullaryOneCycle(this._state,function(t){return s.genNullary(t,function(t){return t.a=t.y})});case 3:return n.branch(this._state,function(t){return 0==(1&t)});case 4:return n.branch(this._state,function(t){return 0<(1&t)});case 8:return n.branch(this._state,function(t){return 0==(2&t)});case 5:return n.branch(this._state,function(t){return 0<(2&t)});case 9:return n.branch(this._state,function(t){return 0==(128&t)});case 7:return n.branch(this._state,function(t){return 0<(128&t)});case 11:return n.branch(this._state,function(t){return 0==(64&t)});case 12:return n.branch(this._state,function(t){return 0<(64&t)});case 44:return n.nullaryOneCycle(this._state,function(t){return t.flags|=1});case 45:return n.nullaryOneCycle(this._state,function(t){return t.flags|=8});case 46:return n.nullaryOneCycle(this._state,function(t){return t.flags|=4});case 47:return this._createAddressing(e.addressingMode,n.write(this._state,function(t){return t.a}).reset,{writeOp:!0});case 13:return n.nullaryOneCycle(this._state,function(t){return t.flags&=-2});case 14:return n.nullaryOneCycle(this._state,function(t){return t.flags&=-9});case 15:return n.nullaryOneCycle(this._state,function(t){return t.flags&=-5});case 16:return n.nullaryOneCycle(this._state,function(t){return t.flags&=-65});case 56:case 57:return this._createAddressing(e.addressingMode,function(){return null},{deref:!0});case 67:return this._createAddressing(e.addressingMode,s.aac);case 64:return this._createAddressing(e.addressingMode,n.write(this._state,s.aax).reset,{writeOp:!0});case 58:return this._createAddressing(e.addressingMode,s.alr,{deref:!0});case 62:return this._createAddressing(e.addressingMode,function(t,e){return s.arr(t,e),null},{deref:!0});case 59:return this._createAddressing(e.addressingMode,s.axs,{deref:!0});case 68:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.x=e.a=e.a&t})},{deref:!0});case 60:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.dcp).reset,{writeOp:!0});case 66:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.isc).reset,{writeOp:!0});case 61:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.a=e.x=t})},{deref:!0});case 65:return this._createAddressing(e.addressingMode,function(t,e){return s.genUnary(t,e,function(t,e){return e.s=e.x=e.a=e.s&t})},{deref:!0});case 70:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.rla).reset,{writeOp:!0});case 69:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.rra).reset,{writeOp:!0});case 63:return this._createAddressing(e.addressingMode,n.readModifyWrite(this._state,s.slo).reset,{writeOp:!0});default:return null}},t.prototype._createAddressing=function(t,e,r){var i=void 0===r?{}:r,n=i.deref,s=void 0!==n&&n,a=i.writeOp,o=void 0!==a&&a;switch(s&&1!==t&&(e=u.dereference(this._state,e).reset),t){case 1:return u.immediate(this._state,e);case 2:return u.zeroPage(this._state,e);case 3:return u.absolute(this._state,e);case 6:return u.zeroPageX(this._state,e);case 9:return u.zeroPageY(this._state,e);case 7:return u.absoluteX(this._state,e,o);case 10:return u.absoluteY(this._state,e,o);case 8:return u.indexedIndirectX(this._state,e);case 11:return u.indirectIndexedY(this._state,e,o);case 4:return c.indirect(this._state,e);default:throw new Error("invalid addressing mode "+t)}},t}();r.default=o},{"../Instruction":27,"./addressing":36,"./addressing/indirect":38,"./instruction":43,"./ops":52,"./vector":54}],31:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(){this.cycleType=0,this.address=0,this.value=0,this.pollInterrupts=!1,this.nextStep=null}return t.prototype.read=function(t,e){return this.cycleType=0,this.address=e,this.nextStep=t,this},t.prototype.write=function(t,e,r){return this.cycleType=1,this.address=e,this.value=r,this.nextStep=t,this},t.prototype.poll=function(t){return this.pollInterrupts=t,this},t}();r.default=i},{}],32:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(){return r._result.read(r._fetchLo,r._state.p)},this._fetchLo=function(t){return r._operand=t,r._state.p=r._state.p+1&65535,r._result.read(r._fetchHi,r._state.p)},this._fetchHi=function(t){return r._operand|=t<<8,r._state.p=r._state.p+1&65535,r._next(r._operand,r._state)},this._operand=0,this._result=new n.default,this._state=t,this._next=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchLo",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchHi",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.absolute=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],33:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),s=t("../ResultImpl"),a=t("../../../../tools/decorators"),i=function(){function i(t,e,r,i){void 0===r&&(r=function(){return null}),void 0===i&&(i=!1);var n=this;this.reset=function(){return n._result.read(n._fetchLo,n._state.p)},this._fetchLo=function(t){return n._operand=t,n._state.p=n._state.p+1&65535,n._result.read(n._fetchHi,n._state.p)},this._fetchHi=function(t){n._operand|=t<<8,n._state.p=n._state.p+1&65535;var e=n._indexExtractor(n._state);return n._carry=255<(255&n._operand)+e,n._operand=65280&n._operand|n._operand+e&255,n._carry||n._writeOp?n._result.read(n._dereferenceAndCarry,n._operand):n._next(n._operand,n._state)},this._dereferenceAndCarry=function(t){return n._carry&&(n._operand=n._operand+256&65535),n._next(n._operand,n._state)},this._operand=0,this._carry=!1,this._result=new s.default,this._state=t,this._indexExtractor=e,this._next=r,this._writeOp=i,a.freezeImmutables(this)}return i.absoluteX=function(t,e,r){return new i(t,function(t){return t.x},e,r)},i.absoluteY=function(t,e,r){return new i(t,function(t){return t.y},e,r)},n.__decorate([a.Immutable],i.prototype,"reset",void 0),n.__decorate([a.Immutable],i.prototype,"_fetchLo",void 0),n.__decorate([a.Immutable],i.prototype,"_fetchHi",void 0),n.__decorate([a.Immutable],i.prototype,"_dereferenceAndCarry",void 0),n.__decorate([a.Immutable],i.prototype,"_result",void 0),n.__decorate([a.Immutable],i.prototype,"_state",void 0),n.__decorate([a.Immutable],i.prototype,"_indexExtractor",void 0),n.__decorate([a.Immutable],i.prototype,"_next",void 0),n.__decorate([a.Immutable],i.prototype,"_writeOp",void 0),n.__decorate([a.Immutable],i,"absoluteX",null),n.__decorate([a.Immutable],i,"absoluteY",null),i}();r.absoluteX=function(t,e,r){return i.absoluteX(t,e,r)},r.absoluteY=function(t,e,r){return i.absoluteY(t,e,r)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],34:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(t){return r._result.read(r._dereference,t)},this._dereference=function(t){return r._next(t,r._state)},this._result=new n.default,this._next=e,this._state=t,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_dereference",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.dereference=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],35:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(){return r._result.read(r._fetchOperand,r._state.p)},this._fetchOperand=function(t){return r._operand=t,r._state.p=r._state.p+1&65535,r._next(r._operand,r._state)},this._operand=0,this._result=new n.default,this._state=t,this._next=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchOperand",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.immediate=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],36:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./absolute");r.absolute=i.absolute;var n=t("./absoluteIndexed");r.absoluteX=n.absoluteX,r.absoluteY=n.absoluteY;var s=t("./dereference");r.dereference=s.dereference;var a=t("./immediate");r.immediate=a.immediate;var o=t("./indexedIndirectX");r.indexedIndirectX=o.indexedIndirectX;var u=t("./indirectIndexedY");r.indirectIndexedY=u.indirectIndexedY;var c=t("./zeroPage");r.zeroPage=c.zeroPage;var l=t("./zeroPageIndexed");r.zeroPageX=l.zeroPageX,r.zeroPageY=l.zeroPageY},{"./absolute":32,"./absoluteIndexed":33,"./dereference":34,"./immediate":35,"./indexedIndirectX":37,"./indirectIndexedY":39,"./zeroPage":40,"./zeroPageIndexed":41}],37:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(){return r._result.read(r._fetchAddress,r._state.p)},this._fetchAddress=function(t){return r._address=t,r._state.p=r._state.p+1&65535,r._result.read(r._addIndex,r._address)},this._addIndex=function(t){return r._address=r._address+r._state.x&255,r._result.read(r._fetchLo,r._address)},this._fetchLo=function(t){return r._operand=t,r._address=r._address+1&255,r._result.read(r._fetchHi,r._address)},this._fetchHi=function(t){return r._operand|=t<<8,r._next(r._operand,r._state)},this._operand=0,this._address=0,this._result=new n.default,this._state=t,this._next=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchAddress",void 0),i.__decorate([s.Immutable],t.prototype,"_addIndex",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchLo",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchHi",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.indexedIndirectX=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],38:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(){return r._result.read(r._fetchAddressLo,r._state.p)},this._fetchAddressLo=function(t){return r._address=t,r._state.p=r._state.p+1&65535,r._result.read(r._fetchAddressHi,r._state.p)},this._fetchAddressHi=function(t){return r._address|=t<<8,r._state.p=r._state.p+1&65535,r._result.read(r._fetchLo,r._address)},this._fetchLo=function(t){return r._operand=t,255==(255&r._address)?r._address&=65280:r._address=r._address+1&65535,r._result.read(r._fetchHi,r._address)},this._fetchHi=function(t){return r._operand|=t<<8,r._next(r._operand,r._state)},this._operand=0,this._address=0,this._result=new n.default,this._state=t,this._next=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchAddressLo",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchAddressHi",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchLo",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchHi",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.indirect=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],39:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e,r){void 0===e&&(e=function(){return null});var i=this;this.reset=function(){return i._result.read(i._fetchAddress,i._state.p)},this._fetchAddress=function(t){return i._address=t,i._state.p=i._state.p+1&65535,i._result.read(i._fetchLo,i._address)},this._fetchLo=function(t){return i._operand=t,i._address=i._address+1&255,i._result.read(i._fetchHi,i._address)},this._fetchHi=function(t){return i._operand|=t<<8,i._carry=255<(255&i._operand)+i._state.y,i._operand=65280&i._operand|i._operand+i._state.y&255,i._carry||i._writeOp?i._result.read(i._dereferenceAndCarry,i._operand):i._next(i._operand,i._state)},this._dereferenceAndCarry=function(t){return i._carry&&(i._operand=i._operand+256&65535),i._next(i._operand,i._state)},this._operand=0,this._address=0,this._carry=!1,this._result=new n.default,this._state=t,this._next=e,this._writeOp=r,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchAddress",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchLo",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchHi",void 0),i.__decorate([s.Immutable],t.prototype,"_dereferenceAndCarry",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),i.__decorate([s.Immutable],t.prototype,"_writeOp",void 0),t}();r.indirectIndexedY=function(t,e,r){return new a(t,e,r)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],40:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){void 0===e&&(e=function(){return null});var r=this;this.reset=function(){return r._result.read(r._fetchAddress,r._state.p)},this._fetchAddress=function(t){return r._operand=t,r._state.p=r._state.p+1&65535,r._next(r._operand,r._state)},this._operand=0,this._result=new n.default,this._state=t,this._next=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchAddress",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_next",void 0),t}();r.zeroPage=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],41:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function r(t,e,r){var i=this;this.reset=function(){return i._result.read(i._fetchAddress,i._state.p)},this._fetchAddress=function(t){return i._operand=t,i._state.p=i._state.p+1&65535,i._result.read(i._addIndex,i._operand)},this._addIndex=function(t){return i._operand=i._operand+i._indexExtractor(i._state)&255,i._next(i._operand,i._state)},this._operand=0,this._result=new n.default,this._state=t,this._indexExtractor=e,this._next=r,s.freezeImmutables(this)}return r.zeroPageX=function(t,e){return void 0===e&&(e=function(){return null}),new r(t,function(t){return t.x},e)},r.zeroPageY=function(t,e){return void 0===e&&(e=function(){return null}),new r(t,function(t){return t.y},e)},i.__decorate([s.Immutable],r.prototype,"reset",void 0),i.__decorate([s.Immutable],r.prototype,"_fetchAddress",void 0),i.__decorate([s.Immutable],r.prototype,"_addIndex",void 0),i.__decorate([s.Immutable],r.prototype,"_result",void 0),i.__decorate([s.Immutable],r.prototype,"_state",void 0),i.__decorate([s.Immutable],r.prototype,"_next",void 0),i.__decorate([s.Immutable],r.prototype,"_indexExtractor",void 0),r}();r.zeroPageX=function(t,e){return a.zeroPageX(t,e)},r.zeroPageY=function(t,e){return a.zeroPageY(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],42:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){var r=this;this.reset=function(){return r._result.read(r._fetchTarget,r._state.p).poll(!0)},this._fetchTarget=function(t){return r._operand=t,r._state.p=r._state.p+1&65535,r._predicate(r._state.flags)?r._result.read(r._firstDummyRead,r._state.p):null},this._firstDummyRead=function(t){return r._target=r._state.p+(128&r._operand?r._operand-256:r._operand)&65535,(65280&r._target)==(65280&r._state.p)?(r._state.p=r._target,null):r._result.read(r._secondDummyRead,65280&r._state.p|255&r._target).poll(!0)},this._secondDummyRead=function(t){return r._state.p=r._target,null},this._target=0,this._operand=0,this._result=new n.default,this._state=t,this._predicate=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchTarget",void 0),i.__decorate([s.Immutable],t.prototype,"_firstDummyRead",void 0),i.__decorate([s.Immutable],t.prototype,"_secondDummyRead",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_predicate",void 0),t}();r.branch=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],43:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./branch");r.branch=i.branch;var n=t("./jsr");r.jsr=n.jsr;var s=t("./readModifyWrite");r.readModifyWrite=s.readModifyWrite;var a=t("./rts");r.rts=a.rts;var o=t("./nullaryOneCycle");r.nullaryOneCycle=o.nullaryOneCycle;var u=t("./pull");r.pull=u.pull;var c=t("./push");r.push=c.push;var l=t("./rti");r.rti=l.rti;var h=t("./write");r.write=h.write},{"./branch":42,"./jsr":44,"./nullaryOneCycle":45,"./pull":46,"./push":47,"./readModifyWrite":48,"./rti":49,"./rts":50,"./write":51}],44:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t){var e=this;this.reset=function(){return e._result.read(e._fetchPcl,e._state.p)},this._fetchPcl=function(t){return e._addressLo=t,e._state.p=e._state.p+1&65535,e._result.read(e._dummyStackRead,256+e._state.s)},this._dummyStackRead=function(){return e._result.write(e._pushPch,256+e._state.s,e._state.p>>>8)},this._pushPch=function(){return e._state.s=e._state.s-1&255,e._result.write(e._pushPcl,256+e._state.s,255&e._state.p)},this._pushPcl=function(){return e._state.s=e._state.s-1&255,e._result.read(e._fetchPch,e._state.p)},this._fetchPch=function(t){return e._state.p=e._addressLo|t<<8,null},this._addressLo=0,this._result=new n.default,this._state=t,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"_fetchPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyStackRead",void 0),i.__decorate([s.Immutable],t.prototype,"_pushPch",void 0),i.__decorate([s.Immutable],t.prototype,"_pushPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchPch",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),t}();r.jsr=function(t){return new a(t)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],45:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){var r=this;this.reset=function(){return r._result.read(r._executeOperation,r._state.p).poll(!0)},this._executeOperation=function(){return r._operation(r._state),null},this._result=new n.default,this._state=t,this._operation=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_executeOperation",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_operation",void 0),t}();r.nullaryOneCycle=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],46:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../../../../tools/decorators"),s=t("../ResultImpl"),a=function(){function t(t,e){var r=this;this.reset=function(){return r._result.read(r._dummyRead,r._state.p).poll(!0)},this._dummyRead=function(){return r._result.read(r._incrementS,256+r._state.s)},this._incrementS=function(){return r._state.s=r._state.s+1&255,r._result.read(r._pull,256+r._state.s)},this._pull=function(t){return r._operation(r._state,t),null},this._result=new s.default,this._state=t,this._operation=e,n.freezeImmutables(this)}return i.__decorate([n.Immutable],t.prototype,"reset",void 0),i.__decorate([n.Immutable],t.prototype,"_dummyRead",void 0),i.__decorate([n.Immutable],t.prototype,"_incrementS",void 0),i.__decorate([n.Immutable],t.prototype,"_pull",void 0),i.__decorate([n.Immutable],t.prototype,"_result",void 0),i.__decorate([n.Immutable],t.prototype,"_state",void 0),i.__decorate([n.Immutable],t.prototype,"_operation",void 0),t}();r.pull=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],47:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../../../../tools/decorators"),s=t("../ResultImpl"),a=function(){function t(t,e){var r=this;this.reset=function(){return r._result.read(r._dummyRead,r._state.p)},this._dummyRead=function(){return r._result.write(r._push,256+r._state.s,r._operation(r._state))},this._push=function(){return r._state.s=r._state.s-1&255,null},this._result=new s.default,this._state=t,this._operation=e,n.freezeImmutables(this)}return i.__decorate([n.Immutable],t.prototype,"reset",void 0),i.__decorate([n.Immutable],t.prototype,"_dummyRead",void 0),i.__decorate([n.Immutable],t.prototype,"_push",void 0),i.__decorate([n.Immutable],t.prototype,"_result",void 0),i.__decorate([n.Immutable],t.prototype,"_state",void 0),i.__decorate([n.Immutable],t.prototype,"_operation",void 0),t}();r.push=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],48:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){var r=this;this.reset=function(t){return r._address=t,r._result.read(r._read,t)},this._read=function(t){return r._operand=t,r._result.write(r._dummyWrite,r._address,r._operand)},this._dummyWrite=function(t){return r._result.write(r._write,r._address,r._operation(r._operand,r._state))},this._write=function(){return null},this._result=new n.default,this._state=t,this._operation=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_read",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyWrite",void 0),i.__decorate([s.Immutable],t.prototype,"_write",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_operation",void 0),t}();r.readModifyWrite=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],49:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t){var e=this;this.reset=function(){return e._result.read(e._dummyOperandRead,e._state.p)},this._dummyOperandRead=function(){return e._result.read(e._dummyStackRead,256+e._state.s)},this._dummyStackRead=function(){return e._state.s=e._state.s+1&255,e._result.read(e._popP,256+e._state.s)},this._popP=function(t){return e._state.flags=-17&(32|t),e._state.s=e._state.s+1&255,e._result.read(e._popPcl,256+e._state.s)},this._popPcl=function(t){return e._state.p=65280&e._state.p|t,e._state.s=e._state.s+1&255,e._result.read(e._popPch,256+e._state.s)},this._popPch=function(t){return e._state.p=255&e._state.p|t<<8,null},this._result=new n.default,this._state=t,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyOperandRead",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyStackRead",void 0),i.__decorate([s.Immutable],t.prototype,"_popP",void 0),i.__decorate([s.Immutable],t.prototype,"_popPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_popPch",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),t}();r.rti=function(t){return new a(t)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],50:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t){var e=this;this.reset=function(){return e._result.read(e._dummyOperandRead,e._state.p)},this._dummyOperandRead=function(){return e._result.read(e._dummyStackRead,256+e._state.s)},this._dummyStackRead=function(){return e._state.s=e._state.s+1&255,e._result.read(e._popPcl,256+e._state.s)},this._popPcl=function(t){return e._state.p=65280&e._state.p|t,e._state.s=e._state.s+1&255,e._result.read(e._popPch,256+e._state.s)},this._popPch=function(t){return e._state.p=255&e._state.p|t<<8,e._result.read(e._incrementP,e._state.p)},this._incrementP=function(){return e._state.p=e._state.p+1&65535,null},this._result=new n.default,this._state=t,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyOperandRead",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyStackRead",void 0),i.__decorate([s.Immutable],t.prototype,"_popPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_popPch",void 0),i.__decorate([s.Immutable],t.prototype,"_incrementP",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),t}();r.rts=function(t){return new a(t)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],51:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e){var r=this;this.reset=function(t){return r._result.write(function(){return null},t,r._operation(r._state))},this._result=new n.default,this._state=t,this._operation=e,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_operation",void 0),t}();r.write=function(t,e){return new a(t,e)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],52:[function(t,e,r){"use strict";function n(t,e){e.flags=-131&e.flags|128&t|(t?0:2)}function i(t,e){if(8&e.flags){var r=(15&t)+(15&e.a)+(1&e.flags),i=(t>>>4)+(e.a>>>4)+(9<r?1:0);e.a=r%10|i%10<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(9<i?1:0)}else{var n=e.a+t+(1&e.flags),s=255&n;e.flags=-196&e.flags|128&s|(s?0:2)|n>>>8|(~(t^e.a)&(s^t)&128)>>>1,e.a=s}return null}function s(t,e){if(8&e.flags){var r=(15&e.a)-(15&t)-(1&~e.flags),i=(e.a>>>4)-(t>>>4)-(r<0?1:0);e.a=(r<0?10+r:r)|(i<0?10+i:i)<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(i<0?0:1)}else{t=255&~t;var n=e.a+t+(1&e.flags),s=255&n;e.flags=-196&e.flags|128&s|(s?0:2)|n>>>8|(~(t^e.a)&(s^t)&128)>>>1,e.a=s}return null}Object.defineProperty(r,"__esModule",{value:!0}),r.genRmw=function(t,e,r){var i=r(t);return n(i,e),i},r.genNullary=function(t,e){n(e(t),t)},r.genUnary=function(t,e,r){return n(r(t,e),e),null},r.adc=i,r.aslImmediate=function(t){var e=t.a;t.a=t.a<<1&255,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7},r.aslRmw=function(t,e){var r=t<<1&255;return e.flags=-132&e.flags|128&r|(r?0:2)|t>>>7,r},r.bit=function(t,e){return e.flags=-195&e.flags|192&t|(t&e.a?0:2),null},r.cmp=function(t,e,r){var i=r(e)+(255&~t)+1;e.flags=-132&e.flags|128&i|(255&i?0:2)|i>>>8},r.sbc=s,r.lsrImmediate=function(t){var e=t.a;t.a=t.a>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e},r.lsrRmw=function(t,e){var r=t>>>1;return e.flags=-132&e.flags|128&r|(r?0:2)|1&t,r},r.rolImmediate=function(t){var e=t.a;t.a=t.a<<1&255|1&t.flags,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7},r.rolRmw=function(t,e){var r=t<<1&255|1&e.flags;return e.flags=-132&e.flags|128&r|(r?0:2)|t>>>7,r},r.rorImmediate=function(t){var e=t.a;t.a=t.a>>>1|(1&t.flags)<<7,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e},r.rorRmw=function(t,e){var r=t>>>1|(1&e.flags)<<7;return e.flags=-132&e.flags|128&r|(r?0:2)|1&t,r},r.arr=function(t,e){e.a=(e.a&t)>>>1|(1&e.flags?128:0),e.flags=-196&e.flags|(64&e.a)>>>6|(e.a?0:2)|128&e.a|64&e.a^(32&e.a)<<1},r.alr=function(t,e){var r=e.a&t;return e.a=r>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&r,null},r.dcp=function(t,e){var r=t+255&255,i=e.a+(255&~r)+1;return e.flags=-132&e.flags|128&i|(255&i?0:2)|i>>>8,r},r.axs=function(t,e){var r=(e.a&e.x)+(255&~t)+1;return e.x=255&r,e.flags=-132&e.flags|128&e.x|(255&e.x?0:2)|r>>>8,null},r.rra=function(t,e){var r=t>>>1|(1&e.flags)<<7;return e.flags=-2&e.flags|1&t,i(r,e),r},r.rla=function(t,e){var r=t<<1&255|1&e.flags;return e.flags=-2&e.flags|t>>>7,n(e.a&=r,e),r},r.slo=function(t,e){e.flags=-2&e.flags|t>>>7;var r=t<<1&255;return e.a=e.a|r,n(e.a,e),r},r.aax=function(t){var e=t.a&t.x;return n(e,t),e},r.isc=function(t,e){var r=t+1&255;return s(r,e),r},r.aac=function(t,e){return e.a&=t,n(e.a,e),e.flags=-2&e.flags|(128&e.a)>>>7,null}},{}],53:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t){var e=this;this.reset=function(){return e._result.read(e._pre1Step,255)},this._pre1Step=function(){return e._result.read(e._pre2Step,255)},this._pre2Step=function(){return e._result.read(e._stack1Step,256)},this._stack1Step=function(){return e._result.read(e._stack2Step,511)},this._stack2Step=function(){return e._state.s=253,e._result.read(e._stack3Step,510)},this._stack3Step=function(){return e._result.read(e._readTargetLoStep,65532)},this._readTargetLoStep=function(t){return e._targetAddress=t,e._result.read(e._readTargetHiStep,65533)},this._readTargetHiStep=function(t){return e._targetAddress|=t<<8,e._state.p=e._targetAddress,null},this._targetAddress=0,this._result=new n.default,this._state=t,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_pre1Step",void 0),i.__decorate([s.Immutable],t.prototype,"_pre2Step",void 0),i.__decorate([s.Immutable],t.prototype,"_stack1Step",void 0),i.__decorate([s.Immutable],t.prototype,"_stack2Step",void 0),i.__decorate([s.Immutable],t.prototype,"_stack3Step",void 0),i.__decorate([s.Immutable],t.prototype,"_readTargetLoStep",void 0),i.__decorate([s.Immutable],t.prototype,"_readTargetHiStep",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),t}();r.boot=function(t){return new a(t)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],54:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./boot");r.boot=i.boot;var n=t("./interrupt");r.brk=n.brk,r.nmi=n.nmi,r.irq=n.irq},{"./boot":53,"./interrupt":55}],55:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("../ResultImpl"),s=t("../../../../tools/decorators"),a=function(){function t(t,e,r){var i=this;this.reset=function(){return i._result.read(i._dummyRead,i._state.p)},this._dummyRead=function(){return i._isBrk&&(i._state.p=i._state.p+1&65535),i._result.write(i._pushPch,256+i._state.s,i._state.p>>>8)},this._pushPch=function(){return i._state.s=i._state.s-1&255,i._result.write(i._pushPcl,256+i._state.s,255&i._state.p).poll(!0)},this._pushPcl=function(){return i._state.s=i._state.s-1&255,i._vector=i._state.nmi?65530:i._defaultVector,i._result.write(i._pushFlags,256+i._state.s,i._isBrk?16|i._state.flags:-17&i._state.flags)},this._pushFlags=function(){return i._state.s=i._state.s-1&255,i._result.read(i._fetchPcl,i._vector)},this._fetchPcl=function(t){return i._state.flags|=4,i._state.p=t,i._result.read(i._fetchPch,++i._vector)},this._fetchPch=function(t){return i._state.p=i._state.p|t<<8,i._state.nmi=i._state.irq=!1,null},this._vector=0,this._result=new n.default,this._state=t,this._defaultVector=e,this._isBrk=r,s.freezeImmutables(this)}return i.__decorate([s.Immutable],t.prototype,"reset",void 0),i.__decorate([s.Immutable],t.prototype,"_dummyRead",void 0),i.__decorate([s.Immutable],t.prototype,"_pushPch",void 0),i.__decorate([s.Immutable],t.prototype,"_pushPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_pushFlags",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchPcl",void 0),i.__decorate([s.Immutable],t.prototype,"_fetchPch",void 0),i.__decorate([s.Immutable],t.prototype,"_result",void 0),i.__decorate([s.Immutable],t.prototype,"_state",void 0),i.__decorate([s.Immutable],t.prototype,"_defaultVector",void 0),i.__decorate([s.Immutable],t.prototype,"_isBrk",void 0),t}();r.brk=function(t){return new a(t,65534,!0)},r.irq=function(t){return new a(t,65534,!1)},r.nmi=function(t){return new a(t,65530,!1)}},{"../../../../tools/decorators":111,"../ResultImpl":31,tslib:20}],56:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./Switch"),n=function(){function t(){this._left=new i.default,this._right=new i.default,this._up=new i.default,this._down=new i.default,this._fire=new i.default}return t.prototype.getLeft=function(){return this._left},t.prototype.getRight=function(){return this._right},t.prototype.getUp=function(){return this._up},t.prototype.getDown=function(){return this._down},t.prototype.getFire=function(){return this._fire},t}();r.default=n},{"./Switch":58}],57:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=t("./Switch"),s=function(){function t(){this.valueChanged=new i.Event,this._fireSwitch=new n.default,this._value=.5}return t.prototype.setValue=function(t){this._value=t,this.valueChanged.dispatch(t)},t.prototype.getValue=function(){return this._value},t.prototype.getFire=function(){return this._fireSwitch},t}();r.default=s},{"./Switch":58,"microevent.ts":6}],58:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=function(){function t(t){void 0===t&&(t=!1),this._state=t,this.stateChanged=new i.Event,this.beforeRead=new i.Event}return t.prototype.read=function(){return this.beforeRead.dispatch(this),this._state},t.prototype.peek=function(){return this._state},t.prototype.toggle=function(t){this._state!==t&&(this._state=t,this.stateChanged.dispatch(t))},t}();r.default=n},{"microevent.ts":6}],59:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=t("microevent.ts"),i=t("../board/BoardInterface"),f=t("./Bus"),p=t("./Pia"),m=t("./tia/Tia"),g=t("./Config"),b=t("./ControlPanel"),y=t("../io/DigitalJoystick"),v=t("../io/Paddle"),k=t("../../tools/rng/factory"),w=t("../cpu/Factory"),n=function(){function e(r,t,e){var i=this;this._config=r,this.trap=new d.Event,this.clock=new d.Event,this.cpuClock=new d.Event,this._clockMode=1,this._cpuCycles=0,this._trap=!1,this._audioEnabled=!0,this._suspended=!0,this._subClock=0,this._clockHz=0,this._sliceSize=0,this._timer={tick:function(t){return i._tick(t)},start:function(t){return i._start(t)},stop:function(){return i._stop()},isRunning:function(){return!!i._runTask}},this._rng=k.createRng(r.randomSeed<0?Math.random():r.randomSeed),t.randomize(this._rng);var n=new f.default;void 0===e&&(e=function(t,e){return new w.default(r.cpuType).create(t,e)});for(var s=new b.default,a=new y.default,o=new y.default,u=new Array(4),c=0;c<4;c++)u[c]=new v.default;var l=e(n,this._rng),h=new p.default(s,a,o,this._rng),_=new m.default(r,a,o,u);l.setInvalidInstructionCallback(function(){return i._onInvalidInstruction()}),_.setCpu(l).setBus(n).setCpuTimeProvider(function(){return i.getCpuTime()}),t.setCpu(l).setBus(n).setCpuTimeProvider(function(){return i.getCpuTime()}).setRng(this._rng),h.setBus(n),n.setTia(_).setPia(h).setCartridge(t),this._bus=n,this._cpu=l,this._tia=_,this._pia=h,this._cartridge=t,this._controlPanel=s,this._joystick0=a,this._joystick1=o,this._paddles=u,this._bus.event.trap.addHandler(function(t){return i.triggerTrap(1,t.message)}),this._clockHz=g.default.getClockHz(r),this._sliceSize=228*(0===r.tvMode?262:312),this.reset()}return e.prototype.getCpu=function(){return this._cpu},e.prototype.getBus=function(){return this._bus},e.prototype.getVideoOutput=function(){return this._tia},e.prototype.getWaveformChannels=function(){var e=this;return[0,1].map(function(t){return e._tia.getWaveformChannel(t)})},e.prototype.getPCMChannel=function(){return this._tia.getPCMChannel()},e.prototype.getTimer=function(){return this._timer},e.prototype.getConfig=function(){return this._config},e.prototype.reset=function(){return this._cpu.reset(),this._tia.reset(),this._pia.reset(),this._cartridge.reset(),this._controlPanel.getResetButton().toggle(!1),this._controlPanel.getSelectSwitch().toggle(!1),this._controlPanel.getColorSwitch().toggle(!1),this._controlPanel.getDifficultySwitchP0().toggle(!0),this._controlPanel.getDifficultySwitchP1().toggle(!0),this._subClock=0,this._cpuCycles=0,this},e.prototype.boot=function(){var t=0,e=0;if(this.reset(),0!==this._cpu.executionState)throw new Error("Already booted!");for(;1!==this._cpu.executionState;)this._cycle(),t++,0===this._subClock&&e++;return this.cpuClock.dispatch(e),this.clock.dispatch(t),this},e.prototype.suspend=function(){this._suspended=!0,this._updateAudioState()},e.prototype.resume=function(){this._suspended=!1,this._updateAudioState()},e.prototype.setAudioEnabled=function(t){this._audioEnabled=t,this._updateAudioState()},e.prototype.triggerTrap=function(t,e){if(this._stop(),this._trap=!0,!this.trap.hasHandlers)throw new Error(e);return this.trap.dispatch(new i.default.TrapPayload(t,this,e)),this},e.prototype.getControlPanel=function(){return this._controlPanel},e.prototype.getJoystick0=function(){return this._joystick0},e.prototype.getJoystick1=function(){return this._joystick1},e.prototype.getBoardStateDebug=function(){var t="============";return"TIA:\n"+t+"\n"+this._tia.getDebugState()+"\n\nPIA:\n"+t+"\n"+this._pia.getDebugState()+"\n"},e.prototype.setClockMode=function(t){return this._clockMode=t,this},e.prototype.getClockMode=function(){return this._clockMode},e.prototype.getPaddle=function(t){return this._paddles[t]},e.prototype.getCpuTime=function(){return this._cpuCycles/g.default.getClockHz(this._config)*3},e._executeSlice=function(t,e){var r=e?Math.round(e*t._clockHz/1e3):t._sliceSize;return t._tick(r)/t._clockHz*1e3},e.prototype._updateAudioState=function(){this._tia.setAudioEnabled(this._audioEnabled&&!this._suspended)},e.prototype._cycle=function(){this._tia.cycle(),2<=this._subClock++&&(this._pia.cycle(),this._cpu.cycle(),this._subClock=0)},e.prototype._tick=function(t){var e=0,r=0,i=0,n=this._cpu.executionState;for(this._trap=!1;e++<t&&!this._trap;)this._cycle(),r++,0===this._subClock&&(i++,this._cpuCycles++),n!==this._cpu.executionState&&(n=this._cpu.executionState,1===this._cpu.executionState&&(this._cartridge.notifyCpuCycleComplete(),0===this._clockMode&&0<i&&this.cpuClock.hasHandlers&&(this.cpuClock.dispatch(i),i=0)));return 0<i&&this.cpuClock.hasHandlers&&this.cpuClock.dispatch(i),0<r&&this.clock.hasHandlers&&this.clock.dispatch(r),r},e.prototype._start=function(t){this._runTask||(this._runTask=t.start(e._executeSlice,this,1e3/(0===this._config.tvMode?60:50)))},e.prototype._stop=function(){this._runTask&&(this._runTask.stop(),this._runTask=void 0)},e.prototype._onInvalidInstruction=function(){this.triggerTrap(0,"invalid instruction")},e}();r.default=n},{"../../tools/rng/factory":118,"../board/BoardInterface":23,"../cpu/Factory":26,"../io/DigitalJoystick":56,"../io/Paddle":57,"./Bus":60,"./Config":61,"./ControlPanel":62,"./Pia":63,"./tia/Tia":103,"microevent.ts":6}],60:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n=t("microevent.ts"),s=function(){function r(){this.event={trap:new n.Event,read:new n.Event,write:new n.Event},this._tia=null,this._pia=null,this._cartridge=null,this._lastDataBusValue=0,this._lastAddressBusValue=0}return r.prototype.setTia=function(t){var e=this;return t.trap.addHandler(function(t){return e.triggerTrap(0,"TIA: "+(t.message||""))}),this._tia=t,this},r.prototype.setPia=function(t){var e=this;return t.trap.addHandler(function(t){return e.triggerTrap(1,"PIA: "+(t.message||""))}),this._pia=t,this},r.prototype.setCartridge=function(t){var e=this;return t.trap.addHandler(function(t){return e.triggerTrap(2,"CARTRIDGE: "+(t.message||""))}),this._cartridge=t,this},r.prototype.readWord=function(t){return this.read(t)|this.read(t+1&65535)<<8},r.prototype.read=function(t){return this._lastAddressBusValue=t,4096&(t&=8191)?(this._lastDataBusValue=this._cartridge.read(t),this.event.read.dispatch(2)):128&t?(this._lastDataBusValue=this._pia.read(t),this.event.read.dispatch(1)):(this._lastDataBusValue=this._tia.read(t),this.event.read.dispatch(0)),this._lastDataBusValue},r.prototype.write=function(t,e){this._lastDataBusValue=e,this._lastAddressBusValue=t,4096&(t&=8191)?(this._cartridge.write(t,e),this.event.write.dispatch(2)):128&t?(this._pia.write(t,e),this.event.write.dispatch(1)):(this._tia.write(t,e),this.event.write.dispatch(0))},r.prototype.peek=function(t){return 4096&(t&=8191)?this._cartridge.peek(t):128&t?this._pia.peek(t):this._tia.peek(t)},r.prototype.poke=function(t,e){},r.prototype.getLastDataBusValue=function(){return this._lastDataBusValue},r.prototype.getLastAddresBusValue=function(){return this._lastAddressBusValue},r.prototype.triggerTrap=function(t,e){if(!this.event.trap.hasHandlers)throw new Error(e);this.event.trap.dispatch(new r.TrapPayload(t,this,e))},r}();r.default=s,i=function(t,e,r){this.reason=t,this.bus=e,this.message=r},(s||(s={})).TrapPayload=i,r.default=s},{"microevent.ts":6}],61:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n,s=t("tslib"),a=t("../cpu/Factory");(n=i||(i={})).create=function(t){return void 0===t&&(t={}),s.__assign({tvMode:0,enableAudio:!0,randomSeed:-1,emulatePaddles:!0,frameStart:-1,pcmAudio:!1,cpuType:a.default.Type.stateMachine},t)},n.getClockHz=function(t){switch(t.tvMode){case 0:return 3584160;case 1:case 2:return 3556800}},r.default=i},{"../cpu/Factory":26,tslib:20}],62:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../io/Switch"),n=function(){function t(){this._selectSwitch=new i.default,this._resetButton=new i.default,this._colorSwitch=new i.default,this._difficutlyP0=new i.default,this._difficutlyP1=new i.default}return t.prototype.getSelectSwitch=function(){return this._selectSwitch},t.prototype.getResetButton=function(){return this._resetButton},t.prototype.getColorSwitch=function(){return this._colorSwitch},t.prototype.getDifficultySwitchP0=function(){return this._difficutlyP0},t.prototype.getDifficultySwitchP1=function(){return this._difficutlyP1},t}();r.default=n},{"../io/Switch":58}],63:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n=t("microevent.ts"),s=function(){function t(t,e,r,i){this._controlPanel=t,this._joystick0=e,this._joystick1=r,this._rng=i,this.trap=new n.Event,this.ram=new Uint8Array(128),this._bus=null,this._timerValue=255,this._subTimer=0,this._timerDivide=1024,this._interruptFlag=0,this._timerWrapped=!1,this._flagSetDuringThisCycle=!1,this.reset()}return t.prototype.reset=function(){for(var t=0;t<128;t++)this.ram[t]=this._rng?this._rng.int(255):0;this._interruptFlag=0,this._flagSetDuringThisCycle=!1,this._timerDivide=1024,this._subTimer=0,this._rng.int(255),this._timerValue=0,this._timerWrapped=!1},t.prototype.read=function(t){return 512&t?4&t?this._readTimer(t):this._readIo(t):this.ram[127&t]},t.prototype.peek=function(t){return 512&t?4&t?this._peekTimer(t):this._readIo(t):this.ram[127&t]},t.prototype.write=function(t,e){if(512&t)return 4&t?this._writeTimer(t,e):this._writeIo(t,e);this.ram[127&t]=e},t.prototype.cycle=function(){this._cycleTimer()},t.prototype.getDebugState=function(){return"divider: "+this._timerDivide+" raw timer: INTIM: "+this._timerValue},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype._writeIo=function(t,e){},t.prototype._writeTimer=function(t,e){switch(this._interruptFlag=0,663&t){case 663:return this._setTimer(1024,e);case 662:return this._setTimer(64,e);case 661:return this._setTimer(8,e);case 660:return this._setTimer(1,e)}},t.prototype._setTimer=function(t,e){this._timerDivide=t,this._timerValue=e,this._subTimer=0,this._timerWrapped=!1},t.prototype._readIo=function(t){switch(643&t){case 640:return(this._joystick1.getUp().read()?0:1)|(this._joystick1.getDown().read()?0:2)|(this._joystick1.getLeft().read()?0:4)|(this._joystick1.getRight().read()?0:8)|(this._joystick0.getUp().read()?0:16)|(this._joystick0.getDown().read()?0:32)|(this._joystick0.getLeft().read()?0:64)|(this._joystick0.getRight().read()?0:128);case 642:return(this._controlPanel.getResetButton().read()?0:1)|(this._controlPanel.getSelectSwitch().read()?0:2)|(this._controlPanel.getColorSwitch().read()?0:8)|(this._controlPanel.getDifficultySwitchP0().read()?0:64)|(this._controlPanel.getDifficultySwitchP1().read()?0:128)}return this._bus.getLastDataBusValue()},t.prototype._readTimer=function(t){return 1&t?128&this._interruptFlag:(this._flagSetDuringThisCycle||(this._interruptFlag=0,this._timerWrapped=!1),this._timerValue)},t.prototype._peekTimer=function(t){return 1&t?128&this._interruptFlag:this._timerValue},t.prototype._cycleTimer=function(){this._flagSetDuringThisCycle=!1,this._timerWrapped?this._timerValue=this._timerValue+255&255:0===this._subTimer&&--this._timerValue<0&&(this._timerValue=255,this._flagSetDuringThisCycle=!0,this._interruptFlag=255,this._timerWrapped=!0),++this._subTimer===this._timerDivide&&(this._subTimer=0)},t}();r.default=s,i=function(t,e,r){this.reason=t,this.pia=e,this.message=r},(s||(s={})).TrapPayload=i,r.default=s},{"microevent.ts":6}],64:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("microevent.ts"),s=t("./CartridgeInterface"),a=t("./CartridgeInfo"),o=function(){function t(){this.trap=new n.Event}return t.prototype.init=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return[2]})})},t.prototype.reset=function(){},t.prototype.read=function(t){return 0},t.prototype.peek=function(t){return this.read(t)},t.prototype.write=function(t,e){},t.prototype.getType=function(){return a.default.CartridgeType.unknown},t.prototype.setCpu=function(t){return this},t.prototype.setBus=function(t){return this},t.prototype.setRng=function(t){return this},t.prototype.setCpuTimeProvider=function(t){return this},t.prototype.notifyCpuCycleComplete=function(){},t.prototype.randomize=function(t){},t.prototype.triggerTrap=function(t,e){if(!this.trap.hasHandlers)throw new Error(e);this.trap.dispatch(new s.default.TrapPayload(t,this,e))},t}();r.default=o},{"./CartridgeInfo":85,"./CartridgeInterface":86,"microevent.ts":6,tslib:20}],65:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("tslib"),i=t("./AbstractCartridge"),n=t("./CartridgeInfo"),o=t("./util"),s=function(i){function t(t){var e=i.call(this)||this;if(e._bank=null,e._bank0=new Uint8Array(4096),e._bank1=new Uint8Array(4096),e._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)e._bank0[r]=t[r],e._bank1[r]=t[4096+r];return e.reset(),e}return a.__extends(t,i),t.matchesBuffer=function(t){var e,r,i=o.searchForSignatures(t,[[173,0,8],[173,64,8],[44,0,8],[12,0,8,76],[12,255,15,76]]);try{for(var n=a.__values(i),s=n.next();!s.done;s=n.next()){if(2<=s.value)return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.reset=function(){this._bank=this._bank0},t.prototype.read=function(t){return this.peek(t)},t.prototype.peek=function(t){return t&=4095,this._bank[t]},t.prototype.getType=function(){return n.default.CartridgeType.bankswitch_8k_econobanking},t.prototype.setBus=function(t){return this._bus=t,this._bus.event.read.addHandler(this._onBusAccess,this),this._bus.event.write.addHandler(this._onBusAccess,this),this},t.prototype._onBusAccess=function(t,e){switch(6208&e._bus.getLastAddresBusValue()){case 2048:e._bank=e._bank0;break;case 2112:e._bank=e._bank1}},t}(i.default);r.default=s},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],66:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo");var a=function(n){function t(t){var e=n.call(this)||this;if(e._rom=new Uint8Array(2048),2048<t.length)throw new Error("buffer is not a 2k cartridge image: wrong length "+t.length);for(var r=function(t){var e=function(t){for(var e=1;e<t;)e*=2;return e}(t.length);if(e===t.length)return t;for(var r=new Uint8Array(e),i=0;i<e;i++)r[e-i-1]=i<t.length?t[t.length-i-1]:0;return r}(t),i=0;i<2048;i++)e._rom[i]=t[i%r.length];return e}return i.__extends(t,n),t.prototype.read=function(t){return this._rom[2047&t]},t.prototype.getType=function(){return s.default.CartridgeType.vanilla_2k},t}(n.default);r.default=a},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],67:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),a=t("./util"),o=t("./CartridgeInfo"),s=function(s){function e(t){var e=s.call(this)||this;if(e._banks=null,e._ramSelect=!1,e._ramBanks=new Array(256),e._bus=null,0!=(2047&t.length))throw new Error("buffer length "+t.length+" is not a multiple of 2k");var r=t.length>>>11;if(r<2)throw new Error("image must have at least 2k");e._banks=new Array(r);for(var i=0;i<r;i++)e._banks[i]=new Uint8Array(2048);for(i=0;i<=255;i++)e._ramBanks[i]=new Uint8Array(1024);e._ramBank=e._ramBanks[0],e._bank1=e._banks[r-1],e._bank0=e._banks[0];for(i=0;i<2048;i++)for(var n=0;n<r;n++)e._banks[n][i]=t[2048*n+i];return e}return i.__extends(e,s),e.matchesBuffer=function(t){return 1<=a.searchForSignatures(t,[[133,62,169,0]])[0]},e.prototype.reset=function(){this._bank0=this._banks[0]},e.prototype.randomize=function(t){for(var e=0;e<this._ramBanks.length;e++)for(var r=0;r<1024;r++)this._ramBanks[e][r]=t.int(255)},e.prototype.setBus=function(t){return this._bus=t,this._bus.event.read.addHandler(e._onBusAccess,this),this._bus.event.write.addHandler(e._onBusAccess,this),this},e.prototype.read=function(t){return t&=4095,this._ramSelect?t<1024?this._ramBank[t]:t<2048?this._ramBank[1023&t]=this._bus.getLastDataBusValue():this._bank1[2047&t]:t<2048?this._bank0[t]:this._bank1[2047&t]},e.prototype.peek=function(t){return t&=4095,this._ramSelect?t<1024?this._ramBank[t]:t<2048?this._bus.getLastDataBusValue():this._bank1[2047&t]:t<2048?this._bank0[t]:this._bank1[2047&t]},e.prototype.write=function(t,e){this._ramSelect&&1024<=(t&=4095)&&t<2048&&(this._ramBank[1023&t]=e)},e.prototype.getType=function(){return o.default.CartridgeType.bankswitch_3E},e._onBusAccess=function(t,e){switch(e._bus.getLastAddresBusValue()){case 63:e._ramSelect=!1,e._bank0=e._banks[e._bus.getLastDataBusValue()%e._banks.length];break;case 62:e._ramSelect=!0,e._ramBank=e._ramBanks[e._bus.getLastDataBusValue()%32]}},e}(n.default);r.default=s},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],68:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./util"),a=t("./CartridgeInfo"),o=function(n){function e(t){var e=n.call(this)||this;if(e._banks=new Array(4),e._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(var r=0;r<4;r++)e._banks[r]=new Uint8Array(2048);e._bank1=e._banks[3],e._bank0=e._banks[0];for(r=0;r<2048;r++)for(var i=0;i<4;i++)e._banks[i][r]=t[2048*i+r];return e}return i.__extends(e,n),e.matchesBuffer=function(t){return 2<=s.searchForSignatures(t,[[133,63]])[0]},e.prototype.reset=function(){this._bank0=this._banks[0]},e.prototype.setBus=function(t){return this._bus=t,this._bus.event.read.addHandler(e._onBusAccess,this),this._bus.event.write.addHandler(e._onBusAccess,this),this},e.prototype.read=function(t){return(t&=4095)<2048?this._bank0[t]:this._bank1[2047&t]},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_3F},e._onBusAccess=function(t,e){63===e._bus.getLastAddresBusValue()&&(e._bank0=e._banks[3&e._bus.getLastDataBusValue()])},e}(n.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],69:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=function(n){function t(t){var e=n.call(this)||this;e._rom=new Uint8Array(4096),4096!==t.length&&console.warn("buffer has invalid size for 4K image: "+t.length+" bytes");for(var r=Math.min(4096,t.length),i=0;i<4096&&i<t.length;i++)e._rom[4095-i]=t[r-1-i];return e}return i.__extends(t,n),t.prototype.read=function(t){return this._rom[4095&t]},t.prototype.getType=function(){return s.default.CartridgeType.vanilla_4k},t}(n.default);r.default=a},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],70:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),s=t("./harmony/Soc"),i=t("./AbstractCartridge"),a=t("./CartridgeInfo"),o=t("./util"),u=new Uint16Array([1760,160]),c=new Uint16Array([1896,296]),l=new Uint16Array([2032,432]),h=function(r){function i(t){var n=r.call(this)||this;if(n._handleBxCDF0=function(t){var e=n._soc.getThumbulator(),r=e.readRegister(2),i=e.readRegister(3);switch(t){case 1762:return n._musicStreams[r%3].frequency=i,0;case 1766:return n._musicStreams[r%3].counter=0;case 1770:return e.writeRegister(2,n._musicStreams[r%3].counter),0;case 1774:return n._musicStreams[r%3].waveformSize=i,0}return 3},n._handleBxCDF1=function(t){var e=n._soc.getThumbulator(),r=e.readRegister(2),i=e.readRegister(3);switch(t){case 1874:return n._musicStreams[r%3].frequency=i,0;case 1878:return n._musicStreams[r%3].counter=0;case 1882:return e.writeRegister(2,n._musicStreams[r%3].counter),0;case 1886:return n._musicStreams[r%3].waveformSize=i,0}return 3},n._version=1,n._banks=new Array(7),n._currentBank=null,n._rom=null,n._ram=null,n._displayRam=null,n._musicStreams=new Array(3),n._clockAccumulator=0,n._lastCpuTime=0,n._soc=null,n._fastFetch=!1,n._digitalAudio=!1,n._fastJumpCountdown=0,n._fastFetchPending=!1,n._jmpOperandAddress=0,n._ldaOperandAddress=0,n._bus=null,n._cpuTimeProvider=null,n._version=i.getVersion(t),32768!==t.length)throw new Error("not a CDF image: invalid lenght "+t.length);if(n._version<0)throw new Error("not a CDF image: missing signature");n._soc=new s.default(0<n._version?n._handleBxCDF1:n._handleBxCDF0),n._soc.trap.addHandler(function(t){return n.triggerTrap(2,t)}),n._rom=n._soc.getRom();for(var e=0;e<32768;e++)n._rom[e]=t[e];for(e=0;e<7;e++)n._banks[e]=new Uint8Array(n._rom.buffer,4096*(e+1),4096);n._ram=n._soc.getRam(),n._displayRam=new Uint8Array(n._soc.getRam().buffer,2048,4096);for(e=0;e<3;e++)n._musicStreams[e]=new _;return n.reset(),n}return n.__extends(i,r),i.getVersion=function(t){var e="CDF".split("").map(function(t){return t.charCodeAt(0)}),r=o.searchForSignature(t,n.__spread(e,[-1],e,[-1],e));return r<0?-1:0<t[r+3]?1:0},i.matchesBuffer=function(t){return 0<=i.getVersion(t)},i.prototype.init=function(){return this._soc.init()},i.prototype.reset=function(){for(var t=0;t<512;t++)this._soc.setRam32(t<<2,this._soc.getRom32(t<<2));this._fastFetch=!1,this._digitalAudio=!1,this._fastJumpCountdown=0,this._fastFetchPending=!1,this._jmpOperandAddress=0,this._ldaOperandAddress=0,this._currentBank=this._banks[6];for(t=0;t<3;t++)this._musicStreams[t].reset();this._lastCpuTime=0,this._clockAccumulator=0},i.prototype.getType=function(){return a.default.CartridgeType.bankswitch_cdf},i.prototype.setBus=function(t){return this._bus=t,this},i.prototype.setCpuTimeProvider=function(t){return this._cpuTimeProvider=t,this},i.prototype.read=function(t){return this._access(t,this._bus.getLastDataBusValue())},i.prototype.peek=function(t){return this._currentBank[4095&t]},i.prototype.write=function(t,e){this._access(t,e)},i.prototype._access=function(t,e){t&=4095;var r=this._currentBank[t];if(0<this._fastJumpCountdown--&&t===this._jmpOperandAddress)return this._jmpOperandAddress++,this._datastreamReadWithIncrement(33,256);if(this._fastFetch&&76===r&&0===this._currentBank[t+1&4095]&&0===this._currentBank[t+2&4095])return this._fastJumpCountdown=2,this._jmpOperandAddress=t+1&4095,r;if(this._fastJumpCountdown=0,this._fastFetch&&this._fastFetchPending&&this._ldaOperandAddress===t&&r<=34){if(this._fastFetchPending=!1,34!==r)return this._datastreamRead(r);if(this._clockMusicStreams(),this._digitalAudio){var i=this._musicStreams[0].counter,n=this._soc.getRam32(l[this._version])+(i>>>21),s=0;return n<32768&&(s=this._rom[n]),1073741824<n&&n<1073750016&&(s=this._ram[n-1073741824]),0==(1048576&i)&&(s>>>=4),15&s}for(var a=0,o=0;o<3;o++)a+=this._displayRam[this._getWaveform(o)+(this._musicStreams[o].counter>>>this._musicStreams[o].waveformSize)&4095];return a}if(this._fastFetchPending=!1,4080<=t){switch(t){case 4080:this._datastreamWriteWithIncrement(32,e,256);break;case 4081:var u=this._getDatastreamPointer(32);u<<=8,u&=4026531840,u|=e<<20,this._setDatastreamPointer(32,u);break;case 4082:this._fastFetch=0==(15&e),this._digitalAudio=0==(240&e);break;case 4083:switch(e){case 254:case 255:this._soc.run(2059)}}4084<t&&t<4092&&(this._currentBank=this._banks[t-4085])}return this._fastFetch&&169===r&&(this._fastFetchPending=!0,this._ldaOperandAddress=t+1&4095),r},i.prototype._clockMusicStreams=function(){var t=this._cpuTimeProvider();this._clockAccumulator+=2e4*(t-this._lastCpuTime),this._lastCpuTime=t;var e=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=e,0!==e)for(var r=0;r<3;r++)this._musicStreams[r].increment(e)},i.prototype._getDatastreamPointer=function(t){return this._soc.getRam32(u[this._version]+4*t)},i.prototype._setDatastreamPointer=function(t,e){this._soc.setRam32(u[this._version]+4*t,e)},i.prototype._getDatastreamIncrement=function(t){return this._soc.getRam32(c[this._version]+4*t)},i.prototype._datastreamRead=function(t){var e=this._getDatastreamPointer(t),r=this._displayRam[e>>>20];return this._setDatastreamPointer(t,e+(this._getDatastreamIncrement(t)<<12)|0),r},i.prototype._datastreamReadWithIncrement=function(t,e){var r=this._getDatastreamPointer(t),i=this._displayRam[r>>>20];return this._setDatastreamPointer(t,r+(e<<12)|0),i},i.prototype._datastreamWriteWithIncrement=function(t,e,r){var i=this._getDatastreamPointer(t);this._displayRam[i>>>20]=e,this._setDatastreamPointer(t,i+(r<<12)|0)},i.prototype._getWaveform=function(t){return this._soc.getRam32(l[this._version]+4*t)-1073741824-2048&4095},i}(i.default);r.default=h;var _=function(){function t(){this.counter=0,this.frequency=0,this.waveformSize=27}return t.prototype.reset=function(){this.counter=this.frequency=0,this.waveformSize=27},t.prototype.increment=function(t){this.counter=this.counter+t*this.frequency|0},t}()},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./harmony/Soc":89,"./util":92,tslib:20}],71:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),i=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=new Uint8Array([0,4,5,9,6,10,11,15]),o=function(i){function t(t){var e=i.call(this)||this;if(e._bank0=new Uint8Array(4096),e._bank1=new Uint8Array(4096),e._fetcherData=new Uint8Array(2048),e._fetchers=new Array(8),e._rng=1,e._cpuTimeProvider=null,e._lastCpuTime=0,e._clockAccumulator=0,t.length<10240)throw new Error("buffer is not a DPC image: too small "+t.length);for(var r=0;r<8;r++)e._fetchers[r]=new u;for(r=0;r<4096;r++)e._bank0[r]=t[r],e._bank1[r]=t[4096+r];for(r=0;r<2048;r++)e._fetcherData[r]=t[8192+r];return e.reset(),e}return n.__extends(t,i),t.prototype.reset=function(){this._bank=this._bank1,this._rng=1,this._fetchers.forEach(function(t){return t.reset()}),this._lastCpuTime=0,this._clockAccumulator=0},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_DPC},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype.setCpuTimeProvider=function(t){return this._cpuTimeProvider=t,this},t.prototype.read=function(t){return this._access(t,this._bus.getLastDataBusValue())},t.prototype.peek=function(t){return this._bank[4095&t]},t.prototype.write=function(t,e){this._access(t,e)},t.prototype._access=function(t,e){if(127<(t&=4095)){switch(t){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}return this._bank[t]}if(t<8)return 4&t?(this._clockMusicFetchers(),a[4&this._fetchers[5].mask|2&this._fetchers[6].mask|1&this._fetchers[7].mask]):this._randomNext();if(t<64){var r=(n=this._fetchers[t-8&7]).mask,i=this._fetcherData[2047-n.pointer];switch(n.next(),t-8>>>3){case 0:return i;case 1:return i&r;case 2:return 255&((i&=r)<<4|i>>>4);case 3:return(1&(i&=r))<<7|(2&i)<<5|(4&i)<<3|(8&i)<<1|(16&i)>>>1|(32&i)>>>3|(64&i)>>>5|(128&i)>>>7;case 4:return(i&r)>>>1;case 5:return i<<1&r;case 6:return r}}if(t<96){var n=this._fetchers[t-64&7];switch(t-64>>>3){case 0:this._clockMusicFetchers(),n.setStart(e);break;case 1:this._clockMusicFetchers(),n.setEnd(e);break;case 2:n.setLow(e);break;case 3:n.setHigh(e),92<t&&n.setMusicMode(e)}return this._bank[t]}return 112<=t&&t<120&&(this._rng=1),this._bank[t]},t.prototype._randomNext=function(){var t=this._rng;return this._rng=255&(this._rng<<1|1&~(this._rng>>>7^this._rng>>>5^this._rng>>>4^this._rng>>>3)),t},t.prototype._clockMusicFetchers=function(){var t=this._cpuTimeProvider();this._clockAccumulator+=2e4*(t-this._lastCpuTime),this._lastCpuTime=t;var e=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=e,0!==e)for(var r=5;r<8;r++)this._fetchers[r].forwardClock(e)},t}(i.default);r.default=o;var u=function(){function t(){this.pointer=0,this.start=0,this.end=0,this.musicMode=!1,this.mask=0}return t.prototype.contructor=function(){this.reset()},t.prototype.reset=function(){this.pointer=this.start=this.end=this.mask=0,this.musicMode=!1},t.prototype.next=function(){this.musicMode||(this.pointer=this.pointer+2047&2047,this._updateMask())},t.prototype.setStart=function(t){this.start=t,this.mask=0,this._updateMask()},t.prototype.setEnd=function(t){this.end=t,this._updateMask()},t.prototype.setLow=function(t){this.pointer=1792&this.pointer|t,this._updateMask()},t.prototype.setHigh=function(t){this.pointer=255&this.pointer|(7&t)<<8,this._updateMask()},t.prototype.setMusicMode=function(t){this.musicMode=0!=(16&t)},t.prototype.forwardClock=function(t){if(this.musicMode){var e=this.start+1,r=((255&this.pointer)+e-t%e)%e,i=256+this.start-r&255,n=256+this.end-r&255;this.pointer=1792&this.pointer|r,this.mask=n<i?0:255}},t.prototype._updateMask=function(){(255&this.pointer)===this.start&&(this.mask=255),(255&this.pointer)===this.end&&(this.mask=0)},t}()},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],72:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),s=t("./harmony/Soc"),n=t("./AbstractCartridge"),a=t("./CartridgeInfo"),o=t("./util"),u=function(n){function t(t){var e=n.call(this)||this;if(e._banks=new Array(6),e._fetchers=new Array(8),e._fractionalFetchers=new Array(8),e._musicFetchers=new Array(3),e._parameters=new Uint8Array(8),e._parameterIndex=0,e._rng=0,e._clockAccumulator=0,e._lastCpuTime=0,e._fastFetch=!1,e._ldaPending=!1,e._cpuTimeProvider=null,e._soc=new s.default,t.length<28672||32768<t.length)throw new Error("not a DPC+ image: invalid lenght "+t.length);e._rom=e._soc.getRom();for(var r=0;r<6;r++)e._banks[r]=new Uint8Array(e._rom.buffer,3072+4096*r,4096);e._ram=e._soc.getRam(),e._imageRam=new Uint8Array(e._ram.buffer,3072,4096);var i=32768-t.length;for(r=0;r<t.length;r++)e._rom[i+r]=t[r];for(r=0;r<8;r++)e._fetchers[r]=new c,e._fractionalFetchers[r]=new l;for(r=0;r<3;r++)e._musicFetchers[r]=new h;return e._soc.trap.addHandler(function(t){return e.triggerTrap(2,t)}),e.reset(),e}return i.__extends(t,n),t.matchesBuffer=function(t){return 2===o.searchForSignatures(t,["DPC+".split("").map(function(t){return t.charCodeAt(0)})])[0]},t.prototype.init=function(){return this._soc.init()},t.prototype.reset=function(){this._soc.reset(),this._currentBank=this._banks[5];for(var t=0;t<768;t++)this._soc.setRam32(t<<2,this._soc.getRom32(t<<2));for(t=6912;t<8192;t++)this._soc.setRam32(768+t-6912<<2,this._soc.getRom32(t<<2));this._currentBank=this._banks[5];for(t=0;t<8;t++)this._parameters[t]=0;for(t=0;t<8;t++)this._fetchers[t].reset(),this._fractionalFetchers[t].reset();for(t=0;t<3;t++)this._musicFetchers[t].reset();this._parameterIndex=0,this._fastFetch=this._ldaPending=!1,this._rng=725831748,this._lastCpuTime=0,this._clockAccumulator=0},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_dpc_plus},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype.setCpuTimeProvider=function(t){return this._cpuTimeProvider=t,this},t.prototype.read=function(t){return this._access(t,this._bus.getLastDataBusValue())},t.prototype.peek=function(t){return this._currentBank[4095&t]},t.prototype.write=function(t,e){this._access(t,e)},t.prototype.triggerTrap=function(t,e){n.prototype.triggerTrap.call(this,t,e)},t.prototype._access=function(t,e){t&=4095;var r=this._currentBank[t];if(this._fastFetch&&this._ldaPending&&127<t&&t<4086&&r<40&&(t=r),this._ldaPending=!1,t<40){var i=7&t,n=this._fetchers[i],s=this._fractionalFetchers[i],a=0;switch(t>>>3&7){case 0:switch(i){case 0:return this._advanceRng(),255&this._rng;case 1:return this._rewindRng(),255&this._rng;case 2:return this._rng>>>8&255;case 3:return this._rng>>>16&255;case 4:return this._rng>>>24&255;case 5:this._clockMusicFetchers();for(var o=0,u=0;u<3;u++)o+=this._imageRam[(this._musicFetchers[u].waveform<<5)+this._musicFetchers[u].waveformSample()];return 255&o}return 0;case 1:return a=this._imageRam[n.pointer],n.increment(),a;case 2:return a=this._imageRam[n.pointer]&n.mask(),n.increment(),a;case 3:return a=this._imageRam[s.pointer>>>8],s.increment(),a;case 4:return i<4?n.mask():0;default:return 0}}else if(t<128){i=7&t,n=this._fetchers[i],s=this._fractionalFetchers[i];switch(t-40>>>3&15){case 0:s.setPointerLo(e);break;case 1:s.setPointerHi(e);break;case 2:s.setFraction(e);break;case 3:n.top=e;break;case 4:n.bottom=e;break;case 5:n.setPointerLo(e);break;case 6:switch(i){case 0:this._fastFetch=0===e;break;case 1:this._parameterIndex<8&&(this._parameters[this._parameterIndex++]=e);break;case 2:this._dispatchFunction(e);break;case 5:case 6:case 7:this._musicFetchers[i-5].waveform=127&e}break;case 7:n.decrement(),this._imageRam[n.pointer]=e;break;case 8:n.setPointerHi(e);break;case 9:switch(i){case 0:this._rng=725831748;break;case 1:this._rng=4294967040&this._rng|e;break;case 2:this._rng=4294902015&this._rng|e<<8;break;case 3:this._rng=4278255615&this._rng|e<<16;break;case 4:this._rng=16777215&this._rng|e<<24;break;case 5:case 6:case 7:this._musicFetchers[i-5].frequency=this._soc.getRam32(7168+(e<<2))}break;case 10:this._imageRam[n.pointer]=e,n.increment()}}else 4085<t&&t<4092&&(this._currentBank=this._banks[t-4086]);return this._fastFetch&&127<t&&t<4086&&(this._ldaPending=169===r),r},t.prototype._clockMusicFetchers=function(){var t=this._cpuTimeProvider();this._clockAccumulator+=2e4*(t-this._lastCpuTime),this._lastCpuTime=t;var e=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=e,0!==e)for(var r=0;r<3;r++)this._musicFetchers[r].increment(e)},t.prototype._dispatchFunction=function(t){var e=this._parameters[0]+(this._parameters[1]<<8);switch(t){case 0:this._parameterIndex=0;break;case 1:for(var r=0;r<this._parameters[3];r++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+r&4095)]=this._rom[3072+(e+r)%29696];this._parameterIndex=0;break;case 2:for(r=0;r<this._parameters[3];r++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+r&4095)]=this._parameters[0];this._parameterIndex=0;break;case 254:case 255:this._soc.run(3083)}},t.prototype._advanceRng=function(){this._rng=(1024&this._rng?279816990:0)^(this._rng>>>11|this._rng<<21)},t.prototype._rewindRng=function(){this._rng=this._rng&1<<31?(279816990^this._rng)<<11|(279816990^this._rng)>>>21:this._rng<<11|this._rng>>>21},t}(n.default);r.default=u;var c=function(){function t(){this.pointer=0,this.top=0,this.bottom=0}return t.prototype.contructor=function(){this.reset()},t.prototype.reset=function(){this.pointer=this.top=this.bottom=0},t.prototype.setPointerHi=function(t){this.pointer=255&this.pointer|(15&t)<<8},t.prototype.setPointerLo=function(t){this.pointer=3840&this.pointer|255&t},t.prototype.increment=function(){this.pointer=this.pointer+1&4095},t.prototype.decrement=function(){this.pointer=this.pointer+4095&4095},t.prototype.mask=function(){return(this.top-(255&this.pointer)&255)>(this.top-this.bottom&255)?255:0},t}(),l=function(){function t(){this.pointer=0,this.fraction=0}return t.prototype.contructor=function(){this.reset()},t.prototype.reset=function(){this.pointer=this.fraction=0},t.prototype.setPointerHi=function(t){this.pointer=65535&this.pointer|(15&t)<<16},t.prototype.setPointerLo=function(t){this.pointer=983295&this.pointer|(255&t)<<8},t.prototype.setFraction=function(t){this.fraction=t,this.pointer&=1048320},t.prototype.increment=function(){this.pointer=this.pointer+this.fraction&1048575},t}(),h=function(){function t(){this.frequency=-1,this.counter=-1,this.waveform=0,this.reset()}return t.prototype.reset=function(){this.frequency=0,this.waveform=0,this.counter=0},t.prototype.increment=function(t){this.counter=this.counter+t*this.frequency|0},t.prototype.waveformSample=function(){return this.counter>>>27},t}()},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./harmony/Soc":89,"./util":92,tslib:20}],73:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./CartridgeInfo"),n=t("./CartridgeF8"),s=t("./CartridgeE0"),a=t("./Cartridge3F"),o=t("./Cartridge3E"),u=t("./CartridgeFE"),c=t("./CartridgeUA"),l=t("./CartridgeE7"),h=t("./CartridgeFA2"),_=t("./CartridgeEF"),d=t("./CartridgeDPCPlus"),f=t("./CartridgeCDF"),p=t("./Cartridge0840"),m=function(){function t(){}return t.prototype.detectCartridgeType=function(t){if(t.length%8448==0)return i.default.CartridgeType.bankswitch_supercharger;if(t.length<=2048)return i.default.CartridgeType.vanilla_2k;if(10240<=t.length&&t.length<=10496)return i.default.CartridgeType.bankswitch_8k_DPC;switch(t.length){case 4096:return i.default.CartridgeType.vanilla_4k;case 8192:return this._detect8k(t);case 12288:return i.default.CartridgeType.bankswitch_12k_FA;case 16384:return this._detect16k(t);case 28672:return i.default.CartridgeType.bankswitch_FA2;case 29696:return this._detect29k(t);case 32768:return this._detect32k(t);case 65536:return this._detect64k(t);default:return i.default.CartridgeType.unknown}},t.prototype._detect8k=function(t){var e=n.default.matchesBuffer(t);return s.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_8k_E0:a.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_8k_3F:c.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_8k_UA:!e&&u.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_8k_FE:p.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_8k_econobanking:i.default.CartridgeType.bankswitch_8k_F8},t.prototype._detect16k=function(t){return l.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_16k_E7:i.default.CartridgeType.bankswitch_16k_F6},t.prototype._detect29k=function(t){return h.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_FA2:i.default.CartridgeType.bankswitch_dpc_plus},t.prototype._detect32k=function(t){return o.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_3E:d.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_dpc_plus:f.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_cdf:i.default.CartridgeType.bankswitch_32k_F4},t.prototype._detect64k=function(t){return _.default.matchesBuffer(t)?i.default.CartridgeType.bankswitch_64k_EF:i.default.CartridgeType.bankswitch_64k_F0},t}();r.default=m},{"./Cartridge0840":65,"./Cartridge3E":67,"./Cartridge3F":68,"./CartridgeCDF":70,"./CartridgeDPCPlus":72,"./CartridgeE0":74,"./CartridgeE7":75,"./CartridgeEF":76,"./CartridgeF8":80,"./CartridgeFA2":82,"./CartridgeFE":83,"./CartridgeInfo":85,"./CartridgeUA":88}],74:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./util"),a=t("./CartridgeInfo"),o=function(n){function t(t){var e=n.call(this)||this;if(e._banks=new Array(8),e._activeBanks=new Array(4),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(var r=0;r<8;r++)e._banks[r]=new Uint8Array(1024);for(r=0;r<1024;r++)for(var i=0;i<8;i++)e._banks[i][r]=t[1024*i+r];return e.reset(),e}return i.__extends(t,n),t.matchesBuffer=function(t){for(var e=s.searchForSignatures(t,[[141,224,31],[141,224,95],[141,233,255],[12,224,31],[173,224,31],[173,233,255],[173,237,255],[173,243,191]]),r=0;r<e.length;r++)if(0<e[r])return!0;return!1},t.prototype.reset=function(){for(var t=0;t<4;t++)this._activeBanks[t]=this._banks[7]},t.prototype.read=function(t){return 4064<=(t&=4095)&&t<4088&&this._handleBankswitch(t),this._activeBanks[t>>10][1023&t]},t.prototype.peek=function(t){return t&=4095,this._activeBanks[t>>10][1023&t]},t.prototype.write=function(t,e){var r=4095&t;return 4064<=r&&r<4088&&this._handleBankswitch(r),n.prototype.write.call(this,t,e)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_E0},t.prototype._handleBankswitch=function(t){t<4072?this._activeBanks[0]=this._banks[t-4064]:t<4080?this._activeBanks[1]=this._banks[t-4072]:this._activeBanks[2]=this._banks[t-4080]},t}(n.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],75:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./util"),a=t("./CartridgeInfo"),o=function(n){function t(t){var e=n.call(this)||this;if(e._banks=new Array(8),e._ram0=new Uint8Array(1024),e._ram1Banks=new Array(4),e._ram0Enabled=!1,16384!==t.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+t.length);for(var r=0;r<8;r++)e._banks[r]=new Uint8Array(2048);for(r=0;r<4;r++)e._ram1Banks[r]=new Uint8Array(256);for(r=0;r<2048;r++)for(var i=0;i<8;i++)e._banks[i][r]=t[2048*i+r];return e.reset(),e}return i.__extends(t,n),t.matchesBuffer=function(t){for(var e=s.searchForSignatures(t,[[173,226,255],[173,229,255],[173,229,31],[173,231,31],[12,231,31],[141,231,255],[141,231,31]]),r=0;r<e.length;r++)if(0<e[r])return!0;return!1},t.prototype.reset=function(){this._bank0=this._banks[0],this._ram1=this._ram1Banks[0],this._ram0Enabled=!1},t.prototype.read=function(t){return this._handleBankswitch(4095&t),this.peek(t)},t.prototype.peek=function(t){return(t&=4095)<2048?this._ram0Enabled?1024<=t?this._ram0[t-1024]:0:this._bank0[t]:t<=2559?2304<=t?this._ram1[t-2304]:0:this._banks[7][2047-(4095-t)]},t.prototype.write=function(t,e){t&=4095,this._handleBankswitch(t),t<1024?this._ram0Enabled?this._ram0[t]=e:n.prototype.write.call(this,t,e):t<2048?n.prototype.write.call(this,t,e):t<2303?this._ram1[t-2048]=e:n.prototype.write.call(this,t,e)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_16k_E7},t.prototype.randomize=function(t){for(var e=0;e<4;e++)for(var r=0;r<this._ram1Banks[e].length;r++)this._ram1Banks[e][r]=t.int(255);for(e=0;e<this._ram0.length;e++)this._ram0[e]=t.int(255)},t.prototype._handleBankswitch=function(t){t<4064||(t<=4070?(this._bank0=this._banks[15&t],this._ram0Enabled=!1):4071===t?this._ram0Enabled=!0:t<=4075&&(this._ram1=this._ram1Banks[t-4072]))},t}(n.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],76:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),a=t("./CartridgeInfo"),o=t("./util"),s=function(s){function t(t,e){void 0===e&&(e=!0);var r=s.call(this)||this;if(r._supportSC=e,r._bus=null,r._banks=new Array(16),r._ram=new Uint8Array(128),r._hasSC=!1,65536!==t.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+t.length);for(var i=0;i<16;i++)r._banks[i]=new Uint8Array(4096);for(i=0;i<4096;i++)for(var n=0;n<16;n++)r._banks[n][i]=t[4096*n+i];return r.reset(),r}return i.__extends(t,s),t.matchesBuffer=function(i){var t=function(t){for(var e=t.split("").map(function(t){return t.charCodeAt(0)}),r=0;r<e.length;r++)if(e[r]!==i[65528+r])return!1;return!0};if(65536!==i.length)return!1;if(t("efef")||t("efsc"))return!0;for(var e=o.searchForSignatures(i,[[12,224,255],[173,224,255],[12,224,31],[173,224,31]]),r=0;r<4;r++)if(0<e[r])return!0;return!1},t.prototype.reset=function(){this._bank=this._banks[15],this._hasSC=!1},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_64k_EF},t.prototype.randomize=function(t){for(var e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype.read=function(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)},t.prototype.peek=function(t){return t&=4095,this._hasSC&&128<=t&&t<256?this._ram[t-128]:this._bank[t]},t.prototype.write=function(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)},t.prototype._access=function(t,e){t<128&&this._hasSC?this._ram[t]=e:4064<=t&&t<=4079&&(this._bank=this._banks[t-4064])},t}(n.default);r.default=s},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],77:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=function(n){function t(t){var e=n.call(this)||this;if(e._banks=new Array(16),e._bankIdx=0,65536!==t.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+t.length);for(var r=0;r<16;r++)e._banks[r]=new Uint8Array(4096);for(r=0;r<4096;r++)for(var i=0;i<16;i++)e._banks[i][r]=t[4096*i+r];return e.reset(),e}return i.__extends(t,n),t.prototype.reset=function(){this._bankIdx=0,this._currentBank=this._banks[this._bankIdx]},t.prototype.read=function(t){return t&=4095,this._handleBankswitch(t),this._currentBank[t]},t.prototype.peek=function(t){return this._currentBank[4095&t]},t.prototype.write=function(t,e){t&=4095,this._handleBankswitch(t),n.prototype.write.call(this,t,e)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_64k_F0},t.prototype._handleBankswitch=function(t){4080===t&&(this._bankIdx=this._bankIdx+1&15,this._currentBank=this._banks[this._bankIdx])},t}(n.default);r.default=a},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],78:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),a=t("./CartridgeInfo"),s=function(s){function t(t,e){void 0===e&&(e=!0);var r=s.call(this)||this;if(r._supportSC=e,r._bus=null,r._banks=new Array(8),r._ram=new Uint8Array(128),r._hasSC=!1,32768!==t.length)throw new Error("buffer is not a 32k cartridge image: wrong length "+t.length);for(var i=0;i<8;i++)r._banks[i]=new Uint8Array(4096);for(i=0;i<4096;i++)for(var n=0;n<8;n++)r._banks[n][i]=t[4096*n+i];return r.reset(),r}return i.__extends(t,s),t.prototype.reset=function(){this._bank=this._banks[0],this._hasSC=!1},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_32k_F4},t.prototype.randomize=function(t){for(var e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype.read=function(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)},t.prototype.peek=function(t){return t&=4095,this._hasSC&&128<=t&&t<256?this._ram[t-128]:this._bank[t]},t.prototype.write=function(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)},t.prototype._access=function(t,e){t<128&&this._hasSC?this._ram[t]=e:4084<=t&&t<=4091&&(this._bank=this._banks[t-4084])},t}(n.default);r.default=s},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],79:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=function(n){function t(t,e){void 0===e&&(e=!0);var r=n.call(this)||this;if(r._supportSC=e,r._bank=null,r._bank0=new Uint8Array(4096),r._bank1=new Uint8Array(4096),r._bank2=new Uint8Array(4096),r._bank3=new Uint8Array(4096),r._hasSC=!1,r._saraRAM=new Uint8Array(128),r._bus=null,16384!==t.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+t.length);for(var i=0;i<4096;i++)r._bank0[i]=t[i],r._bank1[i]=t[4096+i],r._bank2[i]=t[8192+i],r._bank3[i]=t[12288+i];return r.reset(),r}return i.__extends(t,n),t.prototype.reset=function(){this._bank=this._bank0,this._hasSC=!1},t.prototype.read=function(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)},t.prototype.peek=function(t){return t&=4095,this._hasSC&&128<=t&&t<256?this._saraRAM[t-128]:this._bank[t]},t.prototype.write=function(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_16k_F6},t.prototype.randomize=function(t){for(var e=0;e<this._saraRAM.length;e++)this._saraRAM[e]=t.int(255)},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype._access=function(t,e){if(t<128&&this._hasSC)this._saraRAM[t]=255&e;else switch(t){case 4086:this._bank=this._bank0;break;case 4087:this._bank=this._bank1;break;case 4088:this._bank=this._bank2;break;case 4089:this._bank=this._bank3}},t}(n.default);r.default=a},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],80:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=t("./util"),o=function(n){function t(t,e){void 0===e&&(e=!0);var r=n.call(this)||this;if(r._supportSC=e,r._bank=null,r._bank0=new Uint8Array(4096),r._bank1=new Uint8Array(4096),r._hasSC=!1,r._saraRAM=new Uint8Array(128),r._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var i=0;i<4096;i++)r._bank0[i]=t[i],r._bank1[i]=t[4096+i];return r.reset(),r}return i.__extends(t,n),t.matchesBuffer=function(t){return 2<=a.searchForSignatures(t,[[141,249,31]])[0]},t.prototype.reset=function(){this._bank=this._bank1,this._hasSC=!1},t.prototype.read=function(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)},t.prototype.peek=function(t){return t&=4095,this._hasSC&&128<=t&&t<256?this._saraRAM[t-128]:this._bank[t]},t.prototype.write=function(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_F8},t.prototype.randomize=function(t){for(var e=0;e<this._saraRAM.length;e++)this._saraRAM[e]=t.int(255)},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype._access=function(t,e){if(t<128&&this._hasSC)this._saraRAM[t]=255&e;else switch(t){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}},t}(n.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],81:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),i=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=function(i){function t(t){var e=i.call(this)||this;if(e._bank0=new Uint8Array(4096),e._bank1=new Uint8Array(4096),e._bank2=new Uint8Array(4096),e._ram=new Uint8Array(256),12288!==t.length)throw new Error("buffer is not a 12k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)e._bank0[r]=t[r],e._bank1[r]=t[4096+r],e._bank2[r]=t[8192+r];return e.reset(),e}return n.__extends(t,i),t.prototype.reset=function(){this._bank=this._bank0},t.prototype.randomize=function(t){for(var e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)},t.prototype.read=function(t){return this._handleBankswitch(4095&t),this.peek(t)},t.prototype.peek=function(t){return 256<=(t&=4095)&&t<512?this._ram[255&t]:this._bank[t]},t.prototype.write=function(t,e){t&=4095,this._handleBankswitch(t),t<256?this._ram[t]=255&e:i.prototype.write.call(this,t,e)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_12k_FA},t.prototype._handleBankswitch=function(t){switch(t){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1;break;case 4090:this._bank=this._bank2}},t}(i.default);r.default=a},{"./AbstractCartridge":64,"./CartridgeInfo":85,tslib:20}],82:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),a=t("./CartridgeInfo"),o=t("./util"),s=function(s){function t(t){var e=s.call(this)||this;if(e._banks=new Array(7),e._ram=new Uint8Array(256),e._savedRam=new Uint8Array(256),e._accessCounter=0,e._accessCounterLimit=0,28672!==t.length&&29696!==t.length)throw new Error("buffer is not a 28k/29k cartridge image: wrong length "+t.length);for(var r=0;r<7;r++)e._banks[r]=new Uint8Array(4096);var i=28672===t.length?0:1024;for(r=0;r<4096;r++)for(var n=0;n<7;n++)e._banks[n][r]=t[4096*n+r+i];return e.reset(),e}return i.__extends(t,s),t.matchesBuffer=function(t){var e=o.searchForSignatures(t,[[160,193,31,224],[0,128,2,224]]);return 0<e[0]||0<e[1]},t.prototype.reset=function(){this._accessCounter=0,this._accessCounterLimit=0,this._bank=this._banks[0]},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_FA2},t.prototype.randomize=function(t){for(var e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)},t.prototype.setBus=function(t){return this._bus=t,this},t.prototype.read=function(t){return this.write(4095&t,this._bus.getLastDataBusValue()),this.peek(t)},t.prototype.peek=function(t){return 256<=(t&=4095)&&t<512?this._ram[t-256]:4084===t?this._accessCounter>=this._accessCounterLimit?-65&this._bank[t]:64|this._bank[t]:this._bank[t]},t.prototype.write=function(t,e){if(t&=4095,this._accessCounter++,!(t<256))return 4084===t?this._handleIo():void(4085<=t&&t<=4091&&(this._bank=this._banks[t-4085]));this._ram[t]=e},t.prototype._handleIo=function(){if(!(this._accessCounter<this._accessCounterLimit)){if(1===this._ram[255]){for(var t=0;t<256;t++)this._ram[t]=this._savedRam[t];this._accessCounterLimit=10}else{if(2!==this._ram[255])return;for(t=0;t<256;t++)this._savedRam[t]=this._ram[t];this._accessCounterLimit=100}this._accessCounter=0,this._ram[255]=0}},t}(n.default);r.default=s},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],83:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),i=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=t("./util"),o=function(i){function e(t){var e=i.call(this)||this;if(e._bank0=new Uint8Array(4096),e._bank1=new Uint8Array(4096),e._lastAccessWasFE=!1,e._lastAddressBusValue=-1,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)e._bank0[r]=t[r],e._bank1[r]=t[4096+r];return e.reset(),e}return n.__extends(e,i),e.matchesBuffer=function(t){for(var e=a.searchForSignatures(t,[[32,0,208,198,197],[32,195,248,165,130],[208,251,32,115,254],[32,0,240,132,214]]),r=0;r<e.length;r++)if(0<e[r])return!0;return!1},e.prototype.reset=function(){this._bank=this._bank0,this._lastAccessWasFE=!1,this._lastAddressBusValue=-1},e.prototype.read=function(t){return this._bank[4095&t]},e.prototype.write=function(t,e){i.prototype.write.call(this,t,e)},e.prototype.setBus=function(t){return this._bus=t,this._bus.event.read.addHandler(e._onBusAccess,this),this._bus.event.write.addHandler(e._onBusAccess,this),this},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_FE},e._onBusAccess=function(t,e){var r=e._lastAddressBusValue;e._lastAddressBusValue=e._bus.getLastAddresBusValue(),e._lastAddressBusValue!==r&&(e._lastAccessWasFE&&(e._bank=0<(32&e._bus.getLastDataBusValue())?e._bank0:e._bank1),e._lastAccessWasFE=510===e._bus.getLastAddresBusValue())},e}(i.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],84:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),i=t("./Cartridge2k"),s=t("./Cartridge4k"),a=t("./CartridgeF8"),o=t("./CartridgeF6"),u=t("./CartridgeE0"),c=t("./CartridgeFE"),l=t("./Cartridge3F"),h=t("./Cartridge3E"),_=t("./CartridgeUA"),d=t("./CartridgeFA"),f=t("./CartridgeE7"),p=t("./CartridgeF0"),m=t("./CartridgeEF"),g=t("./CartridgeF4"),b=t("./CartridgeFA2"),y=t("./CartridgeSupercharger"),v=t("./CartridgeDPC"),k=t("./CartridgeDPCPlus"),w=t("./CartridgeCDF"),C=t("./Cartridge0840"),A=t("./CartridgeInfo"),M=t("./CartridgeDetector"),P=function(){function t(){}return t.prototype.createCartridge=function(r,i){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,(e=this._createCartridge(r,i)).init()];case 1:return t.sent(),[2,e]}})})},t.prototype._createCartridge=function(t,e){void 0===e&&(e=(new M.default).detectCartridgeType(t));switch(e){case A.default.CartridgeType.vanilla_2k:return new i.default(t);case A.default.CartridgeType.vanilla_4k:return new s.default(t);case A.default.CartridgeType.bankswitch_8k_F8:return new a.default(t);case A.default.CartridgeType.bankswitch_8k_E0:return new u.default(t);case A.default.CartridgeType.bankswitch_8k_3F:return new l.default(t);case A.default.CartridgeType.bankswitch_8k_FE:return new c.default(t);case A.default.CartridgeType.bankswitch_8k_UA:return new _.default(t);case A.default.CartridgeType.bankswitch_8k_DPC:return new v.default(t);case A.default.CartridgeType.bankswitch_8k_econobanking:return new C.default(t);case A.default.CartridgeType.bankswitch_12k_FA:return new d.default(t);case A.default.CartridgeType.bankswitch_16k_F6:return new o.default(t);case A.default.CartridgeType.bankswitch_16k_E7:return new f.default(t);case A.default.CartridgeType.bankswitch_FA2:return new b.default(t);case A.default.CartridgeType.bankswitch_32k_F4:return new g.default(t);case A.default.CartridgeType.bankswitch_64k_F0:return new p.default(t);case A.default.CartridgeType.bankswitch_64k_EF:return new m.default(t);case A.default.CartridgeType.bankswitch_3E:return new h.default(t);case A.default.CartridgeType.bankswitch_supercharger:return new y.default(t);case A.default.CartridgeType.bankswitch_dpc_plus:return new k.default(t);case A.default.CartridgeType.bankswitch_cdf:return new w.default(t);default:throw new Error("invalid or unsupported cartridge image")}},t}();r.default=P},{"./Cartridge0840":65,"./Cartridge2k":66,"./Cartridge3E":67,"./Cartridge3F":68,"./Cartridge4k":69,"./CartridgeCDF":70,"./CartridgeDPC":71,"./CartridgeDPCPlus":72,"./CartridgeDetector":73,"./CartridgeE0":74,"./CartridgeE7":75,"./CartridgeEF":76,"./CartridgeF0":77,"./CartridgeF4":78,"./CartridgeF6":79,"./CartridgeF8":80,"./CartridgeFA":81,"./CartridgeFA2":82,"./CartridgeFE":83,"./CartridgeInfo":85,"./CartridgeSupercharger":87,"./CartridgeUA":88,tslib:20}],85:[function(t,e,r){"use strict";var i,n,s,a;Object.defineProperty(r,"__esModule",{value:!0}),n=i||(i={}),(a=s=n.CartridgeType||(n.CartridgeType={})).vanilla_2k="vanilla_2k",a.vanilla_4k="vanilla_4k",a.bankswitch_8k_F8="bankswitch_8k_F8",a.bankswitch_8k_E0="bankswitch_8k_E0",a.bankswitch_8k_3F="bankswitch_8k_3F",a.bankswitch_8k_FE="bankswitch_8k_FE",a.bankswitch_8k_UA="bankswitch_8k_UA",a.bankswitch_8k_DPC="bankswitch_8k_DPC",a.bankswitch_8k_econobanking="bankswitch_8k_econobanking",a.bankswitch_12k_FA="bankswitch_12k_FA",a.bankswitch_16k_F6="bankswitch_16k_F6",a.bankswitch_16k_E7="bankswitch_16k_E7",a.bankswitch_FA2="bankswitch_FA2",a.bankswitch_32k_F4="bankswitch_32k_F4",a.bankswitch_64k_F0="bankswitch_64k_F0",a.bankswitch_64k_EF="bankswitch_64k_EF",a.bankswitch_3E="bankswitch_3E",a.bankswitch_supercharger="bankswitch_supercharger",a.bankswitch_dpc_plus="bankswitch_dpc_plus",a.bankswitch_cdf="bankswitch_cdf",a.unknown="unknown",n.getAllTypes=function(){return[s.vanilla_2k,s.vanilla_4k,s.bankswitch_8k_F8,s.bankswitch_8k_E0,s.bankswitch_8k_3F,s.bankswitch_8k_FE,s.bankswitch_8k_UA,s.bankswitch_8k_econobanking,s.bankswitch_12k_FA,s.bankswitch_8k_DPC,s.bankswitch_16k_F6,s.bankswitch_16k_E7,s.bankswitch_FA2,s.bankswitch_32k_F4,s.bankswitch_3E,s.bankswitch_64k_F0,s.bankswitch_64k_EF,s.bankswitch_supercharger,s.bankswitch_dpc_plus,s.bankswitch_cdf,s.unknown]},n.describeCartridgeType=function(t){switch(t){case s.vanilla_2k:return"plain 2k";case s.vanilla_4k:return"plain 4k";case s.bankswitch_8k_F8:return"bankswitched 8k, F8 (Atari) scheme";case s.bankswitch_8k_E0:return"bankswitched 8k, E0 (Parker Bros.) scheme";case s.bankswitch_8k_3F:return"bankswitched 8k, 3F (Tigervision) scheme";case s.bankswitch_8k_FE:return"bankswitched 8k, FE (Activision) scheme";case s.bankswitch_8k_UA:return"bankswitched 8k, UA (Pleiades) scheme";case s.bankswitch_12k_FA:return"bankswitched 12k, FA (CBS) scheme";case s.bankswitch_8k_DPC:return"bankswitched 8k + DPC";case s.bankswitch_8k_econobanking:return"bankswitched 8k, econobanking scheme";case s.bankswitch_16k_F6:return"bankswitched 16k, F6 (Atari) scheme";case s.bankswitch_16k_E7:return"bankswitched 16k, E7 (M-Network) scheme";case s.bankswitch_FA2:return"bankswitched 28k/29k, FA2 (modified CBS) scheme";case s.bankswitch_32k_F4:return"bankswitched 32k, F4 (Atari) scheme";case s.bankswitch_3E:return"bankswitched 3E (Tigervision + RAM) scheme";case s.bankswitch_64k_F0:return"bankswitched 64k, F0 (Megaboy) scheme";case s.bankswitch_64k_EF:return"bankswitched 64k, EFSC (Homestar Runner) scheme";case s.bankswitch_supercharger:return"bankswitched supercharger";case s.bankswitch_dpc_plus:return"bankswitched DPC+";case s.bankswitch_cdf:return"bankswitched CDF";case s.unknown:return"unknown"}},r.default=i},{}],86:[function(t,e,r){"use strict";var i,n;Object.defineProperty(r,"__esModule",{value:!0}),n=function(t,e,r){this.reason=t,this.cartridge=e,this.message=r},(i||(i={})).TrapPayload=n,r.default=i},{}],87:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("tslib"),n=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=t("./supercharger/Header"),o=t("./supercharger/blob"),u=function(n){function e(t){var e=n.call(this)||this;if(e._loadCount=0,e._loads=null,e._headers=null,e._rom=new Uint8Array(2048),e._ramBanks=new Array(3),e._bank0=null,e._bank1=null,e._bank1Type=1,e._transitionCount=0,e._pendingWriteData=0,e._pendingWrite=!1,e._lastAddressBusValue=-1,e._writeRamEnabled=!1,e._loadInProgress=!1,e._loadTimestamp=0,e._cpuTimeProvider=null,t.length%8448!=0)throw new Error("not a supercharger image --- invalid size");e._loadCount=t.length/8448,e._loads=new Array(e._loadCount),e._headers=new Array(e._loadCount);for(var r=0;r<e._loadCount;r++)e._loads[r]=new Uint8Array(8448);for(r=0;r<8448;r++)for(var i=0;i<e._loadCount;i++)e._loads[i][r]=t[8448*i+r];for(r=0;r<e._loadCount;r++)e._headers[r]=new a.default(e._loads[r]),e._headers[r].verify()||console.log("load "+r+" has invalid checksum");for(r=0;r<3;r++)e._ramBanks[r]=new Uint8Array(2048);return e._setupRom(),e.reset(),e}return i.__extends(e,n),e.prototype.reset=function(){this._setBankswitchMode(0),this._transitionCount=0,this._pendingWrite=!1,this._pendingWriteData=0,this._lastAddressBusValue=-1,this._writeRamEnabled=!1,this._loadInProgress=!1,this._loadTimestamp=0},e.prototype.setBus=function(t){return this._bus=t,this._bus.event.read.addHandler(e._onBusAccess,this),this._bus.event.write.addHandler(e._onBusAccess,this),this},e.prototype.setCpuTimeProvider=function(t){return this._cpuTimeProvider=t,this},e.prototype.setRng=function(t){return this._rng=t,this},e.prototype.read=function(t){return this._access(t,this._bus.getLastDataBusValue())},e.prototype.peek=function(t){return(t&=4095)<2048?this._bank0[t]:this._bank1[2047&t]},e.prototype.write=function(t,e){this._access(t,e)},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_supercharger},e._onBusAccess=function(t,e){var r=e._bus.getLastAddresBusValue();r===e._lastAddressBusValue||e._loadInProgress||(e._transitionCount<=5&&e._transitionCount++,e._lastAddressBusValue=r)},e.prototype._access=function(t,e){if(t&=4095,this._loadInProgress){if(!(.001<this._cpuTimeProvider()-this._loadTimestamp))return e;this._loadInProgress=!1}var r=t<2048?this._bank0[t]:this._bank1[2047&t];if(!(0!=(3840&t)||this._pendingWrite&&this._writeRamEnabled))return this._pendingWriteData=255&t,this._transitionCount=0,this._pendingWrite=!0,r;if(4088===t)return this._setBankswitchMode((28&this._pendingWriteData)>>>2),this._writeRamEnabled=0<(2&this._pendingWriteData),this._pendingWrite=!1,r;if(4089===t&&1===this._bank1Type&&(8191&this._lastAddressBusValue)<255)return this._loadIntoRam(e),r;if(this._pendingWrite&&this._writeRamEnabled&&5===this._transitionCount){if(this._pendingWrite=!1,t<2048)this._bank0[t]=this._pendingWriteData;else{if(0!==this._bank1Type)return r;this._bank1[2047&t]=this._pendingWriteData}return this._pendingWriteData}return r},e.prototype._setBankswitchMode=function(t){switch(t){case 0:return this._configureBanks(2,1);case 1:return this._configureBanks(0,1);case 2:return this._configureBanks(2,0,0);case 3:return this._configureBanks(0,0,2);case 4:return this._configureBanks(2,1);case 5:return this._configureBanks(1,1);case 6:return this._configureBanks(2,0,1);case 7:return this._configureBanks(1,0,2);default:throw new Error("invalid bankswitching mode")}},e.prototype._configureBanks=function(t,e,r){void 0===r&&(r=0),this._bank0=this._ramBanks[t],this._bank1Type=e,this._bank1=0===e?this._ramBanks[r]:this._rom},e.prototype._setupRom=function(){for(var t=0;t<2048;t++)this._rom[t]=0;for(t=0;t<o.bios.length;t++)this._rom[t]=o.bios[t];this._rom[2047]=this._rom[2045]=248,this._rom[2046]=this._rom[2044]=7},e.prototype._loadIntoRam=function(t){var e;for(e=0;e<this._loadCount&&(this._headers[e].multiloadId!==t&&1!==this._loadCount);e++);e>=this._loadCount&&console.log("no load with id "+t);for(var r=this._headers[e],i=this._loads[e],n=0;n<r.blockCount;n++){var s=r.blockLocation[n],a=3&s;2<a&&(a=0,console.log("invalid bank for block "+n+", load "+e));for(var o=256*((28&s)>>>2),u=s+r.blockChecksum[n],c=0;c<256;c++)u+=i[256*n+c],this._ramBanks[a][o+c]=i[256*n+c];85!=(255&u)&&console.log("load "+e+", block "+n+": invalid checksum")}this._rom[2032]=r.controlWord,this._rom[2033]=this._rng.int(255),this._rom[2034]=r.startAddressLow,this._rom[2035]=r.startAddressHigh,this._loadInProgress=!0,this._loadTimestamp=this._cpuTimeProvider()},e}(n.default);r.default=u},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./supercharger/Header":90,"./supercharger/blob":91,tslib:20}],88:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("tslib"),i=t("./AbstractCartridge"),s=t("./CartridgeInfo"),a=t("./util"),o=function(i){function e(t){var e=i.call(this)||this;if(e._bus=null,e._bank=null,e._bank0=new Uint8Array(4096),e._bank1=new Uint8Array(4096),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)e._bank0[r]=t[r],e._bank1[r]=t[4096+r];return e.reset(),e}return n.__extends(e,i),e.matchesBuffer=function(t){for(var e=a.searchForSignatures(t,[[141,64,2],[173,64,2],[189,31,2]]),r=0;r<e.length;r++)if(0<e[r])return!0;return!1},e.prototype.reset=function(){this._bank=this._bank0},e.prototype.read=function(t){return this._bank[4095&t]},e.prototype.setBus=function(t){return(this._bus=t).event.read.addHandler(e._onBusAccess,this),t.event.write.addHandler(e._onBusAccess,this),this},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_UA},e._onBusAccess=function(t,e){switch(e._bus.getLastAddresBusValue()){case 544:e._bank=e._bank0;break;case 576:e._bank=e._bank1}},e}(i.default);r.default=o},{"./AbstractCartridge":64,"./CartridgeInfo":85,"./util":92,tslib:20}],89:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("thumbulator.ts"),s=t("microevent.ts"),a=t("../../../../tools/hex");var i=function(){function t(t){void 0===t&&(t=function(){return 3});var e,i=this;this.trap=new s.Event,this._thumbulatorBus={read16:function(t){if(1&t)return i._triggerTrap("unaligned 16 bit ARM read from "+a.encode(t,8,!1)),0;var e=268435455&t;switch(t>>>28){case 0:if(e<32768)return i.getRom16(e);break;case 4:if(e<8192)return i.getRam16(e);break;case 14:switch(e){case 2080768:return i._armMamcr}}i._triggerTrap("invalid 16 bit ARM read from "+a.encode(t,8,!1))},read32:function(t){if(3&t)return i._triggerTrap("unaligned 32 bit ARM read from "+a.encode(t,8,!1)),0;var e=268435455&t;switch(t>>>28){case 0:if(e<32768)return i.getRom32(e);break;case 4:if(e<8192)return i.getRam32(e);break;case 14:switch(e){case 32772:case 32776:return 0}}i._triggerTrap("invalid 32 bit ARM read from "+a.encode(t,8,!1))},write16:function(t,e){if(1&t)i._triggerTrap("unaligned 16 bit ARM write: "+a.encode(e,4)+" -> "+a.encode(t,8,!1));else{var r=268435455&t;switch(t>>>28){case 4:if(r<8192)return void i.setRam16(r,65535&e);break;case 14:switch(r){case 2080768:return void(i._armMamcr=e)}}i._triggerTrap("invalid 16 bit ARM write: "+a.encode(e,4)+" -> "+a.encode(t,8,!1))}},write32:function(t,e){if(3&t)i._triggerTrap("unaligned 32 bit ARM write: "+a.encode(e,8,!1)+" -> "+a.encode(t,8,!1));else{var r=268435455&t;switch(t>>>28){case 4:if(r<8192)return void i.setRam32(r,e);case 14:switch(r){case 32772:case 32776:return}}i._triggerTrap("invalid 32 bit ARM write: "+a.encode(e,8,!1)+" -> "+a.encode(t,8,!1))}}},this._romBuffer=new ArrayBuffer(32768),this._ramBuffer=new ArrayBuffer(8192),this._armMamcr=0,this._thumbulator=null,e=new Uint8Array([1,2,3,4]),67305985===new Uint32Array(e.buffer)[0]?(this.getRom16=function(t){return i._rom16[t>>>1]},this.getRom32=function(t){return i._rom32[t>>>2]},this.getRam16=function(t){return i._ram16[t>>>1]},this.getRam32=function(t){return i._ram32[t>>>2]},this.setRam16=function(t,e){return i._ram16[t>>>1]=e},this.setRam32=function(t,e){return i._ram32[t>>>2]=e}):(this.getRom16=function(t){return i._rom8[t]|i._rom8[t+1]<<8},this.getRom32=function(t){return i._rom8[t]|i._rom8[t+1]<<8|i._rom8[t+2]<<16|i._rom8[t+3]<<24},this.getRam16=function(t){return i._ram8[t]|i._ram8[t+1]<<8},this.getRam32=function(t){return i._ram8[t]|i._ram8[t+1]<<8|i._ram8[t+2]<<16|i._ram8[t+3]<<24},this.setRam16=function(t,e){i._ram8[t]=255&e,i._ram8[t+1]=e>>>8&255},this.setRam32=function(t,e){i._ram8[t]=255&e,i._ram8[t+1]=e>>>8&255,i._ram8[t+2]=e>>>16&255,i._ram8[t+3]=e>>>24&255}),this._rom8=new Uint8Array(this._romBuffer),this._rom16=new Uint16Array(this._romBuffer),this._rom32=new Uint32Array(this._romBuffer),this._ram8=new Uint8Array(this._ramBuffer),this._ram16=new Uint16Array(this._ramBuffer),this._ram32=new Uint32Array(this._ramBuffer),this._thumbulator=new n.default(this._thumbulatorBus,{stopAddress:32772,trapOnBx32:t}),this.reset()}return t.prototype.init=function(){return this._thumbulator.init()},t.prototype.reset=function(){},t.prototype.getRom=function(){return this._rom8},t.prototype.getRam=function(){return this._ram8},t.prototype.run=function(t){this._thumbulator.reset(),this._thumbulator.enableDebug(!1);for(var e=0;e<=12;e++)this._thumbulator.writeRegister(e,0);this._thumbulator.writeRegister(13,1073749940),this._thumbulator.writeRegister(14,32773),this._thumbulator.writeRegister(15,t),this._armMamcr=0;var r=this._thumbulator.run(5e5);20!==r&&10!==r&&this._triggerTrap("ARM execution trapped: "+r)},t.prototype.getThumbulator=function(){return this._thumbulator},t.prototype._triggerTrap=function(t){this._thumbulator.abort(),this.trap.dispatch(t)},t}();r.default=i},{"../../../../tools/hex":112,"microevent.ts":6,"thumbulator.ts":18}],90:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t){this.blockLocation=null,this.blockChecksum=null,this.startAddressLow=t[8192],this.startAddressHigh=t[8193],this.controlWord=t[8194],this.blockCount=t[8195],this.checksum=t[8196],this.multiloadId=t[8197],this.progressBarSpeedLow=t[8198],this.progressBarSpeedHigh=t[8199],this.blockLocation=new Uint8Array(this.blockCount),this.blockChecksum=new Uint8Array(this.blockCount);for(var e=0;e<this.blockCount;e++)this.blockLocation[e]=t[8208+e],this.blockChecksum[e]=t[8256+e]}return t.prototype.verify=function(){return 85==(255&this.startAddressLow+this.startAddressHigh+this.controlWord+this.blockCount+this.checksum+this.multiloadId+this.progressBarSpeedLow+this.progressBarSpeedHigh)},t}();r.default=i},{}],91:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../../../tools/base64");r.bios=i.decode("pfqFgEwY+HjYqQCi/5qqqJUA6ND7TBj4ogCtBvCN+P+gAKIolATKEPuiHJSByhD7qQCFG4UchR2FHoUfhRmFGoUIhQGpEIUhhQKiB8rK0P2pAIUghRCFEYUChSqpBYUKqf+FDYUOhQ+FhIWFqfCFg6l0hQmpDIUVqR+FF4WCqQeFGaIIoACFAojQ+4UChQKpAoUChQCFAoUChQKpAIUAyhDkBoNmhCaFpYOFDaWEhQ6lhYUPpoLKhoKGF+AK0MOpAoUBohygAIQZhAmUgcoQ+6IArADw6rwA9+jQ9qILvRL5lfDKEPilgEzwAKIGvR35lfDKEPiu8P+GgLwA8K3x/67y/4b0rvP/hvWi/6AAmkzwAI35/637/9D7TOv4jfj/TAAA")},{"../../../../tools/base64":110}],92:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.searchForSignatures=function(t,e){for(var r=[],i=e.map(function(t){return 0}),n=0;n<t.length;n++){for(var s=0;s<r.length;s++){var a=r[s],o=e[a.signature];t[n]===o[a.nextIndex]?++a.nextIndex===o.length&&(i[a.signature]++,r.splice(s,1),s--):(r.splice(s,1),s--)}for(var u=0;u<e.length;u++)0<(o=e[u]).length&&t[n]===o[0]&&(1===o.length?i[u]++:r.push({signature:u,nextIndex:1}))}return i},r.searchForSignature=function(t,e){for(var r=0;r<t.length;r++){var i=void 0;for(i=0;i<e.length&&(t[r+i]===e[i]||e[i]<0);i++);if(i===e.length)return r}return-1}},{}],93:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){this._collisionMask=t,this._flushLineCache=e,this.color=4294967295,this.collision=0,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this._delaying=!1,this.reset()}return t.prototype.reset=function(){this.color=4294967295,this.collision=0,this._width=1,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._delaying=!1,this._effectiveWidth=0,this._lastMovementTick=0},t.prototype.enabl=function(t){var e=this._enabledNew;this._enabledNew=0<(2&t),e===this._enabledNew||this._delaying||(this._flushLineCache(),this._updateEnabled())},t.prototype.hmbl=function(t){this._hmmClocks=t>>>4^8},t.prototype.resbl=function(t){this._counter=t,this._rendering=!0,this._renderCounter=t-157-4},t.prototype.ctrlpf=function(t){var e=this._widths[(48&t)>>>4];e!==this._width&&this._flushLineCache(),this._width=e},t.prototype.vdelbl=function(t){var e=this._delaying;this._delaying=0<(1&t),e!==this._delaying&&(this._flushLineCache(),this._updateEnabled())},t.prototype.startMovement=function(){this._moving=!0},t.prototype.movementTick=function(t,e){return this._lastMovementTick=this._counter,t===this._hmmClocks&&(this._moving=!1),this._moving&&e&&this.tick(!1),this._moving},t.prototype.tick=function(t){this.collision=this._rendering&&0<=this._renderCounter&&this._enabled?0:this._collisionMask;var e=this._moving&&t;if(156===this._counter){var r=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,e&&3===r&&this._width<4&&this._renderCounter++,r){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(e?this._effectiveWidth:this._width)&&(this._rendering=!1);160<=++this._counter&&(this._counter=0)},t.prototype.getPixel=function(t){return this.collision?t:this.color},t.prototype.shuffleStatus=function(){var t=this._enabledOld;this._enabledOld=this._enabledNew,this._delaying&&this._enabledOld!==t&&(this._flushLineCache(),this._updateEnabled())},t.prototype.setColor=function(t){t!==this.color&&this._enabled&&this._flushLineCache(),this.color=t},t.prototype._updateEnabled=function(){this._enabled=this._delaying?this._enabledOld:this._enabledNew},t}();r.default=i},{}],94:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){this._length=t,this._nextIndex=0,this._indices=new Uint8Array(255),this._queue=new Array(this._length);for(var r=0;r<this._length;r++)this._queue[r]=new n(e)}return t.prototype.reset=function(){for(var t=0;t<this._length;t++)this._queue[t].nextIndex=0},t.prototype.push=function(t,e,r){if(r>=this._length)throw new Error("delay exceeds queue length");var i=this._indices[t];i<this._length&&this._queue[i].remove(t);var n=(this._nextIndex+r)%this._length;return this._queue[n].push(t,e),this._indices[t]=n,this},t.prototype.execute=function(t,e){var r=this._queue[this._nextIndex];this._nextIndex=(this._nextIndex+1)%this._length;for(var i=0;i<r.nextIndex;i++)t(r.addresses[i],r.values[i],e),this._indices[r.addresses[i]]=255;r.nextIndex=0},t}();r.default=i;var n=function(){function t(t){this.size=t,this.nextIndex=0,this.addresses=new Uint8Array(t),this.values=new Uint8Array(t)}return t.prototype.push=function(t,e){if(this.nextIndex>=this.size)throw new Error("delay queue overflow");this.addresses[this.nextIndex]=t,this.values[this.nextIndex]=e,this.nextIndex++},t.prototype.remove=function(t){var e;for(e=0;e<this.nextIndex&&this.addresses[e]!==t;e++);e<this.nextIndex&&(this.addresses[e]=this.addresses[this.nextIndex-1],this.values[e]=this.values[this.nextIndex-1],this.nextIndex--)},t}()},{}],95:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=function(){function t(t){switch(this._config=t,this.newFrame=new i.Event,this.vblank=!1,this.surfaceBuffer=null,this._vblankLines=0,this._kernelLines=0,this._overscanLines=0,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surfaceFactory=null,this._surface=null,this._frameStart=-1,this._config.tvMode){case 0:this._vblankLines=40,this._kernelLines=192,this._overscanLines=30;break;case 1:case 2:this._vblankLines=48,this._kernelLines=228,this._overscanLines=36;break;default:throw new Error("invalid tv mode "+this._config.tvMode)}this._frameStart=this._config.frameStart,this.reset()}return t.prototype.reset=function(){this.vblank=!1,this.surfaceBuffer=null,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surface=null},t.prototype.nextLine=function(){if(this._surfaceFactory)switch(this._lineInState++,this._state){case 0:case 1:150<++this._linesWithoutVsync&&this._setState(2);break;case 2:0<=this._frameStart?this._lineInState>this._frameStart&&this._startFrame():this._lineInState>=(this.vblank?this._vblankLines:this._vblankLines-10)&&this._startFrame();break;case 3:this._lineInState>=this._kernelLines+20&&this._finalizeFrame();break;case 4:this._lineInState>=this._overscanLines-20&&this._setState(0)}},t.prototype.isRendering=function(){return 3===this._state&&!!this._surface},t.prototype.setVblank=function(t){this._surfaceFactory&&(this.vblank=t)},t.prototype.setVsync=function(t){if(this._surfaceFactory&&t!==this._vsync)switch(this._vsync=t,this._state){case 0:this._linesWithoutVsync=0;case 2:case 4:t&&this._setState(1);break;case 1:t||this._setState(2);break;case 3:t&&this._finalizeFrame()}},t.prototype.getHeight=function(){return this._kernelLines+20},t.prototype.setSurfaceFactory=function(t){this._surfaceFactory=t},t.prototype.getCurrentLine=function(){return 3===this._state?this._lineInState:0},t.prototype.getDebugState=function(){return this._getReadableState()+", line = "+this._lineInState+", vblank = "+(this.vblank?"1":"0")},t.prototype._getReadableState=function(){switch(this._state){case 0:return"wait for vsync start";case 1:return"wait for vsync end";case 2:return"wait for frame start";case 3:return"frame";case 4:return"overscan"}},t.prototype._startFrame=function(){this._setState(3),this._surface=this._surfaceFactory(),this.surfaceBuffer=this._surface.getBuffer()},t.prototype._finalizeFrame=function(){if(3!==this._state)throw new Error("finalize frame in invalid state "+this._state);this.newFrame.dispatch(this._surface),this._setState(4)},t.prototype._setState=function(t){this._state=t,this._lineInState=0},t}();r.default=n},{"microevent.ts":6}],96:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t){this._switch=t,this._modeLatched=!1,this._latchedValue=0,this.reset()}return t.prototype.reset=function(){this._modeLatched=!1,this._latchedValue=0},t.prototype.vblank=function(t){64&t?this._modeLatched=!0:(this._modeLatched=!1,this._latchedValue=128)},t.prototype.inpt=function(){var t=this._switch.read()?0:128;return this._modeLatched&&(this._latchedValue&=t,t=this._latchedValue),t},t}();r.default=i},{}],97:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./drawCounterDecodes"),n=function(){function t(t,e){this._collisionMask=t,this._flushLineCache=e,this.color=4294967295,this.collision=0,this._enabled=!1,this._enam=!1,this._resmp=-1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this.reset()}return t.prototype.reset=function(){this.color=4294967295,this._width=1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._decodes=i.decodesMissile[0],this._resmp=-1,this._enam=!1,this._effectiveWidth=0,this._lastMovementTick=0},t.prototype.enam=function(t){var e=0<(2&t),r=e&&0===this._resmp;e===this._enam&&r===this._enabled||this._flushLineCache(),this._enam=e,this._enabled=r},t.prototype.hmm=function(t){this._hmmClocks=t>>>4^8},t.prototype.resm=function(t,e){if(this._counter=t,this._rendering)if(this._renderCounter<0)this._renderCounter=t-157-4;else switch(this._width){case 8:this._renderCounter=t-157+(4<=this._renderCounter?4:0);break;case 4:this._renderCounter=t-157;break;case 2:e?this._rendering=1<this._renderCounter:0===this._renderCounter&&this._renderCounter++;break;default:e&&(this._rendering=0<this._renderCounter)}},t.prototype.resmp=function(t,e){var r=2&t;r!==this._resmp&&(this._flushLineCache(),(this._resmp=r)?this._enabled=!1:(this._enabled=this._enam,this._counter=e.getRespClock()))},t.prototype.nusiz=function(t){this._width=this._widths[(48&t)>>>4],this._decodes=i.decodesMissile[7&t],this._rendering&&this._renderCounter>=this._width&&(this._rendering=!1)},t.prototype.startMovement=function(){this._moving=!0},t.prototype.movementTick=function(t,e){return this._lastMovementTick=this._counter,t===this._hmmClocks&&(this._moving=!1),this._moving&&e&&this.tick(!1),this._moving},t.prototype.tick=function(t){this.collision=this._rendering&&0<=this._renderCounter&&this._enabled?0:this._collisionMask;var e=this._moving&&t;if(this._decodes[this._counter]&&!this._resmp){var r=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,e&&3===r&&this._width<4&&this._renderCounter++,r){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(e?this._effectiveWidth:this._width)&&(this._rendering=!1);160<=++this._counter&&(this._counter=0)},t.prototype.getPixel=function(t){return this.collision?t:this.color},t.prototype.setColor=function(t){t!==this.color&&this._enabled&&this._flushLineCache(),this.color=t},t}();r.default=n},{"./drawCounterDecodes":106}],98:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=t("./PCMChannel"),s=new Float32Array(31);!function(t){for(var e=0;e<=30;e++)s[e]=e/30*60/(30+1*e)}(r.__init||(r.__init={}));var a=function(){function t(t){this._config=t,this.newFrame=new i.Event,this.togglePause=new i.Event,this._currentOutputBuffer=null,this._bufferIndex=0,this._sampleRate=0,this._counter=0,this._isActive=!1,this._channel0=new n.default,this._channel1=new n.default,this._sampleRate=2*(0===this._config.tvMode?15720:15600),this._frameSize=4*(0===this._config.tvMode?262:312),this.reset()}return t.prototype.getChannels=function(){var e=this;return[{audv:function(t){return e._channel0.audv(t)},audc:function(t){return e._channel0.audc(t)},audf:function(t){return e._channel0.audf(t)},reset:function(){return e.reset()},setActive:function(t){return e.setActive(t)}},{audv:function(t){return e._channel1.audv(t)},audc:function(t){return e._channel1.audc(t)},audf:function(t){return e._channel1.audf(t)},reset:function(){},setActive:function(){}}]},t.prototype.reset=function(){this._bufferIndex=0,this._counter=0,this._channel0.reset(),this._channel1.reset()},t.prototype.tick=function(){switch(this._counter){case 9:case 81:this._channel0.phase0(),this._channel1.phase0();break;case 37:case 149:this._currentOutputBuffer.getContent()[this._bufferIndex++]=s[this._channel0.phase1()+this._channel1.phase1()],this._bufferIndex===this._currentOutputBuffer.getLength()&&this._dispatchBuffer()}228==++this._counter&&(this._counter=0)},t.prototype.isPaused=function(){return!this._isActive},t.prototype.setActive=function(t){t!==this._isActive&&(this._isActive=t,this.togglePause.dispatch(!t))},t.prototype.getSampleRate=function(){return this._sampleRate},t.prototype.getFrameSize=function(){return this._frameSize},t.prototype.setFrameBufferFactory=function(t){this._bufferFactory=t,!this._currentOutputBuffer&&t&&(this._currentOutputBuffer=t(),this._bufferIndex=0)},t.prototype._dispatchBuffer=function(){this.newFrame.dispatch(this._currentOutputBuffer),this._currentOutputBuffer=this._bufferFactory?this._bufferFactory():null,this._bufferIndex=0},t}();r.default=a},{"./PCMChannel":99,"microevent.ts":6}],99:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(){this._audv=0,this._audc=0,this._audf=0,this._clkEnable=!1,this._noiseFeedback=!1,this._noiseCounterBit4=!1,this._pulseCounterHold=!1,this._divCounter=0,this._noiseCounter=0,this._pulseCounter=0,this.reset()}return t.prototype.reset=function(){this._audc=this._audf=this._audv=0,this._clkEnable=!1,this._noiseFeedback=!1,this._noiseCounterBit4=!1,this._pulseCounterHold=!1,this._divCounter=0,this._noiseCounter=0,this._pulseCounter=0},t.prototype.phase0=function(){if(this._clkEnable){switch(this._noiseCounterBit4=!!(1&this._noiseCounter),3&this._audc){case 0:case 1:this._pulseCounterHold=!1;break;case 2:this._pulseCounterHold=2!=(30&this._noiseCounter);break;case 3:this._pulseCounterHold=!this._noiseCounterBit4}switch(3&this._audc){case 0:this._noiseFeedback=!(!(1&(this._pulseCounter^this._noiseCounter))&&(0!==this._noiseCounter||10!==this._pulseCounter)&&12&this._audc);break;default:this._noiseFeedback=!!((4&this._noiseCounter?1:0)^1&this._noiseCounter)||0===this._noiseCounter}}this._clkEnable=this._divCounter===this._audf,this._divCounter===this._audf||31===this._divCounter?this._divCounter=0:this._divCounter++},t.prototype.phase1=function(){var t=!1;if(this._clkEnable){switch(this._audc>>>2){case 0:t=!!((2&this._pulseCounter?1:0)^1&this._pulseCounter)&&10!==this._pulseCounter&&!!(3&this._audc);break;case 1:t=!(8&this._pulseCounter);break;case 2:t=!this._noiseCounterBit4;break;case 3:t=!(2&this._pulseCounter||!(14&this._pulseCounter))}this._noiseCounter>>>=1,this._noiseFeedback&&(this._noiseCounter|=16),this._pulseCounterHold||(this._pulseCounter=7&~(this._pulseCounter>>>1),t&&(this._pulseCounter|=8))}return(1&this._pulseCounter)*this._audv},t.prototype.audc=function(t){this._audc=15&t},t.prototype.audf=function(t){this._audf=31&t},t.prototype.audv=function(t){this._audv=15&t},t}();r.default=i},{}],100:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){var r=this;this._paddle=e,this._uThresh=0,this._u=0,this._dumped=!1,this._value=.5,this._timestamp=0,this._cpuTimeProvider=null,this._uThresh=5*(1-Math.exp(-86640/t/1001800/68e-9)),this._paddle.valueChanged.addHandler(function(t){r._updateValue(),r._value=t}),this.reset()}return t.prototype.setCpuTimeProvider=function(t){this._cpuTimeProvider=t,this._timestamp=this._cpuTimeProvider()},t.prototype.reset=function(){this._u=0,this._value=this._paddle.getValue(),this._dumped=!1,this._timestamp=this._cpuTimeProvider?this._cpuTimeProvider():0},t.prototype.vblank=function(t){var e=this._dumped;128&t?(this._dumped=!0,this._u=0):e&&(this._dumped=!1,this._timestamp=this._cpuTimeProvider())},t.prototype.inpt=function(){return this._updateValue(),!this._dumped&&this._u>=this._uThresh?128:0},t.prototype._updateValue=function(){if(!this._dumped){var t=this._cpuTimeProvider();this._u=5*(1-(1-this._u/5)*Math.exp(-(t-this._timestamp)/(1e6*this._value+1800)/68e-9)),this._timestamp=t}},t}();r.default=i},{}],101:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=t("./drawCounterDecodes"),i=function(){function t(t,e){this._collisionMask=t,this._flushLineCache=e,this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._divider=1,this._dividerPending=1,this._dividerChangeCounter=-1,this._sampleCounter=0,this._rendering=!1,this._renderCounter=-5,this._renderCounterTripPoint=0,this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this.reset()}return t.prototype.reset=function(){this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._rendering=!1,this._renderCounter=-5,this._decodes=s.decodesPlayer[0],this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this._sampleCounter=0,this._dividerPending=0,this._dividerChangeCounter=-1,this._setDivider(1)},t.prototype.grp=function(t){t!==this._patternNew&&(this._patternNew=t,this._delaying||(this._flushLineCache(),this._updatePattern()))},t.prototype.hmp=function(t){this._hmmClocks=t>>>4^8},t.prototype.nusiz=function(t,e){var r=7&t;switch(r){case 5:this._dividerPending=2;break;case 7:this._dividerPending=4;break;default:this._dividerPending=1}var i=this._decodes;if(this._decodes=s.decodesPlayer[r],this._decodes!==i&&this._rendering&&this._renderCounter- -5<2&&!this._decodes[(this._counter-this._renderCounter-5+159)%160]&&(this._rendering=!1),this._dividerPending!==this._divider)if(this._rendering){var n=this._renderCounter- -5;switch(this._divider<<4|this._dividerPending){case 18:case 20:e?n<4?this._setDivider(this._dividerPending):this._dividerChangeCounter=n<5?1:0:n<3?this._setDivider(this._dividerPending):this._dividerChangeCounter=1;break;case 33:case 65:n<(e?4:3)?this._setDivider(this._dividerPending):n<(e?6:5)?(this._setDivider(this._dividerPending),this._renderCounter--):this._dividerChangeCounter=e?0:1;break;case 66:case 36:this._renderCounter<1||e&&this._renderCounter%this._divider==1?this._setDivider(this._dividerPending):this._dividerChangeCounter=this._divider-(this._renderCounter-1)%this._divider;break;default:throw new Error("cannot happen")}}else this._setDivider(this._dividerPending)},t.prototype.resp=function(t){this._counter=t,this._rendering&&this._renderCounter- -5<4&&(this._renderCounter=t-157-5)},t.prototype.refp=function(t){var e=this._reflected;this._reflected=0<(8&t),this._reflected!==e&&(this._flushLineCache(),this._updatePattern())},t.prototype.vdelp=function(t){var e=this._delaying;this._delaying=0<(1&t),this._delaying!==e&&(this._flushLineCache(),this._updatePattern())},t.prototype.startMovement=function(){this._moving=!0},t.prototype.movementTick=function(t,e){return t===this._hmmClocks&&(this._moving=!1),this._moving&&e&&this.tick(),this._moving},t.prototype.tick=function(){if(this.collision=this._rendering&&this._renderCounter>=this._renderCounterTripPoint&&this._pattern&1<<this._sampleCounter?0:this._collisionMask,this._decodes[this._counter])this._rendering=!0,this._renderCounter=-5,this._sampleCounter=0;else if(this._rendering){switch(this._renderCounter++,this._divider){case 1:0<this._renderCounter&&this._sampleCounter++,0<=this._renderCounter&&0<=this._dividerChangeCounter&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending);break;default:1<this._renderCounter&&(this._renderCounter-1)%this._divider==0&&this._sampleCounter++,0<this._renderCounter&&0<=this._dividerChangeCounter&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending)}7<this._sampleCounter&&(this._rendering=!1)}160<=++this._counter&&(this._counter=0)},t.prototype.getPixel=function(t){return this.collision?t:this.color},t.prototype.shufflePatterns=function(){var t=this._patternOld;this._patternOld=this._patternNew,this._delaying&&t!==this._patternOld&&(this._flushLineCache(),this._updatePattern())},t.prototype.getRespClock=function(){switch(this._divider){case 1:return(this._counter-5+160)%160;case 2:return(this._counter-9+160)%160;case 4:return(this._counter-12+160)%160;default:throw new Error("cannot happen: invalid divider "+this._divider)}},t.prototype.setColor=function(t){t!==this.color&&this._pattern&&this._flushLineCache(),this.color=t},t.prototype._updatePattern=function(){this._pattern=this._delaying?this._patternOld:this._patternNew,this._reflected||(this._pattern=(1&this._pattern)<<7|(2&this._pattern)<<5|(4&this._pattern)<<3|(8&this._pattern)<<1|(16&this._pattern)>>>1|(32&this._pattern)>>>3|(64&this._pattern)>>>5|(128&this._pattern)>>>7)},t.prototype._setDivider=function(t){this._divider=t,this._renderCounterTripPoint=1===t?0:1},t}();r.default=i},{"./drawCounterDecodes":106}],102:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){this._collisionMask=t,this._flushLineCache=e,this.collision=0,this._colorLeft=0,this._colorRight=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._pattern=0,this._refp=!1,this._reflected=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._x=0,this.reset()}return t.prototype.reset=function(){this._pattern=0,this._reflected=!1,this._refp=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._applyColors()},t.prototype.pf0=function(t){this._pf0!==t>>>4&&(this._flushLineCache(),this._pf0=t>>>4,this._pattern=1048560&this._pattern|this._pf0)},t.prototype.pf1=function(t){this._pf1!==t&&(this._flushLineCache(),this._pf1=t,this._pattern=1044495&this._pattern|(128&t)>>>3|(64&t)>>>1|(32&t)<<1|(16&t)<<3|(8&t)<<5|(4&t)<<7|(2&t)<<9|(1&t)<<11)},t.prototype.pf2=function(t){this._pf2!==t&&(this._flushLineCache(),this._pf2=t,this._pattern=4095&this._pattern|(255&t)<<12)},t.prototype.ctrlpf=function(t){var e=0<(1&t),r=2==(6&t)?1:0;e===this._reflected&&r===this._colorMode||(this._flushLineCache(),this._reflected=e,this._colorMode=r,this._applyColors())},t.prototype.setColor=function(t){t!==this._color&&0===this._colorMode&&this._flushLineCache(),this._color=t,this._applyColors()},t.prototype.setColorP0=function(t){t!==this._colorP0&&1===this._colorMode&&this._flushLineCache(),this._colorP0=t,this._applyColors()},t.prototype.setColorP1=function(t){t!==this._colorP1&&1===this._colorMode&&this._flushLineCache(),this._colorP1=t,this._applyColors()},t.prototype.tick=function(t){var e;(80!==(this._x=t)&&0!==t||(this._refp=this._reflected),3&t)||(e=0===this._pattern?0:t<80?this._pattern&1<<(t>>>2):this._refp?this._pattern&1<<39-(t>>>2):this._pattern&1<<(t>>>2)-20,this.collision=e?0:this._collisionMask)},t.prototype.getPixel=function(t){return this.collision?t:this._x<80?this._colorLeft:this._colorRight},t.prototype._applyColors=function(){switch(this._colorMode){case 0:this._colorLeft=this._colorRight=this._color;break;case 1:this._colorLeft=this._colorP0,this._colorRight=this._colorP1}},t}();r.default=i},{}],103:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,c=t("microevent.ts"),l=t("./WaveformAudio"),h=t("./PCMAudio"),_=t("./Missile"),d=t("./Playfield"),f=t("./Player"),p=t("./Ball"),m=t("./LatchedInput"),g=t("./PaddleReader"),b=t("./FrameManager"),y=t("./DelayQueue"),n=t("./palette"),s=function(){function u(t,e,r,i){var n=this;this._config=t,this.newFrame=new c.Event,this.trap=new c.Event,this._cpu=null,this._bus=null,this._delayQueue=new y.default(10,20),this._hstate=0,this._hctr=0,this._collisionUpdateRequired=!1,this._movementClock=0,this._movementInProgress=!1,this._extendedHblank=!1,this._xDelta=0,this._linesSinceChange=0,this._maxLinesTotal=0,this._colorBk=4278190080,this._priority=0,this._collisionMask=0,this._player0=new f.default(31744,function(){return n._flushLineCache()}),this._player1=new f.default(17344,function(){return n._flushLineCache()}),this._missile0=new _.default(8760,function(){return n._flushLineCache()}),this._missile1=new _.default(4390,function(){return n._flushLineCache()}),this._playfield=new d.default(1099,function(){return n._flushLineCache()}),this._ball=new p.default(2197,function(){return n._flushLineCache()}),this._waveformAudio=new Array(2),this._pcmAudio=null,this._audio=new Array(2),this._frameManager=new b.default(this._config),this._frameManager.newFrame.addHandler(u._onNewFrame,this),this._palette=this._getPalette(this._config),this._input0=new m.default(e.getFire()),this._input1=new m.default(r.getFire()),this._pcmAudio=new h.default(this._config);for(var s=this._pcmAudio.getChannels(),a=0;a<2;a++)this._waveformAudio[a]=new l.default(this._config),this._audio[a]=this._config.pcmAudio?s[a]:this._waveformAudio[a];var o=this._getClockFreq(this._config);this._paddles=new Array(4);for(a=0;a<4;a++)this._paddles[a]=new g.default(o,i[a]);this.reset()}return u.prototype.reset=function(){this._hctr=0,this._movementInProgress=!1,this._extendedHblank=!1,this._movementClock=0,this._priority=0,this._hstate=0,this._collisionMask=0,this._colorBk=4278190080,this._linesSinceChange=0,this._collisionUpdateRequired=!1,this._maxLinesTotal=0,this._xDelta=0,this._delayQueue.reset(),this._frameManager.reset(),this._missile0.reset(),this._missile1.reset(),this._player0.reset(),this._player1.reset(),this._playfield.reset(),this._ball.reset(),this._audio[0].reset(),this._audio[1].reset(),this._input0.reset(),this._input1.reset();for(var t=0;t<4;t++)this._paddles[t].reset();this._cpu&&this._cpu.resume()},u.prototype.setCpu=function(t){return this._cpu=t,this},u.prototype.setCpuTimeProvider=function(t){for(var e=0;e<4;e++)this._paddles[e].setCpuTimeProvider(t);return this},u.prototype.getWidth=function(){return 160},u.prototype.getHeight=function(){return this._frameManager.getHeight()},u.prototype.setSurfaceFactory=function(t){return this._frameManager.setSurfaceFactory(t),this},u.prototype.getWaveformChannel=function(t){return this._waveformAudio[t]},u.prototype.getPCMChannel=function(){return this._pcmAudio},u.prototype.setAudioEnabled=function(t){this._audio[0].setActive(t&&this._config.enableAudio),this._audio[1].setActive(t&&this._config.enableAudio)},u.prototype.read=function(t){var e,r=this._bus.getLastDataBusValue();switch(15&t){case 8:e=this._config.emulatePaddles?this._paddles[0].inpt():0;break;case 9:e=this._config.emulatePaddles?this._paddles[1].inpt():0;break;case 10:e=this._config.emulatePaddles?this._paddles[2].inpt():0;break;case 11:e=this._config.emulatePaddles?this._paddles[3].inpt():0;break;case 12:e=this._input0.inpt();break;case 13:e=this._input1.inpt();break;case 0:e=(8192&this._collisionMask?64:0)|(512&this._collisionMask?128:0);break;case 1:e=(256&this._collisionMask?64:0)|(4096&this._collisionMask?128:0);break;case 2:e=(2048&this._collisionMask?64:0)|(1024&this._collisionMask?128:0);break;case 3:e=(128&this._collisionMask?64:0)|(64&this._collisionMask?128:0);break;case 4:e=(16&this._collisionMask?64:0)|(8&this._collisionMask?128:0);break;case 5:e=(4&this._collisionMask?64:0)|(2&this._collisionMask?128:0);break;case 7:e=(32&this._collisionMask?64:0)|(16384&this._collisionMask?128:0);break;case 6:e=1&this._collisionMask?128:0;break;default:e=0}return 192&e|63&r},u.prototype.peek=function(t){return this.read(t)},u.prototype.write=function(t,e){var r=0;switch(63&t){case 2:this._cpu.halt();break;case 3:this._flushLineCache(),this._rsync();break;case 0:this._frameManager.setVsync(0<(2&e));break;case 1:this._input0.vblank(e),this._input1.vblank(e);for(var i=0;i<4;i++)this._paddles[i].vblank(e);this._delayQueue.push(1,e,1);break;case 29:this._delayQueue.push(29,e,1);break;case 30:this._delayQueue.push(30,e,1);break;case 34:this._delayQueue.push(34,e,2);break;case 35:this._delayQueue.push(35,e,2);break;case 18:this._flushLineCache(),this._missile0.resm(this._resxCounter(),0===this._hstate);break;case 19:this._flushLineCache(),this._missile1.resm(this._resxCounter(),0===this._hstate);break;case 40:this._missile0.resmp(e,this._player0);break;case 41:this._missile1.resmp(e,this._player1);break;case 43:this._delayQueue.push(43,e,2);break;case 4:this._flushLineCache(),this._missile0.nusiz(e),this._player0.nusiz(e,0===this._hstate);break;case 5:this._flushLineCache(),this._missile1.nusiz(e),this._player1.nusiz(e,0===this._hstate);break;case 42:this._delayQueue.push(42,e,6);break;case 9:this._flushLineCache(),this._colorBk=this._palette[(255&e)>>>1];break;case 6:r=this._palette[(255&e)>>>1],this._missile0.setColor(r),this._player0.setColor(r),this._playfield.setColorP0(r);break;case 7:r=this._palette[(255&e)>>>1],this._missile1.setColor(r),this._player1.setColor(r),this._playfield.setColorP1(r);break;case 13:this._delayQueue.push(13,e,2);break;case 14:this._delayQueue.push(14,e,2);break;case 15:this._delayQueue.push(15,e,2);break;case 10:this._setPriority(e),this._playfield.ctrlpf(e),this._ball.ctrlpf(e);break;case 8:this._flushLineCache(),r=this._palette[(255&e)>>>1],this._playfield.setColor(r),this._ball.color=r;break;case 27:this._delayQueue.push(27,e,1).push(241,0,1);break;case 28:this._delayQueue.push(28,e,1).push(240,0,1).push(242,0,1);break;case 16:this._flushLineCache(),this._player0.resp(this._resxCounter());break;case 17:this._flushLineCache(),this._player1.resp(this._resxCounter());break;case 11:this._delayQueue.push(11,e,1);break;case 12:this._delayQueue.push(12,e,1);break;case 32:this._delayQueue.push(32,e,2);break;case 33:this._delayQueue.push(33,e,2);break;case 37:this._player0.vdelp(e);break;case 38:this._player1.vdelp(e);break;case 31:this._delayQueue.push(31,e,1);break;case 36:this._delayQueue.push(36,e,2);break;case 20:this._flushLineCache(),this._ball.resbl(this._resxCounter());break;case 39:this._ball.vdelbl(e);break;case 44:this._flushLineCache(),this._collisionMask=0;break;case 21:this._audio[0].audc(e);break;case 22:this._audio[1].audc(e);break;case 23:this._audio[0].audf(e);break;case 24:this._audio[1].audf(e);break;case 25:this._audio[0].audv(e);break;case 26:this._audio[1].audv(e)}},u.prototype.getDebugState=function(){return"hclock: "+this._hctr+"   line: "+this._frameManager.getCurrentLine()+"\n"+this._frameManager.getDebugState()},u.prototype.setBus=function(t){return this._bus=t,this},u.prototype.cycle=function(){this._delayQueue.execute(u._delayedWrite,this),this._collisionUpdateRequired=!1,this._linesSinceChange<2?(this._tickMovement(),0===this._hstate?this._tickHblank():this._tickHframe(),this._collisionUpdateRequired&&!this._frameManager.vblank&&this._updateCollision()):0===this._hctr&&this._cpu.resume(),228<=++this._hctr&&this._nextLine(),this._config.pcmAudio&&this._pcmAudio.tick()},u._delayedWrite=function(t,e,r){switch(t){case 1:r._flushLineCache(),r._frameManager.setVblank(0<(2&e));break;case 42:r._flushLineCache(),r._movementClock=0,r._movementInProgress=!0,r._extendedHblank||(r._clearHmoveComb(),r._extendedHblank=!0),r._missile0.startMovement(),r._missile1.startMovement(),r._player0.startMovement(),r._player1.startMovement(),r._ball.startMovement();break;case 13:r._playfield.pf0(e);break;case 14:r._playfield.pf1(e);break;case 15:r._playfield.pf2(e);break;case 27:r._player0.grp(e);break;case 28:r._player1.grp(e);break;case 240:r._player0.shufflePatterns();break;case 241:r._player1.shufflePatterns();break;case 32:r._player0.hmp(e);break;case 33:r._player1.hmp(e);break;case 34:r._missile0.hmm(e);break;case 35:r._missile1.hmm(e);break;case 36:r._ball.hmbl(e);break;case 43:r._missile0.hmm(0),r._missile1.hmm(0),r._player0.hmp(0),r._player1.hmp(0),r._ball.hmbl(0);break;case 11:r._player0.refp(e);break;case 12:r._player1.refp(e);break;case 242:r._ball.shuffleStatus();break;case 31:r._ball.enabl(e);break;case 29:r._missile0.enam(e);break;case 30:r._missile1.enam(e)}},u._onNewFrame=function(t,e){var r=e._frameManager.getCurrentLine();if(r>e._maxLinesTotal&&(e._maxLinesTotal=r),r<e._maxLinesTotal)for(var i=t.getBuffer(),n=160*r,s=160*e._maxLinesTotal,a=n;a<s;a++)i[a]=4278190080;e.newFrame.dispatch(t)},u.prototype._tickMovement=function(){if(this._movementInProgress&&0==(3&this._hctr)){var t=0===this._hstate,e=!1,r=15<this._movementClock?0:this._movementClock;e=this._missile0.movementTick(r,t)||e,e=this._missile1.movementTick(r,t)||e,e=this._player0.movementTick(r,t)||e,e=this._player1.movementTick(r,t)||e,e=this._ball.movementTick(r,t)||e,this._movementInProgress=e,this._collisionUpdateRequired=e,this._movementClock++}},u.prototype._tickHblank=function(){switch(this._hctr){case 0:this._extendedHblank=!1,this._cpu.resume();break;case 67:this._extendedHblank||(this._hstate=1);break;case 75:this._extendedHblank&&(this._hstate=1)}this._extendedHblank&&67<this._hctr&&this._playfield.tick(this._hctr-68+this._xDelta)},u.prototype._tickHframe=function(){var t=this._frameManager.getCurrentLine(),e=this._hctr-68+this._xDelta;this._collisionUpdateRequired=!0,this._playfield.tick(e),this._tickSprites(),this._frameManager.isRendering()&&this._renderPixel(e,t)},u.prototype._tickSprites=function(){this._missile0.tick(!0),this._missile1.tick(!0),this._player0.tick(),this._player1.tick(),this._ball.tick(!0)},u.prototype._nextLine=function(){2<=this._linesSinceChange&&this._cloneLastLine(),this._hctr=0,this._playfield.tick(0),this._movementInProgress||this._linesSinceChange++,this._hstate=0,this._xDelta=0,this._frameManager.nextLine(),this._frameManager.isRendering()&&0===this._frameManager.getCurrentLine()&&this._flushLineCache()},u.prototype._cloneLastLine=function(){var t=this._frameManager.getCurrentLine();if(this._frameManager.isRendering()&&0!==t)for(var e=160*t,r=160*(t-1),i=0;i<160;i++)this._frameManager.surfaceBuffer[e+i]=this._frameManager.surfaceBuffer[r+i]},u.prototype._getPalette=function(t){switch(t.tvMode){case 0:return n.NTSC;case 1:return n.PAL;case 2:return n.SECAM;default:throw new Error("invalid TV mode")}},u.prototype._getClockFreq=function(t){return 0===t.tvMode?3584160:3556800},u.prototype._renderPixel=function(t,e){if(this._frameManager.vblank)this._frameManager.surfaceBuffer[160*e+t]=4278190080;else{var r=this._colorBk;switch(this._priority){case 0:r=this._playfield.getPixel(r),r=this._ball.getPixel(r),r=this._missile1.getPixel(r),r=this._player1.getPixel(r),r=this._missile0.getPixel(r),r=this._player0.getPixel(r);break;case 1:r=this._missile1.getPixel(r),r=this._player1.getPixel(r),r=this._missile0.getPixel(r),r=this._player0.getPixel(r),r=this._playfield.getPixel(r),r=this._ball.getPixel(r);break;case 2:r=this._ball.getPixel(r),r=this._missile1.getPixel(r),r=this._player1.getPixel(r),r=this._playfield.getPixel(r),r=this._missile0.getPixel(r),r=this._player0.getPixel(r);break;default:throw new Error("invalid priority")}this._frameManager.surfaceBuffer[160*e+t]=r}},u.prototype._updateCollision=function(){this._collisionMask|=~this._player0.collision&~this._player1.collision&~this._missile0.collision&~this._missile1.collision&~this._ball.collision&~this._playfield.collision},u.prototype._clearHmoveComb=function(){if(this._frameManager.isRendering()&&0===this._hstate)for(var t=160*this._frameManager.getCurrentLine(),e=0;e<8;e++)this._frameManager.surfaceBuffer[t+e]=4278190080},u.prototype._resxCounter=function(){return 0===this._hstate?73<=this._hctr?158:159:157},u.prototype._rsync=function(){var t=68<this._hctr?this._hctr-68:0;if(this._xDelta=157-t,this._frameManager.isRendering())for(var e=this._frameManager.getCurrentLine(),r=160*e+t,i=r+160*(e+1),n=r;n<i;n++)this._frameManager.surfaceBuffer[n]=4278190080;this._hctr=225},u.prototype._setPriority=function(t){var e=4&t?1:2&t?2:0;e!==this._priority&&(this._flushLineCache(),this._priority=e)},u.prototype._flushLineCache=function(){var t=2<=this._linesSinceChange;if(this._linesSinceChange=0,t){var e=this._hctr;for(this._hctr=0;this._hctr<e;this._hctr++)0===this._hstate?this._tickHblank():this._tickHframe()}},u}();r.default=s,i=function(t,e,r){this.reason=t,this.tia=e,this.message=r},(s||(s={})).TrapPayload=i,r.default=s},{"./Ball":93,"./DelayQueue":94,"./FrameManager":95,"./LatchedInput":96,"./Missile":97,"./PCMAudio":98,"./PaddleReader":100,"./Player":101,"./Playfield":102,"./WaveformAudio":105,"./palette":107,"microevent.ts":6}],104:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var _=t("../Config"),d=t("../../../tools/AudioOutputBuffer"),i=t("../../../tools/base64"),f=i.decode("AQEPAQEBAQEBAQEBAwMDAQ=="),n=new Int8Array([1]),s=new Int8Array([1,1]),a=new Int8Array([16,15]),o=i.decode("AQICAQEBBAM="),u=i.decode("AQIBAQICBQQCAQMBAQEBBA=="),c=i.decode("AQQBAwIEAQIDAgEBAQEBAQIEAgEEAQECAgEDAgEDAQEBBAEBAQECAQECBgECAgECAQIBAQIBBgIBAgIBAQEBAgICAgcCAwICAQEBAwIBAQIBAQcBAQMBAQIDAwEBAQICAQECAgQDBQEDAQEFAgEBAQIBAgEDAQIFAQECAQEBBQEBAQEBAQEBBgEBAQIBAQEBBAIBAQMBAwYDAgMBAQIBAgQBAQEDAQEBAQMBAgEEAgIDBAEBBAECAQICAgEBBAMBBAQJBQQBBQMBAQMCAgIBBQECAQEBAgMBAgEBAwQCBQICAQIDAQEBAQECAQMDAwIBAgEBAQEBAwMBAgIDAQMBCA=="),l=i.decode("BQYEBQoFAwcECgYDBgQJBg=="),p=[n,o,o,i.decode("AgMCAQQBBgoCBAIBAQQFCQMDBAEBAQgFBQUEAQEBCAQCCAMDAQEHBAIHBQEDAQcEAQQIAgEDBAcBAwcDAgEGBgICBAUDAgYGAQMDAgUDBwMEAwICAgUJAwEFAwECAgsFAQUDAQECDAUBAgUCAQEMBgECBQECAQoGAwICBAECBgo="),s,s,a,u,c,u,a,n,s,s,a,l],h=function(){function t(t){this._config=t}return t.prototype.setConfig=function(t){this._config=t},t.prototype.getKey=function(t,e){return p[t]===s&&f[t]*(e+1)==1?0:t<<5|e},t.prototype.getBuffer=function(t){for(var e=t>>>5&15,r=31&t,i=p[e],n=0,s=0;s<i.length;s++)n+=i[s];n=n*f[e]*(r+1);var a=new Float32Array(n),o=_.default.getClockHz(this._config)/114,u=0,c=0,l=0,h=!0;for(s=0;s<n;s++)++u===f[e]*(r+1)&&(u=0,++c===i[l]&&(l++,c=0,i.length===l&&(l=0)),h=!(1&l)),a[s]=h?1:-1;return new d.default(a,o)},t}();r.default=h},{"../../../tools/AudioOutputBuffer":108,"../../../tools/base64":110,"../Config":61}],105:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=t("./ToneGenerator"),s=function(){function t(t){this._config=t,this.bufferChanged=new i.Event,this.volumeChanged=new i.Event,this.stop=new i.Event,this._volume=-1,this._tone=-1,this._frequency=-1,this._active=!1,this._toneGenerator=null,this._toneGenerator=new n.default(this._config),this.reset()}return t.prototype.reset=function(){this._volume=-1,this._tone=-1,this._frequency=-1},t.prototype.audc=function(t){(t&=15)!==this._tone&&(this._tone=t,this._dispatchBufferChanged())},t.prototype.audf=function(t){(t&=31)!==this._frequency&&(this._frequency=t,this._dispatchBufferChanged())},t.prototype.audv=function(t){(t&=15)!==this._volume&&(this._volume=t/15,this.volumeChanged.dispatch(this._volume))},t.prototype.setActive=function(t){(this._active=t)?this._dispatchBufferChanged():this.stop.dispatch(void 0)},t.prototype.getVolume=function(){return 0<=this._volume?this._volume:0},t.prototype.getBuffer=function(t){return this._toneGenerator.getBuffer(t)},t.prototype._getKey=function(){return this._toneGenerator.getKey(this._tone,this._frequency)},t.prototype._dispatchBufferChanged=function(){this._active&&this.bufferChanged.hasHandlers&&this.bufferChanged.dispatch(this._getKey())},t}();r.default=s},{"./ToneGenerator":104,"microevent.ts":6}],106:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=new Uint8Array(160),n=new Uint8Array(160),s=new Uint8Array(160),a=new Uint8Array(160),o=new Uint8Array(160),u=new Uint8Array(160);r.decodesMissile=[i,n,s,a,o,i,u,i],r.decodesPlayer=[i,n,s,a,o,i,u,i],[i,n,s,a,o,u].forEach(function(t){for(var e=0;e<160;e++)t[e]=0;t[156]=1}),n[12]=1,s[28]=1,a[12]=a[28]=1,o[60]=1,u[28]=u[60]=1},{}],107:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NTSC=new Uint32Array([4278190080,4283058762,4285493103,4287532686,4289374890,4290822336,4292269782,4293717228,4278208584,4279200105,4280125062,4280984226,4281711547,4282438354,4283099368,4283759868,4278201468,4279322768,4280378018,4281367220,4282224835,4283081938,4283807711,4284532972,4278197392,4279581091,4280832949,4282019014,4283073237,4284061667,4284984048,4285840636,4278190228,4279900839,4281479864,4282927304,4284243158,4285493220,4286611696,4287664380,4284743812,4286192023,4287574184,4288825016,4289944006,4290997460,4291984608,4292906220,4286840912,4288289128,4289540221,4290791058,4291844516,4292897973,4293819589,4294741204,4287627284,4288879155,4290064974,4291184744,4292172927,4293095317,4293951657,4294742204,4287889408,4289141272,4290261549,4291315778,4292238420,4293160805,4293951605,4294742148,4287110144,4288494360,4289746733,4290933314,4291988052,4292976741,4293899637,4294756484,4284755968,4286599192,4288179501,4289759298,4291141716,4292458341,4293643381,4294762628,4281352192,4283327e3,4285104429,4286750274,4288264276,4289646949,4290963317,4292148356,4278207488,4279920154,4281500722,4282949704,4284267100,4285518447,4286638208,4287691920,4278205460,4279787317,4281171538,4282555502,4283742087,4284862622,4285917108,4286905544,4278204464,4279654736,4281038445,4282290824,4283411360,4284465847,4285454540,4286377184,4278201416,4279520617,4280707718,4281894562,4282884027,4283872978,4284730600,4285587708]),r.PAL=new Uint32Array([4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278212736,4279923094,4281501611,4282948798,4284264399,4285513951,4286632430,4287684860,4278213700,4279925086,4281504630,4282952844,4284269216,4285519795,4286638788,4287691988,4278203504,4279914889,4281494432,4282942646,4284259017,4285509596,4286628588,4287681788,4279526400,4281696282,4283602994,4285444168,4287087964,4288600431,4290046848,4291361936,4279500912,4281670281,4283576992,4285417654,4287061193,4288573404,4290019564,4291334396,4284242944,4285953562,4287532594,4288980040,4290295900,4291545967,4292664448,4293717136,4284219504,4285799044,4287181462,4288563368,4289748151,4290867142,4291920083,4292907232,4285545472,4287191577,4288705839,4290154052,4291405143,4292655720,4293709433,4294762632,4285530200,4287175278,4288688771,4290136214,4291386535,4292636599,4293689542,4294742228,4285538304,4287184665,4288698927,4290147396,4291398487,4292649320,4293703033,4294756488,4286578740,4288027210,4289409631,4290660466,4291779715,4292833171,4293820578,4294742192,4287102976,4288485914,4289737266,4290922568,4291976284,4292964207,4293886080,4294742160,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228]),r.SECAM=new Uint32Array([4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295])},{}],108:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){this._content=t,this._sampleRate=e}return t.prototype.getLength=function(){return this._content.length},t.prototype.getContent=function(){return this._content},t.prototype.getSampleRate=function(){return this._sampleRate},t.prototype.replaceUnderlyingBuffer=function(t){this._content=t},t}();r.default=i},{}],109:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=function(){function t(t){this._scheduler=t,this.frequencyUpdate=new i.Event,this._counter=0,this._frequency=0}return t.prototype.attach=function(t){return this._clock&&this.detach(),(this._clock=t).addHandler(this._clockHandler,this),this},t.prototype.start=function(){return this._measurementTask||(this._timestamp=Date.now(),this._counter=0,this._measurementTask=this._scheduler.start(this._updateMeasurement,this)),this},t.prototype.detach=function(){return this._clock&&(this._clock.removeHandler(this._clockHandler,this),this._clock=void 0),this},t.prototype.stop=function(){return this._measurementTask&&(this._measurementTask.stop(),this._measurementTask=void 0),this},t.prototype.getFrequency=function(){return this._frequency},t.prototype._updateMeasurement=function(t){var e=Date.now();t._frequency=t._counter/(e-t._timestamp)*1e3,t._counter=0,t._timestamp=e,t.frequencyUpdate.dispatch(t._frequency)},t.prototype._clockHandler=function(t,e){e._counter+=t},t}();r.default=n},{"microevent.ts":6}],110:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=new Uint8Array(256);function l(t,e){var r=i[t.charCodeAt(e)];if(63<r)throw new Error('invalid base64 character "'+t[e]+'" at index '+e);return r}!function(t){var e;for(e=0;e<256;e++)i[e]=255;for(e=0;e<64;e++)i["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;i["=".charCodeAt(0)]=0}(r.__init||(r.__init={})),r.decode=function(t){if(t.length%4!=0)throw new Error("invalid base64 data --- char count mismatch");for(var e,r,i=t.length/4,n=3*i-function(t){for(var e=0,r=t.length-1;0<=r&&"="===t[r--];)e++;return e}(t),s=new Uint8Array(n),a=0,o=0;o<i;o++)for(var u=(l(e=t,r=4*o)<<18)+(l(e,r+1)<<12)+(l(e,r+2)<<6)+l(e,r+3),c=0;c<3&&a<n;c++)s[a++]=u>>>8*(2-c)&255;return s}},{}],111:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("tslib"),u=Symbol("immutable properties");r.freezeImmutables=function(t){var e,r,i=t[u];if(i)try{for(var n=o.__values(i),s=n.next();!s.done;s=n.next()){var a=s.value;Object.defineProperty(t,a,{writable:!1,configurable:!1})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},r.Immutable=function(t,e){t[u]||Object.defineProperty(t,u,{value:[],writable:!1,enumerable:!1}),t[u].push(e)}},{tslib:20}],112:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.encode=function(t,e,r){return void 0===r&&(r=!0),function t(e,r,i,n){if(void 0===i&&(i=!0),void 0===n&&(n=""),!i&&e<0)return t(e>>>16,r&&8<r?r-4:4,!1,n)+t(65535&e,4);var s=Math.abs(e).toString(16).toUpperCase();if(void 0!==r)for(;s.length<r;)s="0"+s;return(e<0?"-":"")+n+s}(t,e,r,"$")},r.decode=function(t){var e=t.match(/^-/)?-1:1,r=t.replace(/^-/,"").toUpperCase();if(r.match(/^0X[0-9A-F]+$/))r=r.replace(/^0x/,"");else{if(!r.match(/^\$[0-9A-F]+$/))throw new TypeError("invalid hex number "+t);r=r.replace(/^\$/,"")}return e*parseInt(r,16)}},{}],113:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e,r){this._value=t,this._mapper=e,this._adopter=r}return t.prototype.adopt=function(t){this._adopter(this._value,t)},t.prototype.get=function(){return this._mapper(this._value.get())},t.prototype.release=function(){this._value.release()},t.prototype.dispose=function(){this._value.dispose()},t}();r.default=i},{}],114:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./InducedMember"),n=function(){function t(t,e){void 0===e&&(e=function(){throw new Error("adopt is not supported")}),this._mapper=t,this._adopter=e,this._map=new WeakMap}return t.prototype.get=function(t){return this._map.has(t)||this._map.set(t,new i.default(t,this._mapper,this._adopter)),this._map.get(t)},t}();r.default=n},{"./InducedMember":113}],115:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=t("./PoolMember"),s=function(){function t(t){this._factory=t,this.event={release:new i.Event,dispose:new i.Event},this._pool=[],this._poolSize=0}return t.prototype.get=function(){var t,e=this;if(0===this._poolSize){var r=this._factory();t=new n.default(r,function(t){return e._releaseMember(t)},function(t){return e._disposeMember(t)})}else(t=this._pool[--this._poolSize])._isAvailable=!1;return t},t.prototype._releaseMember=function(t){if(t._isAvailable)throw new Error("Trying to release an already released pool member");if(t._isDisposed)throw new Error("Trying to release an already disposed pool member");var e=this._poolSize++;(this._pool[e]=t)._isAvailable=!0,t._poolPosition=e,this.event.release.dispatch(t.get())},t.prototype._disposeMember=function(t){if(t._isDisposed)throw new Error("Trying to dispose of an already disposed pool member");t._isAvailable&&(1<this._poolSize&&(this._pool[t._poolPosition]=this._pool[this._poolSize-1]),this._poolSize--),t._isDisposed=!0,this.event.dispose.dispatch(t.get())},t}();r.default=s},{"./PoolMember":116,"microevent.ts":6}],116:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e,r){this._value=t,this._releaseCB=e,this._disposeCB=r,this._isAvailable=!1,this._isDisposed=!1}return t.prototype.adopt=function(t){this._value=t},t.prototype.get=function(){return this._value},t.prototype.release=function(){this._releaseCB(this)},t.prototype.dispose=function(){this._disposeCB(this)},t}();r.default=i},{}],117:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t){this._rng=t}return t.prototype.single=function(){return this._rng.quick()},t.prototype.double=function(){return this._rng.double()},t.prototype.int32=function(){return this._rng.int32()},t.prototype.int=function(t){return(this._rng.int32()>>>0)%(t+1)},t.prototype.saveState=function(){return this._rng.state()},t}();r.default=i},{}],118:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("seedrandom"),n=t("./SeedrandomGenerator");r.createRng=function(t){return t<0&&(t=Math.random()),new n.default(i.alea(t,{state:!0}))},r.restoreRng=function(t){return new n.default(i.alea("",{state:t}))}},{"./SeedrandomGenerator":117,seedrandom:9}],119:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./PeriodicScheduler"),n=t("./ImmedateScheduler"),s=t("./limiting/BusyWait"),a=t("./limiting/ConstantCycles"),o=t("./limiting/ConstantTimeslice"),u=function(){function t(){}return t.prototype.createPeriodicScheduler=function(t){return new i.default(t)},t.prototype.createImmediateScheduler=function(){return new n.default},t.prototype.createLimitingScheduler=function(t){switch(void 0===t&&(t=1),t){case 0:return new s.default;case 1:return new a.default;case 2:return new o.default;default:throw new Error("invalud limiting scheduling strategy")}},t.prototype.getLimitingSchedulingStrategies=function(){return[0,1,2]},t.prototype.describeLimitingSchedulingStrategy=function(t){switch(t){case 0:return"Busy wait, constant timeslice length";case 1:return"Constant cycle count";case 2:return"Constant timeslice length";default:throw new Error("invalid limiting scheduling strategy")}},t}();r.default=u},{"./ImmedateScheduler":120,"./PeriodicScheduler":121,"./limiting/BusyWait":123,"./limiting/ConstantCycles":124,"./limiting/ConstantTimeslice":125}],120:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./setImmediate"),i=function(){function t(){}return t.prototype.start=function(e,r){var i=!1;return n.setImmediate(function t(){i||(e(r),n.setImmediate(t))}),{stop:function(){return i=!0}}},t}();r.default=i},{"./setImmediate":126}],121:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t){this._period=t}return t.prototype.setPeriod=function(t){return this._period=t,this},t.prototype.getPeriod=function(){return this._period},t.prototype.start=function(t,e){var r=this,i=!1,n=function(){i||(t(e),setTimeout(n,r._period))};return setTimeout(n,this._period),{stop:function(){return i=!0}}},t}();r.default=i},{}],122:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=self.performance&&self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};r.default=i},{}],123:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=t("../getTimestamp"),c=t("../setImmediate"),i=function(){function t(){}return t.prototype.start=function(n,s,t){var a=t||50,o=!0;return c.setImmediate(function t(){if(o){for(var e=u.default(),r=0,i=0;u.default()-e<a;){for(;(i=u.default()-e-r)<1;);r+=n(s,i)}0<(i=u.default()-e-r)&&(r+=n(s,i)),o&&c.setImmediate(t)}}),{stop:function(){return o=!1}}},t}();r.default=i},{"../getTimestamp":122,"../setImmediate":126}],124:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=t("../getTimestamp"),l=t("../setImmediate"),i=function(){function t(){}return t.prototype.start=function(i,n){var s=!1,a=-1,o=0,u=0;return l.setImmediate(function t(){if(!s){var e=c.default(),r=(i(n)||0)-c.default()+e;0<=a&&(u+=a-e+o),100<u?u=100:u<-100&&(u=-100),3<Math.abs(u)&&(r+=u,u=0),r<0&&(u=r=0),0<r?setTimeout(t,Math.round(r)):l.setImmediate(t),a=r,o=c.default()}}),{stop:function(){return s=!0}}},t}();r.default=i},{"../getTimestamp":122,"../setImmediate":126}],125:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=t("../getTimestamp"),h=t("../setImmediate"),i=function(){function t(){}return t.prototype.start=function(n,s,t){var a=t||100,o=l.default(),u=0,c=!0;return h.setImmediate(function t(){if(c){var e=l.default(),r=e-o-u;3*a<r&&(o=e-(r=3*a),u=0),u+=n(s,r);var i=a-l.default()+e;0<i?setTimeout(t,i):h.setImmediate(t)}}),{stop:function(){return c=!1}}},t}();r.default=i},{"../getTimestamp":122,"../setImmediate":126}],126:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("setimmediate2"),n=0;r.setImmediate=function(t){0===n?setTimeout(t,0):i.setImmediate(t),n=(n+1)%10}},{setimmediate2:17}],127:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=function(){function t(){this.emit=new i.Event,this._framesOnHold=new Array(2),this._nFramesOnHold=0,this._width=0,this._height=0}return t.prototype.init=function(t,e){this.flush(),this._width=t,this._height=e},t.prototype.flush=function(){for(var t=0;t<this._nFramesOnHold;t++)this._framesOnHold[t].release(),this._framesOnHold[t]=null;this._nFramesOnHold=0},t.prototype.processSurface=function(t){var e=t.get();if(e.getHeight()!==this._height||e.getWidth()!==this._width)throw new Error("surface dimensions do not match");this._framesOnHold[this._nFramesOnHold++]=t,2===this._nFramesOnHold&&this._process()},t.prototype._process=function(){for(var t=this._framesOnHold[0].get().getBuffer(),e=this._framesOnHold[1].get().getBuffer(),r=0;r<this._width*this._height;r++)t[r]=4278190080|(16711680&t[r])+(16711680&e[r])>>>1&16711680|(65280&t[r])+(65280&e[r])>>>1&65280|(255&t[r])+(255&e[r])>>>1&255;this.emit.dispatch(this._framesOnHold[0]),this._framesOnHold[1].release(),this._nFramesOnHold=0},t}();r.default=n},{"microevent.ts":6}],128:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=function(){function t(){this.emit=new i.Event}return t.prototype.init=function(){},t.prototype.flush=function(){},t.prototype.processSurface=function(t){this.emit.dispatch(t)},t}();r.default=n},{"microevent.ts":6}],129:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./PassthroughProcessor"),n=t("./FrameMergeProcessor"),s=function(){function t(){}return t.prototype.create=function(t){switch(t.type){case 0:return new i.default;case 1:return new n.default;default:throw new Error("cannot happen: invalid processor type")}},t}();r.default=s},{"./FrameMergeProcessor":127,"./PassthroughProcessor":128}],130:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("./ProcessorFactory"),i=function(){function t(t){var r=this;t&&0!==t.length||(t=[{type:0}]);var e=new a.default;this._processors=t.map(function(t){return e.create(t)});for(var i=function(e){n._processors[e-1].emit.addHandler(function(t){return r._processors[e].processSurface(t)})},n=this,s=1;s<this._processors.length;s++)i(s);this.emit=this._processors[this._processors.length-1].emit}return t.prototype.init=function(e,r){this._processors.forEach(function(t){return t.init(e,r)})},t.prototype.flush=function(){this._processors.forEach(function(t){return t.flush()})},t.prototype.processSurface=function(t){this._processors[0].processSurface(t)},t}();r.default=i},{"./ProcessorFactory":129}],131:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("worker-rpc"),s=t("microevent.ts"),a=t("./messages"),i=function(){function i(t){this._rpc=t,this.emit=new s.Event,this._nextId=0,this._surfaces=new Map,this._rpc.registerSignalHandler(a.messageIds.emit,this._onMessageEmit.bind(this)).registerSignalHandler(a.messageIds.release,this._onMessageRelease.bind(this))}return i.spawn=function(t){void 0===t&&(t="video-pipeline.js");var r=new Worker(t),e=new n.RpcProvider(function(t,e){return r.postMessage(t,e)});return r.onmessage=function(t){return e.dispatch(t.data)},new i(e)},i.prototype.configure=function(t,e,r){return this._rpc.rpc(a.messageIds.configure,{width:t,height:e,config:r})},i.prototype.flush=function(){return this._rpc.rpc(a.messageIds.flush)},i.prototype.processSurface=function(t){var e=this._nextId++,r=t.get(),i=r.getUnderlyingBuffer();this._surfaces.set(e,t),this._rpc.signal(a.messageIds.process,{id:e,width:r.getWidth(),height:r.getHeight(),buffer:i},[i])},i.prototype._onMessageEmit=function(t){if(!this._surfaces.has(t.id))throw new Error("no surface with id "+t.id);var e=this._surfaces.get(t.id),r=e.get();this._surfaces.delete(t.id),r.replaceUnderlyingBuffer(r.getWidth(),r.getHeight(),t.buffer),this.emit.dispatch(e)},i.prototype._onMessageRelease=function(t){if(!this._surfaces.has(t.id))throw new Error("no surface with id "+t.id);var e=this._surfaces.get(t.id),r=e.get();this._surfaces.delete(t.id),r.replaceUnderlyingBuffer(r.getWidth(),r.getHeight(),t.buffer),e.release()},i}();r.default=i},{"./messages":132,"microevent.ts":6,"worker-rpc":22}],132:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.messageIds={configure:"pipeline/configure",flush:"pipeline/flush",process:"pipeline/process",emit:"pipeline/emit",release:"pipeline/release"},Object.freeze(r.messageIds)},{}],133:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function i(){this._height=0,this._width=0,this._buffer=null}return i.createFromArrayBuffer=function(t,e,r){return(new i).replaceUnderlyingBuffer(t,e,r)},i.prototype.replaceUnderlyingBuffer=function(t,e,r){if(t*e*4!==r.byteLength)throw new Error("surface size mismatch");return this._width=t,this._height=e,this._underlyingBuffer=r,this._buffer=new Uint32Array(this._underlyingBuffer),this},i.prototype.getUnderlyingBuffer=function(){return this._underlyingBuffer},i.prototype.resetUnderlyingBuffer=function(){return this._width=this._height=0,this._underlyingBuffer=this._buffer=null,this},i.prototype.getWidth=function(){return this._width},i.prototype.getHeight=function(){return this._height},i.prototype.getBuffer=function(){return this._buffer},i.prototype.getByteOrder=function(){return 0},i.prototype.fill=function(t){for(var e=0;e<this._buffer.length;e++)this._buffer[e]=t;return this},i}();r.default=i},{}],134:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),n=t("../../tools/pool/Pool"),s=t("../../tools/pool/InducedPool"),a=t("../../tools/AudioOutputBuffer"),o=function(){function t(t){var e=this;this._output=t,this.newFrame=new i.Event,this.togglePause=new i.Event,this._audioBufferPool=new n.default(function(){return new a.default(new Float32Array(e.getFrameSize()),e.getSampleRate())}),this._audioBufferMap=new WeakMap,this._pcmDataPool=new s.default(function(t){return t.getContent()},function(t,e){return t.get().replaceUnderlyingBuffer(e)}),this._output.newFrame.addHandler(function(t){return e.newFrame.dispatch(e._pcmDataPool.get(e._audioBufferMap.get(t)))}),this._output.togglePause.addHandler(function(t){return e.togglePause.dispatch(t)}),this._output.setFrameBufferFactory(function(){var t=e._audioBufferPool.get();return e._audioBufferMap.has(t.get())||e._audioBufferMap.set(t.get(),t),t.get()})}return t.prototype.getSampleRate=function(){return this._output.getSampleRate()},t.prototype.getFrameSize=function(){return this._output.getFrameSize()},t.prototype.isPaused=function(){return this._output.isPaused()},t}();r.default=o},{"../../tools/AudioOutputBuffer":108,"../../tools/pool/InducedPool":114,"../../tools/pool/Pool":115,"microevent.ts":6}],135:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("microevent.ts"),s=t("../../tools/pool/Pool"),a=t("../../video/surface/ArrayBufferSurface"),o=t("../../tools/pool/InducedPool"),u=t("../../video/processing/ProcessorPipeline"),n=function(){function t(t,e){var n=this;this._video=t,this.newFrame=new i.Event,this._poolMembers=new WeakMap,this._surfaces=new WeakMap,this._surfacePool=new o.default(function(t){return n._surfaces.get(t)}),this._videoProcessor=new u.default(e),this._videoProcessor.init(this._video.getWidth(),this._video.getHeight()),this._pool=new s.default(function(){return new ImageData(n._video.getWidth(),n._video.getHeight())}),this._video.setSurfaceFactory(function(){var t=n._pool.get(),e=t.get();if(!n._surfaces.has(e)){var r=a.default.createFromArrayBuffer(e.width,e.height,e.data.buffer);n._surfaces.set(e,r.fill(4278190080))}var i=n._surfaces.get(e);return n._poolMembers.set(i,t),i}),this._video.newFrame.addHandler(function(t){return n._videoProcessor.processSurface(n._surfacePool.get(n._poolMembers.get(t)))}),this._videoProcessor.emit.addHandler(function(t){return n.newFrame.dispatch(n._poolMembers.get(t.get()))})}return t.prototype.getWidth=function(){return this._video.getWidth()},t.prototype.getHeight=function(){return this._video.getHeight()},t}();r.default=n},{"../../tools/pool/InducedPool":114,"../../tools/pool/Pool":115,"../../video/processing/ProcessorPipeline":130,"../../video/surface/ArrayBufferSurface":133,"microevent.ts":6}],136:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n=t("./EmulationServiceInterface"),s=function(){function r(){this._drivers=new Map,this._driversBound=!1}return r.prototype.bind=function(t){return this._driversBound||(this._emulationService=t,this._shouldBindDrivers()&&this._bindDrivers(),this._emulationService.stateChanged.addHandler(r._onEmuStateChange,this)),this},r.prototype.unbind=function(){return this._emulationService&&(this._unbindDrivers(),this._emulationService.stateChanged.removeHandler(r._onEmuStateChange,this),this._emulationService=null),this},r.prototype.addDriver=function(t,e){return this._drivers.set(t,new r.DriverContext(t,e)),this._driversBound&&e(this._emulationService.getEmulationContext(),t),this},r.prototype.removeDriver=function(t){return this._drivers.get(t)&&(t.unbind(),this._drivers.delete(t)),this},r._onEmuStateChange=function(t,e){e._shouldBindDrivers(t)?e._bindDrivers():e._unbindDrivers()},r.prototype._shouldBindDrivers=function(t){return void 0===t&&(t=this._emulationService?this._emulationService.getState():void 0),this._emulationService&&(t===n.default.State.running||t===n.default.State.paused)},r.prototype._bindDrivers=function(){var e=this;this._driversBound||(this._drivers.forEach(function(t){return t.binder(e._emulationService.getEmulationContext(),t.driver)}),this._driversBound=!0)},r.prototype._unbindDrivers=function(){this._driversBound&&(this._drivers.forEach(function(t){return t.driver.unbind()}),this._driversBound=!1)},r}();r.default=s,i=function(t,e){this.driver=t,this.binder=e},(s||(s={})).DriverContext=i,r.default=s},{"./EmulationServiceInterface":137}],137:[function(t,e,r){"use strict";var i,n,s;Object.defineProperty(r,"__esModule",{value:!0}),n=i||(i={}),(s=n.State||(n.State={}))[s.stopped=0]="stopped",s[s.running=1]="running",s[s.paused=2]="paused",s[s.error=3]="error",r.default=i},{}],138:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../../../driver/VideoEndpoint"),n=t("../../../driver/PCMAudioEndpoint"),s=function(){function t(t,e){this._board=t,this._videoProcessing=e,this._videoEndpoint=null,this._audioEndpoint=null}return t.prototype.getConfig=function(){return this._board.getConfig()},t.prototype.getVideo=function(){return this._videoEndpoint||(this._videoEndpoint=new i.default(this._board.getVideoOutput(),this._videoProcessing)),this._videoEndpoint},t.prototype.getJoystick=function(t){switch(t){case 0:return this._board.getJoystick0();case 1:return this._board.getJoystick1();default:throw new Error("invalid joystick index "+t)}},t.prototype.getControlPanel=function(){return this._board.getControlPanel()},t.prototype.getPaddle=function(t){if(0<=t&&t<4)return this._board.getPaddle(t);throw new Error("invalid paddle index "+t)},t.prototype.getWaveformChannels=function(){return this._board.getWaveformChannels()},t.prototype.getPCMChannel=function(){return this._audioEndpoint||(this._audioEndpoint=new n.default(this._board.getPCMChannel())),this._audioEndpoint},t.prototype.getRawVideo=function(){if(this._videoEndpoint)throw new Error("video endpoint already initialized; raw video unavailable");return this._board.getVideoOutput()},t}();r.default=s},{"../../../driver/PCMAudioEndpoint":134,"../../../driver/VideoEndpoint":135}],139:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=t("tslib"),i=t("microevent.ts"),h=t("../EmulationServiceInterface"),_=t("./EmulationContext"),d=t("../../../../machine/stella/Board"),f=t("../../../../machine/stella/cartridge/CartridgeFactory"),n=t("../../../../tools/scheduler/Factory"),s=t("../../../../tools/ClockProbe"),a=t("../../../../tools/scheduler/PeriodicScheduler"),o=t("async-mutex"),u=function(){function c(){this.stateChanged=new i.Event,this.emulationError=new i.Event,this._enforceRateLimit=!0,this._state=h.default.State.stopped,this._lastError=null,this._scheduler=null,this._clockProbe=new s.default(new a.default(2e3)),this._mutex=new o.Mutex,this._schedulerFactory=new n.default,this._limitingStrategy=1,this.frequencyUpdate=this._clockProbe.frequencyUpdate,this._updateScheduler()}return c.prototype.init=function(){return Promise.resolve()},c.prototype.start=function(n,s,a,o){var t=this,u=new f.default;return this._mutex.runExclusive(function(){return l.__awaiter(t,void 0,void 0,function(){var e,r,i;return l.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this._stop(),this._limitingStrategy=s.pcmAudio?2:1,this._updateScheduler(),this._state===h.default.State.error?[2,this._state]:[4,u.createCartridge(n,a)];case 1:return e=t.sent(),r=new d.default(s,e),this._board=r,this._board.trap.addHandler(c._trapHandler,this),this._context=new _.default(r,o),this._clockProbe.attach(this._board.clock),this._setState(h.default.State.paused),[3,3];case 2:return i=t.sent(),this._setError(i),[3,3];case 3:return[2,this._state]}})})})},c.prototype.stop=function(){var t=this;return this._mutex.runExclusive(function(){return t._stop()})},c.prototype.pause=function(){var e=this;return this._mutex.runExclusive(function(){try{e._state===h.default.State.running&&(e._board.getTimer().stop(),e._board.suspend(),e._setState(h.default.State.paused),e._clockProbe.stop())}catch(t){e._setError(t)}return e._state})},c.prototype.resume=function(){var e=this;return this._mutex.runExclusive(function(){if(e._state===h.default.State.paused)try{e._tryToResume()}catch(t){e._setError(t)}return e._state})},c.prototype.reset=function(){var e=this;return this._mutex.runExclusive(function(){try{switch(e._state){case h.default.State.running:case h.default.State.paused:e._board.reset();break;case h.default.State.error:e._board.reset(),e._tryToResume()}}catch(t){e._setError(t)}return e._state})},c.prototype.getState=function(){return this._state},c.prototype.getEmulationContext=function(){switch(this._state){case h.default.State.running:case h.default.State.paused:return this._context;default:return null}},c.prototype.getLastError=function(){return this._lastError},c.prototype.getFrequency=function(){return this._clockProbe.getFrequency()},c.prototype.getRateLimit=function(){return this._enforceRateLimit},c.prototype.setRateLimit=function(t){var e=this;return this._enforceRateLimit===t?Promise.resolve(void 0):this._mutex.runExclusive(function(){e._state===h.default.State.running&&e._board.getTimer().stop(),e._enforceRateLimit=t,e._updateScheduler(),e._state===h.default.State.running&&e._board.getTimer().start(e._scheduler)})},c._trapHandler=function(t,e){e._setError(new Error("TRAP: "+t.message)),e.emulationError.dispatch(e._lastError)},c.prototype._stop=function(){try{this._state===h.default.State.running&&(this._board.getTimer().stop(),this._board.suspend(),this._board.trap.removeHandler(c._trapHandler,this),this._clockProbe.stop().detach()),this._board=null,this._context=null,this._setState(h.default.State.stopped)}catch(t){this._setError(t)}return this._state},c.prototype._tryToResume=function(){this._state!==h.default.State.running&&(this._board.getTimer().start(this._scheduler),this._board.resume(),this._setState(h.default.State.running),this._clockProbe.start())},c.prototype._setError=function(t){this._lastError=t,this._setState(h.default.State.error)},c.prototype._setState=function(t){return t!==this._state&&(this._state=t,this.stateChanged.dispatch(t)),this._state},c.prototype._updateScheduler=function(){this._scheduler=this._enforceRateLimit?this._schedulerFactory.createLimitingScheduler(this._limitingStrategy):this._schedulerFactory.createImmediateScheduler()},c}();r.default=u},{"../../../../machine/stella/Board":59,"../../../../machine/stella/cartridge/CartridgeFactory":84,"../../../../tools/ClockProbe":109,"../../../../tools/scheduler/Factory":119,"../../../../tools/scheduler/PeriodicScheduler":121,"../EmulationServiceInterface":137,"./EmulationContext":138,"async-mutex":2,"microevent.ts":6,tslib:20}],140:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./messages"),n=function(){function t(t){this._rpc=t,this._active=!1,this._emulationContext=null}return t.prototype.init=function(){this._rpc.registerSignalHandler(i.SIGNAL_TYPE.controlStateUpdate,this._onControlStateUpdate.bind(this))},t.prototype.bind=function(t){this._active||(this._active=!0,this._emulationContext=t)},t.prototype.unbind=function(){this._active&&(this._active=!1,this._emulationContext=null)},t.prototype._onControlStateUpdate=function(t){if(this._active){for(var e=0;e<2;e++)this._applyJoystickState(t.joystickState[e],this._emulationContext.getJoystick(e));for(e=0;e<4;e++)this._applyPaddleState(t.paddleState[e],this._emulationContext.getPaddle(e));this._applyControlPanelState(t.controlPanelState,this._emulationContext.getControlPanel())}},t.prototype._applyJoystickState=function(t,e){e.getUp().toggle(t.up),e.getDown().toggle(t.down),e.getLeft().toggle(t.left),e.getRight().toggle(t.right),e.getFire().toggle(t.fire)},t.prototype._applyPaddleState=function(t,e){e.setValue(t.value),e.getFire().toggle(t.fire)},t.prototype._applyControlPanelState=function(t,e){e.getDifficultySwitchP0().toggle(t.difficulty0),e.getDifficultySwitchP1().toggle(t.difficulty1),e.getResetButton().toggle(t.reset),e.getColorSwitch().toggle(t.color),e.getSelectSwitch().toggle(t.select)},t}();r.default=n},{"./messages":145}],141:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../vanilla/EmulationService"),c=t("../DriverManager"),l=t("./VideoDriver"),h=t("./ControlDriver"),_=t("./WaveformAudioDriver"),d=t("./PCMAudioDriver"),f=t("./messages"),n=function(){function u(t){this._rpc=t,this._videoDriver=null,this._service=new i.default}return u.prototype.startup=function(){var e=this;this._rpc.registerRpcHandler(f.RPC_TYPE.setup,this._onSetup.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationFetchLastError,this._onFetchLastError.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationPause,this._onEmulationPause.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationReset,this._onEmulationReset.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationResume,this._onEmulationResume.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationSetRateLimit,this._onEmulationSetRateLimit.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationStart,this._onEmulationStart.bind(this)).registerRpcHandler(f.RPC_TYPE.emulationStop,this._onEmulationStop.bind(this)),this._service.frequencyUpdate.addHandler(u._onFrequencyUpdate,this),this._service.emulationError.addHandler(u._onEmulationError,this);var t=new c.default,r=new l.default(this._rpc),i=new h.default(this._rpc),n=[0,1].map(function(t){return new _.default(t,e._rpc)}),s=new d.default(0,this._rpc);this._videoDriver=r,i.init(),t.addDriver(r,function(t,e){return e.bind(t.getRawVideo())}).addDriver(i,function(t,e){return e.bind(t)}).addDriver(s,function(t,e){return e.bind(t.getPCMChannel())}).bind(this._service);for(var a=function(r){t.addDriver(n[r],function(t,e){return e.bind(t.getWaveformChannels()[r])})},o=0;o<2;o++)a(o)},u._onFrequencyUpdate=function(t,e){e._rpc.signal(f.SIGNAL_TYPE.emulationFrequencyUpdate,t)},u._onEmulationError=function(t,e){e._rpc.signal(f.SIGNAL_TYPE.emulationError,t?t.message:null)},u.prototype._onSetup=function(t){this._videoDriver.init(t.videoProcessorPort)},u.prototype._onFetchLastError=function(){var t=this._service.getLastError();return t?t.message:null},u.prototype._onEmulationPause=function(){return this._service.pause()},u.prototype._onEmulationReset=function(){return this._service.reset()},u.prototype._onEmulationResume=function(){return this._service.resume()},u.prototype._onEmulationStart=function(t){return this._videoDriver.setVideoProcessingConfig(t.videoProcessing),this._service.start(t.buffer,t.config,t.cartridgeType)},u.prototype._onEmulationStop=function(){return this._service.stop()},u.prototype._onEmulationSetRateLimit=function(t){return this._service.setRateLimit(t)},u}();r.default=n},{"../DriverManager":136,"../vanilla/EmulationService":139,"./ControlDriver":140,"./PCMAudioDriver":142,"./VideoDriver":143,"./WaveformAudioDriver":144,"./messages":145}],142:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./messages"),n=function(){function e(t,e){this._rpc=e,this._enabled=!1,this._sampleRate=0,this._frameSize=0,this._pendingFrames=new Map,this._nextId=0,this._paused=!1,this._signalNewFrame="",this._signalTogglePause="",this._rpc.registerRpcHandler(i.RPC_TYPE.getPCMAudioParameters(t),this._onGetPCMAudioParameters.bind(this)).registerSignalHandler(i.SIGNAL_TYPE.pcmAudioReturnFrame(t),this._onReturnFrame.bind(this)),this._signalNewFrame=i.SIGNAL_TYPE.pcmAudioNewFrame(t),this._signalTogglePause=i.SIGNAL_TYPE.pcmAudioTogglePause(t)}return e.prototype.bind=function(t){this._enabled&&this.unbind(),this._endpoint=t,this._endpoint.newFrame.addHandler(e._onNewFrame,this),this._endpoint.togglePause.addHandler(e._onTogglePause,this),this._sampleRate=this._endpoint.getSampleRate(),this._frameSize=this._endpoint.getFrameSize(),this._enabled=!0},e.prototype.unbind=function(){this._enabled&&(this._endpoint.newFrame.removeHandler(e._onNewFrame,this),this._endpoint.togglePause.removeHandler(e._onTogglePause,this),this._endpoint=null,this._pendingFrames.clear(),this._sampleRate=this._frameSize=0,this._enabled=!1)},e._onNewFrame=function(t,e){if(e._enabled){var r=e._nextId++,i=t.get();e._pendingFrames.set(r,t),e._rpc.signal(e._signalNewFrame,{id:r,buffer:i.buffer},[i.buffer])}else t.dispose()},e._onTogglePause=function(t,e){e._paused=t,e._rpc.signal(e._signalTogglePause,{paused:t})},e.prototype._onGetPCMAudioParameters=function(){return{sampleRate:this._sampleRate,frameSize:this._frameSize,paused:this._paused}},e.prototype._onReturnFrame=function(t){if(this._enabled&&this._pendingFrames.has(t.id)){var e=this._pendingFrames.get(t.id);this._pendingFrames.delete(t.id),e.adopt(new Float32Array(t.buffer)),e.release()}},e}();r.default=n},{"./messages":145}],143:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=t("tslib"),i=t("async-mutex"),a=t("worker-rpc"),o=t("../../../../tools/pool/Pool"),u=t("../../../../video/surface/ArrayBufferSurface"),c=t("../../../../video/processing/worker/PipelineClient"),l=t("./messages"),n=function(){function n(t){this._rpc=t,this._active=!1,this._video=null,this._videoPipelineClient=null,this._mutex=new i.Mutex,this._videoProcessingConfig=null,this._bypassProcessingPipeline=!0,this._surfacePool=null,this._managedSurfacesById=null,this._ids=null,this._width=0,this._height=0,this._nextId=0}return n.prototype.init=function(r){if(this._rpc.registerSignalHandler(l.SIGNAL_TYPE.videoReturnSurface,this._onReturnSurfaceFromHost.bind(this)).registerRpcHandler(l.RPC_TYPE.getVideoParameters,this._onGetVideoParameters.bind(this)),r){var e=new a.RpcProvider(function(t,e){return r.postMessage(t,e)});r.onmessage=function(t){return e.dispatch(t.data)},this._videoPipelineClient=new c.default(e),this._videoPipelineClient.emit.addHandler(n._onEmitFromPipeline,this)}},n.prototype.setVideoProcessingConfig=function(t){this._videoProcessingConfig=t},n.prototype.bind=function(t){var e=this;this._mutex.runExclusive(function(){return e._bind(t)})},n.prototype.unbind=function(){var t=this;this._mutex.runExclusive(function(){return t._unbind()})},n._onEmitFromPipeline=function(t,e){if(e._active)if(e._ids.has(t)){var r=t.get().getUnderlyingBuffer(),i=e._ids.get(t);e._rpc.signal(l.SIGNAL_TYPE.videoNewFrame,{id:i,width:e._width,height:e._height,buffer:r},[r])}else console.warn("surface not registered");else console.warn("surface emmited from pipeline to inactive driver")},n._onNewFrame=function(t,e){e._active?e._managedSurfaces.has(t)?e._bypassProcessingPipeline||!e._videoPipelineClient?n._onEmitFromPipeline(e._managedSurfaces.get(t),e):e._videoPipelineClient.processSurface(e._managedSurfaces.get(t)):console.warn("surface not registered"):console.warn("new frame passed to inactive driver")},n.prototype._bind=function(e){return s.__awaiter(this,void 0,void 0,function(){var i=this;return s.__generator(this,function(t){switch(t.label){case 0:return this._active?[2]:(this._width=e.getWidth(),this._height=e.getHeight(),this._video=e,this._surfacePool=new o.default(function(){return u.default.createFromArrayBuffer(i._width,i._height,new ArrayBuffer(4*i._width*i._height))}),this._managedSurfacesById=new Map,this._managedSurfaces=new WeakMap,this._ids=new WeakMap,this._videoPipelineClient?[4,this._videoPipelineClient.configure(this._width,this._height,this._videoProcessingConfig)]:[3,2]);case 1:t.sent(),t.label=2;case 2:return this._video.setSurfaceFactory(function(){var t=i._surfacePool.get(),e=t.get();if(!i._ids.has(t)){var r=i._nextId++;i._ids.set(t,r),i._managedSurfacesById.set(r,t),i._managedSurfaces.set(e,t),e.fill(4278190080)}return t.get()}),this._video.newFrame.addHandler(n._onNewFrame,this),this._bypassProcessingPipeline=!this._videoProcessingConfig||0===this._videoProcessingConfig.length,this._active=!0,[2]}})})},n.prototype._unbind=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this._active?(this._active=!1,this._video.setSurfaceFactory(null),this._video.newFrame.removeHandler(n._onNewFrame,this),this._videoPipelineClient?[4,this._videoPipelineClient.flush()]:[3,2]):[2];case 1:t.sent(),t.label=2;case 2:return this._video=null,this._surfacePool=null,this._managedSurfacesById=null,this._ids=null,[2]}})})},n.prototype._onReturnSurfaceFromHost=function(t){if(this._active){var e=this._managedSurfacesById.get(t.id);e?(e.get().replaceUnderlyingBuffer(this._width,this._height,t.buffer),e.release()):console.warn("invalid member ID "+t.id)}else console.warn("surface returned from host to inactive driver")},n.prototype._onGetVideoParameters=function(){return{width:this._width,height:this._height}},n}();r.default=n},{"../../../../tools/pool/Pool":115,"../../../../video/processing/worker/PipelineClient":131,"../../../../video/surface/ArrayBufferSurface":133,"./messages":145,"async-mutex":2,tslib:20,"worker-rpc":22}],144:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("./messages"),n=function(){function e(t,e){this._index=t,this._rpc=e,this._audio=null,this._rpc.registerRpcHandler(i.RPC_TYPE.getWaveformAudioParameters(this._index),this._onGetWaveformAudioParameters.bind(this))}return e.prototype.bind=function(t){this._audio||(this._audio=t,this._audio.bufferChanged.addHandler(e._onBufferChanged,this),this._audio.volumeChanged.addHandler(e._onVolumeChanged,this),this._audio.stop.addHandler(e._onStop,this))},e.prototype.unbind=function(){this._audio&&(this._audio.bufferChanged.removeHandler(e._onBufferChanged,this),this._audio.volumeChanged.removeHandler(e._onVolumeChanged,this),this._audio.stop.removeHandler(e._onStop,this),this._audio=null)},e._onBufferChanged=function(t,e){e._rpc.signal(i.SIGNAL_TYPE.waveformAudioBufferChange,{index:e._index,key:t})},e._onVolumeChanged=function(t,e){e._rpc.signal(i.SIGNAL_TYPE.waveformAudioVolumeChange,{index:e._index,value:t})},e._onStop=function(t,e){e._rpc.signal(i.SIGNAL_TYPE.audioStop,e._index)},e.prototype._onGetWaveformAudioParameters=function(){return{volume:this._audio.getVolume()}},e}();r.default=n},{"./messages":145}],145:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RPC_TYPE={emulationPause:"emulation/pause",emulationReset:"emulation/reset",emulationResume:"emulation/resume",emulationSetRateLimit:"emulation/setRateLimit",emulationStart:"emulation/start",emulationStop:"emulation/stop",emulationFetchLastError:"emulation/fetchLastError",getVideoParameters:"video/getParameters",getWaveformAudioParameters:function(t){return"audio/waveform/getParameters/"+t},getPCMAudioParameters:function(t){return"audio/pcm/getParameters/"+t},setup:"/setup"},Object.freeze(r.RPC_TYPE),r.SIGNAL_TYPE={emulationError:"emulation/error",emulationFrequencyUpdate:"emulation/frequencyUpdate",videoNewFrame:"video/newFrame",videoReturnSurface:"video/returnSurface",controlStateUpdate:"control/stateUpdate",waveformAudioVolumeChange:"audio/waveform/volumeChange",waveformAudioBufferChange:"audio/waveform/bufferChange",pcmAudioNewFrame:function(t){return"audio/pcm/newFrame/"+t},pcmAudioTogglePause:function(t){return"audio/pcm/togglePause/"+t},pcmAudioReturnFrame:function(t){return"audio/pcm/returnFrame/"+t},audioStop:"audio/stop"},Object.freeze(r.SIGNAL_TYPE)},{}],146:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("../rpc");new(t("../../../src/web/stella/service/worker/EmulationBackend").default)(i.getRpc()).startup()},{"../../../src/web/stella/service/worker/EmulationBackend":141,"../rpc":147}],147:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t("worker-rpc"),n=null,s=null,a=null;(n=new i.RpcProvider(function(t,e){s?s.postMessage(t,e):postMessage(t,e),a&&((s=a).onmessage=function(t){return n.dispatch(t.data)}),a=null})).error.addHandler(function(t){console.log(t?t.message:"unknown rpc error")}),onmessage=function(t){return s||n.dispatch(t.data)},n.registerRpcHandler("/use-port",function(t){return s||a?Promise.reject("RPC already switched to message port"):(a=t,Promise.resolve())}),r.getRpc=function(){return n}},{"worker-rpc":22}]},{},[146]);
//# sourceMappingURL=stellerator_worker.min.js.map