
/*
 *   This file is part of 6502.ts, an emulator for 6502 based systems built
 *   in Typescript.
 *
 *   Copyright (C) 2014 - 2018 Christian Speckner & contributors
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   Please go to the project's github page at
 *
 *   https://github.com/6502ts/6502.ts
 *
 *   for more details and for a copy of the GNU General Public License v2.
 */

!function s(a,o,u){function c(t,e){if(!o[t]){if(!a[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(h)return h(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var n=o[t]={exports:{}};a[t][0].call(n.exports,function(e){return c(a[t][1][e]||e)},n,n.exports,s,a,o,u)}return o[t].exports}for(var h="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var t=this,e=new Promise(function(e){return t._queue.push(e)});return this._pending||this._dispatchNext(),e},e.prototype.runExclusive=function(i){return this.acquire().then(function(t){var e;try{e=i()}catch(e){throw t(),e}return Promise.resolve(e).then(function(e){return t(),e},function(e){throw t(),e})})},e.prototype._dispatchNext=function(){0<this._queue.length?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}();i.default=r},{}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./Mutex");i.Mutex=r.default},{"./Mutex":1}],3:[function(e,t,i){},{}],4:[function(e,t,i){arguments[4][3][0].apply(i,arguments)},{dup:3}],5:[function(e,t,i){"use strict";var r=[];function n(e){return r[e]||(r[e]=function(e){for(var t="return function dispatcher"+e+"(payload) {\n",i=[],r=[],n=0;n<e;n++)i.push("cb"+n),r.push("ctx"+n),t+="    cb"+n+"(payload, ctx"+n+");\n";return t+="};",new(Function.bind.apply(Function,[void 0].concat(i.concat(r),[t])))}(e)),r[e]}r[0]=function(){return function(){}},r[1]=function(t,i){return void 0===i?t:function(e){t(e,i)}};var s=function(){function e(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return e.prototype.addHandler=function(e,t){return this.isHandlerAttached(e,t)||(this._handlers.push(e),this._contexts.push(t),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.removeHandler=function(e,t){var i=this._getHandlerIndex(e,t);return void 0!==i&&(this._handlers.splice(i,1),this._contexts.splice(i,1),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.isHandlerAttached=function(e,t){return void 0!==this._getHandlerIndex(e,t)},e.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},e.prototype._getHandlerIndex=function(e,t){var i,r=this._handlers.length;for(i=0;i<r&&(this._handlers[i]!==e||this._contexts[i]!==t);i++);return i<r?i:void 0},e.prototype._createDispatcher=function(){this.dispatch=n(this._handlers.length).apply(this,this._handlers.concat(this._contexts))},e}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=s},{}],6:[function(e,t,i){"use strict";var r=e("./Event");i.Event=r.default},{"./Event":5}],7:[function(e,t,c){(function(n){function s(e,t){for(var i=0,r=e.length-1;0<=r;r--){var n=e[r];"."===n?e.splice(r,1):".."===n?(e.splice(r,1),i++):i&&(e.splice(r,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function a(e,t){if(e.filter)return e.filter(t);for(var i=[],r=0;r<e.length;r++)t(e[r],r,e)&&i.push(e[r]);return i}c.resolve=function(){for(var e="",t=!1,i=arguments.length-1;-1<=i&&!t;i--){var r=0<=i?arguments[i]:n.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(e=r+"/"+e,t="/"===r.charAt(0))}return(t?"/":"")+(e=s(a(e.split("/"),function(e){return!!e}),!t).join("/"))||"."},c.normalize=function(e){var t=c.isAbsolute(e),i="/"===r(e,-1);return(e=s(a(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},c.isAbsolute=function(e){return"/"===e.charAt(0)},c.join=function(){var e=Array.prototype.slice.call(arguments,0);return c.normalize(a(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},c.relative=function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;0<=i&&""===e[i];i--);return i<t?[]:e.slice(t,i-t+1)}e=c.resolve(e).substr(1),t=c.resolve(t).substr(1);for(var r=i(e.split("/")),n=i(t.split("/")),s=Math.min(r.length,n.length),a=s,o=0;o<s;o++)if(r[o]!==n[o]){a=o;break}var u=[];for(o=a;o<r.length;o++)u.push("..");return(u=u.concat(n.slice(a))).join("/")},c.sep="/",c.delimiter=":",c.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,r=-1,n=!0,s=e.length-1;1<=s;--s)if(47===(t=e.charCodeAt(s))){if(!n){r=s;break}}else n=!1;return-1===r?i?"/":".":i&&1===r?"/":e.slice(0,r)},c.basename=function(e,t){var i=function(e){"string"!=typeof e&&(e+="");var t,i=0,r=-1,n=!0;for(t=e.length-1;0<=t;--t)if(47===e.charCodeAt(t)){if(!n){i=t+1;break}}else-1===r&&(n=!1,r=t+1);return-1===r?"":e.slice(i,r)}(e);return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},c.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,i=0,r=-1,n=!0,s=0,a=e.length-1;0<=a;--a){var o=e.charCodeAt(a);if(47!==o)-1===r&&(n=!1,r=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!n){i=a+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===i+1?"":e.slice(t,r)};var r="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,e("_process"))},{_process:8}],8:[function(e,t,i){var r,n,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var c,h=[],l=!1,f=-1;function _(){l&&c&&(l=!1,c.length?h=c.concat(h):f=-1,h.length&&d())}function d(){if(!l){var e=u(_);l=!0;for(var t=h.length;t;){for(c=h,h=[];++f<t;)c&&c[f].run();f=-1,t=h.length}c=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new p(e,t)),1!==h.length||l||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],9:[function(e,t,i){var r=e("./lib/alea"),n=e("./lib/xor128"),s=e("./lib/xorwow"),a=e("./lib/xorshift7"),o=e("./lib/xor4096"),u=e("./lib/tychei"),c=e("./seedrandom");c.alea=r,c.xor128=n,c.xorwow=s,c.xorshift7=a,c.xor4096=o,c.tychei=u,t.exports=c},{"./lib/alea":10,"./lib/tychei":11,"./lib/xor128":12,"./lib/xor4096":13,"./lib/xorshift7":14,"./lib/xorwow":15,"./seedrandom":16}],10:[function(e,t,i){!function(e,t,i){function s(e){var r,t=this,i=(r=4022871197,function(e){e=e.toString();for(var t=0;t<e.length;t++){var i=.02519603282416938*(r+=e.charCodeAt(t));i-=r=i>>>0,r=(i*=r)>>>0,r+=4294967296*(i-=r)}return 2.3283064365386963e-10*(r>>>0)});t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=i(" "),t.s1=i(" "),t.s2=i(" "),t.s0-=i(e),t.s0<0&&(t.s0+=1),t.s1-=i(e),t.s1<0&&(t.s1+=1),t.s2-=i(e),t.s2<0&&(t.s2+=1),i=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function r(e,t){var i=new s(e),r=t&&t.state,n=i.next;return n.int32=function(){return 4294967296*i.next()|0},n.double=function(){return n()+11102230246251565e-32*(2097152*n()|0)},n.quick=n,r&&("object"==typeof r&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.alea=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],11:[function(e,t,i){!function(e,t,i){function s(e){var n=this,t="";n.next=function(){var e=n.b,t=n.c,i=n.d,r=n.a;return e=e<<25^e>>>7^t,t=t-i|0,i=i<<24^i>>>8^r,r=r-e|0,n.b=e=e<<20^e>>>12^t,n.c=t=t-i|0,n.d=i<<16^t>>>16^r,n.a=r-e|0},n.a=0,n.b=0,n.c=-1640531527,n.d=1367130551,e===Math.floor(e)?(n.a=e/4294967296|0,n.b=0|e):t+=e;for(var i=0;i<t.length+20;i++)n.b^=0|t.charCodeAt(i),n.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function r(e,t){var i=new s(e),r=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.tychei=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],12:[function(e,t,i){!function(e,t,i){function s(e){var t=this,i="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:i+=e;for(var r=0;r<i.length+64;r++)t.x^=0|i.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function r(e,t){var i=new s(e),r=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.xor128=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],13:[function(e,t,i){!function(e,t,i){function s(e){var s=this;s.next=function(){var e,t,i=s.w,r=s.X,n=s.i;return s.w=i=i+1640531527|0,t=r[n+34&127],e=r[n=n+1&127],t^=t<<13,e^=e<<17,t^=t>>>15,e^=e>>>12,t=r[n]=t^e,s.i=n,t+(i^i>>>16)|0},function(e,t){var i,r,n,s,a,o=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),n=0,s=-32;s<u;++s)t&&(r^=t.charCodeAt((s+32)%t.length)),0===s&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,0<=s&&(a=a+1640531527|0,n=0==(i=o[127&s]^=r+a)?n+1:0);for(128<=n&&(o[127&(t&&t.length||0)]=-1),n=127,s=512;0<s;--s)r=o[n+34&127],i=o[n=n+1&127],r^=r<<13,i^=i<<17,r^=r>>>15,i^=i>>>12,o[n]=r^i;e.w=a,e.X=o,e.i=n}(s,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function r(e,t){null==e&&(e=+new Date);var i=new s(e),r=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},n.int32=i.next,n.quick=n,r&&(r.X&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.xor4096=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],14:[function(e,t,i){!function(e,t,i){function s(e){var n=this;n.next=function(){var e,t,i=n.x,r=n.i;return e=i[r],t=(e^=e>>>7)^e<<24,t^=(e=i[r+1&7])^e>>>10,t^=(e=i[r+3&7])^e>>>3,t^=(e=i[r+4&7])^e<<7,e=i[r+7&7],t^=(e^=e<<13)^e<<9,i[r]=t,n.i=r+1&7,t},function(e,t){var i,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,i=0;i<t.length;++i)r[7&i]=r[7&i]<<15^t.charCodeAt(i)+r[i+1&7]<<13;for(;r.length<8;)r.push(0);for(i=0;i<8&&0===r[i];++i);for(8==i?r[7]=-1:r[i],e.x=r,e.i=0,i=256;0<i;--i)e.next()}(n,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function r(e,t){null==e&&(e=+new Date);var i=new s(e),r=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},n.int32=i.next,n.quick=n,r&&(r.x&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.xorshift7=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],15:[function(e,t,i){!function(e,t,i){function s(e){var t=this,i="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,e===((t.v=0)|e)?t.x=e:i+=e;for(var r=0;r<i.length+64;r++)t.x^=0|i.charCodeAt(r),r==i.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function r(e,t){var i=new s(e),r=t&&t.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&a(r,i),n.state=function(){return a(i,{})}),n}t&&t.exports?t.exports=r:i&&i.amd?i(function(){return r}):this.xorwow=r}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],16:[function(t,i,e){!function(o,u){var c,h=this,l=256,f=6,_="random",d=u.pow(l,f),p=u.pow(2,52),g=2*p,b=l-1;function e(e,t,i){var r=[],n=k(function e(t,i){var r,n=[],s=typeof t;if(i&&"object"==s)for(r in t)try{n.push(e(t[r],i-1))}catch(e){}return n.length?n:"string"==s?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(o)]:null==e?function(){try{var e;return c&&(e=c.randomBytes)?e=e(l):(e=new Uint8Array(l),(h.crypto||h.msCrypto).getRandomValues(e)),v(e)}catch(e){var t=h.navigator,i=t&&t.plugins;return[+new Date,h,i,h.screen,v(o)]}}():e,3),r),s=new m(r),a=function(){for(var e=s.g(f),t=d,i=0;e<p;)e=(e+i)*l,t*=l,i=s.g(1);for(;g<=e;)e/=2,t/=2,i>>>=1;return(e+i)/t};return a.int32=function(){return 0|s.g(4)},a.quick=function(){return s.g(4)/4294967296},a.double=a,k(v(s.S),o),(t.pass||i||function(e,t,i,r){return r&&(r.S&&y(r,s),e.state=function(){return y(s,{})}),i?(u[_]=e,t):e})(a,n,"global"in t?t.global:this==u,t.state)}function m(e){var t,i=e.length,a=this,r=0,n=a.i=a.j=0,s=a.S=[];for(i||(e=[i++]);r<l;)s[r]=r++;for(r=0;r<l;r++)s[r]=s[n=b&n+e[r%i]+(t=s[r])],s[n]=t;(a.g=function(e){for(var t,i=0,r=a.i,n=a.j,s=a.S;e--;)t=s[r=b&r+1],i=i*l+s[b&(s[r]=s[n=b&n+t])+(s[n]=t)];return a.i=r,a.j=n,i})(l)}function y(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function k(e,t){for(var i,r=e+"",n=0;n<r.length;)t[b&n]=b&(i^=19*t[b&n])+r.charCodeAt(n++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(u["seed"+_]=e,k(u.random(),o),"object"==typeof i&&i.exports){i.exports=e;try{c=t("crypto")}catch(e){}}else"function"==typeof define&&define.amd&&define(function(){return e})}([],Math)},{crypto:3}],17:[function(e,t,i){var r,n;r=this,n=function(){"use strict";var r=function(){return this||(0,eval)("this")}(),e=!(r.navigator&&/Trident|Edge/.test(r.navigator.userAgent)),t=1,i=!1,n={};function s(e){var t=Array.prototype.slice.call(arguments,1),i=t.length;return i?1===i?function(){return e.call(void 0,t[0])}:2===i?function(){return e.call(void 0,t[0],t[1])}:3===i?function(){return e.call(void 0,t[0],t[1],t[2])}:function(){return e.apply(void 0,t)}:function(){return e.call(void 0)}}function a(e){return n[t]=s.apply(void 0,e),t++}function o(e){delete n[e]}function u(e){if(i)r.setTimeout(s(u,e),0);else{var t=n[e];if(t){i=!0;try{t()}finally{o(e),i=!1}}}}function c(){var e=function(){var e=a(arguments);return r.setTimeout(s(u,e),0),e};return e.usePolifill="setTimeout",e}var h=Object.freeze({init:c,canUse:function(){return"setTimeout"in r}});var l=[Object.freeze({init:function(){var e=function(){var e=a(arguments);return r.process.nextTick(s(u,e)),e};return e.usePolifill="nextTick",e},canUse:function(){return"[object process]"===Object.prototype.toString.call(r.process)}}),Object.freeze({init:function(){var t="setImmediate$"+Math.random()+"$",e=function(e){e.source===r&&"string"==typeof e.data&&0===e.data.indexOf(t)&&u(Number(e.data.slice(t.length)))};r.addEventListener?r.addEventListener("message",e,!1):r.attachEvent("onmessage",e);var i=function(){var e=a(arguments);return r.postMessage(t+e,"*"),e};return i.usePolifill="postMessage",i},canUse:function(){if(r.importScripts||!r.postMessage)return!1;if(r.navigator&&/Chrome/.test(r.navigator.userAgent))return!1;var e=!0,t=r.onmessage;return r.onmessage=function(){e=!1},r.postMessage("","*"),r.onmessage=t,e}}),Object.freeze({init:function(){var t=new r.MessageChannel;t.port1.onmessage=function(e){u(Number(e.data))};var e=function(){var e=a(arguments);return t.port2.postMessage(e),e};return e.usePolifill="messageChannel",e},canUse:function(){return Boolean(r.MessageChannel)}}),Object.freeze({init:function(){var i=r.document.documentElement,e=function(){var e=a(arguments),t=r.document.createElement("script");return t.onreadystatechange=function(){u(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t),e};return e.usePolifill="readyStateChange",e},canUse:function(){return r.document&&"onreadystatechange"in r.document.createElement("script")}})],f=e?r.setImmediate||r.msSetImmediate||function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.canUse())return r.init()}return t.init()}(l,h):c(),_=e&&(r.clearImmediate||r.msClearImmediate)||o;return{setImmediate:f,clearImmediate:_,polifill:function(){r.setImmediate!==f&&(r.setImmediate=f,r.msSetImmediate=f,r.clearImmediate=_,r.msClearImmediate=_)}}},"object"==typeof i&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):r.immediate=n()},{}],18:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./native/thumbulator"),s=function(){function e(e,t){void 0===t&&(t={}),this._module=null,this._options=null,this._options=r.__assign({stopAddress:0},t),this._module=n(this._getApi(e,this._options)),this.enableDebug(!1)}return e.prototype.init=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this._module._set_stop_address(this._options.stopAddress),[2]})})},e.prototype.ping=function(){return this._module.ccall("ping","string",[],[])},e.prototype.run=function(e){return this._module._run(e)},e.prototype.abort=function(){this._module._abort_run()},e.prototype.enableDebug=function(e){this._module._enable_debug(e?1:0)},e.prototype.reset=function(){this._module._reset()},e.prototype.readRegister=function(e){if(e<0||15<e)throw new Error("illegal thumb register "+e);return this._module._read_register(e)},e.prototype.writeRegister=function(e,t){if(e<0||15<e)throw new Error("illegal thumb register "+e);this._module._write_register(e,t)},e.prototype._getApi=function(i,e){var t=e.printer||function(e){return console.log("thumbulator: "+e)};return{print:t,printErr:t,trapOnInstructionFetch:e.trapOnInstructionFetch||function(){return 0},trapOnBx32:e.trapOnBx32||function(){return 3},busRead16:i.read16,busRead32:i.read32||function(e){return 65535&i.read16(e)|i.read16(e+2)<<16},busWrite16:i.write16,busWrite32:i.write32||function(e,t){return i.write16(e,65535&t),i.write16(e+2,t>>>16)}}},e}();i.default=s},{"./native/thumbulator":19,tslib:20}],19:[function(require,module,exports){(function(process){var Module=function(Module){Module=Module||{};var Module=Module,Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1,nodeFS,nodePath;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE)Module.print||(Module.print=console.log),Module.printErr||(Module.printErr=console.warn),Module.read=function(e,t){nodeFS||(nodeFS=require("fs")),nodePath||(nodePath=require("path")),e=nodePath.normalize(e);var i=nodeFS.readFileSync(e);return t?i:i.toString()},Module.readBinary=function(e){var t=Module.read(e,!0);return t.buffer||(t=new Uint8Array(t)),assert(t.buffer),t},Module.load=function(e){globalEval(read(e))},Module.thisProgram||(1<process.argv.length?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),Module.inspect=function(){return"[Emscripten Module object]"};else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available"},Module.readBinary=function(e){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));var t=read(e,"binary");return assert("object"==typeof t),t},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments),"function"==typeof quit&&(Module.quit=function(e,t){quit(e)});else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Module.readAsync=function(e,t,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):i()},r.onerror=i,r.send(null)},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(e){console.log(e)}),Module.printErr||(Module.printErr=function(e){console.warn(e)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(e){dump(e)}:function(e){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),void 0===Module.setWindowTitle&&(Module.setWindowTitle=function(e){document.title=e})}function globalEval(e){eval.call(null,e)}for(var key in!Module.load&&Module.read&&(Module.load=function(e){globalEval(Module.read(e))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.quit||(Module.quit=function(e,t){throw t}),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[],moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var Runtime={setTempRet0:function(e){return tempRet0=e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return Runtime.QUANTUM_SIZE;if("i"===e[0]){var t=parseInt(e.substr(1));return assert(t%8==0),t/8}return 0}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},getAlignSize:function(e,t,i){return i||"i64"!=e&&"double"!=e?e?Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE):Math.min(t,8):8},dynCall:function(e,t,i){return i&&i.length?Module["dynCall_"+e].apply(null,[t].concat(i)):Module["dynCall_"+e].call(null,t)},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++)if(!Runtime.functionPointers[t])return Runtime.functionPointers[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[e]||(Runtime.warnOnce.shown[e]=1,Module.printErr(e))},funcWrappers:{},getFuncWrapper:function(t,i){if(t){assert(i),Runtime.funcWrappers[i]||(Runtime.funcWrappers[i]={});var e=Runtime.funcWrappers[i];return e[t]||(1===i.length?e[t]=function(){return Runtime.dynCall(i,t)}:2===i.length?e[t]=function(e){return Runtime.dynCall(i,t,[e])}:e[t]=function(){return Runtime.dynCall(i,t,Array.prototype.slice.call(arguments))}),e[t]}},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;return STACKTOP=(STACKTOP=STACKTOP+e|0)+15&-16,t},staticAlloc:function(e){var t=STATICTOP;return STATICTOP=(STATICTOP=STATICTOP+e|0)+15&-16,t},dynamicAlloc:function(e){var t=HEAP32[DYNAMICTOP_PTR>>2],i=-16&(t+e+15|0);if((HEAP32[DYNAMICTOP_PTR>>2]=i,TOTAL_MEMORY<=i)&&!enlargeMemory())return HEAP32[DYNAMICTOP_PTR>>2]=t,0;return t},alignMemory:function(e,t){return e=Math.ceil(e/(t||16))*(t||16)},makeBigInt:function(e,t,i){return i?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=0,EXITSTATUS=0,cwrap,ccall;function assert(e,t){e||abort("Assertion failed: "+t)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(e){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(e,t,i,r){switch("*"===(i=i||"i8").charAt(i.length-1)&&(i="i32"),i){case"i1":case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,1<=+Math_abs(tempDouble)?0<tempDouble?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+i)}}function getValue(e,t,i){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}!function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);return writeArrayToMemory(e,t),t},stringToC:function(e){var t=0;if(null!=e&&0!==e){var i=1+(e.length<<2);stringToUTF8(e,t=Runtime.stackAlloc(i),i)}return t}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(e,t,i,r,n){var s=getCFunc(e),a=[],o=0;if(r)for(var u=0;u<r.length;u++){var c=toC[i[u]];c?(0===o&&(o=Runtime.stackSave()),a[u]=c(r[u])):a[u]=r[u]}var h=s.apply(null,a);if("string"===t&&(h=Pointer_stringify(h)),0!==o){if(n&&n.async)return void EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(o)});Runtime.stackRestore(o)}return h};var sourceRegex=/^function\s*[a-zA-Z$_0-9]*\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}var JSsource=null;function ensureJSsource(){if(!JSsource)for(var e in JSsource={},JSfuncs)JSfuncs.hasOwnProperty(e)&&(JSsource[e]=parseJSFunc(JSfuncs[e]))}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(e){return"number"===e}),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(e,t){return"$"+t}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){ensureJSsource(),funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"=("+convertCode.returnValue+");"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(ensureJSsource(),funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.ccall=ccall,Module.cwrap=cwrap,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(e,t,i,r){var n,s;"number"==typeof e?(n=!0,s=e):(n=!1,s=e.length);var a,o="string"==typeof t?t:null;if(a=i==ALLOC_NONE?r:["function"==typeof _malloc?_malloc:Runtime.staticAlloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===i?ALLOC_STATIC:i](Math.max(s,o?1:t.length)),n){var u;r=a;for(assert(0==(3&a)),u=a+(-4&s);r<u;r+=4)HEAP32[r>>2]=0;for(u=a+s;r<u;)HEAP8[r++>>0]=0;return a}if("i8"===o)return e.subarray||e.slice?HEAPU8.set(e,a):HEAPU8.set(new Uint8Array(e),a),a;for(var c,h,l,f=0;f<s;){var _=e[f];"function"==typeof _&&(_=Runtime.getFunctionIndex(_)),0!==(c=o||t[f])?("i64"==c&&(c="i32"),setValue(a+f,_,c),l!==c&&(h=Runtime.getNativeTypeSize(c),l=c),f+=h):f++}return a}function getMemory(e){return staticSealed?runtimeInitialized?_malloc(e):Runtime.dynamicAlloc(e):Runtime.staticAlloc(e)}function Pointer_stringify(e,t){if(0===t||!e)return"";for(var i,r=0,n=0;r|=i=HEAPU8[e+n>>0],(0!=i||t)&&(n++,!t||n!=t););t||(t=n);var s="";if(r<128){for(var a;0<t;)a=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,1024))),s=s?s+a:a,e+=1024,t-=1024;return s}return Module.UTF8ToString(e)}function AsciiToString(e){for(var t="";;){var i=HEAP8[e++>>0];if(!i)return t;t+=String.fromCharCode(i)}}function stringToAscii(e,t){return writeAsciiToMemory(e,t,!1)}Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.getMemory=getMemory,Module.Pointer_stringify=Pointer_stringify,Module.AsciiToString=AsciiToString,Module.stringToAscii=stringToAscii;var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(e,t){for(var i=t;e[i];)++i;if(16<i-t&&e.subarray&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(t,i));for(var r,n,s,a,o,u="";;){if(!(r=e[t++]))return u;if(128&r)if(n=63&e[t++],192!=(224&r))if(s=63&e[t++],224==(240&r)?r=(15&r)<<12|n<<6|s:(a=63&e[t++],240==(248&r)?r=(7&r)<<18|n<<12|s<<6|a:(o=63&e[t++],r=248==(252&r)?(3&r)<<24|n<<18|s<<12|a<<6|o:(1&r)<<30|n<<24|s<<18|a<<12|o<<6|63&e[t++])),r<65536)u+=String.fromCharCode(r);else{var c=r-65536;u+=String.fromCharCode(55296|c>>10,56320|1023&c)}else u+=String.fromCharCode((31&r)<<6|n);else u+=String.fromCharCode(r)}}function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}function stringToUTF8Array(e,t,i,r){if(!(0<r))return 0;for(var n=i,s=i+r-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(55296<=o&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(s<=i)break;t[i++]=o}else if(o<=2047){if(s<=i+1)break;t[i++]=192|o>>6,t[i++]=128|63&o}else if(o<=65535){if(s<=i+2)break;t[i++]=224|o>>12,t[i++]=128|o>>6&63,t[i++]=128|63&o}else if(o<=2097151){if(s<=i+3)break;t[i++]=240|o>>18,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}else if(o<=67108863){if(s<=i+4)break;t[i++]=248|o>>24,t[i++]=128|o>>18&63,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}else{if(s<=i+5)break;t[i++]=252|o>>30,t[i++]=128|o>>24&63,t[i++]=128|o>>18&63,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}}return t[i]=0,i-n}function stringToUTF8(e,t,i){return stringToUTF8Array(e,HEAPU8,t,i)}function lengthBytesUTF8(e){for(var t=0,i=0;i<e.length;++i){var r=e.charCodeAt(i);55296<=r&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++i)),r<=127?++t:t+=r<=2047?2:r<=65535?3:r<=2097151?4:r<=67108863?5:6}return t}Module.UTF8ArrayToString=UTF8ArrayToString,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8Array=stringToUTF8Array,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8;var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR;function demangle(e){var t=Module.___cxa_demangle||Module.__cxa_demangle;if(t){try{var i=e.substr(1),r=lengthBytesUTF8(i)+1,n=_malloc(r);stringToUTF8(i,n,r);var s=_malloc(4),a=t(n,0,0,s);if(0===getValue(s,"i32")&&a)return Pointer_stringify(a)}catch(e){}finally{n&&_free(n),s&&_free(s),a&&_free(a)}return e}return Runtime.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function stackTrace(){var e=jsStackTrace();return Module.extraStackTrace&&(e+="\n"+Module.extraStackTrace()),demangleAll(e)}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or (4) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){abortOnCannotGrowMemory()}Module.stackTrace=stackTrace,STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1;var TOTAL_STACK=Module.TOTAL_STACK||10240,TOTAL_MEMORY=Module.TOTAL_MEMORY||16777216;function getTotalMemory(){return TOTAL_MEMORY}if(TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")"),buffer=Module.buffer?Module.buffer:new ArrayBuffer(TOTAL_MEMORY),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(e){for(;0<e.length;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?Module.dynCall_v(i):Module.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t()}}Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}function addOnInit(e){__ATINIT__.unshift(e)}function addOnPreMain(e){__ATMAIN__.unshift(e)}function addOnExit(e){__ATEXIT__.unshift(e)}function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}function intArrayFromString(e,t,i){var r=0<i?i:lengthBytesUTF8(e)+1,n=new Array(r),s=stringToUTF8Array(e,n,0,n.length);return t&&(n.length=s),n}function intArrayToString(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];255<r&&(r&=255),t.push(String.fromCharCode(r))}return t.join("")}function writeStringToMemory(e,t,i){var r,n;Runtime.warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!"),i&&(n=t+lengthBytesUTF8(e),r=HEAP8[n]),stringToUTF8(e,t,1/0),i&&(HEAP8[n]=r)}function writeArrayToMemory(e,t){HEAP8.set(e,t)}function writeAsciiToMemory(e,t,i){for(var r=0;r<e.length;++r)HEAP8[t++>>0]=e.charCodeAt(r);i||(HEAP8[t>>0]=0)}Module.addOnPreRun=addOnPreRun,Module.addOnInit=addOnInit,Module.addOnPreMain=addOnPreMain,Module.addOnExit=addOnExit,Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var i=65535&e,r=65535&t;return i*r+((e>>>16)*r+i*(t>>>16)<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;t<32;t++)if(e&1<<31-t)return t;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Math.trunc=Math.trunc;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(e){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var t=dependenciesFulfilled;dependenciesFulfilled=null,t()}}Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var ASM_CONSTS=[function(e){return Module.trapOnInstructionFetch(e)},function(e){return Module.busRead32(e)},function(e,t){Module.busWrite32(e,t)},function(e){return Module.busRead16(e)},function(e,t){return Module.trapOnBx32(e,t)},function(e,t){Module.busWrite16(e,t)}];function _emscripten_asm_const_ii(e,t){return ASM_CONSTS[e](t)}function _emscripten_asm_const_iii(e,t,i){return ASM_CONSTS[e](t,i)}STATIC_BASE=Runtime.GLOBAL_BASE,STATICTOP=STATIC_BASE+5312,__ATINIT__.push(),allocate([12,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,189,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,156,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,116,104,117,109,98,117,108,97,116,111,114,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,49,54,40,36,48,41,59,32,125,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,51,50,40,36,48,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,49,54,40,36,48,44,32,36,49,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,51,50,40,36,48,44,32,36,49,41,59,32,125,0,112,99,32,104,97,115,32,108,115,98,105,116,32,115,101,116,32,48,120,37,48,56,88,10,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,116,114,97,112,79,110,73,110,115,116,114,117,99,116,105,111,110,70,101,116,99,104,40,36,48,41,59,32,125,0,45,45,45,32,48,120,37,48,56,88,58,32,48,120,37,48,52,88,32,0,97,100,99,32,114,37,117,44,114,37,117,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,100,100,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,97,100,100,32,114,37,117,44,114,37,117,10,0,97,100,100,32,112,99,44,46,46,46,32,112,114,111,100,117,99,101,100,32,97,110,32,97,114,109,32,97,100,100,114,101,115,115,32,48,120,37,48,56,88,32,48,120,37,48,56,88,10,0,97,100,100,32,114,37,117,44,80,67,44,35,48,120,37,48,50,88,10,0,97,100,100,32,114,37,117,44,83,80,44,35,48,120,37,48,50,88,10,0,97,100,100,32,83,80,44,35,48,120,37,48,50,88,10,0,97,110,100,115,32,114,37,117,44,114,37,117,10,0,97,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,115,114,115,32,114,37,117,44,114,37,117,10,0,98,101,113,32,48,120,37,48,56,88,10,0,98,110,101,32,48,120,37,48,56,88,10,0,98,99,115,32,48,120,37,48,56,88,10,0,98,99,99,32,48,120,37,48,56,88,10,0,98,109,105,32,48,120,37,48,56,88,10,0,98,112,108,32,48,120,37,48,56,88,10,0,98,118,115,32,48,120,37,48,56,88,10,0,98,118,99,32,48,120,37,48,56,88,10,0,98,104,105,32,48,120,37,48,56,88,10,0,98,108,115,32,48,120,37,48,56,88,10,0,98,103,101,32,48,120,37,48,56,88,10,0,98,108,116,32,48,120,37,48,56,88,10,0,98,103,116,32,48,120,37,48,56,88,10,0,98,108,101,32,48,120,37,48,56,88,10,0,66,32,48,120,37,48,56,88,10,0,98,105,99,115,32,114,37,117,44,114,37,117,10,0,98,107,112,116,32,48,120,37,48,50,88,10,0,98,108,32,48,120,37,48,56,88,10,0,98,108,120,32,114,37,117,10,0,99,97,110,110,111,116,32,98,114,97,110,99,104,32,116,111,32,97,114,109,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,98,120,32,114,37,117,10,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,116,114,97,112,79,110,66,120,51,50,40,36,48,44,32,36,49,41,59,32,125,0,99,109,110,115,32,114,37,117,44,114,37,117,10,0,99,109,112,32,114,37,117,44,35,48,120,37,48,50,88,10,0,99,109,112,115,32,114,37,117,44,114,37,117,10,0,99,112,115,32,84,79,68,79,10,0,99,112,121,32,114,37,117,44,114,37,117,10,0,101,111,114,115,32,114,37,117,44,114,37,117,10,0,108,100,109,105,97,32,114,37,117,33,44,123,0,114,37,117,0,125,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,32,114,37,117,44,91,80,67,43,35,48,120,37,88,93,32,0,59,64,32,48,120,37,88,10,0,108,100,114,32,114,37,117,44,91,83,80,43,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,115,108,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,108,115,32,114,37,117,44,114,37,117,10,0,108,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,114,115,32,114,37,117,44,114,37,117,10,0,109,111,118,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,109,111,118,115,32,114,37,117,44,114,37,117,10,0,109,111,118,32,114,37,117,44,114,37,117,10,0,109,117,108,115,32,114,37,117,44,114,37,117,10,0,109,118,110,115,32,114,37,117,44,114,37,117,10,0,110,101,103,115,32,114,37,117,44,114,37,117,10,0,111,114,114,115,32,114,37,117,44,114,37,117,10,0,112,111,112,32,123,0,112,99,0,112,111,112,32,123,114,99,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,112,117,115,104,32,123,0,108,114,0,112,117,115,104,32,123,108,114,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,114,101,118,32,114,37,117,44,114,37,117,10,0,114,101,118,49,54,32,114,37,117,44,114,37,117,10,0,114,101,118,115,104,32,114,37,117,44,114,37,117,10,0,114,111,114,115,32,114,37,117,44,114,37,117,10,0,115,98,99,32,114,37,117,44,114,37,117,10,0,115,101,116,101,110,100,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,10,0,115,116,109,105,97,32,114,37,117,33,44,123,0,115,116,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,32,114,37,117,44,91,83,80,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,115,117,98,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,115,117,98,32,83,80,44,35,48,120,37,48,50,88,10,0,115,119,105,32,48,120,37,48,50,88,10,0,10,10,115,119,105,32,48,120,37,48,50,88,10,0,115,120,116,98,32,114,37,117,44,114,37,117,10,0,115,120,116,104,32,114,37,117,44,114,37,117,10,0,116,115,116,32,114,37,117,44,114,37,117,10,0,117,120,116,98,32,114,37,117,44,114,37,117,10,0,117,120,116,104,32,114,37,117,44,114,37,117,10,0,105,110,118,97,108,105,100,32,105,110,115,116,114,117,99,116,105,111,110,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,46,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=STATICTOP;function _emscripten_memcpy_big(e,t,i){return HEAPU8.set(HEAPU8.subarray(t,t+i),e),e}STATICTOP+=16;var SYSCALLS={varargs:0,get:function(e){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();return assert(0<=e?0===t:-1===t),e},getZero:function(){assert(0===SYSCALLS.get())}};function ___syscall6(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.getStreamFromFD();return FS.close(i),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_STATIC);function ___setErrNo(e){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=e),e}function __exit(e){Module.exit(e)}function _exit(e){__exit(e)}function ___syscall140(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.getStreamFromFD(),r=(SYSCALLS.get(),SYSCALLS.get()),n=SYSCALLS.get(),s=SYSCALLS.get(),a=r;return FS.llseek(i,a,s),HEAP32[n>>2]=i.position,i.getdents&&0===a&&0===s&&(i.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___syscall146(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.get(),r=SYSCALLS.get(),n=SYSCALLS.get(),s=0;___syscall146.buffer||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(e,t){var i=___syscall146.buffers[e];assert(i),0===t||10===t?((1===e?Module.print:Module.printErr)(UTF8ArrayToString(i,0)),i.length=0):i.push(t)});for(var a=0;a<n;a++){for(var o=HEAP32[r+8*a>>2],u=HEAP32[r+(8*a+4)>>2],c=0;c<u;c++)___syscall146.printChar(i,HEAPU8[o+c]);s+=u}return s}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function invoke_ii(e,t){try{return Module.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_iiii(e,t,i,r){try{return Module.dynCall_iiii(e,t,i,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}__ATEXIT__.push(function(){var e=Module._fflush;e&&e(0);var t=___syscall146.printChar;if(t){var i=___syscall146.buffers;i[1].length&&t(1,10),i[2].length&&t(2,10)}}),DYNAMICTOP_PTR=allocate(1,"i32",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=Runtime.alignMemory(STACK_MAX),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0,Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_ii:invoke_ii,invoke_iiii:invoke_iiii,_emscripten_asm_const_ii:_emscripten_asm_const_ii,___syscall6:___syscall6,___setErrNo:___setErrNo,___syscall146:___syscall146,_emscripten_memcpy_big:_emscripten_memcpy_big,___syscall140:___syscall140,_exit:_exit,__exit:__exit,_emscripten_asm_const_iii:_emscripten_asm_const_iii,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,cttz_i8:cttz_i8};var asm=function(e,t,i){"use asm";var A=new e.Int8Array(i);var k=new e.Int16Array(i);var M=new e.Int32Array(i);var T=new e.Uint8Array(i);var r=new e.Uint16Array(i);var n=new e.Uint32Array(i);var h=new e.Float32Array(i);var v=new e.Float64Array(i);var s=t.DYNAMICTOP_PTR|0;var a=t.tempDoublePtr|0;var o=t.ABORT|0;var P=t.STACKTOP|0;var u=t.STACK_MAX|0;var c=t.cttz_i8|0;var l=0;var f=0;var _=0;var d=0;var p=e.NaN,g=e.Infinity;var b=0,m=0,y=0,w=0,C=0.0;var S=0;var E=e.Math.floor;var R=e.Math.abs;var I=e.Math.sqrt;var x=e.Math.pow;var B=e.Math.cos;var F=e.Math.sin;var O=e.Math.tan;var L=e.Math.acos;var D=e.Math.asin;var H=e.Math.atan;var U=e.Math.atan2;var N=e.Math.exp;var j=e.Math.log;var V=e.Math.ceil;var W=e.Math.imul;var Q=e.Math.min;var z=e.Math.max;var q=e.Math.clz32;var Y=t.abort;var K=t.assert;var G=t.enlargeMemory;var J=t.getTotalMemory;var X=t.abortOnCannotGrowMemory;var $=t.invoke_ii;var Z=t.invoke_iiii;var ee=t._emscripten_asm_const_ii;var te=t.___syscall6;var ie=t.___setErrNo;var re=t.___syscall146;var ne=t._emscripten_memcpy_big;var se=t.___syscall140;var ae=t._exit;var oe=t.__exit;var ue=t._emscripten_asm_const_iii;var ce=0.0;function he(e){e=e|0;var t=0;t=P;P=P+e|0;P=P+15&-16;return t|0}function le(){return P|0}function fe(e){e=e|0;P=e}function _e(e,t){e=e|0;t=t|0;P=e;u=t}function de(e,t){e=e|0;t=t|0;if(!l){l=e;f=t}}function pe(e){e=e|0;S=e}function ge(){return S|0}function be(e){e=e|0;M[1162]=e;return}function me(){return 380}function ye(e){e=e|0;var t=0,i=0,r=0,n=0,s=0;M[1163]=0;if(!e){n=0;return n|0}else{t=0;i=0}while(1){s=Me()|0;i=(s|0)==0?i:s;r=(M[1163]|0)!=0;t=t+1|0;if(r|(s|0)==0^1)break;if(t>>>0>=e>>>0){t=0;n=5;break}}if((n|0)==5)return t|0;s=r?10:i;return s|0}function ke(){M[1163]=1;return}function ve(e){e=e|0;A[5300]=e;return}function we(e){e=e|0;var t=0,i=0;i=P;P=P+16|0;t=M[4668+((e&15)<<2)>>2]|0;if((e&15|0)!=15){P=i;return t|0}if(t&1|0){e=M[2]|0;M[i>>2]=t;Ke(e,520,i)|0}t=t&-2;P=i;return t|0}function Ce(e,t){e=e|0;t=t|0;M[4668+((e&15)<<2)>>2]=(e&15|0)==15?t&-2:t;return}function Ae(){M[1164]=4;M[1165]=0;M[1166]=0;M[1183]=0;M[1184]=0;return 0}function Me(){var e=0,t=0,i=0,r=0,n=0,s=0,a=0,o=0,u=0,c=0;c=P;P=P+4848|0;t=M[1182]|0;if(t&1|0){u=M[2]|0;M[c>>2]=t;Ke(u,520,c)|0}e=M[1162]|0;if(!e){e=ee(0,(t&-2)+-2|0)|0;if(e|0){u=e;P=c;return u|0}}else if(((t&-2)+-2|0)==(e|0)){u=20;P=c;return u|0}if((t&-2)>>>0>4026531839&(M[1183]|0)!=0){M[1183]=0;u=M[1180]|0;M[1167]=ee(1,u|0)|0;M[1168]=ee(1,u+4|0)|0;M[1169]=ee(1,u+8|0)|0;M[1170]=ee(1,u+12|0)|0;M[1179]=ee(1,u+16|0)|0;M[1181]=ee(1,u+20|0)|0;i=ee(1,u+24|0)|0;M[1184]=ee(1,u+28|0)|0;M[1180]=u+32}else i=t&-2;e=M[1164]|0;do{if(e&1){t=M[1166]|0;if(!t){M[1166]=M[1165];M[1164]=e|65536;e=e|65536;break}else{M[1166]=t+-1;break}}}while(0);if((e&3|0)==3)if((e&65536|0)!=0&(M[1183]|0)==0){r=M[1180]|0;t=M[1184]|0;e:do{if((r+-4&-268435456|0)==-536870912)switch((r+536813548|0)>>>2|r+536813548<<30|0){case 0:{M[1164]=t&65543;if((e&1|0)!=0|(t&1|0)==0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=t&16777215;break e}case 2:{M[1166]=t&16777215;break e}case 3:break e;default:break e}else ue(2,r+-4|0,t|0)|0}while(0);e:do{if((r+-8&-268435456|0)==-536870912)switch((r+536813544|0)>>>2|r+536813544<<30|0){case 0:{u=M[1164]|0;M[1164]=i&65543;if((i&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=i&16777215;break e}case 2:{M[1166]=i&16777215;break e}case 3:break e;default:break e}else ue(2,r+-8|0,i|0)|0}while(0);e=M[1181]|0;e:do{if((r+-12&-268435456|0)==-536870912)switch((r+536813540|0)>>>2|r+536813540<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-12|0,e|0)|0}while(0);e=M[1179]|0;e:do{if((r+-16&-268435456|0)==-536870912)switch((r+536813536|0)>>>2|r+536813536<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-16|0,e|0)|0}while(0);e=M[1170]|0;e:do{if((r+-20&-268435456|0)==-536870912)switch((r+536813532|0)>>>2|r+536813532<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-20|0,e|0)|0}while(0);e=M[1169]|0;e:do{if((r+-24&-268435456|0)==-536870912)switch((r+536813528|0)>>>2|r+536813528<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-24|0,e|0)|0}while(0);e=M[1168]|0;e:do{if((r+-28&-268435456|0)==-536870912)switch((r+536813524|0)>>>2|r+536813524<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-28|0,e|0)|0}while(0);e=M[1167]|0;e:do{if((r+-32&-268435456|0)==-536870912)switch((r+536813520|0)>>>2|r+536813520<<30|0){case 0:{u=M[1164]|0;M[1164]=e&65543;if((e&1|0)==0|(u&1|0)!=0)break e;M[1166]=M[1165];break e}case 1:{M[1165]=e&16777215;break e}case 2:{M[1166]=e&16777215;break e}case 3:break e;default:break e}else ue(2,r+-32|0,e|0)|0}while(0);M[1180]=r+-32;i=(ee(1,60)|0)+2|0;M[1181]=-7;M[1183]=1}n=i+-2|0;u=ee(3,n|0)|0;s=i+2|0;M[1182]=s&-2;if(A[5300]|0){r=M[2]|0;M[c+8>>2]=n;M[c+8+4>>2]=u;Ke(r,591,c+8|0)|0}if((u&65472|0)==16704){if(A[5300]|0){o=M[2]|0;M[c+16>>2]=u&7;M[c+16+4>>2]=u>>>3&7;Ke(o,611,c+16|0)|0}t=M[4668+((u&7)<<2)>>2]|0;i=M[4668+((u>>>3&7)<<2)>>2]|0;o=M[1184]|0;M[4668+((u&7)<<2)>>2]=i+t+(o>>>29&1);e=(i+t+(o>>>29&1)|0)<0?o|-2147483648:o&2147483647;e=(i+t+(o>>>29&1)|0)==0?e|1073741824:e&-1073741825;M[1184]=e;if(!(e&536870912)){u=((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)|0)>>>31)&2|0)==0?e&-536870913:e|536870912;M[1184]=(((i&2147483647)+(t&2147483647)|0)>>>31|0)==(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}else{u=(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)+1|0)>>>31)|0)&2|0)==0?e&-536870913:e|536870912;M[1184]=(((i&2147483647)+(t&2147483647)+1|0)>>>31|0)==(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)+1|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}}if((u&65024|0)==7168)if(u>>>6&7|0){if(A[5300]|0){o=M[2]|0;M[c+24>>2]=u&7;M[c+24+4>>2]=u>>>3&7;M[c+24+8>>2]=u>>>6&7;Ke(o,624,c+24|0)|0}a=M[4668+((u>>>3&7)<<2)>>2]|0;M[4668+((u&7)<<2)>>2]=a+(u>>>6&7);o=M[1184]|0;o=(a+(u>>>6&7)|0)<0?o|-2147483648:o&2147483647;o=(a+(u>>>6&7)|0)==0?o|1073741824:o&-1073741825;o=((((a&2147483647)+(u>>>6&7)|0)>>>31)+(a>>>31)&2|0)==0?o&-536870913:o|536870912;M[1184]=(((a&2147483647)+(u>>>6&7)|0)>>>31|0)==(((((a&2147483647)+(u>>>6&7)|0)>>>31)+(a>>>31)|0)>>>1|0)?o&-268435457:o|268435456;u=0;P=c;return u|0}if((u&63488|0)==12288){if(A[5300]|0){o=M[2]|0;M[c+40>>2]=u>>>8&7;M[c+40+4>>2]=u&255;Ke(o,644,c+40|0)|0}a=M[4668+((u>>>8&7)<<2)>>2]|0;M[4668+((u>>>8&7)<<2)>>2]=a+(u&255);o=M[1184]|0;o=(a+(u&255)|0)<0?o|-2147483648:o&2147483647;o=(a+(u&255)|0)==0?o|1073741824:o&-1073741825;o=((((a&2147483647)+(u&255)|0)>>>31)+(a>>>31)&2|0)==0?o&-536870913:o|536870912;M[1184]=(((a&2147483647)+(u&255)|0)>>>31|0)==(((((a&2147483647)+(u&255)|0)>>>31)+(a>>>31)|0)>>>1|0)?o&-268435457:o|268435456;u=0;P=c;return u|0}if((u&65024|0)==6144){if(A[5300]|0){o=M[2]|0;M[c+48>>2]=u&7;M[c+48+4>>2]=u>>>3&7;M[c+48+8>>2]=u>>>6&7;Ke(o,662,c+48|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]|0;a=M[4668+((u>>>6&7)<<2)>>2]|0;M[4668+((u&7)<<2)>>2]=a+o;u=M[1184]|0;u=(a+o|0)<0?u|-2147483648:u&2147483647;u=(a+o|0)==0?u|1073741824:u&-1073741825;u=((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+(o&2147483647)|0)>>>31|0)==(((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}if((u&65280|0)==17408){if(A[5300]|0){o=M[2]|0;M[c+64>>2]=u>>>4&8|u&7;M[c+64+4>>2]=u>>>3&15;Ke(o,680,c+64|0)|0}e=M[4668+((u>>>4&8|u&7)<<2)>>2]|0;if((u>>>4&8|u&7|0)==15){if(e&1|0){o=M[2]|0;M[c+72>>2]=e;Ke(o,520,c+72|0)|0}e=e&-2}t=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(t&1|0){o=M[2]|0;M[c+80>>2]=t;Ke(o,520,c+80|0)|0}t=t&-2}e=t+e|0;do{if((u>>>4&8|u&7|0)==15)if(!(e&1)){o=M[2]|0;M[c+88>>2]=s;M[c+88+4>>2]=e;Ke(o,693,c+88|0)|0;ae(1)}else{a=e+2&-2;break}else a=e}while(0);M[4668+((u>>>4&8|u&7)<<2)>>2]=(u>>>4&8|u&7|0)==15?a&-2:a;u=0;P=c;return u|0}e=1;t=(u&63488)<<16>>16;if(e)switch(t|0){case-24576:{if(A[5300]|0){o=M[2]|0;M[c+96>>2]=u>>>8&7;M[c+96+4>>2]=u<<2&1020;Ke(o,743,c+96|0)|0}e=M[1182]|0;if(e&1|0){o=M[2]|0;M[c+104>>2]=e;Ke(o,520,c+104|0)|0}M[4668+((u>>>8&7)<<2)>>2]=(e&-4)+(u<<2&1020);u=0;P=c;return u|0}case-22528:{if(A[5300]|0){o=M[2]|0;M[c+112>>2]=u>>>8&7;M[c+112+4>>2]=u<<2&1020;Ke(o,763,c+112|0)|0}M[4668+((u>>>8&7)<<2)>>2]=(M[1180]|0)+(u<<2&1020);u=0;P=c;return u|0}default:e=1}if(e)switch(t|0){default:{if((u&65408|0)==45056){if(A[5300]|0){o=M[2]|0;M[c+120>>2]=u<<2&508;Ke(o,783,c+120|0)|0}M[1180]=(M[1180]|0)+(u<<2&508);u=0;P=c;return u|0}if((u&65472|0)==16384){if(A[5300]|0){o=M[2]|0;M[c+128>>2]=u&7;M[c+128+4>>2]=u>>>3&7;Ke(o,799,c+128|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]&M[4668+((u&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;P=c;return u|0}if((u&63488|0)==4096){if(A[5300]|0){o=M[2]|0;M[c+136>>2]=u&7;M[c+136+4>>2]=u>>>3&7;M[c+136+8>>2]=u>>>6&31;Ke(o,813,c+136|0)|0}e=M[4668+((u>>>3&7)<<2)>>2]|0;do{if(!(u>>>6&31)){i=M[1184]|0;if((e|0)<0){M[1184]=i|536870912;t=-1;e=i|536870912;break}else{M[1184]=i&-536870913;t=0;e=i&-536870913;break}}else{o=M[1184]|0;o=e&1<<(u>>>6&31)+-1|0?o|536870912:o&-536870913;M[1184]=o;t=((e|0)<0?-1<<32-(u>>>6&31):0)|e>>>(u>>>6&31);e=o}}while(0);M[4668+((u&7)<<2)>>2]=t;u=(t|0)<0?e|-2147483648:e&2147483647;M[1184]=(t|0)==0?u|1073741824:u&-1073741825;u=0;P=c;return u|0}if((u&65472|0)==16640){if(A[5300]|0){o=M[2]|0;M[c+152>>2]=u&7;M[c+152+4>>2]=u>>>3&7;Ke(o,833,c+152|0)|0}t=M[4668+((u&7)<<2)>>2]|0;e=M[4668+((u>>>3&7)<<2)>>2]&255;do{if(!e)e=M[1184]|0;else{if(e>>>0<32){o=M[1184]|0;o=1<<e+-1&t|0?o|536870912:o&-536870913;M[1184]=o;t=((t|0)<0?-1<<32-e:0)|t>>>e;e=o;break}e=M[1184]|0;if((t|0)<0){M[1184]=e|536870912;t=-1;e=e|536870912;break}else{M[1184]=e&-536870913;t=0;e=e&-536870913;break}}}while(0);M[4668+((u&7)<<2)>>2]=t;u=(t|0)<0?e|-2147483648:e&2147483647;M[1184]=(t|0)==0?u|1073741824:u&-1073741825;u=0;P=c;return u|0}e:do{if((u&61440|0)==53248){t=(((u&128|0)==0?u&255:u|-256)<<1)+s|0;do{switch(u>>>8&15){case 0:{if(A[5300]|0){u=M[2]|0;M[c+160>>2]=t+-1;Ke(u,847,c+160|0)|0}if(!(M[1184]&1073741824)){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 1:{if(A[5300]|0){u=M[2]|0;M[c+168>>2]=t+-1;Ke(u,859,c+168|0)|0}if(M[1184]&1073741824|0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 2:{if(A[5300]|0){u=M[2]|0;M[c+176>>2]=t+-1;Ke(u,871,c+176|0)|0}if(!(M[1184]&536870912)){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 3:{if(A[5300]|0){u=M[2]|0;M[c+184>>2]=t+-1;Ke(u,883,c+184|0)|0}if(M[1184]&536870912|0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 4:{if(A[5300]|0){u=M[2]|0;M[c+192>>2]=t+-1;Ke(u,895,c+192|0)|0}if((M[1184]|0)>=0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 5:{if(A[5300]|0){u=M[2]|0;M[c+200>>2]=t+-1;Ke(u,907,c+200|0)|0}if((M[1184]|0)<0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 6:{if(A[5300]|0){u=M[2]|0;M[c+208>>2]=t+-1;Ke(u,919,c+208|0)|0}if(!(M[1184]&268435456)){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 7:{if(A[5300]|0){u=M[2]|0;M[c+216>>2]=t+-1;Ke(u,931,c+216|0)|0}if(M[1184]&268435456|0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 8:{if(A[5300]|0){u=M[2]|0;M[c+224>>2]=t+-1;Ke(u,943,c+224|0)|0}if((M[1184]&1610612736|0)!=536870912){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 9:{if(A[5300]|0){u=M[2]|0;M[c+232>>2]=t+-1;Ke(u,955,c+232|0)|0}if((M[1184]&1610612736|0)==536870912){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 10:{if(A[5300]|0){u=M[2]|0;M[c+240>>2]=t+-1;Ke(u,967,c+240|0)|0}e=M[1184]&-1879048192;t:do{if((e|0)<0){switch(e|0){case-1879048192:break t;default:o=0}P=c;return o|0}else{switch(e|0){case 0:break t;default:o=0}P=c;return o|0}}while(0);M[1182]=t+2&-2;u=0;P=c;return u|0}case 11:{if(A[5300]|0){u=M[2]|0;M[c+248>>2]=t+-1;Ke(u,979,c+248|0)|0}u=M[1184]|0;if(!((u&268435456|0?(u|0)<0?0:(u&268435456)>>>28:(u|0)<0?1:(u&268435456)>>>28)|0)){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 12:{if(A[5300]|0){u=M[2]|0;M[c+256>>2]=t+-1;Ke(u,991,c+256|0)|0}u=M[1184]|0;if(u&1073741824|0?1:(((u&-1879048192|0)==0?(u&-1879048192|0)==-1879048192?2:1:(u&-1879048192|0)==-1879048192&1)|0)==0){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}case 13:{if(A[5300]|0){u=M[2]|0;M[c+264>>2]=t+-1;Ke(u,1003,c+264|0)|0}u=M[1184]|0;if(((u&268435456|0?(u|0)<0?0:(u&268435456)>>>28:(u|0)<0?1:(u&268435456)>>>28)|0)==(0-(u>>>30&1)|0)){u=0;P=c;return u|0}M[1182]=t+2&-2;u=0;P=c;return u|0}default:break e}}while(0)}}while(0);if((u&63488|0)==57344){e=(((u&1024|0)==0?u&2047:u|-2048)<<1)+s|0;if(A[5300]|0){u=M[2]|0;M[c+272>>2]=e+-1;Ke(u,1015,c+272|0)|0}M[1182]=e+2&-2;u=0;P=c;return u|0}if((u&65472|0)==17280){if(A[5300]|0){o=M[2]|0;M[c+280>>2]=u&7;M[c+280+4>>2]=u>>>3&7;Ke(o,1025,c+280|0)|0}o=M[4668+((u&7)<<2)>>2]&~M[4668+((u>>>3&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;P=c;return u|0}if((u&65280|0)==48640){o=M[2]|0;M[c+288>>2]=u&255;Ke(o,1039,c+288|0)|0;u=1;P=c;return u|0}e:do{if((u&57344|0)==57344){if((u&6144)<4096){switch(u&6144){case 2048:break;default:break e}e=(M[1181]|0)+(u<<1&4094)&-4|2;if(A[5300]|0){u=M[2]|0;M[c+304>>2]=e+-3;Ke(u,1052,c+304|0)|0}M[1181]=i|1;M[1182]=e;u=0;P=c;return u|0}switch(u&6144){case 4096:{if(A[5300]|0)pt(10,M[2]|0)|0;M[1181]=(((u&1024|0)==0?u&2047:u|1046528)<<12)+s;u=0;P=c;return u|0}case 6144:{e=(M[1181]|0)+(u<<1&4094)|0;if(A[5300]|0){u=M[2]|0;M[c+296>>2]=e+-1;Ke(u,1052,c+296|0)|0}M[1181]=i|1;M[1182]=e+2&-2;u=0;P=c;return u|0}default:break e}}}while(0);e=(A[5300]|0)!=0;t=1;r=(u&65415)<<16>>16;if(t)switch(r|0){case 18304:{if(e){o=M[2]|0;M[c+312>>2]=u>>>3&15;Ke(o,1063,c+312|0)|0}e=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(e&1|0){o=M[2]|0;M[c+320>>2]=e;Ke(o,520,c+320|0)|0}e=e&-2}e=e+2|0;if(!(e&1)){o=M[2]|0;M[c+328>>2]=s;M[c+328+4>>2]=u;Ke(o,1072,c+328|0)|0;u=2;P=c;return u|0}else{M[1181]=i|1;M[1182]=e&-2;u=0;P=c;return u|0}}case 18176:{if(e){o=M[2]|0;M[c+336>>2]=u>>>3&15;Ke(o,1108,c+336|0)|0}e=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(e&1|0){u=M[2]|0;M[c+344>>2]=e;Ke(u,520,c+344|0)|0}e=e&-2}e=e+2|0;if(e&1|0){M[1182]=e&-2;u=0;P=c;return u|0}e=ue(4,n|0,e|0)|0;if(e|0){u=e;P=c;return u|0}M[1182]=(M[1181]|0)+2&-2;u=0;P=c;return u|0}default:t=1}if(t)switch(r|0){default:{if((u&65472|0)==17088){if(e){o=M[2]|0;M[c+352>>2]=u&7;M[c+352+4>>2]=u>>>3&7;Ke(o,1154,c+352|0)|0}o=M[4668+((u&7)<<2)>>2]|0;a=M[4668+((u>>>3&7)<<2)>>2]|0;u=M[1184]|0;u=(a+o|0)<0?u|-2147483648:u&2147483647;u=(a+o|0)==0?u|1073741824:u&-1073741825;u=((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+(o&2147483647)|0)>>>31|0)==(((a>>>31)+(o>>>31)+(((a&2147483647)+(o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}if((u&63488|0)==10240){if(e){o=M[2]|0;M[c+360>>2]=u>>>8&7;M[c+360+4>>2]=u&255;Ke(o,1168,c+360|0)|0}a=M[4668+((u>>>8&7)<<2)>>2]|0;o=M[1184]|0;o=(a-(u&255)|0)<0?o|-2147483648:o&2147483647;o=(a-(u&255)|0)==0?o|1073741824:o&-1073741825;o=(((a>>>31)+1+((-2147483648-(u&255)+(a&2147483647)|0)>>>31)|0)&2|0)==0?o&-536870913:o|536870912;M[1184]=((-2147483648-(u&255)+(a&2147483647)|0)>>>31|0)==(((a>>>31)+1+((-2147483648-(u&255)+(a&2147483647)|0)>>>31)|0)>>>1&1|0)?o&-268435457:o|268435456;u=0;P=c;return u|0}if((u&65472|0)==17024){if(e){o=M[2]|0;M[c+368>>2]=u&7;M[c+368+4>>2]=u>>>3&7;Ke(o,1185,c+368|0)|0}a=M[4668+((u&7)<<2)>>2]|0;o=M[4668+((u>>>3&7)<<2)>>2]|0;u=M[1184]|0;u=(a-o|0)<0?u|-2147483648:u&2147483647;u=(a-o|0)==0?u|1073741824:u&-1073741825;u=(((~o>>>31)+(a>>>31)+(((a&2147483647)+1+(~o&2147483647)|0)>>>31)|0)&2|0)==0?u&-536870913:u|536870912;M[1184]=(((a&2147483647)+1+(~o&2147483647)|0)>>>31|0)==(((~o>>>31)+(a>>>31)+(((a&2147483647)+1+(~o&2147483647)|0)>>>31)|0)>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}if((u&65280|0)==17664){if(e){o=M[2]|0;M[c+376>>2]=u>>>4&8|u&7;M[c+376+4>>2]=u>>>3&15;Ke(o,1185,c+376|0)|0}e=M[4668+((u>>>4&8|u&7)<<2)>>2]|0;if((u>>>4&8|u&7|0)==15){if(e&1|0){o=M[2]|0;M[c+384>>2]=e;Ke(o,520,c+384|0)|0}t=e&-2}else t=e;e=M[4668+((u>>>3&15)<<2)>>2]|0;if((u>>>3&15|0)==15){if(e&1|0){u=M[2]|0;M[c+392>>2]=e;Ke(u,520,c+392|0)|0}e=e&-2}o=t-e|0;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;u=(o|0)==0?u|1073741824:u&-1073741825;o=~e;a=((t&2147483647)+1+(o&2147483647)|0)>>>31;o=(o>>>31)+(t>>>31)+a|0;u=(o&2|0)==0?u&-536870913:u|536870912;M[1184]=(a|0)==(o>>>1&1|0)?u&-268435457:u|268435456;u=0;P=c;return u|0}if((u&65512|0)==46688&e)He(1199,9,1,M[2]|0)|0;e=1;t=(u&65472)<<16>>16;if(e)switch(t|0){case 17920:{if(A[5300]|0){o=M[2]|0;M[c+400>>2]=u&7;M[c+400+4>>2]=u>>>3&7;Ke(o,1209,c+400|0)|0}M[4668+((u&7)<<2)>>2]=M[4668+((u>>>3&7)<<2)>>2];u=0;P=c;return u|0}case 16448:{if(A[5300]|0){o=M[2]|0;M[c+408>>2]=u&7;M[c+408+4>>2]=u>>>3&7;Ke(o,1222,c+408|0)|0}o=M[4668+((u>>>3&7)<<2)>>2]^M[4668+((u&7)<<2)>>2];M[4668+((u&7)<<2)>>2]=o;u=M[1184]|0;u=(o|0)<0?u|-2147483648:u&2147483647;M[1184]=(o|0)==0?u|1073741824:u&-1073741825;u=0;P=c;return u|0}default:e=1}if(e)switch(t|0){default:{e:do{if((u&63488)<<16>>16<26624){switch((u&63488)<<16>>16){case-14336:break;default:break e}if(!(A[5300]|0))t=u&1;else{t=M[2]|0;M[c+416>>2]=u>>>8&7;Ke(t,1236,c+416|0)|0;if(!(u&1))e=0;else{M[c+424>>2]=0;Ke(t,1249,c+424|0)|0;e=1}if(u&2){if(e|0)pt(44,t)|0;M[c+1176>>2]=1;Ke(t,1249,c+1176|0)|0;e=e+1|0}if(u&4){if(e|0)pt(44,t)|0;M[c+1184>>2]=2;Ke(t,1249,c+1184|0)|0;e=e+1|0}if(u&8){if(e|0)pt(44,t)|0;M[c+1192>>2]=3;Ke(t,1249,c+1192|0)|0;e=e+1|0}if(u&16){if(e|0)pt(44,t)|0;M[c+1200>>2]=4;Ke(t,1249,c+1200|0)|0;e=e+1|0}if(u&32){if(e|0)pt(44,t)|0;M[c+1208>>2]=5;Ke(t,1249,c+1208|0)|0;e=e+1|0}if(u&64){if(e|0)pt(44,t)|0;M[c+1216>>2]=6;Ke(t,1249,c+1216|0)|0;e=e+1|0}if(u&128|0){if(e|0)pt(44,t)|0;M[c+1224>>2]=7;Ke(t,1249,c+1224|0)|0}He(1253,2,1,t)|0;t=u&1}e=M[4668+((u>>>8&7)<<2)>>2]|0;if(t){M[1167]=ee(1,e|0)|0;e=e+4|0}if(u&2){M[1168]=ee(1,e|0)|0;e=e+4|0}if(u&4){M[1169]=ee(1,e|0)|0;e=e+4|0}if(u&8){M[1170]=ee(1,e|0)|0;e=e+4|0}if(u&16){M[1171]=ee(1,e|0)|0;e=e+4|0}if(u&32){M[1172]=ee(1,e|0)|0;e=e+4|0}if(u&64){M[1173]=ee(1,e|0)|0;e=e+4|0}if(u&128){M[1174]=ee(1,e|0)|0;e=e+4|0}if(1<<(u>>>8&7)&u|0){u=0;P=c;return u|0}M[4668+((u>>>8&7)<<2)>>2]=e;u=0;P=c;return u|0}else{switch((u&63488)<<16>>16){case 26624:break;default:break e}if(A[5300]|0){o=M[2]|0;M[c+432>>2]=u&7;M[c+432+4>>2]=u>>>3&7;M[c+432+8>>2]=u>>>4&124;Ke(o,1256,c+432|0)|0}M[4668+((u&7)<<2)>>2]=ee(1,(M[4668+((u>>>3&7)<<2)>>2]|0)+(u>>>4&124)|0)|0;u=0;P=c;return u|0}}while(0);if((u&65024|0)==22528){if(A[5300]|0){o=M[2]|0;M[c+448>>2]=u&7;M[c+448+4>>2]=u>>>3&7;M[c+448+8>>2]=u>>>6&7;Ke(o,1277,c+448|0)|0}M[4668+((u&7)<<2)>>2]=ee(1,(M[4668+((u>>>6&7)<<2)>>2]|0)+(M[4668+((u>>>3&7)<<2)>>2]|0)|0)|0;u=0;P=c;return u|0}e:do{if((u&63488)<<16>>16<18432){switch((u&63488)<<16>>16){case-26624:break;default:break e}if(A[5300]|0){o=M[2]|0;M[c+488>>2]=u>>>8&7;M[c+488+4>>2]=u<<2&1020;Ke(o,1325,c+488|0)|0}M[4668+((u>>>8&7)<<2)>>2]=ee(1,(M[1180]|0)+(u<<2&1020)|0)|0;u=0;P=c;return u|0}else{if((u&63488)<<16>>16>=30720){switch((u&63488)<<16>>16){case 30720:break;default:break e}if(A[5300]|0){o=M[2]|0;M[c+496>>2]=u&7;M[c+496+4>>2]=u>>>3&7;M[c+496+8>>2]=u>>>6&31;Ke(o,1345,c+496|0)|0}a=M[4668+((u>>>3&7)<<2)>>2]|0;o=ee(3,a+(u>>>6&31)&-2|0)|0;M[4668+((u&7)<<2)>>2]=((a+(u>>>6)&1|0)==0?o:o>>>8)&255;u=0;P=c;return u|0}switch((u&63488)<<16>>16){case 18432:break;default:break e}if(A[5300]|0){o=M[2]|0;M[c+464>>2]=u>>>8&7;M[c+464+4>>2]=u<<2&1020;Ke(o,1296,c+464|0)|0}e=M[1182]|0;if(e&1|0){o=M[2]|0;M[c+472>>2]=e;Ke(o,520,c+472|0)|0}if(A[5300]|0){o=M[2]|0;M[c+480>>2]=(e&-4)+(u<<2&1020);Ke(o,1316,c+480|0)|0}M[4668+((u>>>8&7)<<2)>>2]=ee(1,(e&-4)+(u<<2&1020)|0)|0;u=0;P=c;return u|0}}while(0);M[c+1368>>2]=o;M[c+3472>>2]=n;M[c+3496>>2]=u;M[c+3504>>2]=s;M[c+4792>>2]=0;M[c+4796>>2]=0;Bt(c);w=M[c+4792>>2]|0;b=M[c+4796>>2]|0;C=+h[c+4796>>2];M[c+4792>>2]=0;M[c+4796>>2]=0;if((w|0)==6)return b|0}}}}}}return 0}function Te(e){e=e|0;var t=0,i=0,r=0,n=0,s=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0,_=0;_=P;P=P+16|0;do{if(e>>>0<245){l=e>>>0<11?16:e+11&-8;c=M[1185]|0;if(c>>>(l>>>3)&3|0){e=4780+((c>>>(l>>>3)&1^1)+(l>>>3)<<1<<2)|0;t=M[e+8>>2]|0;i=M[t+8>>2]|0;if((e|0)==(i|0))M[1185]=c&~(1<<(c>>>(l>>>3)&1^1)+(l>>>3));else{M[i+12>>2]=e;M[e+8>>2]=i}f=(c>>>(l>>>3)&1^1)+(l>>>3)<<3;M[t+4>>2]=f|3;M[t+f+4>>2]=M[t+f+4>>2]|1;f=t+8|0;P=_;return f|0}h=M[1187]|0;if(l>>>0>h>>>0){if(c>>>(l>>>3)|0){e=c>>>(l>>>3)<<(l>>>3)&(2<<(l>>>3)|0-(2<<(l>>>3)));n=((e&0-e)+-1|0)>>>(((e&0-e)+-1|0)>>>12&16);r=n>>>(n>>>5&8)>>>(n>>>(n>>>5&8)>>>2&4);r=(n>>>5&8|((e&0-e)+-1|0)>>>12&16|n>>>(n>>>5&8)>>>2&4|r>>>1&2|r>>>(r>>>1&2)>>>1&1)+(r>>>(r>>>1&2)>>>(r>>>(r>>>1&2)>>>1&1))|0;n=M[4780+(r<<1<<2)+8>>2]|0;e=M[n+8>>2]|0;if((4780+(r<<1<<2)|0)==(e|0)){M[1185]=c&~(1<<r);e=c&~(1<<r)}else{M[e+12>>2]=4780+(r<<1<<2);M[4780+(r<<1<<2)+8>>2]=e;e=c}M[n+4>>2]=l|3;M[n+l+4>>2]=(r<<3)-l|1;M[n+l+((r<<3)-l)>>2]=(r<<3)-l;if(h|0){i=M[1190]|0;if(!(e&1<<(h>>>3))){M[1185]=e|1<<(h>>>3);e=4780+(h>>>3<<1<<2)|0;t=4780+(h>>>3<<1<<2)+8|0}else{e=M[4780+(h>>>3<<1<<2)+8>>2]|0;t=4780+(h>>>3<<1<<2)+8|0}M[t>>2]=i;M[e+12>>2]=i;M[i+8>>2]=e;M[i+12>>2]=4780+(h>>>3<<1<<2)}M[1187]=(r<<3)-l;M[1190]=n+l;f=n+8|0;P=_;return f|0}u=M[1186]|0;if(u){t=((u&0-u)+-1|0)>>>(((u&0-u)+-1|0)>>>12&16);e=t>>>(t>>>5&8)>>>(t>>>(t>>>5&8)>>>2&4);e=M[5044+((t>>>5&8|((u&0-u)+-1|0)>>>12&16|t>>>(t>>>5&8)>>>2&4|e>>>1&2|e>>>(e>>>1&2)>>>1&1)+(e>>>(e>>>1&2)>>>(e>>>(e>>>1&2)>>>1&1))<<2)>>2]|0;t=(M[e+4>>2]&-8)-l|0;i=M[e+16+(((M[e+16>>2]|0)==0&1)<<2)>>2]|0;if(!i){o=e;s=t}else{do{a=(M[i+4>>2]&-8)-l|0;o=a>>>0<t>>>0;t=o?a:t;e=o?i:e;i=M[i+16+(((M[i+16>>2]|0)==0&1)<<2)>>2]|0}while((i|0)!=0);o=e;s=t}a=o+l|0;if(o>>>0<a>>>0){n=M[o+24>>2]|0;e=M[o+12>>2]|0;do{if((e|0)==(o|0)){t=o+20|0;e=M[t>>2]|0;if(!e){t=o+16|0;e=M[t>>2]|0;if(!e){t=0;break}}while(1){i=e+20|0;r=M[i>>2]|0;if(r|0){e=r;t=i;continue}i=e+16|0;r=M[i>>2]|0;if(!r)break;else{e=r;t=i}}M[t>>2]=0;t=e}else{t=M[o+8>>2]|0;M[t+12>>2]=e;M[e+8>>2]=t;t=e}}while(0);do{if(n|0){e=M[o+28>>2]|0;if((o|0)==(M[5044+(e<<2)>>2]|0)){M[5044+(e<<2)>>2]=t;if(!t){M[1186]=u&~(1<<e);break}}else{M[n+16+(((M[n+16>>2]|0)!=(o|0)&1)<<2)>>2]=t;if(!t)break}M[t+24>>2]=n;e=M[o+16>>2]|0;if(e|0){M[t+16>>2]=e;M[e+24>>2]=t}e=M[o+20>>2]|0;if(e|0){M[t+20>>2]=e;M[e+24>>2]=t}}}while(0);if(s>>>0<16){f=s+l|0;M[o+4>>2]=f|3;f=o+f+4|0;M[f>>2]=M[f>>2]|1}else{M[o+4>>2]=l|3;M[a+4>>2]=s|1;M[a+s>>2]=s;if(h|0){i=M[1190]|0;if(!(c&1<<(h>>>3))){M[1185]=c|1<<(h>>>3);e=4780+(h>>>3<<1<<2)|0;t=4780+(h>>>3<<1<<2)+8|0}else{e=M[4780+(h>>>3<<1<<2)+8>>2]|0;t=4780+(h>>>3<<1<<2)+8|0}M[t>>2]=i;M[e+12>>2]=i;M[i+8>>2]=e;M[i+12>>2]=4780+(h>>>3<<1<<2)}M[1187]=s;M[1190]=a}f=o+8|0;P=_;return f|0}}}}else if(e>>>0>4294967231)l=-1;else{l=e+11&-8;u=M[1186]|0;if(u){if(!((e+11|0)>>>8))a=0;else if(l>>>0>16777215)a=31;else{a=(e+11|0)>>>8<<((((e+11|0)>>>8)+1048320|0)>>>16&8);a=14-((a+520192|0)>>>16&4|(((e+11|0)>>>8)+1048320|0)>>>16&8|((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)+(a<<((a+520192|0)>>>16&4)<<(((a<<((a+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;a=l>>>(a+7|0)&1|a<<1}t=M[5044+(a<<2)>>2]|0;e:do{if(!t){t=0;e=0;i=0-l|0;f=57}else{e=0;i=0-l|0;s=l<<((a|0)==31?0:25-(a>>>1)|0);n=0;while(1){r=(M[t+4>>2]&-8)-l|0;if(r>>>0<i>>>0)if(!r){e=t;i=0;r=t;f=61;break e}else{e=t;i=r}r=M[t+20>>2]|0;t=M[t+16+(s>>>31<<2)>>2]|0;n=(r|0)==0|(r|0)==(t|0)?n:r;r=(t|0)==0;if(r){t=n;f=57;break}else s=s<<((r^1)&1)}}}while(0);if((f|0)==57){if((t|0)==0&(e|0)==0){e=2<<a;if(!(u&(e|0-e)))break;c=(u&(e|0-e)&0-(u&(e|0-e)))+-1|0;h=c>>>(c>>>12&16)>>>(c>>>(c>>>12&16)>>>5&8);t=h>>>(h>>>2&4)>>>(h>>>(h>>>2&4)>>>1&2);e=0;t=M[5044+((c>>>(c>>>12&16)>>>5&8|c>>>12&16|h>>>2&4|h>>>(h>>>2&4)>>>1&2|t>>>1&1)+(t>>>(t>>>1&1))<<2)>>2]|0}if(!t){o=e;s=i}else{r=t;f=61}}if((f|0)==61)while(1){f=0;t=(M[r+4>>2]&-8)-l|0;h=t>>>0<i>>>0;t=h?t:i;e=h?r:e;r=M[r+16+(((M[r+16>>2]|0)==0&1)<<2)>>2]|0;if(!r){o=e;s=t;break}else{i=t;f=61}}if(o)if(s>>>0<((M[1187]|0)-l|0)>>>0){a=o+l|0;if(o>>>0>=a>>>0){f=0;P=_;return f|0}n=M[o+24>>2]|0;e=M[o+12>>2]|0;do{if((e|0)==(o|0)){t=o+20|0;e=M[t>>2]|0;if(!e){t=o+16|0;e=M[t>>2]|0;if(!e){e=0;break}}while(1){i=e+20|0;r=M[i>>2]|0;if(r|0){e=r;t=i;continue}i=e+16|0;r=M[i>>2]|0;if(!r)break;else{e=r;t=i}}M[t>>2]=0}else{f=M[o+8>>2]|0;M[f+12>>2]=e;M[e+8>>2]=f}}while(0);do{if(!n)r=u;else{t=M[o+28>>2]|0;if((o|0)==(M[5044+(t<<2)>>2]|0)){M[5044+(t<<2)>>2]=e;if(!e){M[1186]=u&~(1<<t);r=u&~(1<<t);break}}else{M[n+16+(((M[n+16>>2]|0)!=(o|0)&1)<<2)>>2]=e;if(!e){r=u;break}}M[e+24>>2]=n;t=M[o+16>>2]|0;if(t|0){M[e+16>>2]=t;M[t+24>>2]=e}t=M[o+20>>2]|0;if(!t)r=u;else{M[e+20>>2]=t;M[t+24>>2]=e;r=u}}}while(0);do{if(s>>>0<16){f=s+l|0;M[o+4>>2]=f|3;f=o+f+4|0;M[f>>2]=M[f>>2]|1}else{M[o+4>>2]=l|3;M[a+4>>2]=s|1;M[a+s>>2]=s;i=s>>>3;if(s>>>0<256){e=M[1185]|0;if(!(e&1<<i)){M[1185]=e|1<<i;e=4780+(i<<1<<2)|0;t=4780+(i<<1<<2)+8|0}else{e=M[4780+(i<<1<<2)+8>>2]|0;t=4780+(i<<1<<2)+8|0}M[t>>2]=a;M[e+12>>2]=a;M[a+8>>2]=e;M[a+12>>2]=4780+(i<<1<<2);break}e=s>>>8;if(!e)e=0;else if(s>>>0>16777215)e=31;else{f=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(f+245760|0)>>>16&2)+(f<<((f+245760|0)>>>16&2)>>>15)|0;e=s>>>(e+7|0)&1|e<<1}i=5044+(e<<2)|0;M[a+28>>2]=e;M[a+16+4>>2]=0;M[a+16>>2]=0;t=1<<e;if(!(r&t)){M[1186]=r|t;M[i>>2]=a;M[a+24>>2]=i;M[a+12>>2]=a;M[a+8>>2]=a;break}t=s<<((e|0)==31?0:25-(e>>>1)|0);i=M[i>>2]|0;while(1){if((M[i+4>>2]&-8|0)==(s|0)){f=97;break}r=i+16+(t>>>31<<2)|0;e=M[r>>2]|0;if(!e){f=96;break}else{t=t<<1;i=e}}if((f|0)==96){M[r>>2]=a;M[a+24>>2]=i;M[a+12>>2]=a;M[a+8>>2]=a;break}else if((f|0)==97){l=i+8|0;f=M[l>>2]|0;M[f+12>>2]=a;M[l>>2]=a;M[a+8>>2]=f;M[a+12>>2]=i;M[a+24>>2]=0;break}}}while(0);f=o+8|0;P=_;return f|0}}}}while(0);i=M[1187]|0;if(i>>>0>=l>>>0){e=i-l|0;t=M[1190]|0;if(e>>>0>15){f=t+l|0;M[1190]=f;M[1187]=e;M[f+4>>2]=e|1;M[f+e>>2]=e;M[t+4>>2]=l|3}else{M[1187]=0;M[1190]=0;M[t+4>>2]=i|3;M[t+i+4>>2]=M[t+i+4>>2]|1}f=t+8|0;P=_;return f|0}s=M[1188]|0;if(s>>>0>l>>>0){c=s-l|0;M[1188]=c;f=M[1191]|0;h=f+l|0;M[1191]=h;M[h+4>>2]=c|1;M[f+4>>2]=l|3;f=f+8|0;P=_;return f|0}if(!(M[1303]|0)){M[1305]=4096;M[1304]=4096;M[1306]=-1;M[1307]=-1;M[1308]=0;M[1296]=0;M[_>>2]=_&-16^1431655768;M[1303]=_&-16^1431655768;e=4096}else e=M[1305]|0;a=l+48|0;o=l+47|0;c=e+o|0;u=0-e|0;if((c&u)>>>0<=l>>>0){f=0;P=_;return f|0}e=M[1295]|0;if(e|0){h=M[1293]|0;if((h+(c&u)|0)>>>0<=h>>>0?1:(h+(c&u)|0)>>>0>e>>>0){f=0;P=_;return f|0}}e:do{if(!(M[1296]&4)){i=M[1191]|0;t:do{if(!i)f=118;else{e=5188;while(1){t=M[e>>2]|0;if(t>>>0<=i>>>0){n=e+4|0;if((t+(M[n>>2]|0)|0)>>>0>i>>>0)break}e=M[e+8>>2]|0;if(!e){f=118;break t}}if((c-s&u)>>>0<2147483647){r=Tt(c-s&u|0)|0;if((r|0)==((M[e>>2]|0)+(M[n>>2]|0)|0))if((r|0)==(-1|0))e=c-s&u;else{s=c-s&u;f=135;break e}else{i=c-s&u;f=126}}else e=0}}while(0);do{if((f|0)==118){n=Tt(0)|0;if((n|0)==(-1|0))e=0;else{i=M[1304]|0;i=((i+-1&n|0)==0?0:(i+-1+n&0-i)-n|0)+(c&u)|0;e=M[1293]|0;if(i>>>0>l>>>0&i>>>0<2147483647){t=M[1295]|0;if(t|0)if((i+e|0)>>>0<=e>>>0|(i+e|0)>>>0>t>>>0){e=0;break}r=Tt(i|0)|0;if((r|0)==(n|0)){s=i;r=n;f=135;break e}else f=126}else e=0}}}while(0);do{if((f|0)==126){t=0-i|0;if(!(a>>>0>i>>>0&(i>>>0<2147483647&(r|0)!=(-1|0))))if((r|0)==(-1|0)){e=0;break}else{s=i;f=135;break e}e=M[1305]|0;e=o-i+e&0-e;if(e>>>0>=2147483647){s=i;f=135;break e}if((Tt(e|0)|0)==(-1|0)){Tt(t|0)|0;e=0;break}else{s=e+i|0;f=135;break e}}}while(0);M[1296]=M[1296]|4;f=133}else{e=0;f=133}}while(0);if((f|0)==133)if((c&u)>>>0<2147483647){r=Tt(c&u|0)|0;t=Tt(0)|0;i=(t-r|0)>>>0>(l+40|0)>>>0;if(!((r|0)==(-1|0)|i^1|r>>>0<t>>>0&((r|0)!=(-1|0)&(t|0)!=(-1|0))^1)){s=i?t-r|0:e;f=135}}if((f|0)==135){e=(M[1293]|0)+s|0;M[1293]=e;if(e>>>0>(M[1294]|0)>>>0)M[1294]=e;a=M[1191]|0;do{if(!a){f=M[1189]|0;if((f|0)==0|r>>>0<f>>>0)M[1189]=r;M[1297]=r;M[1298]=s;M[1300]=0;M[1194]=M[1303];M[1193]=-1;e=0;do{f=4780+(e<<1<<2)|0;M[f+12>>2]=f;M[f+8>>2]=f;e=e+1|0}while((e|0)!=32);f=r+8|0;f=(f&7|0)==0?0:0-f&7;h=r+f|0;f=s+-40-f|0;M[1191]=h;M[1188]=f;M[h+4>>2]=f|1;M[h+f+4>>2]=40;M[1192]=M[1307]}else{e=5188;do{t=M[e>>2]|0;i=e+4|0;n=M[i>>2]|0;if((r|0)==(t+n|0)){f=145;break}e=M[e+8>>2]|0}while((e|0)!=0);if((f|0)==145)if(!(M[e+12>>2]&8))if(a>>>0<r>>>0&a>>>0>=t>>>0){M[i>>2]=n+s;h=(a+8&7|0)==0?0:0-(a+8)&7;f=(M[1188]|0)+(s-h)|0;M[1191]=a+h;M[1188]=f;M[a+h+4>>2]=f|1;M[a+h+f+4>>2]=40;M[1192]=M[1307];break}if(r>>>0<(M[1189]|0)>>>0)M[1189]=r;t=r+s|0;e=5188;do{if((M[e>>2]|0)==(t|0)){f=153;break}e=M[e+8>>2]|0}while((e|0)!=0);if((f|0)==153)if(!(M[e+12>>2]&8)){M[e>>2]=r;c=e+4|0;M[c>>2]=(M[c>>2]|0)+s;c=r+8|0;c=r+((c&7|0)==0?0:0-c&7)|0;e=t+((t+8&7|0)==0?0:0-(t+8)&7)|0;u=c+l|0;o=e-c-l|0;M[c+4>>2]=l|3;do{if((e|0)==(a|0)){f=(M[1188]|0)+o|0;M[1188]=f;M[1191]=u;M[u+4>>2]=f|1}else{if((e|0)==(M[1190]|0)){f=(M[1187]|0)+o|0;M[1187]=f;M[1190]=u;M[u+4>>2]=f|1;M[u+f>>2]=f;break}a=M[e+4>>2]|0;if((a&3|0)==1){e:do{if(a>>>0<256){t=M[e+8>>2]|0;i=M[e+12>>2]|0;if((i|0)==(t|0)){M[1185]=M[1185]&~(1<<(a>>>3));break}else{M[t+12>>2]=i;M[i+8>>2]=t;break}}else{s=M[e+24>>2]|0;t=M[e+12>>2]|0;do{if((t|0)==(e|0)){t=M[e+16+4>>2]|0;if(!t){t=M[e+16>>2]|0;if(!t){t=0;break}else n=e+16|0}else n=e+16+4|0;while(1){i=t+20|0;r=M[i>>2]|0;if(r|0){t=r;n=i;continue}i=t+16|0;r=M[i>>2]|0;if(!r)break;else{t=r;n=i}}M[n>>2]=0}else{f=M[e+8>>2]|0;M[f+12>>2]=t;M[t+8>>2]=f}}while(0);if(!s)break;i=M[e+28>>2]|0;do{if((e|0)==(M[5044+(i<<2)>>2]|0)){M[5044+(i<<2)>>2]=t;if(t|0)break;M[1186]=M[1186]&~(1<<i);break e}else{M[s+16+(((M[s+16>>2]|0)!=(e|0)&1)<<2)>>2]=t;if(!t)break e}}while(0);M[t+24>>2]=s;i=M[e+16>>2]|0;if(i|0){M[t+16>>2]=i;M[i+24>>2]=t}i=M[e+16+4>>2]|0;if(!i)break;M[t+20>>2]=i;M[i+24>>2]=t}}while(0);e=e+(a&-8)|0;n=(a&-8)+o|0}else n=o;i=e+4|0;M[i>>2]=M[i>>2]&-2;M[u+4>>2]=n|1;M[u+n>>2]=n;i=n>>>3;if(n>>>0<256){e=M[1185]|0;if(!(e&1<<i)){M[1185]=e|1<<i;e=4780+(i<<1<<2)|0;t=4780+(i<<1<<2)+8|0}else{e=M[4780+(i<<1<<2)+8>>2]|0;t=4780+(i<<1<<2)+8|0}M[t>>2]=u;M[e+12>>2]=u;M[u+8>>2]=e;M[u+12>>2]=4780+(i<<1<<2);break}e=n>>>8;do{if(!e)e=0;else{if(n>>>0>16777215){e=31;break}f=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(f+245760|0)>>>16&2)+(f<<((f+245760|0)>>>16&2)>>>15)|0;e=n>>>(e+7|0)&1|e<<1}}while(0);r=5044+(e<<2)|0;M[u+28>>2]=e;M[u+16+4>>2]=0;M[u+16>>2]=0;t=M[1186]|0;i=1<<e;if(!(t&i)){M[1186]=t|i;M[r>>2]=u;M[u+24>>2]=r;M[u+12>>2]=u;M[u+8>>2]=u;break}t=n<<((e|0)==31?0:25-(e>>>1)|0);i=M[r>>2]|0;while(1){if((M[i+4>>2]&-8|0)==(n|0)){f=194;break}r=i+16+(t>>>31<<2)|0;e=M[r>>2]|0;if(!e){f=193;break}else{t=t<<1;i=e}}if((f|0)==193){M[r>>2]=u;M[u+24>>2]=i;M[u+12>>2]=u;M[u+8>>2]=u;break}else if((f|0)==194){l=i+8|0;f=M[l>>2]|0;M[f+12>>2]=u;M[l>>2]=u;M[u+8>>2]=f;M[u+12>>2]=i;M[u+24>>2]=0;break}}}while(0);f=c+8|0;P=_;return f|0}t=5188;while(1){e=M[t>>2]|0;if(e>>>0<=a>>>0){i=e+(M[t+4>>2]|0)|0;if(i>>>0>a>>>0)break}t=M[t+8>>2]|0}n=i+-47+((i+-47+8&7|0)==0?0:0-(i+-47+8)&7)|0;n=n>>>0<(a+16|0)>>>0?a:n;e=r+8|0;e=(e&7|0)==0?0:0-e&7;f=r+e|0;e=s+-40-e|0;M[1191]=f;M[1188]=e;M[f+4>>2]=e|1;M[f+e+4>>2]=40;M[1192]=M[1307];M[n+4>>2]=27;M[n+8>>2]=M[1297];M[n+8+4>>2]=M[1298];M[n+8+8>>2]=M[1299];M[n+8+12>>2]=M[1300];M[1297]=r;M[1298]=s;M[1300]=0;M[1299]=n+8;e=n+24|0;do{f=e;e=e+4|0;M[e>>2]=7}while((f+8|0)>>>0<i>>>0);if((n|0)!=(a|0)){M[n+4>>2]=M[n+4>>2]&-2;M[a+4>>2]=n-a|1;M[n>>2]=n-a;if((n-a|0)>>>0<256){i=4780+((n-a|0)>>>3<<1<<2)|0;e=M[1185]|0;if(!(e&1<<((n-a|0)>>>3))){M[1185]=e|1<<((n-a|0)>>>3);e=i;t=i+8|0}else{e=M[i+8>>2]|0;t=i+8|0}M[t>>2]=a;M[e+12>>2]=a;M[a+8>>2]=e;M[a+12>>2]=i;break}if(!((n-a|0)>>>8))e=0;else if((n-a|0)>>>0>16777215)e=31;else{e=(n-a|0)>>>8<<((((n-a|0)>>>8)+1048320|0)>>>16&8);e=14-((e+520192|0)>>>16&4|(((n-a|0)>>>8)+1048320|0)>>>16&8|((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)+(e<<((e+520192|0)>>>16&4)<<(((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;e=(n-a|0)>>>(e+7|0)&1|e<<1}r=5044+(e<<2)|0;M[a+28>>2]=e;M[a+20>>2]=0;M[a+16>>2]=0;t=M[1186]|0;i=1<<e;if(!(t&i)){M[1186]=t|i;M[r>>2]=a;M[a+24>>2]=r;M[a+12>>2]=a;M[a+8>>2]=a;break}t=n-a<<((e|0)==31?0:25-(e>>>1)|0);i=M[r>>2]|0;while(1){if((M[i+4>>2]&-8|0)==(n-a|0)){f=216;break}r=i+16+(t>>>31<<2)|0;e=M[r>>2]|0;if(!e){f=215;break}else{t=t<<1;i=e}}if((f|0)==215){M[r>>2]=a;M[a+24>>2]=i;M[a+12>>2]=a;M[a+8>>2]=a;break}else if((f|0)==216){h=i+8|0;f=M[h>>2]|0;M[f+12>>2]=a;M[h>>2]=a;M[a+8>>2]=f;M[a+12>>2]=i;M[a+24>>2]=0;break}}}}while(0);e=M[1188]|0;if(e>>>0>l>>>0){c=e-l|0;M[1188]=c;f=M[1191]|0;h=f+l|0;M[1191]=h;M[h+4>>2]=c|1;M[f+4>>2]=l|3;f=f+8|0;P=_;return f|0}}M[(Be()|0)>>2]=12;f=0;P=_;return f|0}function Pe(e){e=e|0;var t=0,i=0,r=0,n=0,s=0,a=0,o=0,u=0;if(!e)return;t=M[1189]|0;i=M[e+-4>>2]|0;u=e+-8+(i&-8)|0;do{if(!(i&1)){r=M[e+-8>>2]|0;if(!(i&3))return;a=e+-8+(0-r)|0;s=r+(i&-8)|0;if(a>>>0<t>>>0)return;if((a|0)==(M[1190]|0)){e=M[u+4>>2]|0;if((e&3|0)!=3){o=a;t=s;break}M[1187]=s;M[u+4>>2]=e&-2;M[a+4>>2]=s|1;M[a+s>>2]=s;return}if(r>>>0<256){e=M[a+8>>2]|0;t=M[a+12>>2]|0;if((t|0)==(e|0)){M[1185]=M[1185]&~(1<<(r>>>3));o=a;t=s;break}else{M[e+12>>2]=t;M[t+8>>2]=e;o=a;t=s;break}}n=M[a+24>>2]|0;e=M[a+12>>2]|0;do{if((e|0)==(a|0)){e=M[a+16+4>>2]|0;if(!e){e=M[a+16>>2]|0;if(!e){e=0;break}else r=a+16|0}else r=a+16+4|0;while(1){t=e+20|0;i=M[t>>2]|0;if(i|0){e=i;r=t;continue}t=e+16|0;i=M[t>>2]|0;if(!i)break;else{e=i;r=t}}M[r>>2]=0}else{o=M[a+8>>2]|0;M[o+12>>2]=e;M[e+8>>2]=o}}while(0);if(!n){o=a;t=s}else{t=M[a+28>>2]|0;if((a|0)==(M[5044+(t<<2)>>2]|0)){M[5044+(t<<2)>>2]=e;if(!e){M[1186]=M[1186]&~(1<<t);o=a;t=s;break}}else{M[n+16+(((M[n+16>>2]|0)!=(a|0)&1)<<2)>>2]=e;if(!e){o=a;t=s;break}}M[e+24>>2]=n;t=M[a+16>>2]|0;if(t|0){M[e+16>>2]=t;M[t+24>>2]=e}t=M[a+16+4>>2]|0;if(!t){o=a;t=s}else{M[e+20>>2]=t;M[t+24>>2]=e;o=a;t=s}}}else{o=e+-8|0;t=i&-8;a=e+-8|0}}while(0);if(a>>>0>=u>>>0)return;i=M[u+4>>2]|0;if(!(i&1))return;if(!(i&2)){e=M[1190]|0;if((u|0)==(M[1191]|0)){u=(M[1188]|0)+t|0;M[1188]=u;M[1191]=o;M[o+4>>2]=u|1;if((o|0)!=(e|0))return;M[1190]=0;M[1187]=0;return}if((u|0)==(e|0)){u=(M[1187]|0)+t|0;M[1187]=u;M[1190]=a;M[o+4>>2]=u|1;M[a+u>>2]=u;return}n=(i&-8)+t|0;do{if(i>>>0<256){t=M[u+8>>2]|0;e=M[u+12>>2]|0;if((e|0)==(t|0)){M[1185]=M[1185]&~(1<<(i>>>3));break}else{M[t+12>>2]=e;M[e+8>>2]=t;break}}else{s=M[u+24>>2]|0;e=M[u+12>>2]|0;do{if((e|0)==(u|0)){e=M[u+16+4>>2]|0;if(!e){e=M[u+16>>2]|0;if(!e){t=0;break}else r=u+16|0}else r=u+16+4|0;while(1){t=e+20|0;i=M[t>>2]|0;if(i|0){e=i;r=t;continue}t=e+16|0;i=M[t>>2]|0;if(!i)break;else{e=i;r=t}}M[r>>2]=0;t=e}else{t=M[u+8>>2]|0;M[t+12>>2]=e;M[e+8>>2]=t;t=e}}while(0);if(s|0){e=M[u+28>>2]|0;if((u|0)==(M[5044+(e<<2)>>2]|0)){M[5044+(e<<2)>>2]=t;if(!t){M[1186]=M[1186]&~(1<<e);break}}else{M[s+16+(((M[s+16>>2]|0)!=(u|0)&1)<<2)>>2]=t;if(!t)break}M[t+24>>2]=s;e=M[u+16>>2]|0;if(e|0){M[t+16>>2]=e;M[e+24>>2]=t}e=M[u+16+4>>2]|0;if(e|0){M[t+20>>2]=e;M[e+24>>2]=t}}}}while(0);M[o+4>>2]=n|1;M[a+n>>2]=n;if((o|0)==(M[1190]|0)){M[1187]=n;return}}else{M[u+4>>2]=i&-2;M[o+4>>2]=t|1;M[a+t>>2]=t;n=t}i=n>>>3;if(n>>>0<256){e=M[1185]|0;if(!(e&1<<i)){M[1185]=e|1<<i;e=4780+(i<<1<<2)|0;t=4780+(i<<1<<2)+8|0}else{e=M[4780+(i<<1<<2)+8>>2]|0;t=4780+(i<<1<<2)+8|0}M[t>>2]=o;M[e+12>>2]=o;M[o+8>>2]=e;M[o+12>>2]=4780+(i<<1<<2);return}e=n>>>8;if(!e)e=0;else if(n>>>0>16777215)e=31;else{u=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(u+245760|0)>>>16&2)+(u<<((u+245760|0)>>>16&2)>>>15)|0;e=n>>>(e+7|0)&1|e<<1}r=5044+(e<<2)|0;M[o+28>>2]=e;M[o+20>>2]=0;M[o+16>>2]=0;t=M[1186]|0;i=1<<e;do{if(!(t&i)){M[1186]=t|i;M[r>>2]=o;M[o+24>>2]=r;M[o+12>>2]=o;M[o+8>>2]=o}else{t=n<<((e|0)==31?0:25-(e>>>1)|0);i=M[r>>2]|0;while(1){if((M[i+4>>2]&-8|0)==(n|0)){e=73;break}r=i+16+(t>>>31<<2)|0;e=M[r>>2]|0;if(!e){e=72;break}else{t=t<<1;i=e}}if((e|0)==72){M[r>>2]=o;M[o+24>>2]=i;M[o+12>>2]=o;M[o+8>>2]=o;break}else if((e|0)==73){a=i+8|0;u=M[a>>2]|0;M[u+12>>2]=o;M[a>>2]=o;M[o+8>>2]=u;M[o+12>>2]=i;M[o+24>>2]=0;break}}}while(0);u=(M[1193]|0)+-1|0;M[1193]=u;if(!u)e=5196;else return;while(1){e=M[e>>2]|0;if(!e)break;else e=e+8|0}M[1193]=-1;return}function Se(){return 5236}function Ee(e){e=e|0;var t=0;t=P;P=P+16|0;M[t>>2]=Le(M[e+60>>2]|0)|0;e=xe(te(6,t|0)|0)|0;P=t;return e|0}function Re(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0,a=0,o=0,u=0,c=0;o=P;P=P+48|0;r=M[e+28>>2]|0;M[o+32>>2]=r;r=(M[e+20>>2]|0)-r|0;M[o+32+4>>2]=r;M[o+32+8>>2]=t;M[o+32+12>>2]=i;M[o>>2]=M[e+60>>2];M[o+4>>2]=o+32;M[o+8>>2]=2;n=xe(re(146,o|0)|0)|0;e:do{if((r+i|0)==(n|0))a=3;else{t=2;s=r+i|0;r=o+32|0;while(1){if((n|0)<0)break;s=s-n|0;u=M[r+4>>2]|0;c=n>>>0>u>>>0;r=c?r+8|0:r;t=(c<<31>>31)+t|0;u=n-(c?u:0)|0;M[r>>2]=(M[r>>2]|0)+u;M[r+4>>2]=(M[r+4>>2]|0)-u;M[o+16>>2]=M[e+60>>2];M[o+16+4>>2]=r;M[o+16+8>>2]=t;n=xe(re(146,o+16|0)|0)|0;if((s|0)==(n|0)){a=3;break e}}M[e+16>>2]=0;M[e+28>>2]=0;M[e+20>>2]=0;M[e>>2]=M[e>>2]|32;if((t|0)==2)i=0;else i=i-(M[r+4>>2]|0)|0}}while(0);if((a|0)==3){c=M[e+44>>2]|0;M[e+16>>2]=c+(M[e+48>>2]|0);M[e+28>>2]=c;M[e+20>>2]=c}P=o;return i|0}function Ie(e,t,i){e=e|0;t=t|0;i=i|0;var r=0;r=P;P=P+32|0;M[r>>2]=M[e+60>>2];M[r+4>>2]=0;M[r+8>>2]=t;M[r+12>>2]=r+20;M[r+16>>2]=i;if((xe(se(140,r|0)|0)|0)<0){M[r+20>>2]=-1;e=-1}else e=M[r+20>>2]|0;P=r;return e|0}function xe(e){e=e|0;if(e>>>0>4294963200){M[(Be()|0)>>2]=0-e;e=-1}return e|0}function Be(){return(Fe()|0)+64|0}function Fe(){return Oe()|0}function Oe(){return 136}function Le(e){e=e|0;return e|0}function De(e,t){e=e|0;t=t|0;var i=0,r=0;i=A[e>>0]|0;r=A[t>>0]|0;if(i<<24>>24==0?1:i<<24>>24!=r<<24>>24)e=r;else{do{e=e+1|0;t=t+1|0;i=A[e>>0]|0;r=A[t>>0]|0}while(!(i<<24>>24==0?1:i<<24>>24!=r<<24>>24));e=r}return(i&255)-(e&255)|0}function He(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;var n=0,s=0;n=W(i,t)|0;i=(t|0)==0?0:i;if((M[r+76>>2]|0)>-1){s=(Ne(r)|0)==0;e=We(e,n,r)|0;if(!s)Ue(r)}else e=We(e,n,r)|0;if((e|0)!=(n|0))i=(e>>>0)/(t>>>0)|0;return i|0}function Ue(e){e=e|0;return}function Ne(e){e=e|0;return 0}function je(e,t){e=e|0;t=t|0;var i=0,r=0,n=0,s=0;s=P;P=P+16|0;A[s>>0]=t;i=M[e+16>>2]|0;if(!i)if(!(Ve(e)|0)){r=M[e+16>>2]|0;n=4}else i=-1;else{r=i;n=4}do{if((n|0)==4){i=M[e+20>>2]|0;if(i>>>0<r>>>0)if((t&255|0)!=(A[e+75>>0]|0)){M[e+20>>2]=i+1;A[i>>0]=t;i=t&255;break}if((Ot[M[e+36>>2]&3](e,s,1)|0)==1)i=T[s>>0]|0;else i=-1}}while(0);P=s;return i|0}function Ve(e){e=e|0;var t=0;t=A[e+74>>0]|0;A[e+74>>0]=t+255|t;t=M[e>>2]|0;if(!(t&8)){M[e+8>>2]=0;M[e+4>>2]=0;t=M[e+44>>2]|0;M[e+28>>2]=t;M[e+20>>2]=t;M[e+16>>2]=t+(M[e+48>>2]|0);e=0}else{M[e>>2]=t|32;e=-1}return e|0}function We(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0,a=0;r=M[i+16>>2]|0;if(!r)if(!(Ve(i)|0)){n=M[i+16>>2]|0;s=5}else r=0;else{n=r;s=5}e:do{if((s|0)==5){r=M[i+20>>2]|0;if((n-r|0)>>>0<t>>>0){r=Ot[M[i+36>>2]&3](i,e,t)|0;break}t:do{if((A[i+75>>0]|0)>-1){s=t;while(1){if(!s){a=0;n=e;break t}n=s+-1|0;if((A[e+n>>0]|0)==10)break;else s=n}r=Ot[M[i+36>>2]&3](i,e,s)|0;if(r>>>0<s>>>0)break e;a=s;n=e+s|0;t=t-s|0;r=M[i+20>>2]|0}else{a=0;n=e}}while(0);wt(r|0,n|0,t|0)|0;M[i+20>>2]=(M[i+20>>2]|0)+t;r=a+t|0}}while(0);return r|0}function Qe(e,t){e=e|0;t=t|0;if(!t)t=0;else t=ze(M[t>>2]|0,M[t+4>>2]|0,e)|0;return(t|0?t:e)|0}function ze(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0,a=0,o=0,u=0,c=0,h=0,l=0;l=(M[e>>2]|0)+1794895138|0;r=qe(M[e+8>>2]|0,l)|0;u=qe(M[e+12>>2]|0,l)|0;h=qe(M[e+16>>2]|0,l)|0;e:do{if(r>>>0<t>>>2>>>0)if(u>>>0<(t-(r<<2)|0)>>>0&h>>>0<(t-(r<<2)|0)>>>0)if(!((h|u)&3)){o=0;while(1){a=r>>>1;c=o+a|0;n=qe(M[e+((c<<1)+(u>>>2)<<2)>>2]|0,l)|0;s=qe(M[e+((c<<1)+(u>>>2)+1<<2)>>2]|0,l)|0;if(!(s>>>0<t>>>0&n>>>0<(t-s|0)>>>0)){r=0;break e}if(A[e+(s+n)>>0]|0){r=0;break e}n=De(i,e+s|0)|0;if(!n)break;if((r|0)==1){r=0;break e}else{o=(n|0)<0?o:c;r=(n|0)<0?a:r-a|0}}n=qe(M[e+((c<<1)+(h>>>2)<<2)>>2]|0,l)|0;r=qe(M[e+((c<<1)+(h>>>2)+1<<2)>>2]|0,l)|0;if(r>>>0<t>>>0&n>>>0<(t-r|0)>>>0)r=(A[e+(r+n)>>0]|0)==0?e+r|0:0;else r=0}else r=0;else r=0;else r=0}while(0);return r|0}function qe(e,t){e=e|0;t=t|0;var i=0;i=St(e|0)|0;return((t|0)==0?e:i)|0}function Ye(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0;e:do{if((i|0)!=0&(e&3|0)!=0){r=e;e=i;while(1){if((A[r>>0]|0)==(t&255)<<24>>24){n=6;break e}r=r+1|0;i=e+-1|0;if((i|0)!=0&(r&3|0)!=0)e=i;else{e=i;i=(i|0)!=0;n=5;break}}}else{r=e;e=i;i=(i|0)!=0;n=5}}while(0);if((n|0)==5)if(i)n=6;else e=0;e:do{if((n|0)==6)if((A[r>>0]|0)!=(t&255)<<24>>24){i=W(t&255,16843009)|0;t:do{if(e>>>0>3)while(1){s=M[r>>2]^i;if((s&-2139062144^-2139062144)&s+-16843009|0)break;r=r+4|0;e=e+-4|0;if(e>>>0<=3){n=11;break t}}else n=11}while(0);if((n|0)==11)if(!e){e=0;break}while(1){if((A[r>>0]|0)==(t&255)<<24>>24)break e;r=r+1|0;e=e+-1|0;if(!e){e=0;break}}}}while(0);return(e|0?r:0)|0}function Ke(e,t,i){e=e|0;t=t|0;i=i|0;var r=0;r=P;P=P+16|0;M[r>>2]=i;i=Ge(e,t,r)|0;P=r;return i|0}function Ge(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0,a=0;a=P;P=P+224|0;r=a+80|0;n=r+40|0;do{M[r>>2]=0;r=r+4|0}while((r|0)<(n|0));M[a+120>>2]=M[i>>2];if((Je(0,t,a+120|0,a,a+80|0)|0)<0)i=-1;else{if((M[e+76>>2]|0)>-1)s=Ne(e)|0;else s=0;n=M[e>>2]|0;if((A[e+74>>0]|0)<1)M[e>>2]=n&-33;if(!(M[e+48>>2]|0)){r=M[e+44>>2]|0;M[e+44>>2]=a+136;M[e+28>>2]=a+136;M[e+20>>2]=a+136;M[e+48>>2]=80;M[e+16>>2]=a+136+80;i=Je(e,t,a+120|0,a,a+80|0)|0;if(r){Ot[M[e+36>>2]&3](e,0,0)|0;i=(M[e+20>>2]|0)==0?-1:i;M[e+44>>2]=r;M[e+48>>2]=0;M[e+16>>2]=0;M[e+28>>2]=0;M[e+20>>2]=0}}else i=Je(e,t,a+120|0,a,a+80|0)|0;r=M[e>>2]|0;M[e>>2]=r|n&32;if(s|0)Ue(e);i=(r&32|0)==0?i:-1}P=a;return i|0}function Je(e,t,i,r,n){e=e|0;t=t|0;i=i|0;r=r|0;n=n|0;var s=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0,_=0,d=0,p=0,g=0,b=0,m=0,y=0;m=P;P=P+64|0;M[m+16>>2]=t;b=m+24+40|0;a=0;s=0;h=0;e:while(1){do{if((s|0)>-1)if((a|0)>(2147483647-s|0)){M[(Be()|0)>>2]=75;s=-1;break}else{s=a+s|0;break}}while(0);a=A[t>>0]|0;if(!(a<<24>>24)){g=87;break}else o=t;t:while(1){switch(a<<24>>24){case 37:{a=o;g=9;break t}case 0:{a=o;break t}default:{}}p=o+1|0;M[m+16>>2]=p;a=A[p>>0]|0;o=p}t:do{if((g|0)==9)while(1){g=0;if((A[o+1>>0]|0)!=37)break t;a=a+1|0;o=o+2|0;M[m+16>>2]=o;if((A[o>>0]|0)==37)g=9;else break}}while(0);a=a-t|0;if(e|0)Xe(e,t,a);if(a|0){t=o;continue}u=o+1|0;a=(A[u>>0]|0)+-48|0;if(a>>>0<10){p=(A[o+2>>0]|0)==36;_=p?a:-1;h=p?1:h;u=p?o+3|0:u}else _=-1;M[m+16>>2]=u;a=A[u>>0]|0;t:do{if(((a<<24>>24)+-32|0)>>>0<32){o=0;l=a;c=(a<<24>>24)+-32|0;while(1){a=1<<c;if(!(a&75913)){a=l;break t}o=a|o;u=u+1|0;M[m+16>>2]=u;a=A[u>>0]|0;c=(a<<24>>24)+-32|0;if(c>>>0>=32)break;else l=a}}else o=0}while(0);if(a<<24>>24==42){c=u+1|0;a=(A[c>>0]|0)+-48|0;if(a>>>0<10)if((A[u+2>>0]|0)==36){M[n+(a<<2)>>2]=10;a=M[r+((A[c>>0]|0)+-48<<3)>>2]|0;h=1;u=u+3|0}else g=23;else g=23;if((g|0)==23){g=0;if(h|0){s=-1;break}if(e|0){h=(M[i>>2]|0)+(4-1)&~(4-1);a=M[h>>2]|0;M[i>>2]=h+4;h=0;u=c}else{a=0;h=0;u=c}}M[m+16>>2]=u;d=(a|0)<0;a=d?0-a|0:a;d=d?o|8192:o}else{a=$e(m+16|0)|0;if((a|0)<0){s=-1;break}d=o;u=M[m+16>>2]|0}do{if((A[u>>0]|0)==46){if((A[u+1>>0]|0)!=42){M[m+16>>2]=u+1;o=$e(m+16|0)|0;u=M[m+16>>2]|0;break}c=u+2|0;o=(A[c>>0]|0)+-48|0;if(o>>>0<10)if((A[u+3>>0]|0)==36){M[n+(o<<2)>>2]=10;o=M[r+((A[c>>0]|0)+-48<<3)>>2]|0;u=u+4|0;M[m+16>>2]=u;break}if(h|0){s=-1;break e}if(e|0){p=(M[i>>2]|0)+(4-1)&~(4-1);o=M[p>>2]|0;M[i>>2]=p+4}else o=0;M[m+16>>2]=c;u=c}else o=-1}while(0);f=0;while(1){if(((A[u>>0]|0)+-65|0)>>>0>57){s=-1;break e}p=u+1|0;M[m+16>>2]=p;c=A[(A[u>>0]|0)+-65+(2221+(f*58|0))>>0]|0;if(((c&255)+-1|0)>>>0<8){f=c&255;u=p}else break}if(!(c<<24>>24)){s=-1;break}l=(_|0)>-1;do{if(c<<24>>24==19)if(l){s=-1;break e}else g=49;else{if(l){M[n+(_<<2)>>2]=c&255;_=r+(_<<3)|0;g=M[_+4>>2]|0;M[m>>2]=M[_>>2];M[m+4>>2]=g;g=49;break}if(!e){s=0;break e}Ze(m,c&255,i)}}while(0);if((g|0)==49){g=0;if(!e){a=0;t=p;continue}}u=A[u>>0]|0;u=(f|0)!=0&(u&15|0)==3?u&-33:u;_=d&-65537;d=(d&8192|0)==0?d:_;t:do{switch(u|0){case 110:switch((f&255)<<24>>24){case 0:{M[M[m>>2]>>2]=s;a=0;t=p;continue e}case 1:{M[M[m>>2]>>2]=s;a=0;t=p;continue e}case 2:{a=M[m>>2]|0;M[a>>2]=s;M[a+4>>2]=((s|0)<0)<<31>>31;a=0;t=p;continue e}case 3:{k[M[m>>2]>>1]=s;a=0;t=p;continue e}case 4:{A[M[m>>2]>>0]=s;a=0;t=p;continue e}case 6:{M[M[m>>2]>>2]=s;a=0;t=p;continue e}case 7:{a=M[m>>2]|0;M[a>>2]=s;M[a+4>>2]=((s|0)<0)<<31>>31;a=0;t=p;continue e}default:{a=0;t=p;continue e}}case 112:{u=120;o=o>>>0>8?o:8;t=d|8;g=61;break}case 88:case 120:{t=d;g=61;break}case 111:{t=M[m>>2]|0;u=M[m+4>>2]|0;_=tt(t,u,b)|0;f=_;c=0;l=2685;o=(d&8|0)==0|(o|0)>(b-_|0)?o:b-_+1|0;_=d;g=67;break}case 105:case 100:{t=M[m>>2]|0;u=M[m+4>>2]|0;if((u|0)<0){t=bt(0,0,t|0,u|0)|0;u=S;M[m>>2]=t;M[m+4>>2]=u;c=1;l=2685;g=66;break t}else{c=(d&2049|0)!=0&1;l=(d&2048|0)==0?(d&1|0)==0?2685:2687:2686;g=66;break t}}case 117:{c=0;l=2685;t=M[m>>2]|0;u=M[m+4>>2]|0;g=66;break}case 99:{A[m+24+39>>0]=M[m>>2];t=m+24+39|0;c=0;l=2685;f=b;u=1;o=_;break}case 109:{u=rt(M[(Be()|0)>>2]|0)|0;g=71;break}case 115:{u=M[m>>2]|0;u=u|0?u:2695;g=71;break}case 67:{M[m+8>>2]=M[m>>2];M[m+8+4>>2]=0;M[m>>2]=m+8;f=-1;u=m+8|0;g=75;break}case 83:{t=M[m>>2]|0;if(!o){nt(e,32,a,0,d);t=0;g=84}else{f=o;u=t;g=75}break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{a=at(e,+v[m>>3],a,o,d,u)|0;t=p;continue e}default:{c=0;l=2685;f=b;u=o;o=d}}}while(0);t:do{if((g|0)==61){y=M[m>>2]|0;d=M[m+4>>2]|0;f=et(y,d,b,u&32)|0;l=(t&8|0)==0|(y|0)==0&(d|0)==0;c=l?0:2;l=l?2685:2685+(u>>4)|0;_=t;t=y;u=d;g=67}else if((g|0)==66){f=it(t,u,b)|0;_=d;g=67}else if((g|0)==71){g=0;y=Ye(u,0,o)|0;t=u;c=0;l=2685;f=(y|0)==0?u+o|0:y;u=(y|0)==0?o:y-u|0;o=_}else if((g|0)==75){g=0;l=u;t=0;o=0;while(1){c=M[l>>2]|0;if(!c)break;o=st(m+20|0,c)|0;if((o|0)<0|o>>>0>(f-t|0)>>>0)break;t=o+t|0;if(f>>>0>t>>>0)l=l+4|0;else break}if((o|0)<0){s=-1;break e}nt(e,32,a,t,d);if(!t){t=0;g=84}else{c=0;while(1){o=M[u>>2]|0;if(!o){g=84;break t}o=st(m+20|0,o)|0;c=o+c|0;if((c|0)>(t|0)){g=84;break t}Xe(e,m+20|0,o);if(c>>>0>=t>>>0){g=84;break}else u=u+4|0}}}}while(0);if((g|0)==67){g=0;u=(t|0)!=0|(u|0)!=0;y=(o|0)!=0|u;u=((u^1)&1)+(b-f)|0;t=y?f:b;f=b;u=y?(o|0)>(u|0)?o:u:o;o=(o|0)>-1?_&-65537:_}else if((g|0)==84){g=0;nt(e,32,a,t,d^8192);a=(a|0)>(t|0)?a:t;t=p;continue}d=f-t|0;_=(u|0)<(d|0)?d:u;y=_+c|0;a=(a|0)<(y|0)?y:a;nt(e,32,a,y,o);Xe(e,l,c);nt(e,48,a,y,o^65536);nt(e,48,_,d,0);Xe(e,t,d);nt(e,32,a,y,o^8192);t=p}e:do{if((g|0)==87)if(!e)if(!h)s=0;else{s=1;while(1){t=M[n+(s<<2)>>2]|0;if(!t)break;Ze(r+(s<<3)|0,t,i);s=s+1|0;if((s|0)>=10){s=1;break e}}while(1){if(M[n+(s<<2)>>2]|0){s=-1;break e}s=s+1|0;if((s|0)>=10){s=1;break}}}}while(0);P=m;return s|0}function Xe(e,t,i){e=e|0;t=t|0;i=i|0;if(!(M[e>>2]&32))We(t,i,e)|0;return}function $e(e){e=e|0;var t=0,i=0,r=0;i=M[e>>2]|0;r=(A[i>>0]|0)+-48|0;if(r>>>0<10){t=0;do{t=r+(t*10|0)|0;i=i+1|0;M[e>>2]=i;r=(A[i>>0]|0)+-48|0}while(r>>>0<10)}else t=0;return t|0}function Ze(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0.0;e:do{if(t>>>0<=20)do{switch(t|0){case 9:{r=(M[i>>2]|0)+(4-1)&~(4-1);t=M[r>>2]|0;M[i>>2]=r+4;M[e>>2]=t;break e}case 10:{t=(M[i>>2]|0)+(4-1)&~(4-1);r=M[t>>2]|0;M[i>>2]=t+4;M[e>>2]=r;M[e+4>>2]=((r|0)<0)<<31>>31;break e}case 11:{t=(M[i>>2]|0)+(4-1)&~(4-1);r=M[t>>2]|0;M[i>>2]=t+4;M[e>>2]=r;M[e+4>>2]=0;break e}case 12:{n=(M[i>>2]|0)+(8-1)&~(8-1);t=M[n>>2]|0;r=M[n+4>>2]|0;M[i>>2]=n+8;M[e>>2]=t;M[e+4>>2]=r;break e}case 13:{r=(M[i>>2]|0)+(4-1)&~(4-1);n=M[r>>2]|0;M[i>>2]=r+4;M[e>>2]=(n&65535)<<16>>16;M[e+4>>2]=(((n&65535)<<16>>16|0)<0)<<31>>31;break e}case 14:{r=(M[i>>2]|0)+(4-1)&~(4-1);n=M[r>>2]|0;M[i>>2]=r+4;M[e>>2]=n&65535;M[e+4>>2]=0;break e}case 15:{r=(M[i>>2]|0)+(4-1)&~(4-1);n=M[r>>2]|0;M[i>>2]=r+4;M[e>>2]=(n&255)<<24>>24;M[e+4>>2]=(((n&255)<<24>>24|0)<0)<<31>>31;break e}case 16:{r=(M[i>>2]|0)+(4-1)&~(4-1);n=M[r>>2]|0;M[i>>2]=r+4;M[e>>2]=n&255;M[e+4>>2]=0;break e}case 17:{n=(M[i>>2]|0)+(8-1)&~(8-1);s=+v[n>>3];M[i>>2]=n+8;v[e>>3]=s;break e}case 18:{n=(M[i>>2]|0)+(8-1)&~(8-1);s=+v[n>>3];M[i>>2]=n+8;v[e>>3]=s;break e}default:break e}}while(0)}while(0);return}function et(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;if(!((e|0)==0&(t|0)==0))do{i=i+-1|0;A[i>>0]=T[2737+(e&15)>>0]|0|r;e=kt(e|0,t|0,4)|0;t=S}while(!((e|0)==0&(t|0)==0));return i|0}function tt(e,t,i){e=e|0;t=t|0;i=i|0;if(!((e|0)==0&(t|0)==0))do{i=i+-1|0;A[i>>0]=e&7|48;e=kt(e|0,t|0,3)|0;t=S}while(!((e|0)==0&(t|0)==0));return i|0}function it(e,t,i){e=e|0;t=t|0;i=i|0;var r=0;if(t>>>0>0|(t|0)==0&e>>>0>4294967295){while(1){r=Pt(e|0,t|0,10,0)|0;i=i+-1|0;A[i>>0]=r&255|48;r=e;e=Mt(e|0,t|0,10,0)|0;if(!(t>>>0>9|(t|0)==9&r>>>0>4294967295))break;else t=S}t=e}else t=e;if(t)while(1){i=i+-1|0;A[i>>0]=(t>>>0)%10|0|48;if(t>>>0<10)break;else t=(t>>>0)/10|0}return i|0}function rt(e){e=e|0;return _t(e,M[(ft()|0)+188>>2]|0)|0}function nt(e,t,i,r,n){e=e|0;t=t|0;i=i|0;r=r|0;n=n|0;var s=0;s=P;P=P+256|0;if((i|0)>(r|0)&(n&73728|0)==0){yt(s|0,t|0,((i-r|0)>>>0<256?i-r|0:256)|0)|0;if((i-r|0)>>>0>255){t=i-r|0;do{Xe(e,s,256);t=t+-256|0}while(t>>>0>255);t=i-r&255}else t=i-r|0;Xe(e,s,t)}P=s;return}function st(e,t){e=e|0;t=t|0;if(!e)e=0;else e=ht(e,t,0)|0;return e|0}function at(e,t,i,r,n,s){e=e|0;t=+t;i=i|0;r=r|0;n=n|0;s=s|0;var a=0,o=0,u=0,c=0,h=0,l=0.0,f=0,_=0,d=0,p=0,g=0,b=0,m=0,y=0,k=0,v=0,w=0,C=0;C=P;P=P+560|0;w=C+524|0;M[C>>2]=0;v=C+512+12|0;ot(t)|0;if((S|0)<0){t=-t;y=1;m=2702}else{y=(n&2049|0)!=0&1;m=(n&2048|0)==0?(n&1|0)==0?2703:2708:2705}ot(t)|0;k=S&2146435072;do{if(k>>>0<2146435072|(k|0)==2146435072&0<0){l=+ut(t,C)*2.0;if(l!=0.0)M[C>>2]=(M[C>>2]|0)+-1;if((s|32|0)==97){h=(s&32|0)==0?m:m+9|0;c=y|2;do{if(r>>>0>11|(12-r|0)==0)t=l;else{t=8.0;a=12-r|0;do{a=a+-1|0;t=t*16.0}while((a|0)!=0);if((A[h>>0]|0)==45){t=-(t+(-l-t));break}else{t=l+t-t;break}}}while(0);o=M[C>>2]|0;a=(o|0)<0?0-o|0:o;a=it(a,((a|0)<0)<<31>>31,v)|0;if((a|0)==(v|0)){A[C+512+11>>0]=48;a=C+512+11|0}A[a+-1>>0]=(o>>31&2)+43;u=a+-2|0;A[u>>0]=s+15;a=C+524|0;do{k=~~t;o=a+1|0;A[a>>0]=T[2737+k>>0]|s&32;t=(t-+(k|0))*16.0;if((o-w|0)==1)if((n&8|0)==0&((r|0)<1&t==0.0))a=o;else{A[o>>0]=46;a=a+2|0}else a=o}while(t!=0.0);w=a-w|0;a=(r|0)!=0&(w+-2|0)<(r|0)?r+2|0:w;nt(e,32,i,v-u+c+a|0,n);Xe(e,h,c);nt(e,48,i,v-u+c+a|0,n^65536);Xe(e,C+524|0,w);nt(e,48,a-w|0,0,0);Xe(e,u,v-u|0);nt(e,32,i,v-u+c+a|0,n^8192);a=v-u+c+a|0;break}o=(r|0)<0?6:r;if(l!=0.0){c=(M[C>>2]|0)+-28|0;M[C>>2]=c;t=l*268435456.0}else{t=l;c=M[C>>2]|0}k=(c|0)<0?C+8|0:C+8+288|0;a=k;do{b=~~t>>>0;M[a>>2]=b;a=a+4|0;t=(t-+(b>>>0))*1.0e9}while(t!=0.0);if((c|0)>0){u=k;do{r=(c|0)<29?c:29;c=a+-4|0;if(c>>>0>=u>>>0){h=0;do{g=vt(M[c>>2]|0,0,r|0)|0;g=mt(g|0,S|0,h|0,0)|0;b=S;p=Pt(g|0,b|0,1e9,0)|0;M[c>>2]=p;h=Mt(g|0,b|0,1e9,0)|0;c=c+-4|0}while(c>>>0>=u>>>0);if(h){u=u+-4|0;M[u>>2]=h}}while(1){if(a>>>0<=u>>>0)break;c=a+-4|0;if(!(M[c>>2]|0))a=c;else break}c=(M[C>>2]|0)-r|0;M[C>>2]=c}while((c|0)>0)}else u=k;if((c|0)<0)do{r=0-c|0;r=(r|0)<9?r:9;if(u>>>0<a>>>0){h=0;c=u;do{b=M[c>>2]|0;M[c>>2]=(b>>>r)+h;h=W(b&(1<<r)+-1,1e9>>>r)|0;c=c+4|0}while(c>>>0<a>>>0);u=(M[u>>2]|0)==0?u+4|0:u;if(h){M[a>>2]=h;a=a+4|0}}else u=(M[u>>2]|0)==0?u+4|0:u;c=(s|32|0)==102?k:u;a=(a-c>>2|0)>(((o+25|0)/9|0)+1|0)?c+(((o+25|0)/9|0)+1<<2)|0:a;c=(M[C>>2]|0)+r|0;M[C>>2]=c}while((c|0)<0);if(u>>>0<a>>>0){c=(k-u>>2)*9|0;r=M[u>>2]|0;if(r>>>0<10)d=c;else{h=10;do{h=h*10|0;c=c+1|0}while(r>>>0>=h>>>0);d=c}}else d=0;h=o-((s|32|0)!=102?d:0)+(((o|0)!=0&(s|32|0)==103)<<31>>31)|0;if((h|0)<(((a-k>>2)*9|0)+-9|0)){c=k+4+(((h+9216|0)/9|0)+-1024<<2)|0;if((((h+9216|0)%9|0)+1|0)<9){r=((h+9216|0)%9|0)+1|0;h=10;do{h=h*10|0;r=r+1|0}while((r|0)!=9)}else h=10;f=M[c>>2]|0;_=(f>>>0)%(h>>>0)|0;r=(c+4|0)==(a|0);if(r&(_|0)==0)h=d;else{l=(((f>>>0)/(h>>>0)|0)&1|0)==0?9007199254740992.0:9007199254740994.0;b=(h|0)/2|0;t=_>>>0<b>>>0?.5:r&(_|0)==(b|0)?1.0:1.5;if(y){b=(A[m>>0]|0)==45;t=b?-t:t;l=b?-l:l}M[c>>2]=f-_;if(l+t!=l){b=f-_+h|0;M[c>>2]=b;if(b>>>0>999999999)while(1){h=c+-4|0;M[c>>2]=0;if(h>>>0<u>>>0){u=u+-4|0;M[u>>2]=0}b=(M[h>>2]|0)+1|0;M[h>>2]=b;if(b>>>0>999999999)c=h;else{c=h;break}}h=(k-u>>2)*9|0;f=M[u>>2]|0;if(f>>>0>=10){r=10;do{r=r*10|0;h=h+1|0}while(f>>>0>=r>>>0)}}else h=d}g=c+4|0;a=a>>>0>g>>>0?g:a;g=u}else{h=d;g=u}b=a;while(1){if(b>>>0<=g>>>0){p=0;break}a=b+-4|0;if(!(M[a>>2]|0))b=a;else{p=1;break}}f=0-h|0;do{if((s|32|0)==103){if((h|0)>-5?((((o|0)!=0^1)&1)+o|0)>(h|0):0){r=s+-1|0;o=(((o|0)!=0^1)&1)+o+-1-h|0}else{r=s+-2|0;o=(((o|0)!=0^1)&1)+o+-1|0}if(!(n&8)){if(p){c=M[b+-4>>2]|0;if(!c)a=9;else if(!((c>>>0)%10|0)){a=0;u=10;do{u=u*10|0;a=a+1|0}while(!((c>>>0)%(u>>>0)|0|0))}else a=0}else a=9;u=((b-k>>2)*9|0)+-9|0;if((r|32|0)==102){c=u-a|0;c=(c|0)>0?c:0;o=(o|0)<(c|0)?o:c;c=0;break}else{c=u+h-a|0;c=(c|0)>0?c:0;o=(o|0)<(c|0)?o:c;c=0;break}}else c=n&8}else{r=s;c=n&8}}while(0);d=o|c;u=(r|32|0)==102;if(u){_=0;a=(h|0)>0?h:0}else{a=(h|0)<0?f:h;a=it(a,((a|0)<0)<<31>>31,v)|0;if((v-a|0)<2)do{a=a+-1|0;A[a>>0]=48}while((v-a|0)<2);A[a+-1>>0]=(h>>31&2)+43;a=a+-2|0;A[a>>0]=r;_=a;a=v-a|0}a=y+1+o+((d|0)!=0&1)+a|0;nt(e,32,i,a,n);Xe(e,m,y);nt(e,48,i,a,n^65536);if(u){h=g>>>0>k>>>0?k:g;c=h;do{u=it(M[c>>2]|0,0,C+524+9|0)|0;if((c|0)==(h|0)){if((u|0)==(C+524+9|0)){A[C+524+8>>0]=48;u=C+524+8|0}}else if(u>>>0>(C+524|0)>>>0){yt(C+524|0,48,u-w|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}Xe(e,u,C+524+9-u|0);c=c+4|0}while(c>>>0<=k>>>0);if(d|0)Xe(e,2753,1);if(c>>>0<b>>>0&(o|0)>0)while(1){u=it(M[c>>2]|0,0,C+524+9|0)|0;if(u>>>0>(C+524|0)>>>0){yt(C+524|0,48,u-w|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}Xe(e,u,(o|0)<9?o:9);c=c+4|0;u=o+-9|0;if(!(c>>>0<b>>>0&(o|0)>9)){o=u;break}else o=u}nt(e,48,o+9|0,9,0)}else{f=p?b:g+4|0;if((o|0)>-1){r=(c|0)==0;h=g;do{u=it(M[h>>2]|0,0,C+524+9|0)|0;if((u|0)==(C+524+9|0)){A[C+524+8>>0]=48;u=C+524+8|0}do{if((h|0)==(g|0)){c=u+1|0;Xe(e,u,1);if(r&(o|0)<1){u=c;break}Xe(e,2753,1);u=c}else{if(u>>>0<=(C+524|0)>>>0)break;yt(C+524|0,48,u+(0-w)|0)|0;do{u=u+-1|0}while(u>>>0>(C+524|0)>>>0)}}while(0);k=C+524+9-u|0;Xe(e,u,(o|0)>(k|0)?k:o);o=o-k|0;h=h+4|0}while(h>>>0<f>>>0&(o|0)>-1)}nt(e,48,o+18|0,18,0);Xe(e,_,v-_|0)}nt(e,32,i,a,n^8192)}else{a=y+3|0;nt(e,32,i,a,n&-65537);Xe(e,m,y);Xe(e,t!=t|0.0!=0.0?s&32|0?2729:2733:s&32|0?2721:2725,3);nt(e,32,i,a,n^8192)}}while(0);P=C;return((a|0)<(i|0)?i:a)|0}function ot(e){e=+e;var t=0;v[a>>3]=e;t=M[a>>2]|0;S=M[a+4>>2]|0;return t|0}function ut(e,t){e=+e;t=t|0;return+ +ct(e,t)}function ct(e,t){e=+e;t=t|0;var i=0,r=0,n=0;v[a>>3]=e;i=M[a>>2]|0;r=M[a+4>>2]|0;n=kt(i|0,r|0,52)|0;switch(n&2047){case 0:{if(e!=0.0){e=+ct(e*18446744073709551616.0,t);i=(M[t>>2]|0)+-64|0}else i=0;M[t>>2]=i;break}case 2047:break;default:{M[t>>2]=(n&2047)+-1022;M[a>>2]=i;M[a+4>>2]=r&-2146435073|1071644672;e=+v[a>>3]}}return+e}function ht(e,t,i){e=e|0;t=t|0;i=i|0;do{if(!e)e=1;else{if(t>>>0<128){A[e>>0]=t;e=1;break}if(!(M[M[(lt()|0)+188>>2]>>2]|0))if((t&-128|0)==57216){A[e>>0]=t;e=1;break}else{M[(Be()|0)>>2]=84;e=-1;break}if(t>>>0<2048){A[e>>0]=t>>>6|192;A[e+1>>0]=t&63|128;e=2;break}if(t>>>0<55296|(t&-8192|0)==57344){A[e>>0]=t>>>12|224;A[e+1>>0]=t>>>6&63|128;A[e+2>>0]=t&63|128;e=3;break}if((t+-65536|0)>>>0<1048576){A[e>>0]=t>>>18|240;A[e+1>>0]=t>>>12&63|128;A[e+2>>0]=t>>>6&63|128;A[e+3>>0]=t&63|128;e=4;break}else{M[(Be()|0)>>2]=84;e=-1;break}}}while(0);return e|0}function lt(){return Oe()|0}function ft(){return Oe()|0}function _t(e,t){e=e|0;t=t|0;var i=0,r=0;r=0;while(1){if((T[2755+r>>0]|0)==(e|0)){e=2;break}i=r+1|0;if((i|0)==87){i=2843;r=87;e=5;break}else r=i}if((e|0)==2)if(!r)i=2843;else{i=2843;e=5}if((e|0)==5)while(1){do{e=i;i=i+1|0}while((A[e>>0]|0)!=0);r=r+-1|0;if(!r)break;else e=5}return dt(i,M[t+20>>2]|0)|0}function dt(e,t){e=e|0;t=t|0;return Qe(e,t)|0}function pt(e,t){e=e|0;t=t|0;var i=0,r=0;if((M[t+76>>2]|0)<0)r=3;else if(!(Ne(t)|0))r=3;else{if((e&255|0)==(A[t+75>>0]|0))r=10;else{i=M[t+20>>2]|0;if(i>>>0<(M[t+16>>2]|0)>>>0){M[t+20>>2]=i+1;A[i>>0]=e;i=e&255}else r=10}if((r|0)==10)i=je(t,e)|0;Ue(t)}do{if((r|0)==3){if((e&255|0)!=(A[t+75>>0]|0)){i=M[t+20>>2]|0;if(i>>>0<(M[t+16>>2]|0)>>>0){M[t+20>>2]=i+1;A[i>>0]=e;i=e&255;break}}i=je(t,e)|0}}while(0);return i|0}function gt(){}function bt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;r=t-r-(i>>>0>e>>>0|0)>>>0;return(S=r,e-i>>>0|0)|0}function mt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return(S=t+r+(e+i>>>0>>>0<e>>>0|0)>>>0,e+i>>>0|0)|0}function yt(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0;r=e+i|0;t=t&255;if((i|0)>=67){while(e&3){A[e>>0]=t;e=e+1|0}n=t|t<<8|t<<16|t<<24;while((e|0)<=((r&-4)-64|0)){M[e>>2]=n;M[e+4>>2]=n;M[e+8>>2]=n;M[e+12>>2]=n;M[e+16>>2]=n;M[e+20>>2]=n;M[e+24>>2]=n;M[e+28>>2]=n;M[e+32>>2]=n;M[e+36>>2]=n;M[e+40>>2]=n;M[e+44>>2]=n;M[e+48>>2]=n;M[e+52>>2]=n;M[e+56>>2]=n;M[e+60>>2]=n;e=e+64|0}while((e|0)<(r&-4|0)){M[e>>2]=n;e=e+4|0}}while((e|0)<(r|0)){A[e>>0]=t;e=e+1|0}return r-i|0}function kt(e,t,i){e=e|0;t=t|0;i=i|0;if((i|0)<32){S=t>>>i;return e>>>i|(t&(1<<i)-1)<<32-i}S=0;return t>>>i-32|0}function vt(e,t,i){e=e|0;t=t|0;i=i|0;if((i|0)<32){S=t<<i|(e&(1<<i)-1<<32-i)>>>32-i;return e<<i}S=e<<i-32;return 0}function wt(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,s=0;if((i|0)>=8192)return ne(e|0,t|0,i|0)|0;s=e|0;n=e+i|0;if((e&3)==(t&3)){while(e&3){if(!i)return s|0;A[e>>0]=A[t>>0]|0;e=e+1|0;t=t+1|0;i=i-1|0}i=n&-4|0;r=i-64|0;while((e|0)<=(r|0)){M[e>>2]=M[t>>2];M[e+4>>2]=M[t+4>>2];M[e+8>>2]=M[t+8>>2];M[e+12>>2]=M[t+12>>2];M[e+16>>2]=M[t+16>>2];M[e+20>>2]=M[t+20>>2];M[e+24>>2]=M[t+24>>2];M[e+28>>2]=M[t+28>>2];M[e+32>>2]=M[t+32>>2];M[e+36>>2]=M[t+36>>2];M[e+40>>2]=M[t+40>>2];M[e+44>>2]=M[t+44>>2];M[e+48>>2]=M[t+48>>2];M[e+52>>2]=M[t+52>>2];M[e+56>>2]=M[t+56>>2];M[e+60>>2]=M[t+60>>2];e=e+64|0;t=t+64|0}while((e|0)<(i|0)){M[e>>2]=M[t>>2];e=e+4|0;t=t+4|0}}else{i=n-4|0;while((e|0)<(i|0)){A[e>>0]=A[t>>0]|0;A[e+1>>0]=A[t+1>>0]|0;A[e+2>>0]=A[t+2>>0]|0;A[e+3>>0]=A[t+3>>0]|0;e=e+4|0;t=t+4|0}}while((e|0)<(n|0)){A[e>>0]=A[t>>0]|0;e=e+1|0;t=t+1|0}return s|0}function Ct(e){e=e|0;var t=0;t=A[c+(e&255)>>0]|0;if((t|0)<8)return t|0;t=A[c+(e>>8&255)>>0]|0;if((t|0)<8)return t+8|0;t=A[c+(e>>16&255)>>0]|0;if((t|0)<8)return t+16|0;return(A[c+(e>>>24)>>0]|0)+24|0}function At(e,t,i,r,n){e=e|0;t=t|0;i=i|0;r=r|0;n=n|0;var s=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0,_=0,d=0;if(!t)if(!r){if(n|0){M[n>>2]=(e>>>0)%(i>>>0);M[n+4>>2]=0}r=0;n=(e>>>0)/(i>>>0)>>>0;return(S=r,n)|0}else{if(!n){r=0;n=0;return(S=r,n)|0}M[n>>2]=e|0;M[n+4>>2]=t&0;r=0;n=0;return(S=r,n)|0}do{if(!i){if(!r){if(n|0){M[n>>2]=(t>>>0)%(i>>>0);M[n+4>>2]=0}r=0;n=(t>>>0)/(i>>>0)>>>0;return(S=r,n)|0}if(!e){if(n|0){M[n>>2]=0;M[n+4>>2]=(t>>>0)%(r>>>0)}i=0;n=(t>>>0)/(r>>>0)>>>0;return(S=i,n)|0}if(!(r-1&r)){if(n|0){M[n>>2]=e|0;M[n+4>>2]=r-1&t|t&0}i=0;n=t>>>((Ct(r|0)|0)>>>0);return(S=i,n)|0}a=(q(r|0)|0)-(q(t|0)|0)|0;if(a>>>0<=30){f=a+1|0;o=t<<31-a|e>>>((a+1|0)>>>0);l=t>>>((a+1|0)>>>0);s=0;a=e<<31-a;break}if(!n){r=0;n=0;return(S=r,n)|0}M[n>>2]=e|0;M[n+4>>2]=t|t&0;r=0;n=0;return(S=r,n)|0}else{if(r|0){a=(q(r|0)|0)-(q(t|0)|0)|0;if(a>>>0<=31){f=a+1|0;o=e>>>((a+1|0)>>>0)&a-31>>31|t<<31-a;l=t>>>((a+1|0)>>>0)&a-31>>31;s=0;a=e<<31-a;break}if(!n){r=0;n=0;return(S=r,n)|0}M[n>>2]=e|0;M[n+4>>2]=t|t&0;r=0;n=0;return(S=r,n)|0}if(i-1&i|0){a=(q(i|0)|0)+33-(q(t|0)|0)|0;f=a;o=32-a-1>>31&t>>>((a-32|0)>>>0)|(t<<32-a|e>>>(a>>>0))&a-32>>31;l=a-32>>31&t>>>(a>>>0);s=e<<64-a&32-a>>31;a=(t<<64-a|e>>>((a-32|0)>>>0))&32-a>>31|e<<32-a&a-33>>31;break}if(n|0){M[n>>2]=i-1&e;M[n+4>>2]=0}if((i|0)==1){r=t|t&0;n=e|0|0;return(S=r,n)|0}else{n=Ct(i|0)|0;r=t>>>(n>>>0)|0;n=t<<32-n|e>>>(n>>>0)|0;return(S=r,n)|0}}}while(0);if(!f){u=a;t=l;e=0;a=0}else{c=mt(i|0|0,r|r&0|0,-1,-1)|0;h=S;u=a;t=l;e=f;a=0;do{d=u;u=s>>>31|u<<1;s=a|s<<1;d=o<<1|d>>>31|0;_=o>>>31|t<<1|0;bt(c|0,h|0,d|0,_|0)|0;f=S;l=f>>31|((f|0)<0?-1:0)<<1;a=l&1;o=bt(d|0,_|0,l&(i|0)|0,(((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1)&(r|r&0)|0)|0;t=S;e=e-1|0}while((e|0)!=0);e=0}if(n|0){M[n>>2]=o;M[n+4>>2]=t}_=(s|0)>>>31|u<<1|(0<<1|s>>>31)&0|e;d=(s<<1|0>>>31)&-2|a;return(S=_,d)|0}function Mt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return At(e,t,i,r,0)|0}function Tt(e){e=e|0;var t=0,i=0;i=e+15&-16|0;t=M[s>>2]|0;e=t+i|0;if((i|0)>0&(e|0)<(t|0)|(e|0)<0){X()|0;ie(12);return-1}M[s>>2]=e;if((e|0)>(J()|0))if(!(G()|0)){M[s>>2]=t;ie(12);return-1}return t|0}function Pt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;var n=0;n=P;P=P+16|0;At(e,t,i,r,n|0)|0;P=n;return(S=M[n+4>>2]|0,M[n>>2]|0)|0}function St(e){e=e|0;return(e&255)<<24|(e>>8&255)<<16|(e>>16&255)<<8|e>>>24|0}function Et(e,t){e=e|0;t=t|0;return Ft[e&1](t|0)|0}function Rt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return Ot[e&3](t|0,i|0,r|0)|0}function It(e){e=e|0;Y(0);return 0}function xt(e,t,i){e=e|0;t=t|0;i=i|0;Y(1);return 0}function Bt(e){e=e|0;var t=0,i=0,r=0,n=0,s=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0;r=M[e+1368>>2]|0;n=M[e+3472>>2]|0;f=M[e+3496>>2]|0;l=M[e+3504>>2]|0;e:{if((f&65024|0)==23552){if(A[5300]|0){l=M[2]|0;M[e+512>>2]=f&7;M[e+512+4>>2]=f>>>3&7;M[e+512+8>>2]=f>>>6&7;Ke(l,1367,e+512|0)|0}l=(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0;r=ee(3,l&-2|0)|0;M[4668+((f&7)<<2)>>2]=((l&1|0)==0?r:r>>>8)&255;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&63488|0)==34816){if(A[5300]|0){l=M[2]|0;M[e+528>>2]=f&7;M[e+528+4>>2]=f>>>3&7;M[e+528+8>>2]=f>>>5&62;Ke(l,1387,e+528|0)|0}M[4668+((f&7)<<2)>>2]=(ee(3,(M[4668+((f>>>3&7)<<2)>>2]|0)+(f>>>5&62)|0)|0)&65535;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}t=1;i=(f&65024)<<16>>16;if(t)switch(i|0){case 23040:{if(A[5300]|0){l=M[2]|0;M[e+544>>2]=f&7;M[e+544+4>>2]=f>>>3&7;M[e+544+8>>2]=f>>>6&7;Ke(l,1409,e+544|0)|0}M[4668+((f&7)<<2)>>2]=(ee(3,(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0)|0)&65535;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 22016:{if(A[5300]|0){l=M[2]|0;M[e+560>>2]=f&7;M[e+560+4>>2]=f>>>3&7;M[e+560+8>>2]=f>>>6&7;Ke(l,1429,e+560|0)|0}l=(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0;r=ee(3,l&-2|0)|0;r=(l&1|0)==0?r:r>>>8;M[4668+((f&7)<<2)>>2]=(r&128|0)==0?r&255:r|-256;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 24064:{if(A[5300]|0){l=M[2]|0;M[e+576>>2]=f&7;M[e+576+4>>2]=f>>>3&7;M[e+576+8>>2]=f>>>6&7;Ke(l,1450,e+576|0)|0}r=ee(3,(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0)|0;M[4668+((f&7)<<2)>>2]=(r&32768|0)==0?r&65535:r|-65536;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:t=1}if(t)switch(i|0){default:{if(!(f&63488)){if(A[5300]|0){l=M[2]|0;M[e+592>>2]=f&7;M[e+592+4>>2]=f>>>3&7;M[e+592+8>>2]=f>>>6&31;Ke(l,1471,e+592|0)|0}t=M[4668+((f>>>3&7)<<2)>>2]|0;if(!(f>>>6&31))i=M[1184]|0;else{i=M[1184]|0;i=t&1<<32-(f>>>6&31)|0?i|536870912:i&-536870913;M[1184]=i;t=t<<(f>>>6&31)}M[4668+((f&7)<<2)>>2]=t;r=(t|0)<0?i|-2147483648:i&2147483647;M[1184]=(t|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65472|0)==16512){if(A[5300]|0){l=M[2]|0;M[e+608>>2]=f&7;M[e+608+4>>2]=f>>>3&7;Ke(l,1491,e+608|0)|0}t=M[4668+((f&7)<<2)>>2]|0;i=M[4668+((f>>>3&7)<<2)>>2]&255;do{if(!i)i=M[1184]|0;else{if(i>>>0<32){l=M[1184]|0;l=1<<32-i&t|0?l|536870912:l&-536870913;M[1184]=l;t=t<<i;i=l;break}if((i|0)==32){i=M[1184]|0;i=t&1|0?i|536870912:i&-536870913;M[1184]=i;t=0;break}else{i=M[1184]&-536870913;M[1184]=i;t=0;break}}}while(0);M[4668+((f&7)<<2)>>2]=t;r=(t|0)<0?i|-2147483648:i&2147483647;M[1184]=(t|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&63488|0)==2048){if(A[5300]|0){l=M[2]|0;M[e+616>>2]=f&7;M[e+616+4>>2]=f>>>3&7;M[e+616+8>>2]=f>>>6&31;Ke(l,1505,e+616|0)|0}t=M[4668+((f>>>3&7)<<2)>>2]|0;if(!(f>>>6&31)){i=M[1184]|0;i=(t|0)<0?i|536870912:i&-536870913;M[1184]=i;t=0}else{i=M[1184]|0;i=t&1<<(f>>>6&31)+-1|0?i|536870912:i&-536870913;M[1184]=i;t=t>>>(f>>>6&31)}M[4668+((f&7)<<2)>>2]=t;r=(t|0)<0?i|-2147483648:i&2147483647;M[1184]=(t|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65472|0)==16576){if(A[5300]|0){l=M[2]|0;M[e+632>>2]=f&7;M[e+632+4>>2]=f>>>3&7;Ke(l,1525,e+632|0)|0}t=M[4668+((f&7)<<2)>>2]|0;i=M[4668+((f>>>3&7)<<2)>>2]&255;do{if(!i)i=M[1184]|0;else{if(i>>>0<32){l=M[1184]|0;l=1<<i+-1&t|0?l|536870912:l&-536870913;M[1184]=l;t=t>>>i;i=l;break}if((i|0)==32){i=M[1184]|0;i=(t|0)<0?i|536870912:i&-536870913;M[1184]=i;t=0;break}else{i=M[1184]&-536870913;M[1184]=i;t=0;break}}}while(0);M[4668+((f&7)<<2)>>2]=t;r=(t|0)<0?i|-2147483648:i&2147483647;M[1184]=(t|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&63488|0)==8192){if(A[5300]|0){l=M[2]|0;M[e+640>>2]=f>>>8&7;M[e+640+4>>2]=f&255;Ke(l,1539,e+640|0)|0}M[4668+((f>>>8&7)<<2)>>2]=f&255;r=M[1184]&1073741823;M[1184]=(f&255|0)==0?r|1073741824:r;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65472|0)==7168){if(A[5300]|0){l=M[2]|0;M[e+648>>2]=f&7;M[e+648+4>>2]=f>>>3&7;Ke(l,1557,e+648|0)|0}l=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=l;r=M[1184]|0;r=(l|0)<0?r|-2147483648:r&2147483647;M[1184]=((l|0)==0?r|1073741824:r&-1879048193)&-805306369;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65280|0)==17920){if(A[5300]|0){l=M[2]|0;M[e+656>>2]=f>>>4&8|f&7;M[e+656+4>>2]=f>>>3&15;Ke(l,1571,e+656|0)|0}t=M[4668+((f>>>3&15)<<2)>>2]|0;if((f>>>3&15|0)==15){if(t&1|0){l=M[2]|0;M[e+664>>2]=t;Ke(l,520,e+664|0)|0}t=t&-2}M[4668+((f>>>4&8|f&7)<<2)>>2]=(f>>>4&8|f&7|0)==15?((f>>>4&8|f&7|0)==15?t+2|0:t)&-2:t;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}t=1;i=((f&65472)+-16960|0)>>>6&67108863|0;if(t)switch(i|0){case 4:{if(A[5300]|0){l=M[2]|0;M[e+672>>2]=f&7;M[e+672+4>>2]=f>>>3&7;Ke(l,1584,e+672|0)|0}l=W(M[4668+((f>>>3&7)<<2)>>2]|0,M[4668+((f&7)<<2)>>2]|0)|0;M[4668+((f&7)<<2)>>2]=l;r=M[1184]|0;r=(l|0)<0?r|-2147483648:r&2147483647;M[1184]=(l|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 6:{if(A[5300]|0){l=M[2]|0;M[e+680>>2]=f&7;M[e+680+4>>2]=f>>>3&7;Ke(l,1598,e+680|0)|0}l=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=~l;r=M[1184]|0;r=(l|0)>-1?r|-2147483648:r&2147483647;M[1184]=(l|0)==-1?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 0:{if(A[5300]|0){l=M[2]|0;M[e+688>>2]=f&7;M[e+688+4>>2]=f>>>3&7;Ke(l,1612,e+688|0)|0}l=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=0-l;r=M[1184]|0;r=(0-l|0)<0?r|-2147483648:r&2147483647;r=(l|0)==0?r|1073741824:r&-1073741825;r=(((((~l&2147483647)+1|0)>>>31)+(~l>>>31)|0)&2|0)==0?r&-536870913:r|536870912;M[1184]=(((~l&2147483647)+1|0)>>>31|0)==(((((~l&2147483647)+1|0)>>>31)+(~l>>>31)|0)>>>1|0)?r&-268435457:r|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 3:{if(A[5300]|0){l=M[2]|0;M[e+696>>2]=f&7;M[e+696+4>>2]=f>>>3&7;Ke(l,1626,e+696|0)|0}l=M[4668+((f>>>3&7)<<2)>>2]|M[4668+((f&7)<<2)>>2];M[4668+((f&7)<<2)>>2]=l;r=M[1184]|0;r=(l|0)<0?r|-2147483648:r&2147483647;M[1184]=(l|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:t=1}if(t)switch(i|0){default:{t=1;i=(f&65024)<<16>>16;if(t)switch(i|0){case-17408:{if(!(A[5300]|0))i=f&1;else{i=M[2]|0;He(1640,5,1,i)|0;if(!(f&1))t=0;else{M[e+704>>2]=0;Ke(i,1249,e+704|0)|0;t=1}if(f&2){if(t|0)pt(44,i)|0;M[e+1064>>2]=1;Ke(i,1249,e+1064|0)|0;t=t+1|0}if(f&4){if(t|0)pt(44,i)|0;M[e+1072>>2]=2;Ke(i,1249,e+1072|0)|0;t=t+1|0}if(f&8){if(t|0)pt(44,i)|0;M[e+1080>>2]=3;Ke(i,1249,e+1080|0)|0;t=t+1|0}if(f&16){if(t|0)pt(44,i)|0;M[e+1088>>2]=4;Ke(i,1249,e+1088|0)|0;t=t+1|0}if(f&32){if(t|0)pt(44,i)|0;M[e+1096>>2]=5;Ke(i,1249,e+1096|0)|0;t=t+1|0}if(f&64){if(t|0)pt(44,i)|0;M[e+1104>>2]=6;Ke(i,1249,e+1104|0)|0;t=t+1|0}if(f&128){if(t|0)pt(44,i)|0;M[e+1112>>2]=7;Ke(i,1249,e+1112|0)|0;t=t+1|0}if(f&256|0){if(t|0)pt(44,i)|0;He(1646,2,1,i)|0}He(1253,2,1,i)|0;i=f&1}t=M[1180]|0;if(i){M[1167]=ee(1,t|0)|0;t=t+4|0}if(f&2){M[1168]=ee(1,t|0)|0;t=t+4|0}if(f&4){M[1169]=ee(1,t|0)|0;t=t+4|0}if(f&8){M[1170]=ee(1,t|0)|0;t=t+4|0}if(f&16){M[1171]=ee(1,t|0)|0;t=t+4|0}if(f&32){M[1172]=ee(1,t|0)|0;t=t+4|0}if(f&64){M[1173]=ee(1,t|0)|0;t=t+4|0}if(f&128){M[1174]=ee(1,t|0)|0;t=t+4|0}if(f&256){i=ee(1,t|0)|0;if(!(i&1)){f=M[2]|0;M[e+712>>2]=l;M[e+712+4>>2]=i;Ke(f,1649,e+712|0)|0;i=i&-2}M[1182]=i+2&-2;t=t+4|0}M[1180]=t;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case-19456:{h=M[2]|0;if(!(A[5300]|0)){t=f&2;i=f&4;r=f&8;n=f&16;s=f&32;a=f&64;o=f&128;c=f&256;u=f&1}else{He(1703,6,1,h)|0;if(!(f&1))t=0;else{M[e+720>>2]=0;Ke(h,1249,e+720|0)|0;t=1}if(f&2){if(t|0)pt(44,h)|0;M[e+1120>>2]=1;Ke(h,1249,e+1120|0)|0;t=t+1|0}if(f&4){if(t|0)pt(44,h)|0;M[e+1128>>2]=2;Ke(h,1249,e+1128|0)|0;t=t+1|0}if(f&8){if(t|0)pt(44,h)|0;M[e+1136>>2]=3;Ke(h,1249,e+1136|0)|0;t=t+1|0}if(f&16){if(t|0)pt(44,h)|0;M[e+1144>>2]=4;Ke(h,1249,e+1144|0)|0;t=t+1|0}if(f&32){if(t|0)pt(44,h)|0;M[e+1152>>2]=5;Ke(h,1249,e+1152|0)|0;t=t+1|0}if(f&64){if(t|0)pt(44,h)|0;M[e+1160>>2]=6;Ke(h,1249,e+1160|0)|0;t=t+1|0}if(f&128){if(t|0)pt(44,h)|0;M[e+1168>>2]=7;Ke(h,1249,e+1168|0)|0;t=t+1|0}if(f&256|0){if(t|0)pt(44,h)|0;He(1710,2,1,h)|0}He(1253,2,1,h)|0;t=f&2;i=f&4;r=f&8;n=f&16;s=f&32;a=f&64;o=f&128;c=f&256;u=f&1}s=(M[1180]|0)-((o>>>7)+((a>>>6)+((s>>>5)+((n>>>4)+((r>>>3)+((i>>>2)+((t>>>1)+u))))))+(c>>>8)<<2)|0;t=s;r=0;n=1;while(1){if(!(n&f))i=t;else{i=M[4668+(r<<2)>>2]|0;t:do{if((t&-268435456|0)==-536870912){u=t+536813552|0;switch(u>>>2|u<<30|0){case 0:{u=M[1164]|0;M[1164]=i&65543;if((i&1|0)==0|(u&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=i&16777215;break t}case 2:{M[1166]=i&16777215;break t}case 3:break t;default:break t}}else ue(2,t|0,i|0)|0}while(0);i=t+4|0}r=r+1|0;if((r|0)==8)break;else{t=i;n=n<<1&254}}do{if(c|0){t=M[1181]|0;t:do{if((i&-268435456|0)==-536870912){f=i+536813552|0;switch(f>>>2|f<<30|0){case 0:{f=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(f&1|0)!=0)break t;M[1166]=M[1165];break t}case 1:{M[1165]=t&16777215;break t}case 2:{M[1166]=t&16777215;break t}case 3:break t;default:break t}}else ue(2,i|0,t|0)|0}while(0);if(t&1|0)break;M[e+728>>2]=l;M[e+728+4>>2]=t;Ke(h,1713,e+728|0)|0}}while(0);M[1180]=s;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:t=1}if(t)switch(i|0){default:{t:do{if((f&65472)<<16>>16<-17728)switch((f&65472)<<16>>16){case-17920:{if(A[5300]|0){l=M[2]|0;M[e+736>>2]=f&7;M[e+736+4>>2]=f>>>3&7;Ke(l,1768,e+736|0)|0}M[4668+((f&7)<<2)>>2]=St(M[4668+((f>>>3&7)<<2)>>2]|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case-17856:{if(A[5300]|0){l=M[2]|0;M[e+744>>2]=f&7;M[e+744+4>>2]=f>>>3&7;Ke(l,1781,e+744|0)|0}r=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=r<<8&65280|r>>>8&255|r>>>16<<24|r>>>24<<16;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:break t}else{if((f&65472)<<16>>16<16768){switch((f&65472)<<16>>16){case-17728:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+752>>2]=f&7;M[e+752+4>>2]=f>>>3&7;Ke(l,1796,e+752|0)|0}r=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=(r<<8&32768|0)==0?r<<8&65280|r>>>8&255:r<<8&65280|r>>>8&255|-65536;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}switch((f&65472)<<16>>16){case 16832:break;case 16768:{if(A[5300]|0){l=M[2]|0;M[e+768>>2]=f&7;M[e+768+4>>2]=f>>>3&7;Ke(l,1825,e+768|0)|0}i=M[4668+((f&7)<<2)>>2]|0;r=M[4668+((f>>>3&7)<<2)>>2]|0;l=M[1184]|0;M[4668+((f&7)<<2)>>2]=i-r+-1+(l>>>29&1);t=(i-r+-1+(l>>>29&1)|0)<0?l|-2147483648:l&2147483647;t=(i-r+-1+(l>>>29&1)|0)==0?t|1073741824:t&-1073741825;M[1184]=t;if(!(t&536870912)){f=(((~r>>>31)+(i>>>31)+(((~r&2147483647)+(i&2147483647)|0)>>>31)|0)&2|0)==0?t&-536870913:t|536870912;M[1184]=(((~r&2147483647)+(i&2147483647)|0)>>>31|0)==(((~r>>>31)+(i>>>31)+(((~r&2147483647)+(i&2147483647)|0)>>>31)|0)>>>1&1|0)?f&-268435457:f|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}else{f=(((~r>>>31)+(i>>>31)+(((~r&2147483647)+(i&2147483647)+1|0)>>>31)|0)&2|0)==0?t&-536870913:t|536870912;M[1184]=(((~r&2147483647)+(i&2147483647)+1|0)>>>31|0)==(((~r>>>31)+(i>>>31)+(((~r&2147483647)+(i&2147483647)+1|0)>>>31)|0)>>>1&1|0)?f&-268435457:f|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}default:break t}if(A[5300]|0){l=M[2]|0;M[e+760>>2]=f&7;M[e+760+4>>2]=f>>>3&7;Ke(l,1811,e+760|0)|0}t=M[4668+((f&7)<<2)>>2]|0;i=M[4668+((f>>>3&7)<<2)>>2]|0;do{if(!(i&255))i=M[1184]|0;else if(!(i&31)){i=M[1184]|0;i=(t|0)<0?i|536870912:i&-536870913;M[1184]=i;break}else{l=M[1184]|0;l=1<<(i&31)+-1&t|0?l|536870912:l&-536870913;M[1184]=l;t=t<<32-(i&31)|t>>>(i&31);i=l;break}}while(0);M[4668+((f&7)<<2)>>2]=t;r=(t|0)<0?i|-2147483648:i&2147483647;M[1184]=(t|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}while(0);if((f&65527|0)==46672){He(1838,23,1,M[2]|0)|0;r=1;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}t:do{if((f&63488)<<16>>16<24576){switch((f&63488)<<16>>16){case-16384:break;default:break t}if(A[5300]|0){i=M[2]|0;M[e+776>>2]=f>>>8&7;Ke(i,1862,e+776|0)|0;if(!(f&1))t=0;else{M[e+784>>2]=0;Ke(i,1249,e+784|0)|0;t=1}if(f&2){if(t|0)pt(44,i)|0;M[e+1008>>2]=1;Ke(i,1249,e+1008|0)|0;t=t+1|0}if(f&4){if(t|0)pt(44,i)|0;M[e+1016>>2]=2;Ke(i,1249,e+1016|0)|0;t=t+1|0}if(f&8){if(t|0)pt(44,i)|0;M[e+1024>>2]=3;Ke(i,1249,e+1024|0)|0;t=t+1|0}if(f&16){if(t|0)pt(44,i)|0;M[e+1032>>2]=4;Ke(i,1249,e+1032|0)|0;t=t+1|0}if(f&32){if(t|0)pt(44,i)|0;M[e+1040>>2]=5;Ke(i,1249,e+1040|0)|0;t=t+1|0}if(f&64){if(t|0)pt(44,i)|0;M[e+1048>>2]=6;Ke(i,1249,e+1048|0)|0;t=t+1|0}if(f&128|0){if(t|0)pt(44,i)|0;M[e+1056>>2]=7;Ke(i,1249,e+1056|0)|0}He(1253,2,1,i)|0}r=1;n=0;t=M[4668+((f>>>8&7)<<2)>>2]|0;while(1){if(r&f){i=M[4668+(n<<2)>>2]|0;i:do{if((t&-268435456|0)==-536870912){l=t+536813552|0;switch(l>>>2|l<<30|0){case 0:{l=M[1164]|0;M[1164]=i&65543;if((i&1|0)==0|(l&1|0)!=0)break i;M[1166]=M[1165];break i}case 1:{M[1165]=i&16777215;break i}case 2:{M[1166]=i&16777215;break i}case 3:break i;default:break i}}else ue(2,t|0,i|0)|0}while(0);t=t+4|0}n=n+1|0;if((n|0)==8)break;else r=r<<1&254}M[4668+((f>>>8&7)<<2)>>2]=t;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}else{switch((f&63488)<<16>>16){case 24576:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+792>>2]=f&7;M[e+792+4>>2]=f>>>3&7;M[e+792+8>>2]=f>>>4&124;Ke(l,1875,e+792|0)|0}i=(M[4668+((f>>>3&7)<<2)>>2]|0)+(f>>>4&124)|0;t=M[4668+((f&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){ue(2,i|0,t|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}switch((i+536813552|0)>>>2|i+536813552<<30|0){case 0:{f=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(f&1|0)!=0){r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}M[1166]=M[1165];r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 1:{M[1165]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 2:{M[1166]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 3:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}}}while(0);if((f&65024|0)==20480){if(A[5300]|0){l=M[2]|0;M[e+808>>2]=f&7;M[e+808+4>>2]=f>>>3&7;M[e+808+8>>2]=f>>>6&7;Ke(l,1896,e+808|0)|0}i=(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0;t=M[4668+((f&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){ue(2,i|0,t|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}switch((i+536813552|0)>>>2|i+536813552<<30|0){case 0:{f=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(f&1|0)!=0){r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}M[1166]=M[1165];r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 1:{M[1165]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 2:{M[1166]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 3:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}}t:do{if((f&63488)<<16>>16<28672){switch((f&63488)<<16>>16){case-28672:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+824>>2]=f>>>8&7;M[e+824+4>>2]=f<<2&1020;Ke(l,1915,e+824|0)|0}i=(M[1180]|0)+(f<<2&1020)|0;t=M[4668+((f>>>8&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){ue(2,i|0,t|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}switch((i+536813552|0)>>>2|i+536813552<<30|0){case 0:{f=M[1164]|0;M[1164]=t&65543;if((t&1|0)==0|(f&1|0)!=0){r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}M[1166]=M[1165];r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 1:{M[1165]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 2:{M[1166]=t&16777215;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case 3:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:{r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}}else{switch((f&63488)<<16>>16){case 28672:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+832>>2]=f&7;M[e+832+4>>2]=f>>>3&7;M[e+832+8>>2]=f>>>6&31;Ke(l,1935,e+832|0)|0}r=M[4668+((f>>>3&7)<<2)>>2]|0;t=M[4668+((f&7)<<2)>>2]|0;i=ee(3,r+(f>>>6&31)&-2|0)|0;if(!(r+(f>>>6)&1))t=i&65280|t&255;else t=i&255|t<<8;ue(5,r+(f>>>6&31)&-2|0,t&65535|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}while(0);if((f&65024|0)==21504){if(A[5300]|0){l=M[2]|0;M[e+848>>2]=f&7;M[e+848+4>>2]=f>>>3&7;M[e+848+8>>2]=f>>>6&7;Ke(l,1957,e+848|0)|0}r=(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0;t=M[4668+((f&7)<<2)>>2]|0;i=ee(3,r&-2|0)|0;if(!(r&1))t=i&65280|t&255;else t=i&255|t<<8;ue(5,r&-2|0,t&65535|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&63488|0)==32768){if(A[5300]|0){l=M[2]|0;M[e+864>>2]=f&7;M[e+864+4>>2]=f>>>3&7;M[e+864+8>>2]=f>>>5&62;Ke(l,1977,e+864|0)|0}ue(5,(M[4668+((f>>>3&7)<<2)>>2]|0)+(f>>>5&62)|0,M[4668+((f&7)<<2)>>2]&65535|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}t:do{if((f&65024)<<16>>16<20992){switch((f&65024)<<16>>16){case 7680:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+896>>2]=f&7;M[e+896+4>>2]=f>>>3&7;M[e+896+8>>2]=f>>>6&7;Ke(l,2019,e+896|0)|0}l=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=l-(f>>>6&7);r=M[1184]|0;r=(l-(f>>>6&7)|0)<0?r|-2147483648:r&2147483647;r=(l-(f>>>6&7)|0)==0?r|1073741824:r&-1073741825;r=(((l>>>31)+1+((((f>>>6|2147483640)^7)+1+(l&2147483647)|0)>>>31)|0)&2|0)==0?r&-536870913:r|536870912;M[1184]=((((f>>>6|2147483640)^7)+1+(l&2147483647)|0)>>>31|0)==(((l>>>31)+1+((((f>>>6|2147483640)^7)+1+(l&2147483647)|0)>>>31)|0)>>>1&1|0)?r&-268435457:r|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}else{switch((f&65024)<<16>>16){case 20992:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+880>>2]=f&7;M[e+880+4>>2]=f>>>3&7;M[e+880+8>>2]=f>>>6&7;Ke(l,1999,e+880|0)|0}ue(5,(M[4668+((f>>>6&7)<<2)>>2]|0)+(M[4668+((f>>>3&7)<<2)>>2]|0)|0,M[4668+((f&7)<<2)>>2]&65535|0)|0;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}while(0);if((f&63488|0)==14336){if(A[5300]|0){l=M[2]|0;M[e+912>>2]=f>>>8&7;M[e+912+4>>2]=f&255;Ke(l,2039,e+912|0)|0}l=M[4668+((f>>>8&7)<<2)>>2]|0;M[4668+((f>>>8&7)<<2)>>2]=l-(f&255);r=M[1184]|0;r=(l-(f&255)|0)<0?r|-2147483648:r&2147483647;r=(l-(f&255)|0)==0?r|1073741824:r&-1073741825;r=(((l>>>31)+1+((-2147483648-(f&255)+(l&2147483647)|0)>>>31)|0)&2|0)==0?r&-536870913:r|536870912;M[1184]=((-2147483648-(f&255)+(l&2147483647)|0)>>>31|0)==(((l>>>31)+1+((-2147483648-(f&255)+(l&2147483647)|0)>>>31)|0)>>>1&1|0)?r&-268435457:r|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65024|0)==6656){if(A[5300]|0){l=M[2]|0;M[e+920>>2]=f&7;M[e+920+4>>2]=f>>>3&7;M[e+920+8>>2]=f>>>6&7;Ke(l,2057,e+920|0)|0}h=M[4668+((f>>>3&7)<<2)>>2]|0;l=M[4668+((f>>>6&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=h-l;r=M[1184]|0;r=(h-l|0)<0?r|-2147483648:r&2147483647;r=(h-l|0)==0?r|1073741824:r&-1073741825;r=(((~l>>>31)+(h>>>31)+(((h&2147483647)+1+(~l&2147483647)|0)>>>31)|0)&2|0)==0?r&-536870913:r|536870912;M[1184]=(((h&2147483647)+1+(~l&2147483647)|0)>>>31|0)==(((~l>>>31)+(h>>>31)+(((h&2147483647)+1+(~l&2147483647)|0)>>>31)|0)>>>1&1|0)?r&-268435457:r|268435456;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65408|0)==45184){if(A[5300]|0){l=M[2]|0;M[e+936>>2]=f<<2&508;Ke(l,2075,e+936|0)|0}M[1180]=(M[1180]|0)-(f<<2&508);r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65280|0)==57088){if(A[5300]|0){l=M[2]|0;M[e+944>>2]=f&255;Ke(l,2091,e+944|0)|0}if((f&255|0)==204){M[1167]=M[1184];r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}else{r=M[2]|0;M[e+952>>2]=f&255;Ke(r,2103,e+952|0)|0;r=1;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}t:do{if((f&65472)<<16>>16<-19840)switch((f&65472)<<16>>16){case-19904:{if(A[5300]|0){l=M[2]|0;M[e+960>>2]=f&7;M[e+960+4>>2]=f>>>3&7;Ke(l,2117,e+960|0)|0}r=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=(r&128|0)==0?r&255:r|-256;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}case-19968:{if(A[5300]|0){l=M[2]|0;M[e+968>>2]=f&7;M[e+968+4>>2]=f>>>3&7;Ke(l,2131,e+968|0)|0}r=M[4668+((f>>>3&7)<<2)>>2]|0;M[4668+((f&7)<<2)>>2]=(r&32768|0)==0?r&65535:r|-65536;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}default:break t}else{if((f&65472)<<16>>16<-19776){switch((f&65472)<<16>>16){case-19840:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+992>>2]=f&7;M[e+992+4>>2]=f>>>3&7;Ke(l,2172,e+992|0)|0}M[4668+((f&7)<<2)>>2]=M[4668+((f>>>3&7)<<2)>>2]&65535;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}if((f&65472)<<16>>16<16896){switch((f&65472)<<16>>16){case-19776:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+984>>2]=f&7;M[e+984+4>>2]=f>>>3&7;Ke(l,2158,e+984|0)|0}M[4668+((f&7)<<2)>>2]=M[4668+((f>>>3&7)<<2)>>2]&255;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}else{switch((f&65472)<<16>>16){case 16896:break;default:break t}if(A[5300]|0){l=M[2]|0;M[e+976>>2]=f&7;M[e+976+4>>2]=f>>>3&7;Ke(l,2145,e+976|0)|0}f=M[4668+((f>>>3&7)<<2)>>2]&M[4668+((f&7)<<2)>>2];r=M[1184]|0;r=(f|0)<0?r|-2147483648:r&2147483647;M[1184]=(f|0)==0?r|1073741824:r&-1073741825;r=0;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}}while(0);r=M[2]|0;M[e+1e3>>2]=n;M[e+1e3+4>>2]=f;Ke(r,2186,e+1e3|0)|0;r=1;P=e;M[e+4792>>2]=6;M[e+4796>>2]=r|0;break e}}}}}}}M[e+1368>>2]=r}var Ft=[It,Ee];var Ot=[xt,Re,Ie,xt];return{_llvm_bswap_i32:St,_enable_debug:ve,stackSave:le,_i64Subtract:bt,___udivdi3:Mt,setThrew:de,_bitshift64Lshr:kt,_read_register:we,_bitshift64Shl:vt,_memset:yt,_sbrk:Tt,_memcpy:wt,stackAlloc:he,___uremdi3:Pt,_run:ye,_abort_run:ke,setTempRet0:pe,_i64Add:mt,dynCall_iiii:Rt,dynCall_ii:Et,_ping:me,_emscripten_get_global_libc:Se,_free:Pe,___errno_location:Be,_set_stop_address:be,runPostSets:gt,getTempRet0:ge,_write_register:Ce,stackRestore:fe,_malloc:Te,establishStackSpace:_e,_reset:Ae}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),_enable_debug=Module._enable_debug=asm._enable_debug,stackSave=Module.stackSave=asm.stackSave,_i64Subtract=Module._i64Subtract=asm._i64Subtract,___udivdi3=Module.___udivdi3=asm.___udivdi3,getTempRet0=Module.getTempRet0=asm.getTempRet0,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_read_register=Module._read_register=asm._read_register,_bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl,_memset=Module._memset=asm._memset,_sbrk=Module._sbrk=asm._sbrk,_memcpy=Module._memcpy=asm._memcpy,___errno_location=Module.___errno_location=asm.___errno_location,___uremdi3=Module.___uremdi3=asm.___uremdi3,stackAlloc=Module.stackAlloc=asm.stackAlloc,_run=Module._run=asm._run,_abort_run=Module._abort_run=asm._abort_run,setTempRet0=Module.setTempRet0=asm.setTempRet0,_i64Add=Module._i64Add=asm._i64Add,_ping=Module._ping=asm._ping,_emscripten_get_global_libc=Module._emscripten_get_global_libc=asm._emscripten_get_global_libc,_set_stop_address=Module._set_stop_address=asm._set_stop_address,_llvm_bswap_i32=Module._llvm_bswap_i32=asm._llvm_bswap_i32,_free=Module._free=asm._free,runPostSets=Module.runPostSets=asm.runPostSets,setThrew=Module.setThrew=asm.setThrew,establishStackSpace=Module.establishStackSpace=asm.establishStackSpace,_write_register=Module._write_register=asm._write_register,stackRestore=Module.stackRestore=asm.stackRestore,_malloc=Module._malloc=asm._malloc,_reset=Module._reset=asm._reset,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,initialStackTop;function ExitStatus(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Runtime.stackAlloc=Module.stackAlloc,Runtime.stackSave=Module.stackSave,Runtime.stackRestore=Module.stackRestore,Runtime.establishStackSpace=Module.establishStackSpace,Runtime.setTempRet0=Module.setTempRet0,Runtime.getTempRet0=Module.getTempRet0,Module.asm=asm,Module.then=function(e){if(Module.calledRun)e(Module);else{var t=Module.onRuntimeInitialized;Module.onRuntimeInitialized=function(){t&&t(),e(Module)}}return Module},ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var preloadStartTime=null,calledMain=!1;function run(e){function t(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(e),postRun()))}e=e||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),0<runDependencies||(preRun(),0<runDependencies||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),t()},1)):t()))}function exit(e,t){t&&Module.noExitRuntime||(Module.noExitRuntime||(ABORT=!0,EXITSTATUS=e,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(e)),ENVIRONMENT_IS_NODE&&process.exit(e),Module.quit(e,new ExitStatus(e)))}dependenciesFulfilled=function e(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=e)},Module.callMain=Module.callMain=function(e){e=e||[],ensureInitRuntime();var t=e.length+1;function i(){for(var e=0;e<3;e++)r.push(0)}var r=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];i();for(var n=0;n<t-1;n+=1)r.push(allocate(intArrayFromString(e[n]),"i8",ALLOC_NORMAL)),i();r.push(0),r=allocate(r,"i32",ALLOC_NORMAL);try{exit(Module._main(t,r,0),!0)}catch(e){if(e instanceof ExitStatus)return;if("SimulateInfiniteLoop"==e)return void(Module.noExitRuntime=!0);var s=e;e&&"object"==typeof e&&e.stack&&(s=[e,e.stack]),Module.printErr("exception thrown: "+s),Module.quit(1,e)}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit;var abortDecorators=[];function abort(t){Module.onAbort&&Module.onAbort(t),void 0!==t?(Module.print(t),Module.printErr(t),t=JSON.stringify(t)):t="",ABORT=!0,EXITSTATUS=1;var i="abort("+t+") at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw abortDecorators&&abortDecorators.forEach(function(e){i=e(i,t)}),i}if(Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();var shouldRunNow=!1;return Module.noInitialRun&&(shouldRunNow=!1),Module.noExitRuntime=!0,run(),Module};"object"==typeof module&&module.exports&&(module.exports=Module),module.exports=Module}).call(this,require("_process"))},{_process:8,fs:4,path:7}],20:[function(e,r,t){(function(e){var t,i,n,s,a,o,u,c,h,l,f,_,d,p,g,b,m,y,k;!function(t){var n="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function i(i,r){return i!==n&&("function"==typeof Object.create?Object.defineProperty(i,"__esModule",{value:!0}):i.__esModule=!0),function(e,t){return i[e]=r?r(e,t):t}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){t(i(n,i(e)))}):"object"==typeof r&&"object"==typeof r.exports?t(i(n,i(r.exports))):t(i(n))}(function(e){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};t=function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},i=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&(i[r[n]]=e[r[n]])}return i},s=function(e,t,i,r){var n,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;0<=o;o--)(n=e[o])&&(a=(s<3?n(a):3<s?n(t,i,a):n(t,i))||a);return 3<s&&a&&Object.defineProperty(t,i,a),a},a=function(i,r){return function(e,t){r(e,t,i)}},o=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(s,a,o,u){return new(o||(o=Promise))(function(e,t){function i(e){try{n(u.next(e))}catch(e){t(e)}}function r(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){t.done?e(t.value):new o(function(e){e(t.value)}).then(i,r)}n((u=u.apply(s,a||[])).next())})},c=function(i,r){var n,s,a,e,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return o.label++,{value:t[1],done:!1};case 5:o.label++,s=t[1],t=[0];continue;case 7:t=o.ops.pop(),o.trys.pop();continue;default:if(!(a=0<(a=o.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){o=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){o.label=t[1];break}if(6===t[0]&&o.label<a[1]){o.label=a[1],a=t;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(t);break}a[2]&&o.ops.pop(),o.trys.pop();continue}t=r.call(i,o)}catch(e){t=[6,e],s=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},h=function(e,t){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])},l=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}},f=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,s=i.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=s.next()).done;)a.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},_=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e},d=function(e){return this instanceof d?(this.v=e,this):new d(e)},p=function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=i.apply(e,t||[]),a=[];return n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n;function r(r){s[r]&&(n[r]=function(i){return new Promise(function(e,t){1<a.push([r,i,e,t])||o(r,i)})})}function o(e,t){try{(i=s[e](t)).value instanceof d?Promise.resolve(i.value.v).then(u,c):h(a[0][2],i)}catch(e){h(a[0][3],e)}var i}function u(e){o("next",e)}function c(e){o("throw",e)}function h(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}},g=function(r){var e,n;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,i){e[t]=r[t]?function(e){return(n=!n)?{value:d(r[t](e)),done:"return"===t}:i?i(e):e}:i}},b=function(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=u[Symbol.asyncIterator];return t?t.call(u):(u=l(u),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=u[o]&&function(a){return new Promise(function(e,t){var i,r,n,s;a=u[o](a),i=e,r=t,n=a.done,s=a.value,Promise.resolve(s).then(function(e){i({value:e,done:n})},r)})}}},m=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t},k=function(e){return e&&e.__esModule?e:{default:e}},e("__extends",t),e("__assign",i),e("__rest",n),e("__decorate",s),e("__param",a),e("__metadata",o),e("__awaiter",u),e("__generator",c),e("__exportStar",h),e("__values",l),e("__read",f),e("__spread",_),e("__await",d),e("__asyncGenerator",p),e("__asyncDelegator",g),e("__asyncValues",b),e("__makeTemplateObject",m),e("__importStar",y),e("__importDefault",k)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t,i){"use strict";var r,n=e("microevent.ts"),a="resolve_transaction",o="reject_transaction";!function(e){var t;(t=e.MessageType||(e.MessageType={}))[t.signal=0]="signal",t[t.rpc=1]="rpc",t[t.internal=2]="internal";e.MessageType}((r=function(){function s(e,t){void 0===t&&(t=0),this._dispatch=e,this._rpcTimeout=t,this.error=new n.Event,this._rpcHandlers={},this._signalHandlers={},this._pendingTransactions={},this._nextTransactionId=0}return s.prototype.dispatch=function(e){var t=e;switch(t.type){case s.MessageType.signal:return this._handleSignal(t);case s.MessageType.rpc:return this._handeRpc(t);case s.MessageType.internal:return this._handleInternal(t);default:this._raiseError("invalid message type "+t.type)}},s.prototype.rpc=function(e,t,i){var r=this,n=this._nextTransactionId++;return this._dispatch({type:s.MessageType.rpc,transactionId:n,id:e,payload:t},i||void 0),new Promise(function(e,t){var i=r._pendingTransactions[n]={id:n,resolve:e,reject:t};0<r._rpcTimeout&&(r._pendingTransactions[n].timeoutHandle=setTimeout(function(){return r._transactionTimeout(i)},r._rpcTimeout))})},s.prototype.signal=function(e,t,i){return this._dispatch({type:s.MessageType.signal,id:e,payload:t},i||void 0),this},s.prototype.registerRpcHandler=function(e,t){if(this._rpcHandlers[e])throw new Error("rpc handler for "+e+" already registered");return this._rpcHandlers[e]=t,this},s.prototype.registerSignalHandler=function(e,t){return this._signalHandlers[e]||(this._signalHandlers[e]=[]),this._signalHandlers[e].push(t),this},s.prototype.deregisterRpcHandler=function(e,t){return this._rpcHandlers[e]&&delete this._rpcHandlers[e],this},s.prototype.deregisterSignalHandler=function(e,t){return this._signalHandlers[e]&&(this._signalHandlers[e]=this._signalHandlers[e].filter(function(e){return t!==e})),this},s.prototype._raiseError=function(e){this.error.dispatch(new Error(e)),this._dispatch({type:s.MessageType.internal,id:"error",payload:e})},s.prototype._handleSignal=function(t){if(!this._signalHandlers[t.id])return this._raiseError("invalid signal "+t.id);this._signalHandlers[t.id].forEach(function(e){return e(t.payload)})},s.prototype._handeRpc=function(t){var i=this;if(!this._rpcHandlers[t.id])return this._raiseError("invalid rpc "+t.id);Promise.resolve(this._rpcHandlers[t.id](t.payload)).then(function(e){return i._dispatch({type:s.MessageType.internal,id:a,transactionId:t.transactionId,payload:e})},function(e){return i._dispatch({type:s.MessageType.internal,id:o,transactionId:t.transactionId,payload:e})})},s.prototype._handleInternal=function(e){switch(e.id){case a:if(!this._pendingTransactions[e.transactionId])return this._raiseError("no pending transaction with id "+e.transactionId);this._pendingTransactions[e.transactionId].resolve(e.payload),this._clearTransaction(this._pendingTransactions[e.transactionId]);break;case o:if(!this._pendingTransactions[e.transactionId])return this._raiseError("no pending transaction with id "+e.transactionId);this._pendingTransactions[e.transactionId].reject(e.payload),this._clearTransaction(this._pendingTransactions[e.transactionId]);break;case"error":this.error.dispatch(new Error("remote error: "+e.payload));break;default:this._raiseError("unhandled internal message "+e.id)}},s.prototype._transactionTimeout=function(e){e.reject("transaction timed out"),this._raiseError("transaction "+e.id+" timed out"),delete this._pendingTransactions[e.id]},s.prototype._clearTransaction=function(e){void 0!==e.timeoutHandle&&clearTimeout(e.timeoutHandle),delete this._pendingTransactions[e.id]},s}())||(r={})),Object.defineProperty(i,"__esModule",{value:!0}),i.default=r},{"microevent.ts":6}],22:[function(e,t,i){"use strict";var r=e("./RpcProvider");i.RpcProvider=r.default},{"./RpcProvider":21}],23:[function(e,t,i){"use strict";var r,n;Object.defineProperty(i,"__esModule",{value:!0}),n=function(e,t,i){this.reason=e,this.board=t,this.message=i},(r||(r={})).TrapPayload=n,i.default=r},{}],24:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./Instruction"),r=e("./CpuInterface");function n(e,t){e.s=e.s+1&255,e.flags=-17&(32|t.read(256+e.s))}function s(e,t){e.flags=-131&e.flags|128&t|(t?0:2)}function o(e,t,i){var r=e.p;e.nmi&&(i=65530),e.nmi=e.irq=!1,t.write(e.s+256,r>>>8&255),e.s=e.s+255&255,t.write(e.s+256,255&r),e.s=e.s+255&255,t.write(e.s+256,-17&e.flags),e.s=e.s+255&255,e.flags|=4,e.p=t.readWord(i)}function u(e,t){o(e,t,65534)}function c(e,t){o(e,t,65530)}function h(e,t){e.p=t.readWord(65532)}function l(e,t,i){if(8&e.flags){var r=(15&i)+(15&e.a)+(1&e.flags),n=(i>>>4)+(e.a>>>4)+(9<r?1:0);e.a=r%10|n%10<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(9<n?1:0)}else{var s=e.a+i+(1&e.flags),a=255&s;e.flags=-196&e.flags|128&a|(a?0:2)|s>>>8|(~(i^e.a)&(a^i)&128)>>>1,e.a=a}}function f(e,t,i){e.a&=i,s(e,e.a)}function _(e){var t=e.a;e.a=e.a<<1&255,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|t>>>7}function d(e,t,i){var r=t.read(i),n=r<<1&255;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|r>>>7}function p(e,t,i){e.flags=-195&e.flags|192&i|(i&e.a?0:2)}function g(e,t){var i=e.p+1&65535,r=65534;e.nmi&&(r=65530,e.nmi=!1),e.nmi=e.irq=!1,t.write(e.s+256,i>>>8&255),e.s=e.s+255&255,t.write(e.s+256,255&i),e.s=e.s+255&255,t.write(e.s+256,16|e.flags),e.s=e.s+255&255,e.flags|=4,e.p=t.readWord(r)}function b(e){e.flags&=-2}function m(e){e.flags&=-9}function y(e){e.flags&=-5}function k(e){e.flags&=-65}function v(e,t,i){var r=e.a+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function w(e,t,i){var r=e.x+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function C(e,t,i){var r=e.y+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function A(e,t,i){var r=t.read(i)+255&255;t.write(i,r),s(e,r)}function M(e){e.x=e.x+255&255,s(e,e.x)}function T(e,t,i){e.a=e.a^i,s(e,e.a)}function P(e){e.y=e.y+255&255,s(e,e.y)}function S(e,t,i){var r=t.read(i)+1&255;t.write(i,r),s(e,r)}function E(e){e.x=e.x+1&255,s(e,e.x)}function R(e){e.y=e.y+1&255,s(e,e.y)}function I(e,t,i){e.p=i}function x(e,t,i){var r=e.p+1&65535,n=t.read(e.p);t.read(256+e.s),t.write(256+e.s,r>>>8),e.s=e.s+255&255,t.write(256+e.s,255&r),e.s=e.s+255&255,e.p=n|t.read(e.p+1&65535)<<8}function B(e,t,i,r){e.a=1===r?i:t.read(i),s(e,e.a)}function F(e,t,i,r){e.x=1===r?i:t.read(i),s(e,e.x)}function O(e,t,i,r){e.y=1===r?i:t.read(i),s(e,e.y)}function L(e){var t=e.a;e.a=e.a>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&t}function D(e,t,i){var r=t.read(i),n=r>>>1;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|1&r}function H(){}function U(e,t,i){e.a|=i,s(e,e.a)}function N(e,t){t.write(256+e.s,16|e.flags),e.s=e.s+255&255}function j(e,t){n(e,t)}function V(e,t){t.write(256+e.s,e.a),e.s=e.s+255&255}function W(e,t){e.s=e.s+1&255,e.a=t.read(256+e.s),s(e,e.a)}function Q(e){var t=e.a;e.a=e.a<<1&255|1&e.flags,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|t>>>7}function z(e,t,i){var r=t.read(i),n=r<<1&255|1&e.flags;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|r>>>7}function q(e){var t=e.a;e.a=e.a>>>1|(1&e.flags)<<7,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&t}function Y(e,t,i){var r=t.read(i),n=r>>>1|(1&e.flags)<<7;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|1&r}function K(e,t){var i;n(e,t),e.s=e.s+1&255,i=t.read(256+e.s),e.s=e.s+1&255,i|=t.read(256+e.s)<<8,e.p=i}function G(e,t){var i;t.read(256+e.s),e.s=e.s+1&255,i=t.read(256+e.s),e.s=e.s+1&255,i+=t.read(256+e.s)<<8,e.p=i+1&65535}function J(e,t,i){if(8&e.flags){var r=(15&e.a)-(15&i)-(1&~e.flags),n=(e.a>>>4)-(i>>>4)-(r<0?1:0);e.a=(r<0?10+r:r)|(n<0?10+n:n)<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(n<0?0:1)}else{i=255&~i;var s=e.a+i+(1&e.flags),a=255&s;e.flags=-196&e.flags|128&a|(a?0:2)|s>>>8|(~(i^e.a)&(a^i)&128)>>>1,e.a=a}}function X(e){e.flags|=1}function $(e){e.flags|=8}function Z(e){e.flags|=4}function ee(e,t,i){t.write(i,e.a)}function te(e,t,i){t.write(i,e.x)}function ie(e,t,i){t.write(i,e.y)}function re(e){e.x=e.a,s(e,e.a)}function ne(e){e.y=e.a,s(e,e.a)}function se(e){e.x=e.s,s(e,e.x)}function ae(e){e.a=e.x,s(e,e.a)}function oe(e){e.s=e.x}function ue(e){e.a=e.y,s(e,e.a)}function ce(e,t,i){var r=e.a&i;e.a=r>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&r}function he(e,t,i){var r=(e.a&e.x)+(255&~i)+1;e.x=255&r,e.flags=-132&e.flags|128&e.x|(255&e.x?0:2)|r>>>8}function le(e,t,i){var r=t.read(i)+255&255;t.write(i,r);var n=e.a+(255&~r)+1;e.flags=-132&e.flags|128&n|(255&n?0:2)|n>>>8}function fe(e,t,i){e.a=i,e.x=i,s(e,i)}function _e(e,t,i){e.a=(e.a&i)>>>1|(1&e.flags?128:0),e.flags=-196&e.flags|(64&e.a)>>>6|(e.a?0:2)|128&e.a|64&e.a^(32&e.a)<<1}function de(e,t,i){var r=t.read(i);e.flags=-2&e.flags|r>>>7,r<<=1,t.write(i,r),e.a=e.a|r,s(e,e.a)}function pe(e,t,i){var r=e.x&e.a;t.write(i,r),s(e,r)}function ge(e,t,i){e.s=e.a=e.x=e.s&i,s(e,e.a)}function be(e,t,i){var r=t.read(i)+1&255;t.write(i,r),J(e,0,r)}function me(e,t,i){e.a&=i,s(e,e.a),e.flags=-2&e.flags|(128&e.a)>>>7}function ye(e,t,i){e.a&=i,e.x=e.a,s(e,e.a)}function ke(e,t,i){var r=t.read(i),n=r>>>1|(1&e.flags)<<7;t.write(i,n),e.flags=-2&e.flags|1&r,l(e,0,n)}function ve(e,t,i){var r=t.read(i),n=r<<1&255|1&e.flags;t.write(i,n),e.flags=-2&e.flags|r>>>7,f(e,0,n)}var we=function(){function e(e,t){this._bus=e,this._rng=t,this.executionState=0,this.state=new r.default.State,this._opCycles=0,this._instructionCallback=null,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._interuptCheck=0,this._halted=!1,this._operand=0,this._lastInstructionPointer=0,this._currentAddressingMode=12,this._dereference=!1,this.reset()}return e.prototype.setInterrupt=function(e){return this._interruptPending=e,this},e.prototype.isInterrupt=function(){return this._interruptPending},e.prototype.nmi=function(){return this._nmiPending=!0,this},e.prototype.halt=function(){return this._halted=!0,this},e.prototype.resume=function(){return this._halted=!1,this},e.prototype.isHalt=function(){return this._halted},e.prototype.setInvalidInstructionCallback=function(e){return this._invalidInstructionCallback=e,this},e.prototype.getInvalidInstructionCallback=function(){return this._invalidInstructionCallback},e.prototype.getLastInstructionPointer=function(){return this._lastInstructionPointer},e.prototype.reset=function(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._opCycles=7,this._interruptPending=!1,this._nmiPending=!1,this._instructionCallback=h,this},e.prototype.cycle=function(){if(this._halted)return this;switch(this.executionState){case 0:case 2:0==--this._opCycles&&(this._dereference&&(this._operand=this._bus.read(this._operand)),1===this._interuptCheck&&this._checkForInterrupts(),this._instructionCallback(this.state,this._bus,this._operand,this._currentAddressingMode),this.executionState=1,0===this._interuptCheck&&this._checkForInterrupts());break;case 1:if(this.state.nmi)return this._instructionCallback=c,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;if(this.state.irq)return this._instructionCallback=u,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;this._fetch()}return this},e.prototype._fetch=function(){var e,t,i=a.default.opcodes[this._bus.read(this.state.p)],r=i.addressingMode,n=!1,s=!1;switch(this._lastInstructionPointer=this.state.p,this._currentAddressingMode=r,this._interuptCheck=0,i.operation){case 0:this._opCycles=0,this._instructionCallback=l,n=!0;break;case 1:this._opCycles=0,this._instructionCallback=f,n=!0;break;case 2:0===r?(this._opCycles=1,this._instructionCallback=_):(this._opCycles=3,this._instructionCallback=d,s=!0);break;case 3:1&this.state.flags?(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=I,this._opCycles=0);break;case 4:1&this.state.flags?(this._instructionCallback=I,this._opCycles=0):(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 5:2&this.state.flags?(this._instructionCallback=I,this._opCycles=0):(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 6:this._opCycles=0,this._instructionCallback=p,n=!0;break;case 7:128&this.state.flags?(this._instructionCallback=I,this._opCycles=0):(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 8:2&this.state.flags?(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=I,this._opCycles=0);break;case 9:128&this.state.flags?(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=I,this._opCycles=0);break;case 11:64&this.state.flags?(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=I,this._opCycles=0);break;case 12:64&this.state.flags?(this._instructionCallback=I,this._opCycles=0):(r=0,this._instructionCallback=H,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 10:this._opCycles=6,this._instructionCallback=g,this._interuptCheck=1;break;case 13:this._opCycles=1,this._instructionCallback=b;break;case 14:this._opCycles=1,this._instructionCallback=m;break;case 15:this._opCycles=1,this._instructionCallback=y,this._interuptCheck=1;break;case 16:this._opCycles=1,this._instructionCallback=k;break;case 17:this._opCycles=0,this._instructionCallback=v,n=!0;break;case 18:this._opCycles=0,this._instructionCallback=w,n=!0;break;case 19:this._opCycles=0,this._instructionCallback=C,n=!0;break;case 20:this._opCycles=3,this._instructionCallback=A,s=!0;break;case 21:this._opCycles=1,this._instructionCallback=M;break;case 22:this._opCycles=1,this._instructionCallback=P;break;case 23:this._opCycles=0,this._instructionCallback=T,n=!0;break;case 24:this._opCycles=3,this._instructionCallback=S,s=!0;break;case 25:this._opCycles=1,this._instructionCallback=E;break;case 26:this._opCycles=1,this._instructionCallback=R;break;case 27:this._opCycles=0,this._instructionCallback=I;break;case 28:this._opCycles=5,this._instructionCallback=x;break;case 29:this._opCycles=1===r?0:1,this._instructionCallback=B;break;case 30:this._opCycles=1===r?0:1,this._instructionCallback=F;break;case 31:this._opCycles=1===r?0:1,this._instructionCallback=O;break;case 32:0===r?(this._opCycles=1,this._instructionCallback=L):(this._opCycles=3,this._instructionCallback=D,s=!0);break;case 33:this._opCycles=1,this._instructionCallback=H;break;case 56:case 57:n=!(this._opCycles=0),this._instructionCallback=H;break;case 34:this._opCycles=0,this._instructionCallback=U,n=!0;break;case 36:this._opCycles=2,this._instructionCallback=N;break;case 35:this._opCycles=2,this._instructionCallback=V;break;case 37:this._opCycles=3,this._instructionCallback=W;break;case 38:this._opCycles=3,this._instructionCallback=j,this._interuptCheck=1;break;case 39:0===r?(this._opCycles=1,this._instructionCallback=Q):(this._opCycles=3,this._instructionCallback=z,s=!0);break;case 40:0===r?(this._opCycles=1,this._instructionCallback=q):(this._opCycles=3,this._instructionCallback=Y,s=!0);break;case 41:this._opCycles=5,this._instructionCallback=K;break;case 42:this._opCycles=5,this._instructionCallback=G;break;case 43:this._opCycles=0,this._instructionCallback=J,n=!0;break;case 44:this._opCycles=1,this._instructionCallback=X;break;case 45:this._opCycles=1,this._instructionCallback=$;break;case 46:this._opCycles=1,this._instructionCallback=Z,this._interuptCheck=1;break;case 47:this._opCycles=1,this._instructionCallback=ee,s=!0;break;case 48:this._opCycles=1,this._instructionCallback=te,s=!0;break;case 49:this._opCycles=1,this._instructionCallback=ie,s=!0;break;case 50:this._opCycles=1,this._instructionCallback=re;break;case 51:this._opCycles=1,this._instructionCallback=ne;break;case 52:this._opCycles=1,this._instructionCallback=se;break;case 53:this._opCycles=1,this._instructionCallback=ae;break;case 54:this._opCycles=1,this._instructionCallback=oe;break;case 55:this._opCycles=1,this._instructionCallback=ue;break;case 62:this._opCycles=0,this._instructionCallback=_e;break;case 58:this._opCycles=0,this._instructionCallback=ce;break;case 59:this._opCycles=0,this._instructionCallback=he;break;case 60:this._opCycles=3,this._instructionCallback=le,s=!0;break;case 61:this._opCycles=0,this._instructionCallback=fe,n=!0;break;case 63:this._opCycles=2,this._instructionCallback=de,s=!0;break;case 64:this._opCycles=1,this._instructionCallback=pe;break;case 65:this._opCycles=0,this._instructionCallback=ge,n=!0;break;case 66:this._opCycles=3,this._instructionCallback=be;break;case 67:this._opCycles=0,this._instructionCallback=me;break;case 68:this._opCycles=0,this._instructionCallback=ye;break;case 69:s=!(n=!(this._opCycles=3)),this._instructionCallback=ke;break;case 70:s=!(n=!(this._opCycles=3)),this._instructionCallback=ve;break;default:return void(this._invalidInstructionCallback&&this._invalidInstructionCallback(this))}switch(this.state.p=this.state.p+1&65535,r){case 1:this._operand=this._bus.read(this.state.p),n=!1,this.state.p=this.state.p+1&65535,this._opCycles++;break;case 2:this._operand=this._bus.read(this.state.p),this.state.p=this.state.p+1&65535,this._opCycles++;break;case 3:this._operand=this._bus.readWord(this.state.p),this.state.p=this.state.p+2&65535,this._opCycles+=2;break;case 4:e=this._bus.readWord(this.state.p),this._operand=255==(255&e)?this._bus.read(e)+(this._bus.read(65280&e)<<8):this._bus.readWord(e),this.state.p=this.state.p+2&65535,this._opCycles+=4;break;case 5:e=128&(e=this._bus.read(this.state.p))?-(255&~(e-1)):e,this._operand=this.state.p+e+65537&65535,this.state.p=this.state.p+1&65535,this._opCycles+=(65280&this._operand)!=(65280&this.state.p)?3:2;break;case 6:t=this._bus.read(this.state.p),this._bus.read(t),this._operand=t+this.state.x&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 7:e=this._bus.readWord(this.state.p),this._operand=e+this.state.x&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&e)?3:2,this.state.p=this.state.p+2&65535;break;case 9:t=this._bus.read(this.state.p),this._bus.read(t),this._operand=t+this.state.y&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 10:e=this._bus.readWord(this.state.p),this._operand=e+this.state.y&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&e)?3:2,this.state.p=this.state.p+2&65535;break;case 8:t=this._bus.read(this.state.p),this._bus.read(t),e=t+this.state.x&255,this._operand=255===e?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(e),this._opCycles+=4,this.state.p=this.state.p+1&65535;break;case 11:e=255===(e=this._bus.read(this.state.p))?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(e),this._operand=e+this.state.y&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&e)!=(65280&this._operand)?4:3,this.state.p=this.state.p+1&65535}(this._dereference=n)&&this._opCycles++,this.executionState=2},e.prototype._checkForInterrupts=function(){this._nmiPending&&(this.state.irq=!1,this.state.nmi=!0,this._nmiPending=!1),!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)},e}();i.default=we},{"./CpuInterface":25,"./Instruction":26}],25:[function(e,t,i){"use strict";var r,n;Object.defineProperty(i,"__esModule",{value:!0}),n=function(){this.a=0,this.x=0,this.y=0,this.s=0,this.p=0,this.flags=0,this.irq=!1,this.nmi=!1},(r||(r={})).State=n,i.default=r},{}],26:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n,o,s=function(){function e(e,t,i){void 0===i&&(i=t),this.operation=e,this.addressingMode=t,this.effectiveAddressingMode=i}return e.prototype.getSize=function(){switch(this.effectiveAddressingMode){case 1:case 2:case 6:case 9:case 8:case 11:case 5:return 2;case 3:case 7:case 10:case 4:return 3;default:return 1}},e}();i.default=s,r=s||(s={}),(n=r.OperationMap||(r.OperationMap={}))[n.adc=0]="adc",n[n.and=1]="and",n[n.asl=2]="asl",n[n.bcc=3]="bcc",n[n.bcs=4]="bcs",n[n.beq=5]="beq",n[n.bit=6]="bit",n[n.bmi=7]="bmi",n[n.bne=8]="bne",n[n.bpl=9]="bpl",n[n.brk=10]="brk",n[n.bvc=11]="bvc",n[n.bvs=12]="bvs",n[n.clc=13]="clc",n[n.cld=14]="cld",n[n.cli=15]="cli",n[n.clv=16]="clv",n[n.cmp=17]="cmp",n[n.cpx=18]="cpx",n[n.cpy=19]="cpy",n[n.dec=20]="dec",n[n.dex=21]="dex",n[n.dey=22]="dey",n[n.eor=23]="eor",n[n.inc=24]="inc",n[n.inx=25]="inx",n[n.iny=26]="iny",n[n.jmp=27]="jmp",n[n.jsr=28]="jsr",n[n.lda=29]="lda",n[n.ldx=30]="ldx",n[n.ldy=31]="ldy",n[n.lsr=32]="lsr",n[n.nop=33]="nop",n[n.ora=34]="ora",n[n.pha=35]="pha",n[n.php=36]="php",n[n.pla=37]="pla",n[n.plp=38]="plp",n[n.rol=39]="rol",n[n.ror=40]="ror",n[n.rti=41]="rti",n[n.rts=42]="rts",n[n.sbc=43]="sbc",n[n.sec=44]="sec",n[n.sed=45]="sed",n[n.sei=46]="sei",n[n.sta=47]="sta",n[n.stx=48]="stx",n[n.sty=49]="sty",n[n.tax=50]="tax",n[n.tay=51]="tay",n[n.tsx=52]="tsx",n[n.txa=53]="txa",n[n.txs=54]="txs",n[n.tya=55]="tya",n[n.dop=56]="dop",n[n.top=57]="top",n[n.alr=58]="alr",n[n.axs=59]="axs",n[n.dcp=60]="dcp",n[n.lax=61]="lax",n[n.arr=62]="arr",n[n.slo=63]="slo",n[n.aax=64]="aax",n[n.lar=65]="lar",n[n.isc=66]="isc",n[n.aac=67]="aac",n[n.atx=68]="atx",n[n.rra=69]="rra",n[n.rla=70]="rla",n[n.invalid=71]="invalid",r.opcodes=new Array(256),i.default=s,function(e){for(var t=0;t<256;t++)o.opcodes[t]=new o(71,12);var i,r,n;for(t=0;t<8;t++){switch(t){case 0:i=34;break;case 1:i=1;break;case 2:i=23;break;case 3:i=0;break;case 4:i=47;break;case 5:i=29;break;case 6:i=17;break;case 7:i=43}for(var s=0;s<8;s++){switch(s){case 0:r=8;break;case 1:r=2;break;case 2:r=1;break;case 3:r=3;break;case 4:r=11;break;case 5:r=6;break;case 6:r=10;break;case 7:r=7}47===i&&1===r&&(r=12),71!==i&&12!==r&&(n=t<<5|s<<2|1,o.opcodes[n]=new o(i,r))}}function a(e,t,i,r){if(71!==o.opcodes[e].operation)throw new Error("entry for opcode "+e+" already exists");o.opcodes[e]=new o(t,i,r)}a(6,2,2),a(10,2,0),a(14,2,3),a(22,2,6),a(30,2,7),a(38,39,2),a(42,39,0),a(46,39,3),a(54,39,6),a(62,39,7),a(70,32,2),a(74,32,0),a(78,32,3),a(86,32,6),a(94,32,7),a(102,40,2),a(106,40,0),a(110,40,3),a(118,40,6),a(126,40,7),a(134,48,2),a(142,48,3),a(150,48,9),a(162,30,1),a(166,30,2),a(174,30,3),a(182,30,9),a(190,30,10),a(198,20,2),a(206,20,3),a(214,20,6),a(222,20,7),a(230,24,2),a(238,24,3),a(246,24,6),a(254,24,7),a(36,6,2),a(44,6,3),a(76,27,3),a(108,27,4),a(132,49,2),a(140,49,3),a(148,49,6),a(160,31,1),a(164,31,2),a(172,31,3),a(180,31,6),a(188,31,7),a(192,19,1),a(196,19,2),a(204,19,3),a(224,18,1),a(228,18,2),a(236,18,3),a(16,9,5),a(48,7,5),a(80,11,5),a(112,12,5),a(144,3,5),a(176,4,5),a(208,8,5),a(240,5,5),a(0,10,0),a(32,28,0,3),a(64,41,0),a(96,42,0),a(8,36,0),a(40,38,0),a(72,35,0),a(104,37,0),a(136,22,0),a(168,51,0),a(200,26,0),a(232,25,0),a(24,13,0),a(56,44,0),a(88,15,0),a(120,46,0),a(152,55,0),a(184,16,0),a(216,14,0),a(248,45,0),a(138,53,0),a(154,54,0),a(170,50,0),a(186,52,0),a(202,21,0),a(234,33,0),a(26,33,0),a(58,33,0),a(90,33,0),a(122,33,0),a(218,33,0),a(250,33,0),a(4,56,2),a(20,56,6),a(52,56,6),a(68,56,2),a(84,56,6),a(100,56,2),a(116,56,6),a(128,56,1),a(130,56,1),a(137,56,1),a(194,56,1),a(212,56,6),a(226,56,1),a(244,56,6),a(12,57,3),a(28,57,7),a(60,57,7),a(92,57,7),a(124,57,7),a(220,57,7),a(252,57,7),a(235,43,1),a(75,58,1),a(203,59,1),a(199,60,2),a(215,60,6),a(207,60,3),a(223,60,7),a(219,60,10),a(195,60,8),a(211,60,11),a(167,61,2),a(183,61,9),a(175,61,3),a(191,61,10),a(163,61,8),a(179,61,11),a(107,62,1),a(7,63,2),a(23,63,6),a(15,63,3),a(31,63,7),a(27,63,10),a(3,63,8),a(19,63,11),a(135,64,2),a(151,64,9),a(131,64,8),a(143,64,3),a(187,65,10),a(231,66,2),a(247,66,6),a(239,66,3),a(255,66,7),a(251,66,10),a(227,66,8),a(243,66,11),a(11,67,1),a(43,67,1),a(171,68,1),a(103,69,2),a(119,69,6),a(111,69,3),a(127,69,7),a(123,69,10),a(99,69,8),a(115,69,11),a(39,70,2),a(55,70,6),a(47,70,3),a(63,70,7),a(59,70,10),a(35,70,8),a(51,70,11)}((o=s||(s={})).__init||(o.__init={})),i.default=s},{}],27:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./Switch"),n=function(){function e(){this._left=new r.default,this._right=new r.default,this._up=new r.default,this._down=new r.default,this._fire=new r.default}return e.prototype.getLeft=function(){return this._left},e.prototype.getRight=function(){return this._right},e.prototype.getUp=function(){return this._up},e.prototype.getDown=function(){return this._down},e.prototype.getFire=function(){return this._fire},e}();i.default=n},{"./Switch":29}],28:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./Switch"),s=function(){function e(){this.valueChanged=new r.Event,this._fireSwitch=new n.default,this._value=.5}return e.prototype.setValue=function(e){this._value=e,this.valueChanged.dispatch(e)},e.prototype.getValue=function(){return this._value},e.prototype.getFire=function(){return this._fireSwitch},e}();i.default=s},{"./Switch":29,"microevent.ts":6}],29:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e){void 0===e&&(e=!1),this._state=e,this.stateChanged=new r.Event,this.beforeRead=new r.Event}return e.prototype.read=function(){return this.beforeRead.dispatch(this),this._state},e.prototype.peek=function(){return this._state},e.prototype.toggle=function(e){this._state!==e&&(this._state=e,this.stateChanged.dispatch(e))},e}();i.default=n},{"microevent.ts":6}],30:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var _=e("microevent.ts"),r=e("../board/BoardInterface"),d=e("../cpu/Cpu"),p=e("./Bus"),g=e("./Pia"),b=e("./tia/Tia"),m=e("./Config"),y=e("./ControlPanel"),k=e("../io/DigitalJoystick"),v=e("../io/Paddle"),w=e("../../tools/rng/factory"),n=function(){function t(e,t,i){var r=this;this._config=e,this.trap=new _.Event,this.clock=new _.Event,this.cpuClock=new _.Event,this._clockMode=1,this._cpuCycles=0,this._trap=!1,this._audioEnabled=!0,this._suspended=!0,this._subClock=0,this._clockHz=0,this._sliceSize=0,this._timer={tick:function(e){return r._tick(e)},start:function(e){return r._start(e)},stop:function(){return r._stop()},isRunning:function(){return!!r._runTask}},this._rng=w.createRng(e.randomSeed<0?Math.random():e.randomSeed),t.randomize(this._rng);var n=new p.default;void 0===i&&(i=function(e,t){return new d.default(e,t)});for(var s=new y.default,a=new k.default,o=new k.default,u=new Array(4),c=0;c<4;c++)u[c]=new v.default;var h=i(n,this._rng),l=new g.default(s,a,o,this._rng),f=new b.default(e,a,o,u);h.setInvalidInstructionCallback(function(){return r._onInvalidInstruction()}),f.setCpu(h).setBus(n).setCpuTimeProvider(function(){return r.getCpuTime()}),t.setCpu(h).setBus(n).setCpuTimeProvider(function(){return r.getCpuTime()}).setRng(this._rng),l.setBus(n),n.setTia(f).setPia(l).setCartridge(t),this._bus=n,this._cpu=h,this._tia=f,this._pia=l,this._cartridge=t,this._controlPanel=s,this._joystick0=a,this._joystick1=o,this._paddles=u,this._bus.event.trap.addHandler(function(e){return r.triggerTrap(1,e.message)}),this._clockHz=m.default.getClockHz(e),this._sliceSize=228*(0===e.tvMode?262:312),this.reset()}return t.prototype.getCpu=function(){return this._cpu},t.prototype.getBus=function(){return this._bus},t.prototype.getVideoOutput=function(){return this._tia},t.prototype.getWaveformChannels=function(){var t=this;return[0,1].map(function(e){return t._tia.getWaveformChannel(e)})},t.prototype.getPCMChannel=function(){return this._tia.getPCMChannel()},t.prototype.getTimer=function(){return this._timer},t.prototype.getConfig=function(){return this._config},t.prototype.reset=function(){return this._cpu.reset(),this._tia.reset(),this._pia.reset(),this._cartridge.reset(),this._controlPanel.getResetButton().toggle(!1),this._controlPanel.getSelectSwitch().toggle(!1),this._controlPanel.getColorSwitch().toggle(!1),this._controlPanel.getDifficultySwitchP0().toggle(!0),this._controlPanel.getDifficultySwitchP1().toggle(!0),this._subClock=0,this._cpuCycles=0,this},t.prototype.boot=function(){var e=0,t=0;if(this.reset(),0!==this._cpu.executionState)throw new Error("Already booted!");for(;1!==this._cpu.executionState;)this._cycle(),e++,0===this._subClock&&t++;return this.cpuClock.dispatch(t),this.clock.dispatch(e),this},t.prototype.suspend=function(){this._suspended=!0,this._updateAudioState()},t.prototype.resume=function(){this._suspended=!1,this._updateAudioState()},t.prototype.setAudioEnabled=function(e){this._audioEnabled=e,this._updateAudioState()},t.prototype.triggerTrap=function(e,t){if(this._stop(),this._trap=!0,!this.trap.hasHandlers)throw new Error(t);return this.trap.dispatch(new r.default.TrapPayload(e,this,t)),this},t.prototype.getControlPanel=function(){return this._controlPanel},t.prototype.getJoystick0=function(){return this._joystick0},t.prototype.getJoystick1=function(){return this._joystick1},t.prototype.getBoardStateDebug=function(){var e="============";return"TIA:\n"+e+"\n"+this._tia.getDebugState()+"\n\nPIA:\n"+e+"\n"+this._pia.getDebugState()+"\n"},t.prototype.setClockMode=function(e){return this._clockMode=e,this},t.prototype.getClockMode=function(){return this._clockMode},t.prototype.getPaddle=function(e){return this._paddles[e]},t.prototype.getCpuTime=function(){return this._cpuCycles/m.default.getClockHz(this._config)*3},t._executeSlice=function(e,t){var i=t?Math.round(t*e._clockHz/1e3):e._sliceSize;return e._tick(i)/e._clockHz*1e3},t.prototype._updateAudioState=function(){this._tia.setAudioEnabled(this._audioEnabled&&!this._suspended)},t.prototype._cycle=function(){this._tia.cycle(),2<=this._subClock++&&(this._pia.cycle(),this._cpu.cycle(),this._subClock=0)},t.prototype._tick=function(e){var t=0,i=0,r=0,n=this._cpu.executionState;for(this._trap=!1;t++<e&&!this._trap;)this._cycle(),i++,0===this._subClock&&(r++,this._cpuCycles++),n!==this._cpu.executionState&&(n=this._cpu.executionState,1===this._cpu.executionState&&(this._cartridge.notifyCpuCycleComplete(),0===this._clockMode&&0<r&&this.cpuClock.hasHandlers&&(this.cpuClock.dispatch(r),r=0)));return 0<r&&this.cpuClock.hasHandlers&&this.cpuClock.dispatch(r),0<i&&this.clock.hasHandlers&&this.clock.dispatch(i),i},t.prototype._start=function(e){this._runTask||(this._runTask=e.start(t._executeSlice,this,1e3/(0===this._config.tvMode?60:50)))},t.prototype._stop=function(){this._runTask&&(this._runTask.stop(),this._runTask=void 0)},t.prototype._onInvalidInstruction=function(){this.triggerTrap(0,"invalid instruction")},t}();i.default=n},{"../../tools/rng/factory":88,"../board/BoardInterface":23,"../cpu/Cpu":24,"../io/DigitalJoystick":27,"../io/Paddle":28,"./Bus":31,"./Config":32,"./ControlPanel":33,"./Pia":34,"./tia/Tia":74,"microevent.ts":6}],31:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("microevent.ts"),s=function(){function i(){this.event={trap:new n.Event,read:new n.Event,write:new n.Event},this._tia=null,this._pia=null,this._cartridge=null,this._lastDataBusValue=0,this._lastAddressBusValue=0}return i.prototype.setTia=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(0,"TIA: "+(e.message||""))}),this._tia=e,this},i.prototype.setPia=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(1,"PIA: "+(e.message||""))}),this._pia=e,this},i.prototype.setCartridge=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(2,"CARTRIDGE: "+(e.message||""))}),this._cartridge=e,this},i.prototype.readWord=function(e){return this.read(e)|this.read(e+1&65535)<<8},i.prototype.read=function(e){return this._lastAddressBusValue=e,4096&(e&=8191)?(this._lastDataBusValue=this._cartridge.read(e),this.event.read.dispatch(2)):128&e?(this._lastDataBusValue=this._pia.read(e),this.event.read.dispatch(1)):(this._lastDataBusValue=this._tia.read(e),this.event.read.dispatch(0)),this._lastDataBusValue},i.prototype.write=function(e,t){this._lastDataBusValue=t,this._lastAddressBusValue=e,4096&(e&=8191)?(this._cartridge.write(e,t),this.event.write.dispatch(2)):128&e?(this._pia.write(e,t),this.event.write.dispatch(1)):(this._tia.write(e,t),this.event.write.dispatch(0))},i.prototype.peek=function(e){return 4096&(e&=8191)?this._cartridge.peek(e):128&e?this._pia.peek(e):this._tia.peek(e)},i.prototype.poke=function(e,t){},i.prototype.getLastDataBusValue=function(){return this._lastDataBusValue},i.prototype.getLastAddresBusValue=function(){return this._lastAddressBusValue},i.prototype.triggerTrap=function(e,t){if(!this.event.trap.hasHandlers)throw new Error(t);this.event.trap.dispatch(new i.TrapPayload(e,this,t))},i}();i.default=s,r=function(e,t,i){this.reason=e,this.bus=t,this.message=i},(s||(s={})).TrapPayload=r,i.default=s},{"microevent.ts":6}],32:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n,s=e("tslib");(n=r||(r={})).create=function(e){return void 0===e&&(e={}),s.__assign({tvMode:0,enableAudio:!0,randomSeed:-1,emulatePaddles:!0,frameStart:-1,pcmAudio:!1},e)},n.getClockHz=function(e){switch(e.tvMode){case 0:return 3584160;case 1:case 2:return 3556800}},i.default=r},{tslib:20}],33:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../io/Switch"),n=function(){function e(){this._selectSwitch=new r.default,this._resetButton=new r.default,this._colorSwitch=new r.default,this._difficutlyP0=new r.default,this._difficutlyP1=new r.default}return e.prototype.getSelectSwitch=function(){return this._selectSwitch},e.prototype.getResetButton=function(){return this._resetButton},e.prototype.getColorSwitch=function(){return this._colorSwitch},e.prototype.getDifficultySwitchP0=function(){return this._difficutlyP0},e.prototype.getDifficultySwitchP1=function(){return this._difficutlyP1},e}();i.default=n},{"../io/Switch":29}],34:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("microevent.ts"),s=function(){function e(e,t,i,r){this._controlPanel=e,this._joystick0=t,this._joystick1=i,this._rng=r,this.trap=new n.Event,this.ram=new Uint8Array(128),this._bus=null,this._timerValue=255,this._subTimer=0,this._timerDivide=1024,this._interruptFlag=0,this._timerWrapped=!1,this._flagSetDuringThisCycle=!1,this.reset()}return e.prototype.reset=function(){for(var e=0;e<128;e++)this.ram[e]=this._rng?this._rng.int(255):0;this._interruptFlag=0,this._flagSetDuringThisCycle=!1,this._timerDivide=1024,this._subTimer=0,this._rng.int(255),this._timerValue=0,this._timerWrapped=!1},e.prototype.read=function(e){return 512&e?4&e?this._readTimer(e):this._readIo(e):this.ram[127&e]},e.prototype.peek=function(e){return 512&e?4&e?this._peekTimer(e):this._readIo(e):this.ram[127&e]},e.prototype.write=function(e,t){if(512&e)return 4&e?this._writeTimer(e,t):this._writeIo(e,t);this.ram[127&e]=t},e.prototype.cycle=function(){this._cycleTimer()},e.prototype.getDebugState=function(){return"divider: "+this._timerDivide+" raw timer: INTIM: "+this._timerValue},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype._writeIo=function(e,t){},e.prototype._writeTimer=function(e,t){switch(this._interruptFlag=0,663&e){case 663:return this._setTimer(1024,t);case 662:return this._setTimer(64,t);case 661:return this._setTimer(8,t);case 660:return this._setTimer(1,t)}},e.prototype._setTimer=function(e,t){this._timerDivide=e,this._timerValue=t,this._subTimer=0,this._timerWrapped=!1},e.prototype._readIo=function(e){switch(643&e){case 640:return(this._joystick1.getUp().read()?0:1)|(this._joystick1.getDown().read()?0:2)|(this._joystick1.getLeft().read()?0:4)|(this._joystick1.getRight().read()?0:8)|(this._joystick0.getUp().read()?0:16)|(this._joystick0.getDown().read()?0:32)|(this._joystick0.getLeft().read()?0:64)|(this._joystick0.getRight().read()?0:128);case 642:return(this._controlPanel.getResetButton().read()?0:1)|(this._controlPanel.getSelectSwitch().read()?0:2)|(this._controlPanel.getColorSwitch().read()?0:8)|(this._controlPanel.getDifficultySwitchP0().read()?0:64)|(this._controlPanel.getDifficultySwitchP1().read()?0:128)}return this._bus.getLastDataBusValue()},e.prototype._readTimer=function(e){return 1&e?128&this._interruptFlag:(this._flagSetDuringThisCycle||(this._interruptFlag=0,this._timerWrapped=!1),this._timerValue)},e.prototype._peekTimer=function(e){return 1&e?128&this._interruptFlag:this._timerValue},e.prototype._cycleTimer=function(){this._flagSetDuringThisCycle=!1,this._timerWrapped?this._timerValue=this._timerValue+255&255:0===this._subTimer&&--this._timerValue<0&&(this._timerValue=255,this._flagSetDuringThisCycle=!0,this._interruptFlag=255,this._timerWrapped=!0),++this._subTimer===this._timerDivide&&(this._subTimer=0)},e}();i.default=s,r=function(e,t,i){this.reason=e,this.pia=t,this.message=i},(s||(s={})).TrapPayload=r,i.default=s},{"microevent.ts":6}],35:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("microevent.ts"),s=e("./CartridgeInterface"),a=e("./CartridgeInfo"),o=function(){function e(){this.trap=new n.Event}return e.prototype.init=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2]})})},e.prototype.reset=function(){},e.prototype.read=function(e){return 0},e.prototype.peek=function(e){return this.read(e)},e.prototype.write=function(e,t){},e.prototype.getType=function(){return a.default.CartridgeType.unknown},e.prototype.setCpu=function(e){return this},e.prototype.setBus=function(e){return this},e.prototype.setRng=function(e){return this},e.prototype.setCpuTimeProvider=function(e){return this},e.prototype.notifyCpuCycleComplete=function(){},e.prototype.randomize=function(e){},e.prototype.triggerTrap=function(e,t){if(!this.trap.hasHandlers)throw new Error(t);this.trap.dispatch(new s.default.TrapPayload(e,this,t))},e}();i.default=o},{"./CartridgeInfo":56,"./CartridgeInterface":57,"microevent.ts":6,tslib:20}],36:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("tslib"),r=e("./AbstractCartridge"),n=e("./CartridgeInfo"),o=e("./util"),s=function(r){function e(e){var t=r.call(this)||this;if(t._bank=null,t._bank0=new Uint8Array(4096),t._bank1=new Uint8Array(4096),t._bus=null,8192!==e.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+e.length);for(var i=0;i<4096;i++)t._bank0[i]=e[i],t._bank1[i]=e[4096+i];return t.reset(),t}return a.__extends(e,r),e.matchesBuffer=function(e){var t,i,r=o.searchForSignatures(e,[[173,0,8],[173,64,8],[44,0,8],[12,0,8,76],[12,255,15,76]]);try{for(var n=a.__values(r),s=n.next();!s.done;s=n.next()){if(2<=s.value)return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return!1},e.prototype.reset=function(){this._bank=this._bank0},e.prototype.read=function(e){return this.peek(e)},e.prototype.peek=function(e){return e&=4095,this._bank[e]},e.prototype.getType=function(){return n.default.CartridgeType.bankswitch_8k_econobanking},e.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(this._onBusAccess,this),this._bus.event.write.addHandler(this._onBusAccess,this),this},e.prototype._onBusAccess=function(e,t){switch(6208&t._bus.getLastAddresBusValue()){case 2048:t._bank=t._bank0;break;case 2112:t._bank=t._bank1}},e}(r.default);i.default=s},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],37:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(r){function e(e){var t=r.call(this)||this;if(t._rom=new Uint8Array(2048),2048<e.length)throw new Error("buffer is not a 2k cartridge image: wrong length "+e.length);for(var i=0;i<e.length&&i<2048;i++)t._rom[2047-i]=e[e.length-1-i];return t}return n.__extends(e,r),e.prototype.read=function(e){return this._rom[2047&e]},e.prototype.getType=function(){return s.default.CartridgeType.vanilla_2k},e}(r.default);i.default=a},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],38:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),a=e("./util"),o=e("./CartridgeInfo"),s=function(s){function t(e){var t=s.call(this)||this;if(t._banks=null,t._ramSelect=!1,t._ramBanks=new Array(256),t._bus=null,0!=(2047&e.length))throw new Error("buffer length "+e.length+" is not a multiple of 2k");var i=e.length>>>11;if(i<2)throw new Error("image must have at least 2k");t._banks=new Array(i);for(var r=0;r<i;r++)t._banks[r]=new Uint8Array(2048);for(r=0;r<=255;r++)t._ramBanks[r]=new Uint8Array(1024);t._ramBank=t._ramBanks[0],t._bank1=t._banks[i-1],t._bank0=t._banks[0];for(r=0;r<2048;r++)for(var n=0;n<i;n++)t._banks[n][r]=e[2048*n+r];return t}return r.__extends(t,s),t.matchesBuffer=function(e){return 1<=a.searchForSignatures(e,[[133,62,169,0]])[0]},t.prototype.reset=function(){this._bank0=this._banks[0]},t.prototype.randomize=function(e){for(var t=0;t<this._ramBanks.length;t++)for(var i=0;i<1024;i++)this._ramBanks[t][i]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.read=function(e){return e&=4095,this._ramSelect?e<1024?this._ramBank[e]:e<2048?this._ramBank[1023&e]=this._bus.getLastDataBusValue():this._bank1[2047&e]:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.peek=function(e){return e&=4095,this._ramSelect?e<1024?this._ramBank[e]:e<2048?this._bus.getLastDataBusValue():this._bank1[2047&e]:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.write=function(e,t){this._ramSelect&&1024<=(e&=4095)&&e<2048&&(this._ramBank[1023&e]=t)},t.prototype.getType=function(){return o.default.CartridgeType.bankswitch_3E},t._onBusAccess=function(e,t){switch(t._bus.getLastAddresBusValue()){case 63:t._ramSelect=!1,t._bank0=t._banks[t._bus.getLastDataBusValue()%t._banks.length];break;case 62:t._ramSelect=!0,t._ramBank=t._ramBanks[t._bus.getLastDataBusValue()%32]}},t}(n.default);i.default=s},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],39:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(n){function t(e){var t=n.call(this)||this;if(t._banks=new Array(4),t._bus=null,8192!==e.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+e.length);for(var i=0;i<4;i++)t._banks[i]=new Uint8Array(2048);t._bank1=t._banks[3],t._bank0=t._banks[0];for(i=0;i<2048;i++)for(var r=0;r<4;r++)t._banks[r][i]=e[2048*r+i];return t}return r.__extends(t,n),t.matchesBuffer=function(e){return 2<=s.searchForSignatures(e,[[133,63]])[0]},t.prototype.reset=function(){this._bank0=this._banks[0]},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.read=function(e){return(e&=4095)<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_3F},t._onBusAccess=function(e,t){63===t._bus.getLastAddresBusValue()&&(t._bank0=t._banks[3&t._bus.getLastDataBusValue()])},t}(n.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],40:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(n){function e(e){var t=n.call(this)||this;t._rom=new Uint8Array(4096),4096!==e.length&&console.warn("buffer has invalid size for 4K image: "+e.length+" bytes");for(var i=Math.min(4096,e.length),r=0;r<4096&&r<e.length;r++)t._rom[4095-r]=e[i-1-r];return t}return r.__extends(e,n),e.prototype.read=function(e){return this._rom[4095&e]},e.prototype.getType=function(){return s.default.CartridgeType.vanilla_4k},e}(n.default);i.default=a},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],41:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),s=e("./harmony/Soc"),r=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./util"),u=new Uint16Array([1760,160]),c=new Uint16Array([1896,296]),h=new Uint16Array([2032,432]),l=function(i){function r(e){var n=i.call(this)||this;if(n._handleBxCDF0=function(e){var t=n._soc.getThumbulator(),i=t.readRegister(2),r=t.readRegister(3);switch(e){case 1762:return n._musicStreams[i%3].frequency=r,0;case 1766:return n._musicStreams[i%3].counter=0;case 1770:return t.writeRegister(2,n._musicStreams[i%3].counter),0;case 1774:return n._musicStreams[i%3].waveformSize=r,0}return 3},n._handleBxCDF1=function(e){var t=n._soc.getThumbulator(),i=t.readRegister(2),r=t.readRegister(3);switch(e){case 1874:return n._musicStreams[i%3].frequency=r,0;case 1878:return n._musicStreams[i%3].counter=0;case 1882:return t.writeRegister(2,n._musicStreams[i%3].counter),0;case 1886:return n._musicStreams[i%3].waveformSize=r,0}return 3},n._version=1,n._banks=new Array(7),n._currentBank=null,n._rom=null,n._ram=null,n._displayRam=null,n._musicStreams=new Array(3),n._clockAccumulator=0,n._lastCpuTime=0,n._soc=null,n._fastFetch=!1,n._digitalAudio=!1,n._fastJumpCountdown=0,n._fastFetchPending=!1,n._jmpOperandAddress=0,n._ldaOperandAddress=0,n._bus=null,n._cpuTimeProvider=null,n._version=r.getVersion(e),32768!==e.length)throw new Error("not a CDF image: invalid lenght "+e.length);if(n._version<0)throw new Error("not a CDF image: missing signature");n._soc=new s.default(0<n._version?n._handleBxCDF1:n._handleBxCDF0),n._soc.trap.addHandler(function(e){return n.triggerTrap(2,e)}),n._rom=n._soc.getRom();for(var t=0;t<32768;t++)n._rom[t]=e[t];for(t=0;t<7;t++)n._banks[t]=new Uint8Array(n._rom.buffer,4096*(t+1),4096);n._ram=n._soc.getRam(),n._displayRam=new Uint8Array(n._soc.getRam().buffer,2048,4096);for(t=0;t<3;t++)n._musicStreams[t]=new f;return n.reset(),n}return n.__extends(r,i),r.getVersion=function(e){var t="CDF".split("").map(function(e){return e.charCodeAt(0)}),i=o.searchForSignature(e,n.__spread(t,[-1],t,[-1],t));return i<0?-1:0<e[i+3]?1:0},r.matchesBuffer=function(e){return 0<=r.getVersion(e)},r.prototype.init=function(){return this._soc.init()},r.prototype.reset=function(){for(var e=0;e<512;e++)this._soc.setRam32(e<<2,this._soc.getRom32(e<<2));this._fastFetch=!1,this._digitalAudio=!1,this._fastJumpCountdown=0,this._fastFetchPending=!1,this._jmpOperandAddress=0,this._ldaOperandAddress=0,this._currentBank=this._banks[6];for(e=0;e<3;e++)this._musicStreams[e].reset();this._lastCpuTime=0,this._clockAccumulator=0},r.prototype.getType=function(){return a.default.CartridgeType.bankswitch_cdf},r.prototype.setBus=function(e){return this._bus=e,this},r.prototype.setCpuTimeProvider=function(e){return this._cpuTimeProvider=e,this},r.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},r.prototype.peek=function(e){return this._currentBank[4095&e]},r.prototype.write=function(e,t){this._access(e,t)},r.prototype._access=function(e,t){e&=4095;var i=this._currentBank[e];if(0<this._fastJumpCountdown--&&e===this._jmpOperandAddress)return this._jmpOperandAddress++,this._datastreamReadWithIncrement(33,256);if(this._fastFetch&&76===i&&0===this._currentBank[e+1&4095]&&0===this._currentBank[e+2&4095])return this._fastJumpCountdown=2,this._jmpOperandAddress=e+1&4095,i;if(this._fastJumpCountdown=0,this._fastFetch&&this._fastFetchPending&&this._ldaOperandAddress===e&&i<=34){if(this._fastFetchPending=!1,34===i){if(this._clockMusicStreams(),this._digitalAudio){var r=this._musicStreams[0].counter,n=this._soc.getRam32(h[this._version])+(r>>>21),s=0;return n<32768&&(s=this._rom[n]),1073741824<n&&n<1073750016&&(s=this._ram[n-1073741824]),0==(1048576&r)&&(s>>>=4),15&s}for(var a=0,o=0;o<3;o++)a+=this._displayRam[this._getWaveform(o)+(this._musicStreams[o].counter>>>this._musicStreams[o].waveformSize)&4095];return a}return this._datastreamRead(i)}if(this._fastFetchPending=!1,4080<=e){switch(e){case 4080:this._datastreamWriteWithIncrement(32,t,256);break;case 4081:var u=this._getDatastreamPointer(32);u<<=8,u&=4026531840,u|=t<<20,this._setDatastreamPointer(32,u);break;case 4082:this._fastFetch=0==(15&t),this._digitalAudio=0==(240&t);break;case 4083:switch(t){case 254:case 255:this._soc.run(2059)}}4084<e&&e<4092&&(this._currentBank=this._banks[e-4085])}return this._fastFetch&&169===i&&(this._fastFetchPending=!0,this._ldaOperandAddress=e+1&4095),i},r.prototype._clockMusicStreams=function(){var e=this._cpuTimeProvider();this._clockAccumulator+=2e4*(e-this._lastCpuTime),this._lastCpuTime=e;var t=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=t,0!==t)for(var i=0;i<3;i++)this._musicStreams[i].increment(t)},r.prototype._getDatastreamPointer=function(e){return this._soc.getRam32(u[this._version]+4*e)},r.prototype._setDatastreamPointer=function(e,t){this._soc.setRam32(u[this._version]+4*e,t)},r.prototype._getDatastreamIncrement=function(e){return this._soc.getRam32(c[this._version]+4*e)},r.prototype._datastreamRead=function(e){var t=this._getDatastreamPointer(e),i=this._displayRam[t>>>20];return this._setDatastreamPointer(e,t+(this._getDatastreamIncrement(e)<<12)|0),i},r.prototype._datastreamReadWithIncrement=function(e,t){var i=this._getDatastreamPointer(e),r=this._displayRam[i>>>20];return this._setDatastreamPointer(e,i+(t<<12)|0),r},r.prototype._datastreamWriteWithIncrement=function(e,t,i){var r=this._getDatastreamPointer(e);this._displayRam[r>>>20]=t,this._setDatastreamPointer(e,r+(i<<12)|0)},r.prototype._getWaveform=function(e){return this._soc.getRam32(h[this._version]+4*e)-1073741824-2048&4095},r}(r.default);i.default=l;var f=function(){function e(){this.counter=0,this.frequency=0,this.waveformSize=27}return e.prototype.reset=function(){this.counter=this.frequency=0,this.waveformSize=27},e.prototype.increment=function(e){this.counter=this.counter+e*this.frequency|0},e}()},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./harmony/Soc":60,"./util":63,tslib:20}],42:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=new Uint8Array([0,4,5,9,6,10,11,15]),o=function(r){function e(e){var t=r.call(this)||this;if(t._bank0=new Uint8Array(4096),t._bank1=new Uint8Array(4096),t._fetcherData=new Uint8Array(2048),t._fetchers=new Array(8),t._rng=1,t._cpuTimeProvider=null,t._lastCpuTime=0,t._clockAccumulator=0,e.length<10240)throw new Error("buffer is not a DPC image: too small "+e.length);for(var i=0;i<8;i++)t._fetchers[i]=new u;for(i=0;i<4096;i++)t._bank0[i]=e[i],t._bank1[i]=e[4096+i];for(i=0;i<2048;i++)t._fetcherData[i]=e[8192+i];return t.reset(),t}return n.__extends(e,r),e.prototype.reset=function(){this._bank=this._bank1,this._rng=1,this._fetchers.forEach(function(e){return e.reset()}),this._lastCpuTime=0,this._clockAccumulator=0},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_DPC},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.setCpuTimeProvider=function(e){return this._cpuTimeProvider=e,this},e.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},e.prototype.peek=function(e){return this._bank[4095&e]},e.prototype.write=function(e,t){this._access(e,t)},e.prototype._access=function(e,t){if(127<(e&=4095)){switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}return this._bank[e]}if(e<8)return 4&e?(this._clockMusicFetchers(),a[4&this._fetchers[5].mask|2&this._fetchers[6].mask|1&this._fetchers[7].mask]):this._randomNext();if(e<64){var i=(n=this._fetchers[e-8&7]).mask,r=this._fetcherData[2047-n.pointer];switch(n.next(),e-8>>>3){case 0:return r;case 1:return r&i;case 2:return 255&((r&=i)<<4|r>>>4);case 3:return(1&(r&=i))<<7|(2&r)<<5|(4&r)<<3|(8&r)<<1|(16&r)>>>1|(32&r)>>>3|(64&r)>>>5|(128&r)>>>7;case 4:return(r&i)>>>1;case 5:return r<<1&i;case 6:return i}}if(e<96){var n=this._fetchers[e-64&7];switch(e-64>>>3){case 0:this._clockMusicFetchers(),n.setStart(t);break;case 1:this._clockMusicFetchers(),n.setEnd(t);break;case 2:n.setLow(t);break;case 3:n.setHigh(t),92<e&&n.setMusicMode(t)}return this._bank[e]}return 112<=e&&e<120&&(this._rng=1),this._bank[e]},e.prototype._randomNext=function(){var e=this._rng;return this._rng=255&(this._rng<<1|1&~(this._rng>>>7^this._rng>>>5^this._rng>>>4^this._rng>>>3)),e},e.prototype._clockMusicFetchers=function(){var e=this._cpuTimeProvider();this._clockAccumulator+=2e4*(e-this._lastCpuTime),this._lastCpuTime=e;var t=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=t,0!==t)for(var i=5;i<8;i++)this._fetchers[i].forwardClock(t)},e}(r.default);i.default=o;var u=function(){function e(){this.pointer=0,this.start=0,this.end=0,this.musicMode=!1,this.mask=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.start=this.end=this.mask=0,this.musicMode=!1},e.prototype.next=function(){this.musicMode||(this.pointer=this.pointer+2047&2047,this._updateMask())},e.prototype.setStart=function(e){this.start=e,this.mask=0,this._updateMask()},e.prototype.setEnd=function(e){this.end=e,this._updateMask()},e.prototype.setLow=function(e){this.pointer=1792&this.pointer|e,this._updateMask()},e.prototype.setHigh=function(e){this.pointer=255&this.pointer|(7&e)<<8,this._updateMask()},e.prototype.setMusicMode=function(e){this.musicMode=0!=(16&e)},e.prototype.forwardClock=function(e){if(this.musicMode){var t=this.start+1,i=((255&this.pointer)+t-e%t)%t,r=256+this.start-i&255,n=256+this.end-i&255;this.pointer=1792&this.pointer|i,this.mask=n<r?0:255}},e.prototype._updateMask=function(){(255&this.pointer)===this.start&&(this.mask=255),(255&this.pointer)===this.end&&(this.mask=0)},e}()},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],43:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),s=e("./harmony/Soc"),n=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./util"),u=function(n){function e(e){var t=n.call(this)||this;if(t._banks=new Array(6),t._fetchers=new Array(8),t._fractionalFetchers=new Array(8),t._musicFetchers=new Array(3),t._parameters=new Uint8Array(8),t._parameterIndex=0,t._rng=0,t._clockAccumulator=0,t._lastCpuTime=0,t._fastFetch=!1,t._ldaPending=!1,t._cpuTimeProvider=null,t._soc=new s.default,e.length<28672||32768<e.length)throw new Error("not a DPC+ image: invalid lenght "+e.length);t._rom=t._soc.getRom();for(var i=0;i<6;i++)t._banks[i]=new Uint8Array(t._rom.buffer,3072+4096*i,4096);t._ram=t._soc.getRam(),t._imageRam=new Uint8Array(t._ram.buffer,3072,4096);var r=32768-e.length;for(i=0;i<e.length;i++)t._rom[r+i]=e[i];for(i=0;i<8;i++)t._fetchers[i]=new c,t._fractionalFetchers[i]=new h;for(i=0;i<3;i++)t._musicFetchers[i]=new l;return t._soc.trap.addHandler(function(e){return t.triggerTrap(2,e)}),t.reset(),t}return r.__extends(e,n),e.matchesBuffer=function(e){return 2===o.searchForSignatures(e,["DPC+".split("").map(function(e){return e.charCodeAt(0)})])[0]},e.prototype.init=function(){return this._soc.init()},e.prototype.reset=function(){this._soc.reset(),this._currentBank=this._banks[5];for(var e=0;e<768;e++)this._soc.setRam32(e<<2,this._soc.getRom32(e<<2));for(e=6912;e<8192;e++)this._soc.setRam32(768+e-6912<<2,this._soc.getRom32(e<<2));this._currentBank=this._banks[5];for(e=0;e<8;e++)this._parameters[e]=0;for(e=0;e<8;e++)this._fetchers[e].reset(),this._fractionalFetchers[e].reset();for(e=0;e<3;e++)this._musicFetchers[e].reset();this._parameterIndex=0,this._fastFetch=this._ldaPending=!1,this._rng=725831748,this._lastCpuTime=0,this._clockAccumulator=0},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_dpc_plus},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.setCpuTimeProvider=function(e){return this._cpuTimeProvider=e,this},e.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},e.prototype.peek=function(e){return this._currentBank[4095&e]},e.prototype.write=function(e,t){this._access(e,t)},e.prototype.triggerTrap=function(e,t){n.prototype.triggerTrap.call(this,e,t)},e.prototype._access=function(e,t){e&=4095;var i=this._currentBank[e];if(this._fastFetch&&this._ldaPending&&127<e&&e<4086&&i<40&&(e=i),this._ldaPending=!1,e<40){var r=7&e,n=this._fetchers[r],s=this._fractionalFetchers[r],a=0;switch(e>>>3&7){case 0:switch(r){case 0:return this._advanceRng(),255&this._rng;case 1:return this._rewindRng(),255&this._rng;case 2:return this._rng>>>8&255;case 3:return this._rng>>>16&255;case 4:return this._rng>>>24&255;case 5:this._clockMusicFetchers();for(var o=0,u=0;u<3;u++)o+=this._imageRam[(this._musicFetchers[u].waveform<<5)+this._musicFetchers[u].waveformSample()];return 255&o}return 0;case 1:return a=this._imageRam[n.pointer],n.increment(),a;case 2:return a=this._imageRam[n.pointer]&n.mask(),n.increment(),a;case 3:return a=this._imageRam[s.pointer>>>8],s.increment(),a;case 4:return r<4?n.mask():0;default:return 0}}else if(e<128){r=7&e,n=this._fetchers[r],s=this._fractionalFetchers[r];switch(e-40>>>3&15){case 0:s.setPointerLo(t);break;case 1:s.setPointerHi(t);break;case 2:s.setFraction(t);break;case 3:n.top=t;break;case 4:n.bottom=t;break;case 5:n.setPointerLo(t);break;case 6:switch(r){case 0:this._fastFetch=0===t;break;case 1:this._parameterIndex<8&&(this._parameters[this._parameterIndex++]=t);break;case 2:this._dispatchFunction(t);break;case 5:case 6:case 7:this._musicFetchers[r-5].waveform=127&t}break;case 7:n.decrement(),this._imageRam[n.pointer]=t;break;case 8:n.setPointerHi(t);break;case 9:switch(r){case 0:this._rng=725831748;break;case 1:this._rng=4294967040&this._rng|t;break;case 2:this._rng=4294902015&this._rng|t<<8;break;case 3:this._rng=4278255615&this._rng|t<<16;break;case 4:this._rng=16777215&this._rng|t<<24;break;case 5:case 6:case 7:this._musicFetchers[r-5].frequency=this._soc.getRam32(7168+(t<<2))}break;case 10:this._imageRam[n.pointer]=t,n.increment()}}else 4085<e&&e<4092&&(this._currentBank=this._banks[e-4086]);return this._fastFetch&&127<e&&e<4086&&(this._ldaPending=169===i),i},e.prototype._clockMusicFetchers=function(){var e=this._cpuTimeProvider();this._clockAccumulator+=2e4*(e-this._lastCpuTime),this._lastCpuTime=e;var t=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=t,0!==t)for(var i=0;i<3;i++)this._musicFetchers[i].increment(t)},e.prototype._dispatchFunction=function(e){var t=this._parameters[0]+(this._parameters[1]<<8);switch(e){case 0:this._parameterIndex=0;break;case 1:for(var i=0;i<this._parameters[3];i++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+i&4095)]=this._rom[3072+(t+i)%29696];this._parameterIndex=0;break;case 2:for(i=0;i<this._parameters[3];i++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+i&4095)]=this._parameters[0];this._parameterIndex=0;break;case 254:case 255:this._soc.run(3083)}},e.prototype._advanceRng=function(){this._rng=(1024&this._rng?279816990:0)^(this._rng>>>11|this._rng<<21)},e.prototype._rewindRng=function(){this._rng=this._rng&1<<31?(279816990^this._rng)<<11|(279816990^this._rng)>>>21:this._rng<<11|this._rng>>>21},e}(n.default);i.default=u;var c=function(){function e(){this.pointer=0,this.top=0,this.bottom=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.top=this.bottom=0},e.prototype.setPointerHi=function(e){this.pointer=255&this.pointer|(15&e)<<8},e.prototype.setPointerLo=function(e){this.pointer=3840&this.pointer|255&e},e.prototype.increment=function(){this.pointer=this.pointer+1&4095},e.prototype.decrement=function(){this.pointer=this.pointer+4095&4095},e.prototype.mask=function(){return(this.top-(255&this.pointer)&255)>(this.top-this.bottom&255)?255:0},e}(),h=function(){function e(){this.pointer=0,this.fraction=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.fraction=0},e.prototype.setPointerHi=function(e){this.pointer=65535&this.pointer|(15&e)<<16},e.prototype.setPointerLo=function(e){this.pointer=983295&this.pointer|(255&e)<<8},e.prototype.setFraction=function(e){this.fraction=e,this.pointer&=1048320},e.prototype.increment=function(){this.pointer=this.pointer+this.fraction&1048575},e}(),l=function(){function e(){this.frequency=-1,this.counter=-1,this.waveform=0,this.reset()}return e.prototype.reset=function(){this.frequency=0,this.waveform=0,this.counter=0},e.prototype.increment=function(e){this.counter=this.counter+e*this.frequency|0},e.prototype.waveformSample=function(){return this.counter>>>27},e}()},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./harmony/Soc":60,"./util":63,tslib:20}],44:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./CartridgeInfo"),n=e("./CartridgeF8"),s=e("./CartridgeE0"),a=e("./Cartridge3F"),o=e("./Cartridge3E"),u=e("./CartridgeFE"),c=e("./CartridgeUA"),h=e("./CartridgeE7"),l=e("./CartridgeFA2"),f=e("./CartridgeEF"),_=e("./CartridgeDPCPlus"),d=e("./CartridgeCDF"),p=e("./Cartridge0840"),g=function(){function e(){}return e.prototype.detectCartridgeType=function(e){if(e.length%8448==0)return r.default.CartridgeType.bankswitch_supercharger;if(e.length<=2048)return r.default.CartridgeType.vanilla_2k;if(10240<=e.length&&e.length<=10496)return r.default.CartridgeType.bankswitch_8k_DPC;switch(e.length){case 4096:return r.default.CartridgeType.vanilla_4k;case 8192:return this._detect8k(e);case 12288:return r.default.CartridgeType.bankswitch_12k_FA;case 16384:return this._detect16k(e);case 28672:return r.default.CartridgeType.bankswitch_FA2;case 29696:return this._detect29k(e);case 32768:return this._detect32k(e);case 65536:return this._detect64k(e);default:return r.default.CartridgeType.unknown}},e.prototype._detect8k=function(e){var t=n.default.matchesBuffer(e);return s.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_E0:a.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_3F:c.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_UA:!t&&u.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_FE:p.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_econobanking:r.default.CartridgeType.bankswitch_8k_F8},e.prototype._detect16k=function(e){return h.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_16k_E7:r.default.CartridgeType.bankswitch_16k_F6},e.prototype._detect29k=function(e){return l.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_FA2:r.default.CartridgeType.bankswitch_dpc_plus},e.prototype._detect32k=function(e){return o.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_3E:_.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_dpc_plus:d.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_cdf:r.default.CartridgeType.bankswitch_32k_F4},e.prototype._detect64k=function(e){return f.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_64k_EF:r.default.CartridgeType.bankswitch_64k_F0},e}();i.default=g},{"./Cartridge0840":36,"./Cartridge3E":38,"./Cartridge3F":39,"./CartridgeCDF":41,"./CartridgeDPCPlus":43,"./CartridgeE0":45,"./CartridgeE7":46,"./CartridgeEF":47,"./CartridgeF8":51,"./CartridgeFA2":53,"./CartridgeFE":54,"./CartridgeInfo":56,"./CartridgeUA":59}],45:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(n){function e(e){var t=n.call(this)||this;if(t._banks=new Array(8),t._activeBanks=new Array(4),8192!==e.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+e.length);for(var i=0;i<8;i++)t._banks[i]=new Uint8Array(1024);for(i=0;i<1024;i++)for(var r=0;r<8;r++)t._banks[r][i]=e[1024*r+i];return t.reset(),t}return r.__extends(e,n),e.matchesBuffer=function(e){for(var t=s.searchForSignatures(e,[[141,224,31],[141,224,95],[141,233,255],[12,224,31],[173,224,31],[173,233,255],[173,237,255],[173,243,191]]),i=0;i<t.length;i++)if(0<t[i])return!0;return!1},e.prototype.reset=function(){for(var e=0;e<4;e++)this._activeBanks[e]=this._banks[7]},e.prototype.read=function(e){return 4064<=(e&=4095)&&e<4088&&this._handleBankswitch(e),this._activeBanks[e>>10][1023&e]},e.prototype.peek=function(e){return e&=4095,this._activeBanks[e>>10][1023&e]},e.prototype.write=function(e,t){var i=4095&e;return 4064<=i&&i<4088&&this._handleBankswitch(i),n.prototype.write.call(this,e,t)},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_E0},e.prototype._handleBankswitch=function(e){e<4072?this._activeBanks[0]=this._banks[e-4064]:e<4080?this._activeBanks[1]=this._banks[e-4072]:this._activeBanks[2]=this._banks[e-4080]},e}(n.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],46:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(n){function e(e){var t=n.call(this)||this;if(t._banks=new Array(8),t._ram0=new Uint8Array(1024),t._ram1Banks=new Array(4),t._ram0Enabled=!1,16384!==e.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+e.length);for(var i=0;i<8;i++)t._banks[i]=new Uint8Array(2048);for(i=0;i<4;i++)t._ram1Banks[i]=new Uint8Array(256);for(i=0;i<2048;i++)for(var r=0;r<8;r++)t._banks[r][i]=e[2048*r+i];return t.reset(),t}return r.__extends(e,n),e.matchesBuffer=function(e){for(var t=s.searchForSignatures(e,[[173,226,255],[173,229,255],[173,229,31],[173,231,31],[12,231,31],[141,231,255],[141,231,31]]),i=0;i<t.length;i++)if(0<t[i])return!0;return!1},e.prototype.reset=function(){this._bank0=this._banks[0],this._ram1=this._ram1Banks[0],this._ram0Enabled=!1},e.prototype.read=function(e){return this._handleBankswitch(4095&e),this.peek(e)},e.prototype.peek=function(e){return(e&=4095)<2048?this._ram0Enabled?1024<=e?this._ram0[e-1024]:0:this._bank0[e]:e<=2559?2304<=e?this._ram1[e-2304]:0:this._banks[7][2047-(4095-e)]},e.prototype.write=function(e,t){e&=4095,this._handleBankswitch(e),e<1024?this._ram0Enabled?this._ram0[e]=t:n.prototype.write.call(this,e,t):e<2048?n.prototype.write.call(this,e,t):e<2303?this._ram1[e-2048]=t:n.prototype.write.call(this,e,t)},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_16k_E7},e.prototype.randomize=function(e){for(var t=0;t<4;t++)for(var i=0;i<this._ram1Banks[t].length;i++)this._ram1Banks[t][i]=e.int(255);for(t=0;t<this._ram0.length;t++)this._ram0[t]=e.int(255)},e.prototype._handleBankswitch=function(e){e<4064||(e<=4070?(this._bank0=this._banks[15&e],this._ram0Enabled=!1):4071===e?this._ram0Enabled=!0:e<=4075&&(this._ram1=this._ram1Banks[e-4072]))},e}(n.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],47:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./util"),s=function(s){function e(e,t){void 0===t&&(t=!0);var i=s.call(this)||this;if(i._supportSC=t,i._bus=null,i._banks=new Array(16),i._ram=new Uint8Array(128),i._hasSC=!1,65536!==e.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+e.length);for(var r=0;r<16;r++)i._banks[r]=new Uint8Array(4096);for(r=0;r<4096;r++)for(var n=0;n<16;n++)i._banks[n][r]=e[4096*n+r];return i.reset(),i}return r.__extends(e,s),e.matchesBuffer=function(r){var e=function(e){for(var t=e.split("").map(function(e){return e.charCodeAt(0)}),i=0;i<t.length;i++)if(t[i]!==r[65528+i])return!1;return!0};if(65536!==r.length)return!1;if(e("efef")||e("efsc"))return!0;for(var t=o.searchForSignatures(r,[[12,224,255],[173,224,255],[12,224,31],[173,224,31]]),i=0;i<4;i++)if(0<t[i])return!0;return!1},e.prototype.reset=function(){this._bank=this._banks[15],this._hasSC=!1},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_64k_EF},e.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},e.prototype.peek=function(e){return e&=4095,this._hasSC&&128<=e&&e<256?this._ram[e-128]:this._bank[e]},e.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},e.prototype._access=function(e,t){e<128&&this._hasSC?this._ram[e]=t:4064<=e&&e<=4079&&(this._bank=this._banks[e-4064])},e}(n.default);i.default=s},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],48:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(n){function e(e){var t=n.call(this)||this;if(t._banks=new Array(16),t._bankIdx=0,65536!==e.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+e.length);for(var i=0;i<16;i++)t._banks[i]=new Uint8Array(4096);for(i=0;i<4096;i++)for(var r=0;r<16;r++)t._banks[r][i]=e[4096*r+i];return t.reset(),t}return r.__extends(e,n),e.prototype.reset=function(){this._bankIdx=0,this._currentBank=this._banks[this._bankIdx]},e.prototype.read=function(e){return e&=4095,this._handleBankswitch(e),this._currentBank[e]},e.prototype.peek=function(e){return this._currentBank[4095&e]},e.prototype.write=function(e,t){e&=4095,this._handleBankswitch(e),n.prototype.write.call(this,e,t)},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_64k_F0},e.prototype._handleBankswitch=function(e){4080===e&&(this._bankIdx=this._bankIdx+1&15,this._currentBank=this._banks[this._bankIdx])},e}(n.default);i.default=a},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],49:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),a=e("./CartridgeInfo"),s=function(s){function e(e,t){void 0===t&&(t=!0);var i=s.call(this)||this;if(i._supportSC=t,i._bus=null,i._banks=new Array(8),i._ram=new Uint8Array(128),i._hasSC=!1,32768!==e.length)throw new Error("buffer is not a 32k cartridge image: wrong length "+e.length);for(var r=0;r<8;r++)i._banks[r]=new Uint8Array(4096);for(r=0;r<4096;r++)for(var n=0;n<8;n++)i._banks[n][r]=e[4096*n+r];return i.reset(),i}return r.__extends(e,s),e.prototype.reset=function(){this._bank=this._banks[0],this._hasSC=!1},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_32k_F4},e.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},e.prototype.peek=function(e){return e&=4095,this._hasSC&&128<=e&&e<256?this._ram[e-128]:this._bank[e]},e.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},e.prototype._access=function(e,t){e<128&&this._hasSC?this._ram[e]=t:4084<=e&&e<=4091&&(this._bank=this._banks[e-4084])},e}(n.default);i.default=s},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(n){function e(e,t){void 0===t&&(t=!0);var i=n.call(this)||this;if(i._supportSC=t,i._bank=null,i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),i._bank2=new Uint8Array(4096),i._bank3=new Uint8Array(4096),i._hasSC=!1,i._saraRAM=new Uint8Array(128),i._bus=null,16384!==e.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+e.length);for(var r=0;r<4096;r++)i._bank0[r]=e[r],i._bank1[r]=e[4096+r],i._bank2[r]=e[8192+r],i._bank3[r]=e[12288+r];return i.reset(),i}return r.__extends(e,n),e.prototype.reset=function(){this._bank=this._bank0,this._hasSC=!1},e.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},e.prototype.peek=function(e){return e&=4095,this._hasSC&&128<=e&&e<256?this._saraRAM[e-128]:this._bank[e]},e.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_16k_F6},e.prototype.randomize=function(e){for(var t=0;t<this._saraRAM.length;t++)this._saraRAM[t]=e.int(255)},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype._access=function(e,t){if(e<128&&this._hasSC)this._saraRAM[e]=255&t;else switch(e){case 4086:this._bank=this._bank0;break;case 4087:this._bank=this._bank1;break;case 4088:this._bank=this._bank2;break;case 4089:this._bank=this._bank3}},e}(n.default);i.default=a},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],51:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(n){function e(e,t){void 0===t&&(t=!0);var i=n.call(this)||this;if(i._supportSC=t,i._bank=null,i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),i._hasSC=!1,i._saraRAM=new Uint8Array(128),i._bus=null,8192!==e.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+e.length);for(var r=0;r<4096;r++)i._bank0[r]=e[r],i._bank1[r]=e[4096+r];return i.reset(),i}return r.__extends(e,n),e.matchesBuffer=function(e){return 2<=a.searchForSignatures(e,[[141,249,31]])[0]},e.prototype.reset=function(){this._bank=this._bank1,this._hasSC=!1},e.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},e.prototype.peek=function(e){return e&=4095,this._hasSC&&128<=e&&e<256?this._saraRAM[e-128]:this._bank[e]},e.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_F8},e.prototype.randomize=function(e){for(var t=0;t<this._saraRAM.length;t++)this._saraRAM[t]=e.int(255)},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype._access=function(e,t){if(e<128&&this._hasSC)this._saraRAM[e]=255&t;else switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}},e}(n.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],52:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(r){function e(e){var t=r.call(this)||this;if(t._bank0=new Uint8Array(4096),t._bank1=new Uint8Array(4096),t._bank2=new Uint8Array(4096),t._ram=new Uint8Array(256),12288!==e.length)throw new Error("buffer is not a 12k cartridge image: wrong length "+e.length);for(var i=0;i<4096;i++)t._bank0[i]=e[i],t._bank1[i]=e[4096+i],t._bank2[i]=e[8192+i];return t.reset(),t}return n.__extends(e,r),e.prototype.reset=function(){this._bank=this._bank0},e.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},e.prototype.read=function(e){return this._handleBankswitch(4095&e),this.peek(e)},e.prototype.peek=function(e){return 256<=(e&=4095)&&e<512?this._ram[255&e]:this._bank[e]},e.prototype.write=function(e,t){e&=4095,this._handleBankswitch(e),e<256?this._ram[e]=255&t:r.prototype.write.call(this,e,t)},e.prototype.getType=function(){return s.default.CartridgeType.bankswitch_12k_FA},e.prototype._handleBankswitch=function(e){switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1;break;case 4090:this._bank=this._bank2}},e}(r.default);i.default=a},{"./AbstractCartridge":35,"./CartridgeInfo":56,tslib:20}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./util"),s=function(s){function e(e){var t=s.call(this)||this;if(t._banks=new Array(7),t._ram=new Uint8Array(256),t._savedRam=new Uint8Array(256),t._accessCounter=0,t._accessCounterLimit=0,28672!==e.length&&29696!==e.length)throw new Error("buffer is not a 28k/29k cartridge image: wrong length "+e.length);for(var i=0;i<7;i++)t._banks[i]=new Uint8Array(4096);var r=28672===e.length?0:1024;for(i=0;i<4096;i++)for(var n=0;n<7;n++)t._banks[n][i]=e[4096*n+i+r];return t.reset(),t}return r.__extends(e,s),e.matchesBuffer=function(e){var t=o.searchForSignatures(e,[[160,193,31,224],[0,128,2,224]]);return 0<t[0]||0<t[1]},e.prototype.reset=function(){this._accessCounter=0,this._accessCounterLimit=0,this._bank=this._banks[0]},e.prototype.getType=function(){return a.default.CartridgeType.bankswitch_FA2},e.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.read=function(e){return this.write(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},e.prototype.peek=function(e){return 256<=(e&=4095)&&e<512?this._ram[e-256]:4084===e?this._accessCounter>=this._accessCounterLimit?-65&this._bank[e]:64|this._bank[e]:this._bank[e]},e.prototype.write=function(e,t){if(e&=4095,this._accessCounter++,!(e<256))return 4084===e?this._handleIo():void(4085<=e&&e<=4091&&(this._bank=this._banks[e-4085]));this._ram[e]=t},e.prototype._handleIo=function(){if(!(this._accessCounter<this._accessCounterLimit)){if(1===this._ram[255]){for(var e=0;e<256;e++)this._ram[e]=this._savedRam[e];this._accessCounterLimit=10}else{if(2!==this._ram[255])return;for(e=0;e<256;e++)this._savedRam[e]=this._ram[e];this._accessCounterLimit=100}this._accessCounter=0,this._ram[255]=0}},e}(n.default);i.default=s},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],54:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(r){function t(e){var t=r.call(this)||this;if(t._bank0=new Uint8Array(4096),t._bank1=new Uint8Array(4096),t._lastAccessWasFE=!1,t._lastAddressBusValue=-1,8192!==e.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+e.length);for(var i=0;i<4096;i++)t._bank0[i]=e[i],t._bank1[i]=e[4096+i];return t.reset(),t}return n.__extends(t,r),t.matchesBuffer=function(e){for(var t=a.searchForSignatures(e,[[32,0,208,198,197],[32,195,248,165,130],[208,251,32,115,254],[32,0,240,132,214]]),i=0;i<t.length;i++)if(0<t[i])return!0;return!1},t.prototype.reset=function(){this._bank=this._bank0,this._lastAccessWasFE=!1,this._lastAddressBusValue=-1},t.prototype.read=function(e){return this._bank[4095&e]},t.prototype.write=function(e,t){r.prototype.write.call(this,e,t)},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_FE},t._onBusAccess=function(e,t){var i=t._lastAddressBusValue;t._lastAddressBusValue=t._bus.getLastAddresBusValue(),t._lastAddressBusValue!==i&&(t._lastAccessWasFE&&(t._bank=0<(32&t._bus.getLastDataBusValue())?t._bank0:t._bank1),t._lastAccessWasFE=510===t._bus.getLastAddresBusValue())},t}(r.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],55:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./Cartridge2k"),s=e("./Cartridge4k"),a=e("./CartridgeF8"),o=e("./CartridgeF6"),u=e("./CartridgeE0"),c=e("./CartridgeFE"),h=e("./Cartridge3F"),l=e("./Cartridge3E"),f=e("./CartridgeUA"),_=e("./CartridgeFA"),d=e("./CartridgeE7"),p=e("./CartridgeF0"),g=e("./CartridgeEF"),b=e("./CartridgeF4"),m=e("./CartridgeFA2"),y=e("./CartridgeSupercharger"),k=e("./CartridgeDPC"),v=e("./CartridgeDPCPlus"),w=e("./CartridgeCDF"),C=e("./Cartridge0840"),A=e("./CartridgeInfo"),M=e("./CartridgeDetector"),T=function(){function e(){}return e.prototype.createCartridge=function(i,r){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,(t=this._createCartridge(i,r)).init()];case 1:return e.sent(),[2,t]}})})},e.prototype._createCartridge=function(e,t){void 0===t&&(t=(new M.default).detectCartridgeType(e));switch(t){case A.default.CartridgeType.vanilla_2k:return new r.default(e);case A.default.CartridgeType.vanilla_4k:return new s.default(e);case A.default.CartridgeType.bankswitch_8k_F8:return new a.default(e);case A.default.CartridgeType.bankswitch_8k_E0:return new u.default(e);case A.default.CartridgeType.bankswitch_8k_3F:return new h.default(e);case A.default.CartridgeType.bankswitch_8k_FE:return new c.default(e);case A.default.CartridgeType.bankswitch_8k_UA:return new f.default(e);case A.default.CartridgeType.bankswitch_8k_DPC:return new k.default(e);case A.default.CartridgeType.bankswitch_8k_econobanking:return new C.default(e);case A.default.CartridgeType.bankswitch_12k_FA:return new _.default(e);case A.default.CartridgeType.bankswitch_16k_F6:return new o.default(e);case A.default.CartridgeType.bankswitch_16k_E7:return new d.default(e);case A.default.CartridgeType.bankswitch_FA2:return new m.default(e);case A.default.CartridgeType.bankswitch_32k_F4:return new b.default(e);case A.default.CartridgeType.bankswitch_64k_F0:return new p.default(e);case A.default.CartridgeType.bankswitch_64k_EF:return new g.default(e);case A.default.CartridgeType.bankswitch_3E:return new l.default(e);case A.default.CartridgeType.bankswitch_supercharger:return new y.default(e);case A.default.CartridgeType.bankswitch_dpc_plus:return new v.default(e);case A.default.CartridgeType.bankswitch_cdf:return new w.default(e);default:throw new Error("invalid or unsupported cartridge image")}},e}();i.default=T},{"./Cartridge0840":36,"./Cartridge2k":37,"./Cartridge3E":38,"./Cartridge3F":39,"./Cartridge4k":40,"./CartridgeCDF":41,"./CartridgeDPC":42,"./CartridgeDPCPlus":43,"./CartridgeDetector":44,"./CartridgeE0":45,"./CartridgeE7":46,"./CartridgeEF":47,"./CartridgeF0":48,"./CartridgeF4":49,"./CartridgeF6":50,"./CartridgeF8":51,"./CartridgeFA":52,"./CartridgeFA2":53,"./CartridgeFE":54,"./CartridgeInfo":56,"./CartridgeSupercharger":58,"./CartridgeUA":59,tslib:20}],56:[function(e,t,i){"use strict";var r,n,s,a;Object.defineProperty(i,"__esModule",{value:!0}),n=r||(r={}),(a=s=n.CartridgeType||(n.CartridgeType={})).vanilla_2k="vanilla_2k",a.vanilla_4k="vanilla_4k",a.bankswitch_8k_F8="bankswitch_8k_F8",a.bankswitch_8k_E0="bankswitch_8k_E0",a.bankswitch_8k_3F="bankswitch_8k_3F",a.bankswitch_8k_FE="bankswitch_8k_FE",a.bankswitch_8k_UA="bankswitch_8k_UA",a.bankswitch_8k_DPC="bankswitch_8k_DPC",a.bankswitch_8k_econobanking="bankswitch_8k_econobanking",a.bankswitch_12k_FA="bankswitch_12k_FA",a.bankswitch_16k_F6="bankswitch_16k_F6",a.bankswitch_16k_E7="bankswitch_16k_E7",a.bankswitch_FA2="bankswitch_FA2",a.bankswitch_32k_F4="bankswitch_32k_F4",a.bankswitch_64k_F0="bankswitch_64k_F0",a.bankswitch_64k_EF="bankswitch_64k_EF",a.bankswitch_3E="bankswitch_3E",a.bankswitch_supercharger="bankswitch_supercharger",a.bankswitch_dpc_plus="bankswitch_dpc_plus",a.bankswitch_cdf="bankswitch_cdf",a.unknown="unknown",n.getAllTypes=function(){return[s.vanilla_2k,s.vanilla_4k,s.bankswitch_8k_F8,s.bankswitch_8k_E0,s.bankswitch_8k_3F,s.bankswitch_8k_FE,s.bankswitch_8k_UA,s.bankswitch_8k_econobanking,s.bankswitch_12k_FA,s.bankswitch_8k_DPC,s.bankswitch_16k_F6,s.bankswitch_16k_E7,s.bankswitch_FA2,s.bankswitch_32k_F4,s.bankswitch_3E,s.bankswitch_64k_F0,s.bankswitch_64k_EF,s.bankswitch_supercharger,s.bankswitch_dpc_plus,s.bankswitch_cdf,s.unknown]},n.describeCartridgeType=function(e){switch(e){case s.vanilla_2k:return"plain 2k";case s.vanilla_4k:return"plain 4k";case s.bankswitch_8k_F8:return"bankswitched 8k, F8 (Atari) scheme";case s.bankswitch_8k_E0:return"bankswitched 8k, E0 (Parker Bros.) scheme";case s.bankswitch_8k_3F:return"bankswitched 8k, 3F (Tigervision) scheme";case s.bankswitch_8k_FE:return"bankswitched 8k, FE (Activision) scheme";case s.bankswitch_8k_UA:return"bankswitched 8k, UA (Pleiades) scheme";case s.bankswitch_12k_FA:return"bankswitched 12k, FA (CBS) scheme";case s.bankswitch_8k_DPC:return"bankswitched 8k + DPC";case s.bankswitch_8k_econobanking:return"bankswitched 8k, econobanking scheme";case s.bankswitch_16k_F6:return"bankswitched 16k, F6 (Atari) scheme";case s.bankswitch_16k_E7:return"bankswitched 16k, E7 (M-Network) scheme";case s.bankswitch_FA2:return"bankswitched 28k/29k, FA2 (modified CBS) scheme";case s.bankswitch_32k_F4:return"bankswitched 32k, F4 (Atari) scheme";case s.bankswitch_3E:return"bankswitched 3E (Tigervision + RAM) scheme";case s.bankswitch_64k_F0:return"bankswitched 64k, F0 (Megaboy) scheme";case s.bankswitch_64k_EF:return"bankswitched 64k, EFSC (Homestar Runner) scheme";case s.bankswitch_supercharger:return"bankswitched supercharger";case s.bankswitch_dpc_plus:return"bankswitched DPC+";case s.bankswitch_cdf:return"bankswitched CDF";case s.unknown:return"unknown"}},i.default=r},{}],57:[function(e,t,i){"use strict";var r,n;Object.defineProperty(i,"__esModule",{value:!0}),n=function(e,t,i){this.reason=e,this.cartridge=t,this.message=i},(r||(r={})).TrapPayload=n,i.default=r},{}],58:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("tslib"),n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./supercharger/Header"),o=e("./supercharger/blob"),u=function(n){function t(e){var t=n.call(this)||this;if(t._loadCount=0,t._loads=null,t._headers=null,t._rom=new Uint8Array(2048),t._ramBanks=new Array(3),t._bank0=null,t._bank1=null,t._bank1Type=1,t._transitionCount=0,t._pendingWriteData=0,t._pendingWrite=!1,t._lastAddressBusValue=-1,t._writeRamEnabled=!1,t._loadInProgress=!1,t._loadTimestamp=0,t._cpuTimeProvider=null,e.length%8448!=0)throw new Error("not a supercharger image --- invalid size");t._loadCount=e.length/8448,t._loads=new Array(t._loadCount),t._headers=new Array(t._loadCount);for(var i=0;i<t._loadCount;i++)t._loads[i]=new Uint8Array(8448);for(i=0;i<8448;i++)for(var r=0;r<t._loadCount;r++)t._loads[r][i]=e[8448*r+i];for(i=0;i<t._loadCount;i++)t._headers[i]=new a.default(t._loads[i]),t._headers[i].verify()||console.log("load "+i+" has invalid checksum");for(i=0;i<3;i++)t._ramBanks[i]=new Uint8Array(2048);return t._setupRom(),t.reset(),t}return r.__extends(t,n),t.prototype.reset=function(){this._setBankswitchMode(0),this._transitionCount=0,this._pendingWrite=!1,this._pendingWriteData=0,this._lastAddressBusValue=-1,this._writeRamEnabled=!1,this._loadInProgress=!1,this._loadTimestamp=0},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.setCpuTimeProvider=function(e){return this._cpuTimeProvider=e,this},t.prototype.setRng=function(e){return this._rng=e,this},t.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},t.prototype.peek=function(e){return(e&=4095)<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.write=function(e,t){this._access(e,t)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_supercharger},t._onBusAccess=function(e,t){var i=t._bus.getLastAddresBusValue();i===t._lastAddressBusValue||t._loadInProgress||(t._transitionCount<=5&&t._transitionCount++,t._lastAddressBusValue=i)},t.prototype._access=function(e,t){if(e&=4095,this._loadInProgress){if(!(.001<this._cpuTimeProvider()-this._loadTimestamp))return t;this._loadInProgress=!1}var i=e<2048?this._bank0[e]:this._bank1[2047&e];if(!(0!=(3840&e)||this._pendingWrite&&this._writeRamEnabled))return this._pendingWriteData=255&e,this._transitionCount=0,this._pendingWrite=!0,i;if(4088===e)return this._setBankswitchMode((28&this._pendingWriteData)>>>2),this._writeRamEnabled=0<(2&this._pendingWriteData),this._pendingWrite=!1,i;if(4089===e&&1===this._bank1Type&&(8191&this._lastAddressBusValue)<255)return this._loadIntoRam(t),i;if(this._pendingWrite&&this._writeRamEnabled&&5===this._transitionCount){if(this._pendingWrite=!1,e<2048)this._bank0[e]=this._pendingWriteData;else{if(0!==this._bank1Type)return i;this._bank1[2047&e]=this._pendingWriteData}return this._pendingWriteData}return i},t.prototype._setBankswitchMode=function(e){switch(e){case 0:return this._configureBanks(2,1);case 1:return this._configureBanks(0,1);case 2:return this._configureBanks(2,0,0);case 3:return this._configureBanks(0,0,2);case 4:return this._configureBanks(2,1);case 5:return this._configureBanks(1,1);case 6:return this._configureBanks(2,0,1);case 7:return this._configureBanks(1,0,2);default:throw new Error("invalid bankswitching mode")}},t.prototype._configureBanks=function(e,t,i){void 0===i&&(i=0),this._bank0=this._ramBanks[e],this._bank1Type=t,this._bank1=0===t?this._ramBanks[i]:this._rom},t.prototype._setupRom=function(){for(var e=0;e<2048;e++)this._rom[e]=0;for(e=0;e<o.bios.length;e++)this._rom[e]=o.bios[e];this._rom[2047]=this._rom[2045]=248,this._rom[2046]=this._rom[2044]=7},t.prototype._loadIntoRam=function(e){var t;for(t=0;t<this._loadCount&&(this._headers[t].multiloadId!==e&&1!==this._loadCount);t++);t>=this._loadCount&&console.log("no load with id "+e);for(var i=this._headers[t],r=this._loads[t],n=0;n<i.blockCount;n++){var s=i.blockLocation[n],a=3&s;2<a&&(a=0,console.log("invalid bank for block "+n+", load "+t));for(var o=256*((28&s)>>>2),u=s+i.blockChecksum[n],c=0;c<256;c++)u+=r[256*n+c],this._ramBanks[a][o+c]=r[256*n+c];85!=(255&u)&&console.log("load "+t+", block "+n+": invalid checksum")}this._rom[2032]=i.controlWord,this._rom[2033]=this._rng.int(255),this._rom[2034]=i.startAddressLow,this._rom[2035]=i.startAddressHigh,this._loadInProgress=!0,this._loadTimestamp=this._cpuTimeProvider()},t}(n.default);i.default=u},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./supercharger/Header":61,"./supercharger/blob":62,tslib:20}],59:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tslib"),r=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(r){function t(e){var t=r.call(this)||this;if(t._bus=null,t._bank=null,t._bank0=new Uint8Array(4096),t._bank1=new Uint8Array(4096),8192!==e.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+e.length);for(var i=0;i<4096;i++)t._bank0[i]=e[i],t._bank1[i]=e[4096+i];return t.reset(),t}return n.__extends(t,r),t.matchesBuffer=function(e){for(var t=a.searchForSignatures(e,[[141,64,2],[173,64,2],[189,31,2]]),i=0;i<t.length;i++)if(0<t[i])return!0;return!1},t.prototype.reset=function(){this._bank=this._bank0},t.prototype.read=function(e){return this._bank[4095&e]},t.prototype.setBus=function(e){return(this._bus=e).event.read.addHandler(t._onBusAccess,this),e.event.write.addHandler(t._onBusAccess,this),this},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_UA},t._onBusAccess=function(e,t){switch(t._bus.getLastAddresBusValue()){case 544:t._bank=t._bank0;break;case 576:t._bank=t._bank1}},t}(r.default);i.default=o},{"./AbstractCartridge":35,"./CartridgeInfo":56,"./util":63,tslib:20}],60:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("thumbulator.ts"),s=e("microevent.ts"),a=e("../../../../tools/hex");var r=function(){function e(e){void 0===e&&(e=function(){return 3});var t,r=this;this.trap=new s.Event,this._thumbulatorBus={read16:function(e){if(1&e)return r._triggerTrap("unaligned 16 bit ARM read from "+a.encode(e,8,!1)),0;var t=268435455&e;switch(e>>>28){case 0:if(t<32768)return r.getRom16(t);break;case 4:if(t<8192)return r.getRam16(t);break;case 14:switch(t){case 2080768:return r._armMamcr}}r._triggerTrap("invalid 16 bit ARM read from "+a.encode(e,8,!1))},read32:function(e){if(3&e)return r._triggerTrap("unaligned 32 bit ARM read from "+a.encode(e,8,!1)),0;var t=268435455&e;switch(e>>>28){case 0:if(t<32768)return r.getRom32(t);break;case 4:if(t<8192)return r.getRam32(t);break;case 14:switch(t){case 32772:case 32776:return 0}}r._triggerTrap("invalid 32 bit ARM read from "+a.encode(e,8,!1))},write16:function(e,t){if(1&e)r._triggerTrap("unaligned 16 bit ARM write: "+a.encode(t,4)+" -> "+a.encode(e,8,!1));else{var i=268435455&e;switch(e>>>28){case 4:if(i<8192)return void r.setRam16(i,65535&t);break;case 14:switch(i){case 2080768:return void(r._armMamcr=t)}}r._triggerTrap("invalid 16 bit ARM write: "+a.encode(t,4)+" -> "+a.encode(e,8,!1))}},write32:function(e,t){if(3&e)r._triggerTrap("unaligned 32 bit ARM write: "+a.encode(t,8,!1)+" -> "+a.encode(e,8,!1));else{var i=268435455&e;switch(e>>>28){case 4:if(i<8192)return void r.setRam32(i,t);case 14:switch(i){case 32772:case 32776:return}}r._triggerTrap("invalid 32 bit ARM write: "+a.encode(t,8,!1)+" -> "+a.encode(e,8,!1))}}},this._romBuffer=new ArrayBuffer(32768),this._ramBuffer=new ArrayBuffer(8192),this._armMamcr=0,this._thumbulator=null,t=new Uint8Array([1,2,3,4]),67305985===new Uint32Array(t.buffer)[0]?(this.getRom16=function(e){return r._rom16[e>>>1]},this.getRom32=function(e){return r._rom32[e>>>2]},this.getRam16=function(e){return r._ram16[e>>>1]},this.getRam32=function(e){return r._ram32[e>>>2]},this.setRam16=function(e,t){return r._ram16[e>>>1]=t},this.setRam32=function(e,t){return r._ram32[e>>>2]=t}):(this.getRom16=function(e){return r._rom8[e]|r._rom8[e+1]<<8},this.getRom32=function(e){return r._rom8[e]|r._rom8[e+1]<<8|r._rom8[e+2]<<16|r._rom8[e+3]<<24},this.getRam16=function(e){return r._ram8[e]|r._ram8[e+1]<<8},this.getRam32=function(e){return r._ram8[e]|r._ram8[e+1]<<8|r._ram8[e+2]<<16|r._ram8[e+3]<<24},this.setRam16=function(e,t){r._ram8[e]=255&t,r._ram8[e+1]=t>>>8&255},this.setRam32=function(e,t){r._ram8[e]=255&t,r._ram8[e+1]=t>>>8&255,r._ram8[e+2]=t>>>16&255,r._ram8[e+3]=t>>>24&255}),this._rom8=new Uint8Array(this._romBuffer),this._rom16=new Uint16Array(this._romBuffer),this._rom32=new Uint32Array(this._romBuffer),this._ram8=new Uint8Array(this._ramBuffer),this._ram16=new Uint16Array(this._ramBuffer),this._ram32=new Uint32Array(this._ramBuffer),this._thumbulator=new n.default(this._thumbulatorBus,{stopAddress:32772,trapOnBx32:e}),this.reset()}return e.prototype.init=function(){return this._thumbulator.init()},e.prototype.reset=function(){},e.prototype.getRom=function(){return this._rom8},e.prototype.getRam=function(){return this._ram8},e.prototype.run=function(e){this._thumbulator.reset(),this._thumbulator.enableDebug(!1);for(var t=0;t<=12;t++)this._thumbulator.writeRegister(t,0);this._thumbulator.writeRegister(13,1073749940),this._thumbulator.writeRegister(14,32773),this._thumbulator.writeRegister(15,e),this._armMamcr=0;var i=this._thumbulator.run(5e5);20!==i&&10!==i&&this._triggerTrap("ARM execution trapped: "+i)},e.prototype.getThumbulator=function(){return this._thumbulator},e.prototype._triggerTrap=function(e){this._thumbulator.abort(),this.trap.dispatch(e)},e}();i.default=r},{"../../../../tools/hex":82,"microevent.ts":6,"thumbulator.ts":18}],61:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this.blockLocation=null,this.blockChecksum=null,this.startAddressLow=e[8192],this.startAddressHigh=e[8193],this.controlWord=e[8194],this.blockCount=e[8195],this.checksum=e[8196],this.multiloadId=e[8197],this.progressBarSpeedLow=e[8198],this.progressBarSpeedHigh=e[8199],this.blockLocation=new Uint8Array(this.blockCount),this.blockChecksum=new Uint8Array(this.blockCount);for(var t=0;t<this.blockCount;t++)this.blockLocation[t]=e[8208+t],this.blockChecksum[t]=e[8256+t]}return e.prototype.verify=function(){return 85==(255&this.startAddressLow+this.startAddressHigh+this.controlWord+this.blockCount+this.checksum+this.multiloadId+this.progressBarSpeedLow+this.progressBarSpeedHigh)},e}();i.default=r},{}],62:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../../../../tools/base64");i.bios=r.decode("pfqFgEwY+HjYqQCi/5qqqJUA6ND7TBj4ogCtBvCN+P+gAKIolATKEPuiHJSByhD7qQCFG4UchR2FHoUfhRmFGoUIhQGpEIUhhQKiB8rK0P2pAIUghRCFEYUChSqpBYUKqf+FDYUOhQ+FhIWFqfCFg6l0hQmpDIUVqR+FF4WCqQeFGaIIoACFAojQ+4UChQKpAoUChQCFAoUChQKpAIUAyhDkBoNmhCaFpYOFDaWEhQ6lhYUPpoLKhoKGF+AK0MOpAoUBohygAIQZhAmUgcoQ+6IArADw6rwA9+jQ9qILvRL5lfDKEPilgEzwAKIGvR35lfDKEPiu8P+GgLwA8K3x/67y/4b0rvP/hvWi/6AAmkzwAI35/637/9D7TOv4jfj/TAAA")},{"../../../../tools/base64":81}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.searchForSignatures=function(e,t){for(var i=[],r=t.map(function(e){return 0}),n=0;n<e.length;n++){for(var s=0;s<i.length;s++){var a=i[s],o=t[a.signature];e[n]===o[a.nextIndex]?++a.nextIndex===o.length&&(r[a.signature]++,i.splice(s,1),s--):(i.splice(s,1),s--)}for(var u=0;u<t.length;u++)0<(o=t[u]).length&&e[n]===o[0]&&(1===o.length?r[u]++:i.push({signature:u,nextIndex:1}))}return r},i.searchForSignature=function(e,t){for(var i=0;i<e.length;i++){var r=void 0;for(r=0;r<t.length&&(e[i+r]===t[r]||t[r]<0);r++);if(r===t.length)return i}return-1}},{}],64:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this._delaying=!1,this.reset()}return e.prototype.reset=function(){this.color=4294967295,this.collision=0,this._width=1,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._delaying=!1,this._effectiveWidth=0,this._lastMovementTick=0},e.prototype.enabl=function(e){var t=this._enabledNew;this._enabledNew=0<(2&e),t===this._enabledNew||this._delaying||(this._flushLineCache(),this._updateEnabled())},e.prototype.hmbl=function(e){this._hmmClocks=e>>>4^8},e.prototype.resbl=function(e){this._counter=e,this._rendering=!0,this._renderCounter=e-157-4},e.prototype.ctrlpf=function(e){var t=this._widths[(48&e)>>>4];t!==this._width&&this._flushLineCache(),this._width=t},e.prototype.vdelbl=function(e){var t=this._delaying;this._delaying=0<(1&e),t!==this._delaying&&(this._flushLineCache(),this._updateEnabled())},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return this._lastMovementTick=this._counter,e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(!1),this._moving},e.prototype.tick=function(e){this.collision=this._rendering&&0<=this._renderCounter&&this._enabled?0:this._collisionMask;var t=this._moving&&e;if(156===this._counter){var i=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,t&&3===i&&this._width<4&&this._renderCounter++,i){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(t?this._effectiveWidth:this._width)&&(this._rendering=!1);160<=++this._counter&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.shuffleStatus=function(){var e=this._enabledOld;this._enabledOld=this._enabledNew,this._delaying&&this._enabledOld!==e&&(this._flushLineCache(),this._updateEnabled())},e.prototype.setColor=function(e){e!==this.color&&this._enabled&&this._flushLineCache(),this.color=e},e.prototype._updateEnabled=function(){this._enabled=this._delaying?this._enabledOld:this._enabledNew},e}();i.default=r},{}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._length=e,this._nextIndex=0,this._indices=new Uint8Array(255),this._queue=new Array(this._length);for(var i=0;i<this._length;i++)this._queue[i]=new n(t)}return e.prototype.reset=function(){for(var e=0;e<this._length;e++)this._queue[e].nextIndex=0},e.prototype.push=function(e,t,i){if(i>=this._length)throw new Error("delay exceeds queue length");var r=this._indices[e];r<this._length&&this._queue[r].remove(e);var n=(this._nextIndex+i)%this._length;return this._queue[n].push(e,t),this._indices[e]=n,this},e.prototype.execute=function(e,t){var i=this._queue[this._nextIndex];this._nextIndex=(this._nextIndex+1)%this._length;for(var r=0;r<i.nextIndex;r++)e(i.addresses[r],i.values[r],t),this._indices[i.addresses[r]]=255;i.nextIndex=0},e}();i.default=r;var n=function(){function e(e){this.size=e,this.nextIndex=0,this.addresses=new Uint8Array(e),this.values=new Uint8Array(e)}return e.prototype.push=function(e,t){if(this.nextIndex>=this.size)throw new Error("delay queue overflow");this.addresses[this.nextIndex]=e,this.values[this.nextIndex]=t,this.nextIndex++},e.prototype.remove=function(e){var t;for(t=0;t<this.nextIndex&&this.addresses[t]!==e;t++);t<this.nextIndex&&(this.addresses[t]=this.addresses[this.nextIndex-1],this.values[t]=this.values[this.nextIndex-1],this.nextIndex--)},e}()},{}],66:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e){switch(this._config=e,this.newFrame=new r.Event,this.vblank=!1,this.surfaceBuffer=null,this._vblankLines=0,this._kernelLines=0,this._overscanLines=0,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surfaceFactory=null,this._surface=null,this._frameStart=-1,this._config.tvMode){case 0:this._vblankLines=40,this._kernelLines=192,this._overscanLines=30;break;case 1:case 2:this._vblankLines=48,this._kernelLines=228,this._overscanLines=36;break;default:throw new Error("invalid tv mode "+this._config.tvMode)}this._frameStart=this._config.frameStart,this.reset()}return e.prototype.reset=function(){this.vblank=!1,this.surfaceBuffer=null,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surface=null},e.prototype.nextLine=function(){if(this._surfaceFactory)switch(this._lineInState++,this._state){case 0:case 1:150<++this._linesWithoutVsync&&this._setState(2);break;case 2:0<=this._frameStart?this._lineInState>this._frameStart&&this._startFrame():this._lineInState>=(this.vblank?this._vblankLines:this._vblankLines-10)&&this._startFrame();break;case 3:this._lineInState>=this._kernelLines+20&&this._finalizeFrame();break;case 4:this._lineInState>=this._overscanLines-20&&this._setState(0)}},e.prototype.isRendering=function(){return 3===this._state&&!!this._surface},e.prototype.setVblank=function(e){this._surfaceFactory&&(this.vblank=e)},e.prototype.setVsync=function(e){if(this._surfaceFactory&&e!==this._vsync)switch(this._vsync=e,this._state){case 0:this._linesWithoutVsync=0;case 2:case 4:e&&this._setState(1);break;case 1:e||this._setState(2);break;case 3:e&&this._finalizeFrame()}},e.prototype.getHeight=function(){return this._kernelLines+20},e.prototype.setSurfaceFactory=function(e){this._surfaceFactory=e},e.prototype.getCurrentLine=function(){return 3===this._state?this._lineInState:0},e.prototype.getDebugState=function(){return this._getReadableState()+", line = "+this._lineInState+", vblank = "+(this.vblank?"1":"0")},e.prototype._getReadableState=function(){switch(this._state){case 0:return"wait for vsync start";case 1:return"wait for vsync end";case 2:return"wait for frame start";case 3:return"frame";case 4:return"overscan"}},e.prototype._startFrame=function(){this._setState(3),this._surface=this._surfaceFactory(),this.surfaceBuffer=this._surface.getBuffer()},e.prototype._finalizeFrame=function(){if(3!==this._state)throw new Error("finalize frame in invalid state "+this._state);this.newFrame.dispatch(this._surface),this._setState(4)},e.prototype._setState=function(e){this._state=e,this._lineInState=0},e}();i.default=n},{"microevent.ts":6}],67:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._switch=e,this._modeLatched=!1,this._latchedValue=0,this.reset()}return e.prototype.reset=function(){this._modeLatched=!1,this._latchedValue=0},e.prototype.vblank=function(e){64&e?this._modeLatched=!0:(this._modeLatched=!1,this._latchedValue=128)},e.prototype.inpt=function(){var e=this._switch.read()?0:128;return this._modeLatched&&(this._latchedValue&=e,e=this._latchedValue),e},e}();i.default=r},{}],68:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./drawCounterDecodes"),n=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._enabled=!1,this._enam=!1,this._resmp=-1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this.reset()}return e.prototype.reset=function(){this.color=4294967295,this._width=1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._decodes=r.decodesMissile[0],this._resmp=-1,this._enam=!1,this._effectiveWidth=0,this._lastMovementTick=0},e.prototype.enam=function(e){var t=0<(2&e),i=t&&0===this._resmp;t===this._enam&&i===this._enabled||this._flushLineCache(),this._enam=t,this._enabled=i},e.prototype.hmm=function(e){this._hmmClocks=e>>>4^8},e.prototype.resm=function(e,t){if(this._counter=e,this._rendering)if(this._renderCounter<0)this._renderCounter=e-157-4;else switch(this._width){case 8:this._renderCounter=e-157+(4<=this._renderCounter?4:0);break;case 4:this._renderCounter=e-157;break;case 2:t?this._rendering=1<this._renderCounter:0===this._renderCounter&&this._renderCounter++;break;default:t&&(this._rendering=0<this._renderCounter)}},e.prototype.resmp=function(e,t){var i=2&e;i!==this._resmp&&(this._flushLineCache(),(this._resmp=i)?this._enabled=!1:(this._enabled=this._enam,this._counter=t.getRespClock()))},e.prototype.nusiz=function(e){this._width=this._widths[(48&e)>>>4],this._decodes=r.decodesMissile[7&e],this._rendering&&this._renderCounter>=this._width&&(this._rendering=!1)},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return this._lastMovementTick=this._counter,e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(!1),this._moving},e.prototype.tick=function(e){this.collision=this._rendering&&0<=this._renderCounter&&this._enabled?0:this._collisionMask;var t=this._moving&&e;if(this._decodes[this._counter]&&!this._resmp){var i=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,t&&3===i&&this._width<4&&this._renderCounter++,i){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(t?this._effectiveWidth:this._width)&&(this._rendering=!1);160<=++this._counter&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.setColor=function(e){e!==this.color&&this._enabled&&this._flushLineCache(),this.color=e},e}();i.default=n},{"./drawCounterDecodes":77}],69:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./PCMChannel"),s=new Float32Array(31);!function(e){for(var t=0;t<=30;t++)s[t]=t/30*60/(30+1*t)}(i.__init||(i.__init={}));var a=function(){function e(e){this._config=e,this.newFrame=new r.Event,this.togglePause=new r.Event,this._currentOutputBuffer=null,this._bufferIndex=0,this._sampleRate=0,this._counter=0,this._isActive=!1,this._channel0=new n.default,this._channel1=new n.default,this._sampleRate=2*(0===this._config.tvMode?15720:15600),this._frameSize=4*(0===this._config.tvMode?262:312),this.reset()}return e.prototype.getChannels=function(){var t=this;return[{audv:function(e){return t._channel0.audv(e)},audc:function(e){return t._channel0.audc(e)},audf:function(e){return t._channel0.audf(e)},reset:function(){return t.reset()},setActive:function(e){return t.setActive(e)}},{audv:function(e){return t._channel1.audv(e)},audc:function(e){return t._channel1.audc(e)},audf:function(e){return t._channel1.audf(e)},reset:function(){},setActive:function(){}}]},e.prototype.reset=function(){this._bufferIndex=0,this._counter=0,this._channel0.reset(),this._channel1.reset()},e.prototype.tick=function(){switch(this._counter){case 9:case 81:this._channel0.phase0(),this._channel1.phase0();break;case 37:case 149:this._currentOutputBuffer.getContent()[this._bufferIndex++]=s[this._channel0.phase1()+this._channel1.phase1()],this._bufferIndex===this._currentOutputBuffer.getLength()&&this._dispatchBuffer()}228==++this._counter&&(this._counter=0)},e.prototype.isPaused=function(){return!this._isActive},e.prototype.setActive=function(e){e!==this._isActive&&(this._isActive=e,this.togglePause.dispatch(!e))},e.prototype.getSampleRate=function(){return this._sampleRate},e.prototype.getFrameSize=function(){return this._frameSize},e.prototype.setFrameBufferFactory=function(e){this._bufferFactory=e,!this._currentOutputBuffer&&e&&(this._currentOutputBuffer=e(),this._bufferIndex=0)},e.prototype._dispatchBuffer=function(){this.newFrame.dispatch(this._currentOutputBuffer),this._currentOutputBuffer=this._bufferFactory?this._bufferFactory():null,this._bufferIndex=0},e}();i.default=a},{"./PCMChannel":70,"microevent.ts":6}],70:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){this._audv=0,this._audc=0,this._audf=0,this._clkEnable=!1,this._noiseFeedback=!1,this._noiseCounterBit4=!1,this._pulseCounterHold=!1,this._divCounter=0,this._noiseCounter=0,this._pulseCounter=0,this.reset()}return e.prototype.reset=function(){this._audc=this._audf=this._audv=0,this._clkEnable=!1,this._noiseFeedback=!1,this._noiseCounterBit4=!1,this._pulseCounterHold=!1,this._divCounter=0,this._noiseCounter=0,this._pulseCounter=0},e.prototype.phase0=function(){if(this._clkEnable){switch(this._noiseCounterBit4=!!(1&this._noiseCounter),3&this._audc){case 0:case 1:this._pulseCounterHold=!1;break;case 2:this._pulseCounterHold=2!=(30&this._noiseCounter);break;case 3:this._pulseCounterHold=!this._noiseCounterBit4}switch(3&this._audc){case 0:this._noiseFeedback=!(!(1&(this._pulseCounter^this._noiseCounter))&&(0!==this._noiseCounter||10!==this._pulseCounter)&&12&this._audc);break;default:this._noiseFeedback=!!((4&this._noiseCounter?1:0)^1&this._noiseCounter)||0===this._noiseCounter}}this._clkEnable=this._divCounter===this._audf,this._divCounter===this._audf||31===this._divCounter?this._divCounter=0:this._divCounter++},e.prototype.phase1=function(){var e=!1;if(this._clkEnable){switch(this._audc>>>2){case 0:e=!!((2&this._pulseCounter?1:0)^1&this._pulseCounter)&&10!==this._pulseCounter&&!!(3&this._audc);break;case 1:e=!(8&this._pulseCounter);break;case 2:e=!this._noiseCounterBit4;break;case 3:e=!(2&this._pulseCounter||!(14&this._pulseCounter))}this._noiseCounter>>>=1,this._noiseFeedback&&(this._noiseCounter|=16),this._pulseCounterHold||(this._pulseCounter=7&~(this._pulseCounter>>>1),e&&(this._pulseCounter|=8))}return(1&this._pulseCounter)*this._audv},e.prototype.audc=function(e){this._audc=15&e},e.prototype.audf=function(e){this._audf=31&e},e.prototype.audv=function(e){this._audv=15&e},e}();i.default=r},{}],71:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){var i=this;this._paddle=t,this._uThresh=0,this._u=0,this._dumped=!1,this._value=.5,this._timestamp=0,this._cpuTimeProvider=null,this._uThresh=5*(1-Math.exp(-86640/e/1001800/68e-9)),this._paddle.valueChanged.addHandler(function(e){i._updateValue(),i._value=e}),this.reset()}return e.prototype.setCpuTimeProvider=function(e){this._cpuTimeProvider=e,this._timestamp=this._cpuTimeProvider()},e.prototype.reset=function(){this._u=0,this._value=this._paddle.getValue(),this._dumped=!1,this._timestamp=this._cpuTimeProvider?this._cpuTimeProvider():0},e.prototype.vblank=function(e){var t=this._dumped;128&e?(this._dumped=!0,this._u=0):t&&(this._dumped=!1,this._timestamp=this._cpuTimeProvider())},e.prototype.inpt=function(){return this._updateValue(),!this._dumped&&this._u>=this._uThresh?128:0},e.prototype._updateValue=function(){if(!this._dumped){var e=this._cpuTimeProvider();this._u=5*(1-(1-this._u/5)*Math.exp(-(e-this._timestamp)/(1e6*this._value+1800)/68e-9)),this._timestamp=e}},e}();i.default=r},{}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("./drawCounterDecodes"),r=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._divider=1,this._dividerPending=1,this._dividerChangeCounter=-1,this._sampleCounter=0,this._rendering=!1,this._renderCounter=-5,this._renderCounterTripPoint=0,this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this.reset()}return e.prototype.reset=function(){this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._rendering=!1,this._renderCounter=-5,this._decodes=s.decodesPlayer[0],this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this._sampleCounter=0,this._dividerPending=0,this._dividerChangeCounter=-1,this._setDivider(1)},e.prototype.grp=function(e){e!==this._patternNew&&(this._patternNew=e,this._delaying||(this._flushLineCache(),this._updatePattern()))},e.prototype.hmp=function(e){this._hmmClocks=e>>>4^8},e.prototype.nusiz=function(e,t){var i=7&e;switch(i){case 5:this._dividerPending=2;break;case 7:this._dividerPending=4;break;default:this._dividerPending=1}var r=this._decodes;if(this._decodes=s.decodesPlayer[i],this._decodes!==r&&this._rendering&&this._renderCounter- -5<2&&!this._decodes[(this._counter-this._renderCounter-5+159)%160]&&(this._rendering=!1),this._dividerPending!==this._divider)if(this._rendering){var n=this._renderCounter- -5;switch(this._divider<<4|this._dividerPending){case 18:case 20:t?n<4?this._setDivider(this._dividerPending):this._dividerChangeCounter=n<5?1:0:n<3?this._setDivider(this._dividerPending):this._dividerChangeCounter=1;break;case 33:case 65:n<(t?4:3)?this._setDivider(this._dividerPending):n<(t?6:5)?(this._setDivider(this._dividerPending),this._renderCounter--):this._dividerChangeCounter=t?0:1;break;case 66:case 36:this._renderCounter<1||t&&this._renderCounter%this._divider==1?this._setDivider(this._dividerPending):this._dividerChangeCounter=this._divider-(this._renderCounter-1)%this._divider;break;default:throw new Error("cannot happen")}}else this._setDivider(this._dividerPending)},e.prototype.resp=function(e){this._counter=e,this._rendering&&this._renderCounter- -5<4&&(this._renderCounter=e-157-5)},e.prototype.refp=function(e){var t=this._reflected;this._reflected=0<(8&e),this._reflected!==t&&(this._flushLineCache(),this._updatePattern())},e.prototype.vdelp=function(e){var t=this._delaying;this._delaying=0<(1&e),this._delaying!==t&&(this._flushLineCache(),this._updatePattern())},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(),this._moving},e.prototype.tick=function(){if(this.collision=this._rendering&&this._renderCounter>=this._renderCounterTripPoint&&this._pattern&1<<this._sampleCounter?0:this._collisionMask,this._decodes[this._counter])this._rendering=!0,this._renderCounter=-5,this._sampleCounter=0;else if(this._rendering){switch(this._renderCounter++,this._divider){case 1:0<this._renderCounter&&this._sampleCounter++,0<=this._renderCounter&&0<=this._dividerChangeCounter&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending);break;default:1<this._renderCounter&&(this._renderCounter-1)%this._divider==0&&this._sampleCounter++,0<this._renderCounter&&0<=this._dividerChangeCounter&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending)}7<this._sampleCounter&&(this._rendering=!1)}160<=++this._counter&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.shufflePatterns=function(){var e=this._patternOld;this._patternOld=this._patternNew,this._delaying&&e!==this._patternOld&&(this._flushLineCache(),this._updatePattern())},e.prototype.getRespClock=function(){switch(this._divider){case 1:return(this._counter-5+160)%160;case 2:return(this._counter-9+160)%160;case 4:return(this._counter-12+160)%160;default:throw new Error("cannot happen: invalid divider "+this._divider)}},e.prototype.setColor=function(e){e!==this.color&&this._pattern&&this._flushLineCache(),this.color=e},e.prototype._updatePattern=function(){this._pattern=this._delaying?this._patternOld:this._patternNew,this._reflected||(this._pattern=(1&this._pattern)<<7|(2&this._pattern)<<5|(4&this._pattern)<<3|(8&this._pattern)<<1|(16&this._pattern)>>>1|(32&this._pattern)>>>3|(64&this._pattern)>>>5|(128&this._pattern)>>>7)},e.prototype._setDivider=function(e){this._divider=e,this._renderCounterTripPoint=1===e?0:1},e}();i.default=r},{"./drawCounterDecodes":77}],73:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.collision=0,this._colorLeft=0,this._colorRight=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._pattern=0,this._refp=!1,this._reflected=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._x=0,this.reset()}return e.prototype.reset=function(){this._pattern=0,this._reflected=!1,this._refp=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._applyColors()},e.prototype.pf0=function(e){this._pf0!==e>>>4&&(this._flushLineCache(),this._pf0=e>>>4,this._pattern=1048560&this._pattern|this._pf0)},e.prototype.pf1=function(e){this._pf1!==e&&(this._flushLineCache(),this._pf1=e,this._pattern=1044495&this._pattern|(128&e)>>>3|(64&e)>>>1|(32&e)<<1|(16&e)<<3|(8&e)<<5|(4&e)<<7|(2&e)<<9|(1&e)<<11)},e.prototype.pf2=function(e){this._pf2!==e&&(this._flushLineCache(),this._pf2=e,this._pattern=4095&this._pattern|(255&e)<<12)},e.prototype.ctrlpf=function(e){var t=0<(1&e),i=2==(6&e)?1:0;t===this._reflected&&i===this._colorMode||(this._flushLineCache(),this._reflected=t,this._colorMode=i,this._applyColors())},e.prototype.setColor=function(e){e!==this._color&&0===this._colorMode&&this._flushLineCache(),this._color=e,this._applyColors()},e.prototype.setColorP0=function(e){e!==this._colorP0&&1===this._colorMode&&this._flushLineCache(),this._colorP0=e,this._applyColors()},e.prototype.setColorP1=function(e){e!==this._colorP1&&1===this._colorMode&&this._flushLineCache(),this._colorP1=e,this._applyColors()},e.prototype.tick=function(e){var t;(80!==(this._x=e)&&0!==e||(this._refp=this._reflected),3&e)||(t=0===this._pattern?0:e<80?this._pattern&1<<(e>>>2):this._refp?this._pattern&1<<39-(e>>>2):this._pattern&1<<(e>>>2)-20,this.collision=t?0:this._collisionMask)},e.prototype.getPixel=function(e){return this.collision?e:this._x<80?this._colorLeft:this._colorRight},e.prototype._applyColors=function(){switch(this._colorMode){case 0:this._colorLeft=this._colorRight=this._color;break;case 1:this._colorLeft=this._colorP0,this._colorRight=this._colorP1}},e}();i.default=r},{}],74:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,c=e("microevent.ts"),h=e("./WaveformAudio"),l=e("./PCMAudio"),f=e("./Missile"),_=e("./Playfield"),d=e("./Player"),p=e("./Ball"),g=e("./LatchedInput"),b=e("./PaddleReader"),m=e("./FrameManager"),y=e("./DelayQueue"),n=e("./palette"),s=function(){function u(e,t,i,r){var n=this;this._config=e,this.newFrame=new c.Event,this.trap=new c.Event,this._cpu=null,this._bus=null,this._delayQueue=new y.default(10,20),this._hstate=0,this._hctr=0,this._collisionUpdateRequired=!1,this._movementClock=0,this._movementInProgress=!1,this._extendedHblank=!1,this._xDelta=0,this._linesSinceChange=0,this._maxLinesTotal=0,this._colorBk=4278190080,this._priority=0,this._collisionMask=0,this._player0=new d.default(31744,function(){return n._flushLineCache()}),this._player1=new d.default(17344,function(){return n._flushLineCache()}),this._missile0=new f.default(8760,function(){return n._flushLineCache()}),this._missile1=new f.default(4390,function(){return n._flushLineCache()}),this._playfield=new _.default(1099,function(){return n._flushLineCache()}),this._ball=new p.default(2197,function(){return n._flushLineCache()}),this._waveformAudio=new Array(2),this._pcmAudio=null,this._audio=new Array(2),this._frameManager=new m.default(this._config),this._frameManager.newFrame.addHandler(u._onNewFrame,this),this._palette=this._getPalette(this._config),this._input0=new g.default(t.getFire()),this._input1=new g.default(i.getFire()),this._pcmAudio=new l.default(this._config);for(var s=this._pcmAudio.getChannels(),a=0;a<2;a++)this._waveformAudio[a]=new h.default(this._config),this._audio[a]=this._config.pcmAudio?s[a]:this._waveformAudio[a];var o=this._getClockFreq(this._config);this._paddles=new Array(4);for(a=0;a<4;a++)this._paddles[a]=new b.default(o,r[a]);this.reset()}return u.prototype.reset=function(){this._hctr=0,this._movementInProgress=!1,this._extendedHblank=!1,this._movementClock=0,this._priority=0,this._hstate=0,this._collisionMask=0,this._colorBk=4278190080,this._linesSinceChange=0,this._collisionUpdateRequired=!1,this._maxLinesTotal=0,this._xDelta=0,this._delayQueue.reset(),this._frameManager.reset(),this._missile0.reset(),this._missile1.reset(),this._player0.reset(),this._player1.reset(),this._playfield.reset(),this._ball.reset(),this._audio[0].reset(),this._audio[1].reset(),this._input0.reset(),this._input1.reset();for(var e=0;e<4;e++)this._paddles[e].reset();this._cpu&&this._cpu.resume()},u.prototype.setCpu=function(e){return this._cpu=e,this},u.prototype.setCpuTimeProvider=function(e){for(var t=0;t<4;t++)this._paddles[t].setCpuTimeProvider(e);return this},u.prototype.getWidth=function(){return 160},u.prototype.getHeight=function(){return this._frameManager.getHeight()},u.prototype.setSurfaceFactory=function(e){return this._frameManager.setSurfaceFactory(e),this},u.prototype.getWaveformChannel=function(e){return this._waveformAudio[e]},u.prototype.getPCMChannel=function(){return this._pcmAudio},u.prototype.setAudioEnabled=function(e){this._audio[0].setActive(e&&this._config.enableAudio),this._audio[1].setActive(e&&this._config.enableAudio)},u.prototype.read=function(e){var t,i=this._bus.getLastDataBusValue();switch(15&e){case 8:t=this._config.emulatePaddles?this._paddles[0].inpt():0;break;case 9:t=this._config.emulatePaddles?this._paddles[1].inpt():0;break;case 10:t=this._config.emulatePaddles?this._paddles[2].inpt():0;break;case 11:t=this._config.emulatePaddles?this._paddles[3].inpt():0;break;case 12:t=this._input0.inpt();break;case 13:t=this._input1.inpt();break;case 0:t=(8192&this._collisionMask?64:0)|(512&this._collisionMask?128:0);break;case 1:t=(256&this._collisionMask?64:0)|(4096&this._collisionMask?128:0);break;case 2:t=(2048&this._collisionMask?64:0)|(1024&this._collisionMask?128:0);break;case 3:t=(128&this._collisionMask?64:0)|(64&this._collisionMask?128:0);break;case 4:t=(16&this._collisionMask?64:0)|(8&this._collisionMask?128:0);break;case 5:t=(4&this._collisionMask?64:0)|(2&this._collisionMask?128:0);break;case 7:t=(32&this._collisionMask?64:0)|(16384&this._collisionMask?128:0);break;case 6:t=1&this._collisionMask?128:0;break;default:t=0}return 192&t|63&i},u.prototype.peek=function(e){return this.read(e)},u.prototype.write=function(e,t){var i=0;switch(63&e){case 2:this._cpu.halt();break;case 3:this._flushLineCache(),this._rsync();break;case 0:this._frameManager.setVsync(0<(2&t));break;case 1:this._input0.vblank(t),this._input1.vblank(t);for(var r=0;r<4;r++)this._paddles[r].vblank(t);this._delayQueue.push(1,t,1);break;case 29:this._delayQueue.push(29,t,1);break;case 30:this._delayQueue.push(30,t,1);break;case 34:this._delayQueue.push(34,t,2);break;case 35:this._delayQueue.push(35,t,2);break;case 18:this._flushLineCache(),this._missile0.resm(this._resxCounter(),0===this._hstate);break;case 19:this._flushLineCache(),this._missile1.resm(this._resxCounter(),0===this._hstate);break;case 40:this._missile0.resmp(t,this._player0);break;case 41:this._missile1.resmp(t,this._player1);break;case 43:this._delayQueue.push(43,t,2);break;case 4:this._flushLineCache(),this._missile0.nusiz(t),this._player0.nusiz(t,0===this._hstate);break;case 5:this._flushLineCache(),this._missile1.nusiz(t),this._player1.nusiz(t,0===this._hstate);break;case 42:this._delayQueue.push(42,t,6);break;case 9:this._flushLineCache(),this._colorBk=this._palette[(255&t)>>>1];break;case 6:i=this._palette[(255&t)>>>1],this._missile0.setColor(i),this._player0.setColor(i),this._playfield.setColorP0(i);break;case 7:i=this._palette[(255&t)>>>1],this._missile1.setColor(i),this._player1.setColor(i),this._playfield.setColorP1(i);break;case 13:this._delayQueue.push(13,t,2);break;case 14:this._delayQueue.push(14,t,2);break;case 15:this._delayQueue.push(15,t,2);break;case 10:this._setPriority(t),this._playfield.ctrlpf(t),this._ball.ctrlpf(t);break;case 8:this._flushLineCache(),i=this._palette[(255&t)>>>1],this._playfield.setColor(i),this._ball.color=i;break;case 27:this._delayQueue.push(27,t,1).push(241,0,1);break;case 28:this._delayQueue.push(28,t,1).push(240,0,1).push(242,0,1);break;case 16:this._flushLineCache(),this._player0.resp(this._resxCounter());break;case 17:this._flushLineCache(),this._player1.resp(this._resxCounter());break;case 11:this._delayQueue.push(11,t,1);break;case 12:this._delayQueue.push(12,t,1);break;case 32:this._delayQueue.push(32,t,2);break;case 33:this._delayQueue.push(33,t,2);break;case 37:this._player0.vdelp(t);break;case 38:this._player1.vdelp(t);break;case 31:this._delayQueue.push(31,t,1);break;case 36:this._delayQueue.push(36,t,2);break;case 20:this._flushLineCache(),this._ball.resbl(this._resxCounter());break;case 39:this._ball.vdelbl(t);break;case 44:this._flushLineCache(),this._collisionMask=0;break;case 21:this._audio[0].audc(t);break;case 22:this._audio[1].audc(t);break;case 23:this._audio[0].audf(t);break;case 24:this._audio[1].audf(t);break;case 25:this._audio[0].audv(t);break;case 26:this._audio[1].audv(t)}},u.prototype.getDebugState=function(){return"hclock: "+this._hctr+"   line: "+this._frameManager.getCurrentLine()+"\n"+this._frameManager.getDebugState()},u.prototype.setBus=function(e){return this._bus=e,this},u.prototype.cycle=function(){this._delayQueue.execute(u._delayedWrite,this),this._collisionUpdateRequired=!1,this._linesSinceChange<2?(this._tickMovement(),0===this._hstate?this._tickHblank():this._tickHframe(),this._collisionUpdateRequired&&!this._frameManager.vblank&&this._updateCollision()):0===this._hctr&&this._cpu.resume(),228<=++this._hctr&&this._nextLine(),this._config.pcmAudio&&this._pcmAudio.tick()},u._delayedWrite=function(e,t,i){switch(e){case 1:i._flushLineCache(),i._frameManager.setVblank(0<(2&t));break;case 42:i._flushLineCache(),i._movementClock=0,i._movementInProgress=!0,i._extendedHblank||(i._clearHmoveComb(),i._extendedHblank=!0),i._missile0.startMovement(),i._missile1.startMovement(),i._player0.startMovement(),i._player1.startMovement(),i._ball.startMovement();break;case 13:i._playfield.pf0(t);break;case 14:i._playfield.pf1(t);break;case 15:i._playfield.pf2(t);break;case 27:i._player0.grp(t);break;case 28:i._player1.grp(t);break;case 240:i._player0.shufflePatterns();break;case 241:i._player1.shufflePatterns();break;case 32:i._player0.hmp(t);break;case 33:i._player1.hmp(t);break;case 34:i._missile0.hmm(t);break;case 35:i._missile1.hmm(t);break;case 36:i._ball.hmbl(t);break;case 43:i._missile0.hmm(0),i._missile1.hmm(0),i._player0.hmp(0),i._player1.hmp(0),i._ball.hmbl(0);break;case 11:i._player0.refp(t);break;case 12:i._player1.refp(t);break;case 242:i._ball.shuffleStatus();break;case 31:i._ball.enabl(t);break;case 29:i._missile0.enam(t);break;case 30:i._missile1.enam(t)}},u._onNewFrame=function(e,t){var i=t._frameManager.getCurrentLine();if(i>t._maxLinesTotal&&(t._maxLinesTotal=i),i<t._maxLinesTotal)for(var r=e.getBuffer(),n=160*i,s=160*t._maxLinesTotal,a=n;a<s;a++)r[a]=4278190080;t.newFrame.dispatch(e)},u.prototype._tickMovement=function(){if(this._movementInProgress&&0==(3&this._hctr)){var e=0===this._hstate,t=!1,i=15<this._movementClock?0:this._movementClock;t=this._missile0.movementTick(i,e)||t,t=this._missile1.movementTick(i,e)||t,t=this._player0.movementTick(i,e)||t,t=this._player1.movementTick(i,e)||t,t=this._ball.movementTick(i,e)||t,this._movementInProgress=t,this._collisionUpdateRequired=t,this._movementClock++}},u.prototype._tickHblank=function(){switch(this._hctr){case 0:this._extendedHblank=!1,this._cpu.resume();break;case 67:this._extendedHblank||(this._hstate=1);break;case 75:this._extendedHblank&&(this._hstate=1)}this._extendedHblank&&67<this._hctr&&this._playfield.tick(this._hctr-68+this._xDelta)},u.prototype._tickHframe=function(){var e=this._frameManager.getCurrentLine(),t=this._hctr-68+this._xDelta;this._collisionUpdateRequired=!0,this._playfield.tick(t),this._tickSprites(),this._frameManager.isRendering()&&this._renderPixel(t,e)},u.prototype._tickSprites=function(){this._missile0.tick(!0),this._missile1.tick(!0),this._player0.tick(),this._player1.tick(),this._ball.tick(!0)},u.prototype._nextLine=function(){2<=this._linesSinceChange&&this._cloneLastLine(),this._hctr=0,this._playfield.tick(0),this._movementInProgress||this._linesSinceChange++,this._hstate=0,this._xDelta=0,this._frameManager.nextLine(),this._frameManager.isRendering()&&0===this._frameManager.getCurrentLine()&&this._flushLineCache()},u.prototype._cloneLastLine=function(){var e=this._frameManager.getCurrentLine();if(this._frameManager.isRendering()&&0!==e)for(var t=160*e,i=160*(e-1),r=0;r<160;r++)this._frameManager.surfaceBuffer[t+r]=this._frameManager.surfaceBuffer[i+r]},u.prototype._getPalette=function(e){switch(e.tvMode){case 0:return n.NTSC;case 1:return n.PAL;case 2:return n.SECAM;default:throw new Error("invalid TV mode")}},u.prototype._getClockFreq=function(e){return 0===e.tvMode?3584160:3556800},u.prototype._renderPixel=function(e,t){if(this._frameManager.vblank)this._frameManager.surfaceBuffer[160*t+e]=4278190080;else{var i=this._colorBk;switch(this._priority){case 0:i=this._playfield.getPixel(i),i=this._ball.getPixel(i),i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i);break;case 1:i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i),i=this._playfield.getPixel(i),i=this._ball.getPixel(i);break;case 2:i=this._ball.getPixel(i),i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._playfield.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i);break;default:throw new Error("invalid priority")}this._frameManager.surfaceBuffer[160*t+e]=i}},u.prototype._updateCollision=function(){this._collisionMask|=~this._player0.collision&~this._player1.collision&~this._missile0.collision&~this._missile1.collision&~this._ball.collision&~this._playfield.collision},u.prototype._clearHmoveComb=function(){if(this._frameManager.isRendering()&&0===this._hstate)for(var e=160*this._frameManager.getCurrentLine(),t=0;t<8;t++)this._frameManager.surfaceBuffer[e+t]=4278190080},u.prototype._resxCounter=function(){return 0===this._hstate?73<=this._hctr?158:159:157},u.prototype._rsync=function(){var e=68<this._hctr?this._hctr-68:0;if(this._xDelta=157-e,this._frameManager.isRendering())for(var t=this._frameManager.getCurrentLine(),i=160*t+e,r=i+160*(t+1),n=i;n<r;n++)this._frameManager.surfaceBuffer[n]=4278190080;this._hctr=225},u.prototype._setPriority=function(e){var t=4&e?1:2&e?2:0;t!==this._priority&&(this._flushLineCache(),this._priority=t)},u.prototype._flushLineCache=function(){var e=2<=this._linesSinceChange;if(this._linesSinceChange=0,e){var t=this._hctr;for(this._hctr=0;this._hctr<t;this._hctr++)0===this._hstate?this._tickHblank():this._tickHframe()}},u}();i.default=s,r=function(e,t,i){this.reason=e,this.tia=t,this.message=i},(s||(s={})).TrapPayload=r,i.default=s},{"./Ball":64,"./DelayQueue":65,"./FrameManager":66,"./LatchedInput":67,"./Missile":68,"./PCMAudio":69,"./PaddleReader":71,"./Player":72,"./Playfield":73,"./WaveformAudio":76,"./palette":78,"microevent.ts":6}],75:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var f=e("../Config"),_=e("../../../tools/AudioOutputBuffer"),r=e("../../../tools/base64"),d=r.decode("AQEPAQEBAQEBAQEBAwMDAQ=="),n=new Int8Array([1]),s=new Int8Array([1,1]),a=new Int8Array([16,15]),o=r.decode("AQICAQEBBAM="),u=r.decode("AQIBAQICBQQCAQMBAQEBBA=="),c=r.decode("AQQBAwIEAQIDAgEBAQEBAQIEAgEEAQECAgEDAgEDAQEBBAEBAQECAQECBgECAgECAQIBAQIBBgIBAgIBAQEBAgICAgcCAwICAQEBAwIBAQIBAQcBAQMBAQIDAwEBAQICAQECAgQDBQEDAQEFAgEBAQIBAgEDAQIFAQECAQEBBQEBAQEBAQEBBgEBAQIBAQEBBAIBAQMBAwYDAgMBAQIBAgQBAQEDAQEBAQMBAgEEAgIDBAEBBAECAQICAgEBBAMBBAQJBQQBBQMBAQMCAgIBBQECAQEBAgMBAgEBAwQCBQICAQIDAQEBAQECAQMDAwIBAgEBAQEBAwMBAgIDAQMBCA=="),h=r.decode("BQYEBQoFAwcECgYDBgQJBg=="),p=[n,o,o,r.decode("AgMCAQQBBgoCBAIBAQQFCQMDBAEBAQgFBQUEAQEBCAQCCAMDAQEHBAIHBQEDAQcEAQQIAgEDBAcBAwcDAgEGBgICBAUDAgYGAQMDAgUDBwMEAwICAgUJAwEFAwECAgsFAQUDAQECDAUBAgUCAQEMBgECBQECAQoGAwICBAECBgo="),s,s,a,u,c,u,a,n,s,s,a,h],l=function(){function e(e){this._config=e}return e.prototype.setConfig=function(e){this._config=e},e.prototype.getKey=function(e,t){return p[e]===s&&d[e]*(t+1)==1?0:e<<5|t},e.prototype.getBuffer=function(e){for(var t=e>>>5&15,i=31&e,r=p[t],n=0,s=0;s<r.length;s++)n+=r[s];n=n*d[t]*(i+1);var a=new Float32Array(n),o=f.default.getClockHz(this._config)/114,u=0,c=0,h=0,l=!0;for(s=0;s<n;s++)++u===d[t]*(i+1)&&(u=0,++c===r[h]&&(h++,c=0,r.length===h&&(h=0)),l=!(1&h)),a[s]=l?1:-1;return new _.default(a,o)},e}();i.default=l},{"../../../tools/AudioOutputBuffer":79,"../../../tools/base64":81,"../Config":32}],76:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./ToneGenerator"),s=function(){function e(e){this._config=e,this.bufferChanged=new r.Event,this.volumeChanged=new r.Event,this.stop=new r.Event,this._volume=-1,this._tone=-1,this._frequency=-1,this._active=!1,this._toneGenerator=null,this._toneGenerator=new n.default(this._config),this.reset()}return e.prototype.reset=function(){this._volume=-1,this._tone=-1,this._frequency=-1},e.prototype.audc=function(e){(e&=15)!==this._tone&&(this._tone=e,this._dispatchBufferChanged())},e.prototype.audf=function(e){(e&=31)!==this._frequency&&(this._frequency=e,this._dispatchBufferChanged())},e.prototype.audv=function(e){(e&=15)!==this._volume&&(this._volume=e/15,this.volumeChanged.dispatch(this._volume))},e.prototype.setActive=function(e){(this._active=e)?this._dispatchBufferChanged():this.stop.dispatch(void 0)},e.prototype.getVolume=function(){return 0<=this._volume?this._volume:0},e.prototype.getBuffer=function(e){return this._toneGenerator.getBuffer(e)},e.prototype._getKey=function(){return this._toneGenerator.getKey(this._tone,this._frequency)},e.prototype._dispatchBufferChanged=function(){this._active&&this.bufferChanged.hasHandlers&&this.bufferChanged.dispatch(this._getKey())},e}();i.default=s},{"./ToneGenerator":75,"microevent.ts":6}],77:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=new Uint8Array(160),n=new Uint8Array(160),s=new Uint8Array(160),a=new Uint8Array(160),o=new Uint8Array(160),u=new Uint8Array(160);i.decodesMissile=[r,n,s,a,o,r,u,r],i.decodesPlayer=[r,n,s,a,o,r,u,r],[r,n,s,a,o,u].forEach(function(e){for(var t=0;t<160;t++)e[t]=0;e[156]=1}),n[12]=1,s[28]=1,a[12]=a[28]=1,o[60]=1,u[28]=u[60]=1},{}],78:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NTSC=new Uint32Array([4278190080,4283058762,4285493103,4287532686,4289374890,4290822336,4292269782,4293717228,4278208584,4279200105,4280125062,4280984226,4281711547,4282438354,4283099368,4283759868,4278201468,4279322768,4280378018,4281367220,4282224835,4283081938,4283807711,4284532972,4278197392,4279581091,4280832949,4282019014,4283073237,4284061667,4284984048,4285840636,4278190228,4279900839,4281479864,4282927304,4284243158,4285493220,4286611696,4287664380,4284743812,4286192023,4287574184,4288825016,4289944006,4290997460,4291984608,4292906220,4286840912,4288289128,4289540221,4290791058,4291844516,4292897973,4293819589,4294741204,4287627284,4288879155,4290064974,4291184744,4292172927,4293095317,4293951657,4294742204,4287889408,4289141272,4290261549,4291315778,4292238420,4293160805,4293951605,4294742148,4287110144,4288494360,4289746733,4290933314,4291988052,4292976741,4293899637,4294756484,4284755968,4286599192,4288179501,4289759298,4291141716,4292458341,4293643381,4294762628,4281352192,4283327e3,4285104429,4286750274,4288264276,4289646949,4290963317,4292148356,4278207488,4279920154,4281500722,4282949704,4284267100,4285518447,4286638208,4287691920,4278205460,4279787317,4281171538,4282555502,4283742087,4284862622,4285917108,4286905544,4278204464,4279654736,4281038445,4282290824,4283411360,4284465847,4285454540,4286377184,4278201416,4279520617,4280707718,4281894562,4282884027,4283872978,4284730600,4285587708]),i.PAL=new Uint32Array([4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278212736,4279923094,4281501611,4282948798,4284264399,4285513951,4286632430,4287684860,4278213700,4279925086,4281504630,4282952844,4284269216,4285519795,4286638788,4287691988,4278203504,4279914889,4281494432,4282942646,4284259017,4285509596,4286628588,4287681788,4279526400,4281696282,4283602994,4285444168,4287087964,4288600431,4290046848,4291361936,4279500912,4281670281,4283576992,4285417654,4287061193,4288573404,4290019564,4291334396,4284242944,4285953562,4287532594,4288980040,4290295900,4291545967,4292664448,4293717136,4284219504,4285799044,4287181462,4288563368,4289748151,4290867142,4291920083,4292907232,4285545472,4287191577,4288705839,4290154052,4291405143,4292655720,4293709433,4294762632,4285530200,4287175278,4288688771,4290136214,4291386535,4292636599,4293689542,4294742228,4285538304,4287184665,4288698927,4290147396,4291398487,4292649320,4293703033,4294756488,4286578740,4288027210,4289409631,4290660466,4291779715,4292833171,4293820578,4294742192,4287102976,4288485914,4289737266,4290922568,4291976284,4292964207,4293886080,4294742160,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228]),i.SECAM=new Uint32Array([4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295])},{}],79:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._content=e,this._sampleRate=t}return e.prototype.getLength=function(){return this._content.length},e.prototype.getContent=function(){return this._content},e.prototype.getSampleRate=function(){return this._sampleRate},e.prototype.replaceUnderlyingBuffer=function(e){this._content=e},e}();i.default=r},{}],80:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e){this._scheduler=e,this.frequencyUpdate=new r.Event,this._counter=0,this._frequency=0}return e.prototype.attach=function(e){return this._clock&&this.detach(),(this._clock=e).addHandler(this._clockHandler,this),this},e.prototype.start=function(){return this._measurementTask||(this._timestamp=Date.now(),this._counter=0,this._measurementTask=this._scheduler.start(this._updateMeasurement,this)),this},e.prototype.detach=function(){return this._clock&&(this._clock.removeHandler(this._clockHandler,this),this._clock=void 0),this},e.prototype.stop=function(){return this._measurementTask&&(this._measurementTask.stop(),this._measurementTask=void 0),this},e.prototype.getFrequency=function(){return this._frequency},e.prototype._updateMeasurement=function(e){var t=Date.now();e._frequency=e._counter/(t-e._timestamp)*1e3,e._counter=0,e._timestamp=t,e.frequencyUpdate.dispatch(e._frequency)},e.prototype._clockHandler=function(e,t){t._counter+=e},e}();i.default=n},{"microevent.ts":6}],81:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=new Uint8Array(256);function h(e,t){var i=r[e.charCodeAt(t)];if(63<i)throw new Error('invalid base64 character "'+e[t]+'" at index '+t);return i}!function(e){var t;for(t=0;t<256;t++)r[t]=255;for(t=0;t<64;t++)r["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;r["=".charCodeAt(0)]=0}(i.__init||(i.__init={})),i.decode=function(e){if(e.length%4!=0)throw new Error("invalid base64 data --- char count mismatch");for(var t,i,r=e.length/4,n=3*r-function(e){for(var t=0,i=e.length-1;0<=i&&"="===e[i--];)t++;return t}(e),s=new Uint8Array(n),a=0,o=0;o<r;o++)for(var u=(h(t=e,i=4*o)<<18)+(h(t,i+1)<<12)+(h(t,i+2)<<6)+h(t,i+3),c=0;c<3&&a<n;c++)s[a++]=u>>>8*(2-c)&255;return s}},{}],82:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.encode=function(e,t,i){return void 0===i&&(i=!0),function e(t,i,r,n){if(void 0===r&&(r=!0),void 0===n&&(n=""),!r&&t<0)return e(t>>>16,i&&8<i?i-4:4,!1,n)+e(65535&t,4);var s=Math.abs(t).toString(16).toUpperCase();if(void 0!==i)for(;s.length<i;)s="0"+s;return(t<0?"-":"")+n+s}(e,t,i,"$")},i.decode=function(e){var t=e.match(/^-/)?-1:1,i=e.replace(/^-/,"").toUpperCase();if(i.match(/^0X[0-9A-F]+$/))i=i.replace(/^0x/,"");else{if(!i.match(/^\$[0-9A-F]+$/))throw new TypeError("invalid hex number "+e);i=i.replace(/^\$/,"")}return t*parseInt(i,16)}},{}],83:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t,i){this._value=e,this._mapper=t,this._adopter=i}return e.prototype.adopt=function(e){this._adopter(this._value,e)},e.prototype.get=function(){return this._mapper(this._value.get())},e.prototype.release=function(){this._value.release()},e.prototype.dispose=function(){this._value.dispose()},e}();i.default=r},{}],84:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./InducedMember"),n=function(){function e(e,t){void 0===t&&(t=function(){throw new Error("adopt is not supported")}),this._mapper=e,this._adopter=t,this._map=new WeakMap}return e.prototype.get=function(e){return this._map.has(e)||this._map.set(e,new r.default(e,this._mapper,this._adopter)),this._map.get(e)},e}();i.default=n},{"./InducedMember":83}],85:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./PoolMember"),s=function(){function e(e){this._factory=e,this.event={release:new r.Event,dispose:new r.Event},this._pool=[],this._poolSize=0}return e.prototype.get=function(){var e,t=this;if(0===this._poolSize){var i=this._factory();e=new n.default(i,function(e){return t._releaseMember(e)},function(e){return t._disposeMember(e)})}else(e=this._pool[--this._poolSize])._isAvailable=!1;return e},e.prototype._releaseMember=function(e){if(e._isAvailable)throw new Error("Trying to release an already released pool member");if(e._isDisposed)throw new Error("Trying to release an already disposed pool member");var t=this._poolSize++;(this._pool[t]=e)._isAvailable=!0,e._poolPosition=t,this.event.release.dispatch(e.get())},e.prototype._disposeMember=function(e){if(e._isDisposed)throw new Error("Trying to dispose of an already disposed pool member");e._isAvailable&&(1<this._poolSize&&(this._pool[e._poolPosition]=this._pool[this._poolSize-1]),this._poolSize--),e._isDisposed=!0,this.event.dispose.dispatch(e.get())},e}();i.default=s},{"./PoolMember":86,"microevent.ts":6}],86:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t,i){this._value=e,this._releaseCB=t,this._disposeCB=i,this._isAvailable=!1,this._isDisposed=!1}return e.prototype.adopt=function(e){this._value=e},e.prototype.get=function(){return this._value},e.prototype.release=function(){this._releaseCB(this)},e.prototype.dispose=function(){this._disposeCB(this)},e}();i.default=r},{}],87:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._rng=e}return e.prototype.single=function(){return this._rng.quick()},e.prototype.double=function(){return this._rng.double()},e.prototype.int32=function(){return this._rng.int32()},e.prototype.int=function(e){return(this._rng.int32()>>>0)%(e+1)},e.prototype.saveState=function(){return this._rng.state()},e}();i.default=r},{}],88:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("seedrandom"),n=e("./SeedrandomGenerator");i.createRng=function(e){return e<0&&(e=Math.random()),new n.default(r.alea(e,{state:!0}))},i.restoreRng=function(e){return new n.default(r.alea("",{state:e}))}},{"./SeedrandomGenerator":87,seedrandom:9}],89:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./PeriodicScheduler"),n=e("./ImmedateScheduler"),s=e("./limiting/BusyWait"),a=e("./limiting/ConstantCycles"),o=e("./limiting/ConstantTimeslice"),u=function(){function e(){}return e.prototype.createPeriodicScheduler=function(e){return new r.default(e)},e.prototype.createImmediateScheduler=function(){return new n.default},e.prototype.createLimitingScheduler=function(e){switch(void 0===e&&(e=1),e){case 0:return new s.default;case 1:return new a.default;case 2:return new o.default;default:throw new Error("invalud limiting scheduling strategy")}},e.prototype.getLimitingSchedulingStrategies=function(){return[0,1,2]},e.prototype.describeLimitingSchedulingStrategy=function(e){switch(e){case 0:return"Busy wait, constant timeslice length";case 1:return"Constant cycle count";case 2:return"Constant timeslice length";default:throw new Error("invalid limiting scheduling strategy")}},e}();i.default=u},{"./ImmedateScheduler":90,"./PeriodicScheduler":91,"./limiting/BusyWait":93,"./limiting/ConstantCycles":94,"./limiting/ConstantTimeslice":95}],90:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./setImmediate"),r=function(){function e(){}return e.prototype.start=function(t,i){var r=!1;return n.setImmediate(function e(){r||(t(i),n.setImmediate(e))}),{stop:function(){return r=!0}}},e}();i.default=r},{"./setImmediate":96}],91:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._period=e}return e.prototype.setPeriod=function(e){return this._period=e,this},e.prototype.getPeriod=function(){return this._period},e.prototype.start=function(e,t){var i=this,r=!1,n=function(){r||(e(t),setTimeout(n,i._period))};return setTimeout(n,this._period),{stop:function(){return r=!0}}},e}();i.default=r},{}],92:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=self.performance&&self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};i.default=r},{}],93:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=e("../getTimestamp"),c=e("../setImmediate"),r=function(){function e(){}return e.prototype.start=function(n,s,e){var a=e||50,o=!0;return c.setImmediate(function e(){if(o){for(var t=u.default(),i=0,r=0;u.default()-t<a;){for(;(r=u.default()-t-i)<1;);i+=n(s,r)}0<(r=u.default()-t-i)&&(i+=n(s,r)),o&&c.setImmediate(e)}}),{stop:function(){return o=!1}}},e}();i.default=r},{"../getTimestamp":92,"../setImmediate":96}],94:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=e("../getTimestamp"),h=e("../setImmediate"),r=function(){function e(){}return e.prototype.start=function(r,n){var s=!1,a=-1,o=0,u=0;return h.setImmediate(function e(){if(!s){var t=c.default(),i=(r(n)||0)-c.default()+t;0<=a&&(u+=a-t+o),100<u?u=100:u<-100&&(u=-100),3<Math.abs(u)&&(i+=u,u=0),i<0&&(u=i=0),0<i?setTimeout(e,Math.round(i)):h.setImmediate(e),a=i,o=c.default()}}),{stop:function(){return s=!0}}},e}();i.default=r},{"../getTimestamp":92,"../setImmediate":96}],95:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var h=e("../getTimestamp"),l=e("../setImmediate"),r=function(){function e(){}return e.prototype.start=function(n,s,e){var a=e||100,o=h.default(),u=0,c=!0;return l.setImmediate(function e(){if(c){var t=h.default(),i=t-o-u;3*a<i&&(o=t-(i=3*a),u=0),u+=n(s,i);var r=a-h.default()+t;0<r?setTimeout(e,r):l.setImmediate(e)}}),{stop:function(){return c=!1}}},e}();i.default=r},{"../getTimestamp":92,"../setImmediate":96}],96:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("setimmediate2"),n=0;i.setImmediate=function(e){0===n?setTimeout(e,0):r.setImmediate(e),n=(n+1)%10}},{setimmediate2:17}],97:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(){this.emit=new r.Event,this._framesOnHold=new Array(2),this._nFramesOnHold=0,this._width=0,this._height=0}return e.prototype.init=function(e,t){this.flush(),this._width=e,this._height=t},e.prototype.flush=function(){for(var e=0;e<this._nFramesOnHold;e++)this._framesOnHold[e].release(),this._framesOnHold[e]=null;this._nFramesOnHold=0},e.prototype.processSurface=function(e){var t=e.get();if(t.getHeight()!==this._height||t.getWidth()!==this._width)throw new Error("surface dimensions do not match");this._framesOnHold[this._nFramesOnHold++]=e,2===this._nFramesOnHold&&this._process()},e.prototype._process=function(){for(var e=this._framesOnHold[0].get().getBuffer(),t=this._framesOnHold[1].get().getBuffer(),i=0;i<this._width*this._height;i++)e[i]=4278190080|(16711680&e[i])+(16711680&t[i])>>>1&16711680|(65280&e[i])+(65280&t[i])>>>1&65280|(255&e[i])+(255&t[i])>>>1&255;this.emit.dispatch(this._framesOnHold[0]),this._framesOnHold[1].release(),this._nFramesOnHold=0},e}();i.default=n},{"microevent.ts":6}],98:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(){this.emit=new r.Event}return e.prototype.init=function(){},e.prototype.flush=function(){},e.prototype.processSurface=function(e){this.emit.dispatch(e)},e}();i.default=n},{"microevent.ts":6}],99:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./PassthroughProcessor"),n=e("./FrameMergeProcessor"),s=function(){function e(){}return e.prototype.create=function(e){switch(e.type){case 0:return new r.default;case 1:return new n.default;default:throw new Error("cannot happen: invalid processor type")}},e}();i.default=s},{"./FrameMergeProcessor":97,"./PassthroughProcessor":98}],100:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./ProcessorFactory"),r=function(){function e(e){var i=this;e&&0!==e.length||(e=[{type:0}]);var t=new a.default;this._processors=e.map(function(e){return t.create(e)});for(var r=function(t){n._processors[t-1].emit.addHandler(function(e){return i._processors[t].processSurface(e)})},n=this,s=1;s<this._processors.length;s++)r(s);this.emit=this._processors[this._processors.length-1].emit}return e.prototype.init=function(t,i){this._processors.forEach(function(e){return e.init(t,i)})},e.prototype.flush=function(){this._processors.forEach(function(e){return e.flush()})},e.prototype.processSurface=function(e){this._processors[0].processSurface(e)},e}();i.default=r},{"./ProcessorFactory":99}],101:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("worker-rpc"),s=e("microevent.ts"),a=e("./messages"),r=function(){function r(e){this._rpc=e,this.emit=new s.Event,this._nextId=0,this._surfaces=new Map,this._rpc.registerSignalHandler(a.messageIds.emit,this._onMessageEmit.bind(this)).registerSignalHandler(a.messageIds.release,this._onMessageRelease.bind(this))}return r.spawn=function(e){void 0===e&&(e="video-pipeline.js");var i=new Worker(e),t=new n.RpcProvider(function(e,t){return i.postMessage(e,t)});return i.onmessage=function(e){return t.dispatch(e.data)},new r(t)},r.prototype.configure=function(e,t,i){return this._rpc.rpc(a.messageIds.configure,{width:e,height:t,config:i})},r.prototype.flush=function(){return this._rpc.rpc(a.messageIds.flush)},r.prototype.processSurface=function(e){var t=this._nextId++,i=e.get(),r=i.getUnderlyingBuffer();this._surfaces.set(t,e),this._rpc.signal(a.messageIds.process,{id:t,width:i.getWidth(),height:i.getHeight(),buffer:r},[r])},r.prototype._onMessageEmit=function(e){if(!this._surfaces.has(e.id))throw new Error("no surface with id "+e.id);var t=this._surfaces.get(e.id),i=t.get();this._surfaces.delete(e.id),i.replaceUnderlyingBuffer(i.getWidth(),i.getHeight(),e.buffer),this.emit.dispatch(t)},r.prototype._onMessageRelease=function(e){if(!this._surfaces.has(e.id))throw new Error("no surface with id "+e.id);var t=this._surfaces.get(e.id),i=t.get();this._surfaces.delete(e.id),i.replaceUnderlyingBuffer(i.getWidth(),i.getHeight(),e.buffer),t.release()},r}();i.default=r},{"./messages":102,"microevent.ts":6,"worker-rpc":22}],102:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.messageIds={configure:"pipeline/configure",flush:"pipeline/flush",process:"pipeline/process",emit:"pipeline/emit",release:"pipeline/release"},Object.freeze(i.messageIds)},{}],103:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function r(){this._height=0,this._width=0,this._buffer=null}return r.createFromArrayBuffer=function(e,t,i){return(new r).replaceUnderlyingBuffer(e,t,i)},r.prototype.replaceUnderlyingBuffer=function(e,t,i){if(e*t*4!==i.byteLength)throw new Error("surface size mismatch");return this._width=e,this._height=t,this._underlyingBuffer=i,this._buffer=new Uint32Array(this._underlyingBuffer),this},r.prototype.getUnderlyingBuffer=function(){return this._underlyingBuffer},r.prototype.resetUnderlyingBuffer=function(){return this._width=this._height=0,this._underlyingBuffer=this._buffer=null,this},r.prototype.getWidth=function(){return this._width},r.prototype.getHeight=function(){return this._height},r.prototype.getBuffer=function(){return this._buffer},r.prototype.getByteOrder=function(){return 0},r.prototype.fill=function(e){for(var t=0;t<this._buffer.length;t++)this._buffer[t]=e;return this},r}();i.default=r},{}],104:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("../../tools/pool/Pool"),s=e("../../tools/pool/InducedPool"),a=e("../../tools/AudioOutputBuffer"),o=function(){function e(e){var t=this;this._output=e,this.newFrame=new r.Event,this.togglePause=new r.Event,this._audioBufferPool=new n.default(function(){return new a.default(new Float32Array(t.getFrameSize()),t.getSampleRate())}),this._audioBufferMap=new WeakMap,this._pcmDataPool=new s.default(function(e){return e.getContent()},function(e,t){return e.get().replaceUnderlyingBuffer(t)}),this._output.newFrame.addHandler(function(e){return t.newFrame.dispatch(t._pcmDataPool.get(t._audioBufferMap.get(e)))}),this._output.togglePause.addHandler(function(e){return t.togglePause.dispatch(e)}),this._output.setFrameBufferFactory(function(){var e=t._audioBufferPool.get();return t._audioBufferMap.has(e.get())||t._audioBufferMap.set(e.get(),e),e.get()})}return e.prototype.getSampleRate=function(){return this._output.getSampleRate()},e.prototype.getFrameSize=function(){return this._output.getFrameSize()},e.prototype.isPaused=function(){return this._output.isPaused()},e}();i.default=o},{"../../tools/AudioOutputBuffer":79,"../../tools/pool/InducedPool":84,"../../tools/pool/Pool":85,"microevent.ts":6}],105:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),s=e("../../tools/pool/Pool"),a=e("../../video/surface/ArrayBufferSurface"),o=e("../../tools/pool/InducedPool"),u=e("../../video/processing/ProcessorPipeline"),n=function(){function e(e,t){var n=this;this._video=e,this.newFrame=new r.Event,this._poolMembers=new WeakMap,this._surfaces=new WeakMap,this._surfacePool=new o.default(function(e){return n._surfaces.get(e)}),this._videoProcessor=new u.default(t),this._videoProcessor.init(this._video.getWidth(),this._video.getHeight()),this._pool=new s.default(function(){return new ImageData(n._video.getWidth(),n._video.getHeight())}),this._video.setSurfaceFactory(function(){var e=n._pool.get(),t=e.get();if(!n._surfaces.has(t)){var i=a.default.createFromArrayBuffer(t.width,t.height,t.data.buffer);n._surfaces.set(t,i.fill(4278190080))}var r=n._surfaces.get(t);return n._poolMembers.set(r,e),r}),this._video.newFrame.addHandler(function(e){return n._videoProcessor.processSurface(n._surfacePool.get(n._poolMembers.get(e)))}),this._videoProcessor.emit.addHandler(function(e){return n.newFrame.dispatch(n._poolMembers.get(e.get()))})}return e.prototype.getWidth=function(){return this._video.getWidth()},e.prototype.getHeight=function(){return this._video.getHeight()},e}();i.default=n},{"../../tools/pool/InducedPool":84,"../../tools/pool/Pool":85,"../../video/processing/ProcessorPipeline":100,"../../video/surface/ArrayBufferSurface":103,"microevent.ts":6}],106:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("./EmulationServiceInterface"),s=function(){function i(){this._drivers=new Map,this._driversBound=!1}return i.prototype.bind=function(e){return this._driversBound||(this._emulationService=e,this._shouldBindDrivers()&&this._bindDrivers(),this._emulationService.stateChanged.addHandler(i._onEmuStateChange,this)),this},i.prototype.unbind=function(){return this._emulationService&&(this._unbindDrivers(),this._emulationService.stateChanged.removeHandler(i._onEmuStateChange,this),this._emulationService=null),this},i.prototype.addDriver=function(e,t){return this._drivers.set(e,new i.DriverContext(e,t)),this._driversBound&&t(this._emulationService.getEmulationContext(),e),this},i.prototype.removeDriver=function(e){return this._drivers.get(e)&&(e.unbind(),this._drivers.delete(e)),this},i._onEmuStateChange=function(e,t){t._shouldBindDrivers(e)?t._bindDrivers():t._unbindDrivers()},i.prototype._shouldBindDrivers=function(e){return void 0===e&&(e=this._emulationService?this._emulationService.getState():void 0),this._emulationService&&(e===n.default.State.running||e===n.default.State.paused)},i.prototype._bindDrivers=function(){var t=this;this._driversBound||(this._drivers.forEach(function(e){return e.binder(t._emulationService.getEmulationContext(),e.driver)}),this._driversBound=!0)},i.prototype._unbindDrivers=function(){this._driversBound&&(this._drivers.forEach(function(e){return e.driver.unbind()}),this._driversBound=!1)},i}();i.default=s,r=function(e,t){this.driver=e,this.binder=t},(s||(s={})).DriverContext=r,i.default=s},{"./EmulationServiceInterface":107}],107:[function(e,t,i){"use strict";var r,n,s;Object.defineProperty(i,"__esModule",{value:!0}),n=r||(r={}),(s=n.State||(n.State={}))[s.stopped=0]="stopped",s[s.running=1]="running",s[s.paused=2]="paused",s[s.error=3]="error",i.default=r},{}],108:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../../../driver/VideoEndpoint"),n=e("../../../driver/PCMAudioEndpoint"),s=function(){function e(e,t){this._board=e,this._videoProcessing=t,this._videoEndpoint=null,this._audioEndpoint=null}return e.prototype.getConfig=function(){return this._board.getConfig()},e.prototype.getVideo=function(){return this._videoEndpoint||(this._videoEndpoint=new r.default(this._board.getVideoOutput(),this._videoProcessing)),this._videoEndpoint},e.prototype.getJoystick=function(e){switch(e){case 0:return this._board.getJoystick0();case 1:return this._board.getJoystick1();default:throw new Error("invalid joystick index "+e)}},e.prototype.getControlPanel=function(){return this._board.getControlPanel()},e.prototype.getPaddle=function(e){if(0<=e&&e<4)return this._board.getPaddle(e);throw new Error("invalid paddle index "+e)},e.prototype.getWaveformChannels=function(){return this._board.getWaveformChannels()},e.prototype.getPCMChannel=function(){return this._audioEndpoint||(this._audioEndpoint=new n.default(this._board.getPCMChannel())),this._audioEndpoint},e.prototype.getRawVideo=function(){if(this._videoEndpoint)throw new Error("video endpoint already initialized; raw video unavailable");return this._board.getVideoOutput()},e}();i.default=s},{"../../../driver/PCMAudioEndpoint":104,"../../../driver/VideoEndpoint":105}],109:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var h=e("tslib"),r=e("microevent.ts"),l=e("../EmulationServiceInterface"),f=e("./EmulationContext"),_=e("../../../../machine/stella/Board"),d=e("../../../../machine/stella/cartridge/CartridgeFactory"),n=e("../../../../tools/scheduler/Factory"),s=e("../../../../tools/ClockProbe"),a=e("../../../../tools/scheduler/PeriodicScheduler"),o=e("async-mutex"),u=function(){function c(){this.stateChanged=new r.Event,this.emulationError=new r.Event,this._enforceRateLimit=!0,this._state=l.default.State.stopped,this._lastError=null,this._scheduler=null,this._clockProbe=new s.default(new a.default(2e3)),this._mutex=new o.Mutex,this._schedulerFactory=new n.default,this._limitingStrategy=1,this.frequencyUpdate=this._clockProbe.frequencyUpdate,this._updateScheduler()}return c.prototype.init=function(){return Promise.resolve()},c.prototype.start=function(n,s,a,o){var e=this,u=new d.default;return this._mutex.runExclusive(function(){return h.__awaiter(e,void 0,void 0,function(){var t,i,r;return h.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this._stop(),this._limitingStrategy=s.pcmAudio?2:1,this._updateScheduler(),this._state===l.default.State.error?[2,this._state]:[4,u.createCartridge(n,a)];case 1:return t=e.sent(),i=new _.default(s,t),this._board=i,this._board.trap.addHandler(c._trapHandler,this),this._context=new f.default(i,o),this._clockProbe.attach(this._board.clock),this._setState(l.default.State.paused),[3,3];case 2:return r=e.sent(),this._setError(r),[3,3];case 3:return[2,this._state]}})})})},c.prototype.stop=function(){var e=this;return this._mutex.runExclusive(function(){return e._stop()})},c.prototype.pause=function(){var t=this;return this._mutex.runExclusive(function(){try{t._state===l.default.State.running&&(t._board.getTimer().stop(),t._board.suspend(),t._setState(l.default.State.paused),t._clockProbe.stop())}catch(e){t._setError(e)}return t._state})},c.prototype.resume=function(){var t=this;return this._mutex.runExclusive(function(){if(t._state===l.default.State.paused)try{t._tryToResume()}catch(e){t._setError(e)}return t._state})},c.prototype.reset=function(){var t=this;return this._mutex.runExclusive(function(){try{switch(t._state){case l.default.State.running:case l.default.State.paused:t._board.reset();break;case l.default.State.error:t._board.reset(),t._tryToResume()}}catch(e){t._setError(e)}return t._state})},c.prototype.getState=function(){return this._state},c.prototype.getEmulationContext=function(){switch(this._state){case l.default.State.running:case l.default.State.paused:return this._context;default:return null}},c.prototype.getLastError=function(){return this._lastError},c.prototype.getFrequency=function(){return this._clockProbe.getFrequency()},c.prototype.getRateLimit=function(){return this._enforceRateLimit},c.prototype.setRateLimit=function(e){var t=this;return this._enforceRateLimit===e?Promise.resolve(void 0):this._mutex.runExclusive(function(){t._state===l.default.State.running&&t._board.getTimer().stop(),t._enforceRateLimit=e,t._updateScheduler(),t._state===l.default.State.running&&t._board.getTimer().start(t._scheduler)})},c._trapHandler=function(e,t){t._setError(new Error("TRAP: "+e.message)),t.emulationError.dispatch(t._lastError)},c.prototype._stop=function(){try{this._state===l.default.State.running&&(this._board.getTimer().stop(),this._board.suspend(),this._board.trap.removeHandler(c._trapHandler,this),this._clockProbe.stop().detach()),this._board=null,this._context=null,this._setState(l.default.State.stopped)}catch(e){this._setError(e)}return this._state},c.prototype._tryToResume=function(){this._state!==l.default.State.running&&(this._board.getTimer().start(this._scheduler),this._board.resume(),this._setState(l.default.State.running),this._clockProbe.start())},c.prototype._setError=function(e){this._lastError=e,this._setState(l.default.State.error)},c.prototype._setState=function(e){return e!==this._state&&(this._state=e,this.stateChanged.dispatch(e)),this._state},c.prototype._updateScheduler=function(){this._scheduler=this._enforceRateLimit?this._schedulerFactory.createLimitingScheduler(this._limitingStrategy):this._schedulerFactory.createImmediateScheduler()},c}();i.default=u},{"../../../../machine/stella/Board":30,"../../../../machine/stella/cartridge/CartridgeFactory":55,"../../../../tools/ClockProbe":80,"../../../../tools/scheduler/Factory":89,"../../../../tools/scheduler/PeriodicScheduler":91,"../EmulationServiceInterface":107,"./EmulationContext":108,"async-mutex":2,"microevent.ts":6,tslib:20}],110:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./messages"),n=function(){function e(e){this._rpc=e,this._active=!1,this._emulationContext=null}return e.prototype.init=function(){this._rpc.registerSignalHandler(r.SIGNAL_TYPE.controlStateUpdate,this._onControlStateUpdate.bind(this))},e.prototype.bind=function(e){this._active||(this._active=!0,this._emulationContext=e)},e.prototype.unbind=function(){this._active&&(this._active=!1,this._emulationContext=null)},e.prototype._onControlStateUpdate=function(e){if(this._active){for(var t=0;t<2;t++)this._applyJoystickState(e.joystickState[t],this._emulationContext.getJoystick(t));for(t=0;t<4;t++)this._applyPaddleState(e.paddleState[t],this._emulationContext.getPaddle(t));this._applyControlPanelState(e.controlPanelState,this._emulationContext.getControlPanel())}},e.prototype._applyJoystickState=function(e,t){t.getUp().toggle(e.up),t.getDown().toggle(e.down),t.getLeft().toggle(e.left),t.getRight().toggle(e.right),t.getFire().toggle(e.fire)},e.prototype._applyPaddleState=function(e,t){t.setValue(e.value),t.getFire().toggle(e.fire)},e.prototype._applyControlPanelState=function(e,t){t.getDifficultySwitchP0().toggle(e.difficulty0),t.getDifficultySwitchP1().toggle(e.difficulty1),t.getResetButton().toggle(e.reset),t.getColorSwitch().toggle(e.color),t.getSelectSwitch().toggle(e.select)},e}();i.default=n},{"./messages":115}],111:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../vanilla/EmulationService"),c=e("../DriverManager"),h=e("./VideoDriver"),l=e("./ControlDriver"),f=e("./WaveformAudioDriver"),_=e("./PCMAudioDriver"),d=e("./messages"),n=function(){function u(e){this._rpc=e,this._videoDriver=null,this._service=new r.default}return u.prototype.startup=function(){var t=this;this._rpc.registerRpcHandler(d.RPC_TYPE.setup,this._onSetup.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationFetchLastError,this._onFetchLastError.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationPause,this._onEmulationPause.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationReset,this._onEmulationReset.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationResume,this._onEmulationResume.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationSetRateLimit,this._onEmulationSetRateLimit.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationStart,this._onEmulationStart.bind(this)).registerRpcHandler(d.RPC_TYPE.emulationStop,this._onEmulationStop.bind(this)),this._service.frequencyUpdate.addHandler(u._onFrequencyUpdate,this),this._service.emulationError.addHandler(u._onEmulationError,this);var e=new c.default,i=new h.default(this._rpc),r=new l.default(this._rpc),n=[0,1].map(function(e){return new f.default(e,t._rpc)}),s=new _.default(0,this._rpc);this._videoDriver=i,r.init(),e.addDriver(i,function(e,t){return t.bind(e.getRawVideo())}).addDriver(r,function(e,t){return t.bind(e)}).addDriver(s,function(e,t){return t.bind(e.getPCMChannel())}).bind(this._service);for(var a=function(i){e.addDriver(n[i],function(e,t){return t.bind(e.getWaveformChannels()[i])})},o=0;o<2;o++)a(o)},u._onFrequencyUpdate=function(e,t){t._rpc.signal(d.SIGNAL_TYPE.emulationFrequencyUpdate,e)},u._onEmulationError=function(e,t){t._rpc.signal(d.SIGNAL_TYPE.emulationError,e?e.message:null)},u.prototype._onSetup=function(e){this._videoDriver.init(e.videoProcessorPort)},u.prototype._onFetchLastError=function(){var e=this._service.getLastError();return e?e.message:null},u.prototype._onEmulationPause=function(){return this._service.pause()},u.prototype._onEmulationReset=function(){return this._service.reset()},u.prototype._onEmulationResume=function(){return this._service.resume()},u.prototype._onEmulationStart=function(e){return this._videoDriver.setVideoProcessingConfig(e.videoProcessing),this._service.start(e.buffer,e.config,e.cartridgeType)},u.prototype._onEmulationStop=function(){return this._service.stop()},u.prototype._onEmulationSetRateLimit=function(e){return this._service.setRateLimit(e)},u}();i.default=n},{"../DriverManager":106,"../vanilla/EmulationService":109,"./ControlDriver":110,"./PCMAudioDriver":112,"./VideoDriver":113,"./WaveformAudioDriver":114,"./messages":115}],112:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./messages"),n=function(){function t(e,t){this._rpc=t,this._enabled=!1,this._sampleRate=0,this._frameSize=0,this._pendingFrames=new Map,this._nextId=0,this._paused=!1,this._signalNewFrame="",this._signalTogglePause="",this._rpc.registerRpcHandler(r.RPC_TYPE.getPCMAudioParameters(e),this._onGetPCMAudioParameters.bind(this)).registerSignalHandler(r.SIGNAL_TYPE.pcmAudioReturnFrame(e),this._onReturnFrame.bind(this)),this._signalNewFrame=r.SIGNAL_TYPE.pcmAudioNewFrame(e),this._signalTogglePause=r.SIGNAL_TYPE.pcmAudioTogglePause(e)}return t.prototype.bind=function(e){this._enabled&&this.unbind(),this._endpoint=e,this._endpoint.newFrame.addHandler(t._onNewFrame,this),this._endpoint.togglePause.addHandler(t._onTogglePause,this),this._sampleRate=this._endpoint.getSampleRate(),this._frameSize=this._endpoint.getFrameSize(),this._enabled=!0},t.prototype.unbind=function(){this._enabled&&(this._endpoint.newFrame.removeHandler(t._onNewFrame,this),this._endpoint.togglePause.removeHandler(t._onTogglePause,this),this._endpoint=null,this._pendingFrames.clear(),this._sampleRate=this._frameSize=0,this._enabled=!1)},t._onNewFrame=function(e,t){if(t._enabled){var i=t._nextId++,r=e.get();t._pendingFrames.set(i,e),t._rpc.signal(t._signalNewFrame,{id:i,buffer:r.buffer},[r.buffer])}else e.dispose()},t._onTogglePause=function(e,t){t._paused=e,t._rpc.signal(t._signalTogglePause,{paused:e})},t.prototype._onGetPCMAudioParameters=function(){return{sampleRate:this._sampleRate,frameSize:this._frameSize,paused:this._paused}},t.prototype._onReturnFrame=function(e){if(this._enabled&&this._pendingFrames.has(e.id)){var t=this._pendingFrames.get(e.id);this._pendingFrames.delete(e.id),t.adopt(new Float32Array(e.buffer)),t.release()}},t}();i.default=n},{"./messages":115}],113:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("tslib"),r=e("async-mutex"),a=e("worker-rpc"),o=e("../../../../tools/pool/Pool"),u=e("../../../../video/surface/ArrayBufferSurface"),c=e("../../../../video/processing/worker/PipelineClient"),h=e("./messages"),n=function(){function n(e){this._rpc=e,this._active=!1,this._video=null,this._videoPipelineClient=null,this._mutex=new r.Mutex,this._videoProcessingConfig=null,this._bypassProcessingPipeline=!0,this._surfacePool=null,this._managedSurfacesById=null,this._ids=null,this._width=0,this._height=0,this._nextId=0}return n.prototype.init=function(i){if(this._rpc.registerSignalHandler(h.SIGNAL_TYPE.videoReturnSurface,this._onReturnSurfaceFromHost.bind(this)).registerRpcHandler(h.RPC_TYPE.getVideoParameters,this._onGetVideoParameters.bind(this)),i){var t=new a.RpcProvider(function(e,t){return i.postMessage(e,t)});i.onmessage=function(e){return t.dispatch(e.data)},this._videoPipelineClient=new c.default(t),this._videoPipelineClient.emit.addHandler(n._onEmitFromPipeline,this)}},n.prototype.setVideoProcessingConfig=function(e){this._videoProcessingConfig=e},n.prototype.bind=function(e){var t=this;this._mutex.runExclusive(function(){return t._bind(e)})},n.prototype.unbind=function(){var e=this;this._mutex.runExclusive(function(){return e._unbind()})},n._onEmitFromPipeline=function(e,t){if(t._active)if(t._ids.has(e)){var i=e.get().getUnderlyingBuffer(),r=t._ids.get(e);t._rpc.signal(h.SIGNAL_TYPE.videoNewFrame,{id:r,width:t._width,height:t._height,buffer:i},[i])}else console.warn("surface not registered");else console.warn("surface emmited from pipeline to inactive driver")},n._onNewFrame=function(e,t){t._active?t._managedSurfaces.has(e)?t._bypassProcessingPipeline||!t._videoPipelineClient?n._onEmitFromPipeline(t._managedSurfaces.get(e),t):t._videoPipelineClient.processSurface(t._managedSurfaces.get(e)):console.warn("surface not registered"):console.warn("new frame passed to inactive driver")},n.prototype._bind=function(t){return s.__awaiter(this,void 0,void 0,function(){var r=this;return s.__generator(this,function(e){switch(e.label){case 0:return this._active?[2]:(this._width=t.getWidth(),this._height=t.getHeight(),this._video=t,this._surfacePool=new o.default(function(){return u.default.createFromArrayBuffer(r._width,r._height,new ArrayBuffer(4*r._width*r._height))}),this._managedSurfacesById=new Map,this._managedSurfaces=new WeakMap,this._ids=new WeakMap,this._videoPipelineClient?[4,this._videoPipelineClient.configure(this._width,this._height,this._videoProcessingConfig)]:[3,2]);case 1:e.sent(),e.label=2;case 2:return this._video.setSurfaceFactory(function(){var e=r._surfacePool.get(),t=e.get();if(!r._ids.has(e)){var i=r._nextId++;r._ids.set(e,i),r._managedSurfacesById.set(i,e),r._managedSurfaces.set(t,e),t.fill(4278190080)}return e.get()}),this._video.newFrame.addHandler(n._onNewFrame,this),this._bypassProcessingPipeline=!this._videoProcessingConfig||0===this._videoProcessingConfig.length,this._active=!0,[2]}})})},n.prototype._unbind=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return this._active?(this._active=!1,this._video.setSurfaceFactory(null),this._video.newFrame.removeHandler(n._onNewFrame,this),this._videoPipelineClient?[4,this._videoPipelineClient.flush()]:[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return this._video=null,this._surfacePool=null,this._managedSurfacesById=null,this._ids=null,[2]}})})},n.prototype._onReturnSurfaceFromHost=function(e){if(this._active){var t=this._managedSurfacesById.get(e.id);t?(t.get().replaceUnderlyingBuffer(this._width,this._height,e.buffer),t.release()):console.warn("invalid member ID "+e.id)}else console.warn("surface returned from host to inactive driver")},n.prototype._onGetVideoParameters=function(){return{width:this._width,height:this._height}},n}();i.default=n},{"../../../../tools/pool/Pool":85,"../../../../video/processing/worker/PipelineClient":101,"../../../../video/surface/ArrayBufferSurface":103,"./messages":115,"async-mutex":2,tslib:20,"worker-rpc":22}],114:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./messages"),n=function(){function t(e,t){this._index=e,this._rpc=t,this._audio=null,this._rpc.registerRpcHandler(r.RPC_TYPE.getWaveformAudioParameters(this._index),this._onGetWaveformAudioParameters.bind(this))}return t.prototype.bind=function(e){this._audio||(this._audio=e,this._audio.bufferChanged.addHandler(t._onBufferChanged,this),this._audio.volumeChanged.addHandler(t._onVolumeChanged,this),this._audio.stop.addHandler(t._onStop,this))},t.prototype.unbind=function(){this._audio&&(this._audio.bufferChanged.removeHandler(t._onBufferChanged,this),this._audio.volumeChanged.removeHandler(t._onVolumeChanged,this),this._audio.stop.removeHandler(t._onStop,this),this._audio=null)},t._onBufferChanged=function(e,t){t._rpc.signal(r.SIGNAL_TYPE.waveformAudioBufferChange,{index:t._index,key:e})},t._onVolumeChanged=function(e,t){t._rpc.signal(r.SIGNAL_TYPE.waveformAudioVolumeChange,{index:t._index,value:e})},t._onStop=function(e,t){t._rpc.signal(r.SIGNAL_TYPE.audioStop,t._index)},t.prototype._onGetWaveformAudioParameters=function(){return{volume:this._audio.getVolume()}},t}();i.default=n},{"./messages":115}],115:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.RPC_TYPE={emulationPause:"emulation/pause",emulationReset:"emulation/reset",emulationResume:"emulation/resume",emulationSetRateLimit:"emulation/setRateLimit",emulationStart:"emulation/start",emulationStop:"emulation/stop",emulationFetchLastError:"emulation/fetchLastError",getVideoParameters:"video/getParameters",getWaveformAudioParameters:function(e){return"audio/waveform/getParameters/"+e},getPCMAudioParameters:function(e){return"audio/pcm/getParameters/"+e},setup:"/setup"},Object.freeze(i.RPC_TYPE),i.SIGNAL_TYPE={emulationError:"emulation/error",emulationFrequencyUpdate:"emulation/frequencyUpdate",videoNewFrame:"video/newFrame",videoReturnSurface:"video/returnSurface",controlStateUpdate:"control/stateUpdate",waveformAudioVolumeChange:"audio/waveform/volumeChange",waveformAudioBufferChange:"audio/waveform/bufferChange",pcmAudioNewFrame:function(e){return"audio/pcm/newFrame/"+e},pcmAudioTogglePause:function(e){return"audio/pcm/togglePause/"+e},pcmAudioReturnFrame:function(e){return"audio/pcm/returnFrame/"+e},audioStop:"audio/stop"},Object.freeze(i.SIGNAL_TYPE)},{}],116:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../rpc");new(e("../../../src/web/stella/service/worker/EmulationBackend").default)(r.getRpc()).startup()},{"../../../src/web/stella/service/worker/EmulationBackend":111,"../rpc":117}],117:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("worker-rpc"),n=null,s=null,a=null;(n=new r.RpcProvider(function(e,t){s?s.postMessage(e,t):postMessage(e,t),a&&((s=a).onmessage=function(e){return n.dispatch(e.data)}),a=null})).error.addHandler(function(e){console.log(e?e.message:"unknown rpc error")}),onmessage=function(e){return s||n.dispatch(e.data)},n.registerRpcHandler("/use-port",function(e){return s||a?Promise.reject("RPC already switched to message port"):(a=e,Promise.resolve())}),i.getRpc=function(){return n}},{"worker-rpc":22}]},{},[116]);
//# sourceMappingURL=stellerator_worker.min.js.map