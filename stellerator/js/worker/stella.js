!function e(t,i,r){function n(a,o){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){var i=t[a][1][e];return n(i||e)},l,l.exports,e,t,i,r)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var e=this,t=new Promise(function(t){return e._queue.push(t)});return this._pending||this._dispatchNext(),t},e.prototype.runExclusive=function(e){return this.acquire().then(function(t){var i;try{i=e()}catch(e){throw t(),e}return Promise.resolve(i).then(function(e){return t(),e},function(e){throw t(),e})})},e.prototype._dispatchNext=function(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}();i.default=r},{}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./Mutex");i.Mutex=r.default},{"./Mutex":1}],3:[function(e,t,i){},{}],4:[function(e,t,i){"use strict";function r(e){return s[e]||(s[e]=n(e)),s[e]}function n(e){for(var t="return function dispatcher"+e+"(payload) {\n",i=[],r=[],n=0;n<e;n++)i.push("cb"+n),r.push("ctx"+n),t+="    cb"+n+"(payload, ctx"+n+");\n";return t+="};",new(Function.bind.apply(Function,[void 0].concat(i.concat(r),[t])))}var s=[];s[0]=function(){return function(){}},s[1]=function(e,t){return void 0===t?e:function(i){e(i,t)}};var a=function(){function e(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return e.prototype.addHandler=function(e,t){return this.isHandlerAttached(e,t)||(this._handlers.push(e),this._contexts.push(t),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.removeHandler=function(e,t){var i=this._getHandlerIndex(e,t);return void 0!==i&&(this._handlers.splice(i,1),this._contexts.splice(i,1),this._createDispatcher(),this._updateHasHandlers()),this},e.prototype.isHandlerAttached=function(e,t){return void 0!==this._getHandlerIndex(e,t)},e.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},e.prototype._getHandlerIndex=function(e,t){var i,r=this._handlers.length;for(i=0;i<r&&(this._handlers[i]!==e||this._contexts[i]!==t);i++);return i<r?i:void 0},e.prototype._createDispatcher=function(){this.dispatch=r(this._handlers.length).apply(this,this._handlers.concat(this._contexts))},e}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=a},{}],5:[function(e,t,i){"use strict";var r=e("./Event");i.Event=r.default},{"./Event":4}],6:[function(e,t,i){(function(e){function t(e,t){for(var i=0,r=e.length-1;r>=0;r--){var n=e[r];"."===n?e.splice(r,1):".."===n?(e.splice(r,1),i++):i&&(e.splice(r,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var i=[],r=0;r<e.length;r++)t(e[r],r,e)&&i.push(e[r]);return i}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return n.exec(e).slice(1)};i.resolve=function(){for(var i="",n=!1,s=arguments.length-1;s>=-1&&!n;s--){var a=s>=0?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(i=a+"/"+i,n="/"===a.charAt(0))}return i=t(r(i.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+i||"."},i.normalize=function(e){var n=i.isAbsolute(e),s="/"===a(e,-1);return(e=t(r(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&s&&(e+="/"),(n?"/":"")+e},i.isAbsolute=function(e){return"/"===e.charAt(0)},i.join=function(){var e=Array.prototype.slice.call(arguments,0);return i.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},i.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=i.resolve(e).substr(1),t=i.resolve(t).substr(1);for(var n=r(e.split("/")),s=r(t.split("/")),a=Math.min(n.length,s.length),o=a,u=0;u<a;u++)if(n[u]!==s[u]){o=u;break}for(var c=[],u=o;u<n.length;u++)c.push("..");return(c=c.concat(s.slice(o))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(e){var t=s(e),i=t[0],r=t[1];return i||r?(r&&(r=r.substr(0,r.length-1)),i+r):"."},i.basename=function(e,t){var i=s(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},i.extname=function(e){return s(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,e("_process"))},{_process:7}],7:[function(e,t,i){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function s(e){if(h===setTimeout)return setTimeout(e,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function a(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function o(){b&&d&&(b=!1,d.length?p=d.concat(p):g=-1,p.length&&u())}function u(){if(!b){var e=s(o);b=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,b=!1,a(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var h,f,_=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(e){h=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var d,p=[],b=!1,g=-1;_.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];p.push(new c(e,t)),1!==p.length||b||s(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=l,_.addListener=l,_.once=l,_.off=l,_.removeListener=l,_.removeAllListeners=l,_.emit=l,_.prependListener=l,_.prependOnceListener=l,_.listeners=function(e){return[]},_.binding=function(e){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(e){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},{}],8:[function(e,t,i){var r=e("./lib/alea"),n=e("./lib/xor128"),s=e("./lib/xorwow"),a=e("./lib/xorshift7"),o=e("./lib/xor4096"),u=e("./lib/tychei"),c=e("./seedrandom");c.alea=r,c.xor128=n,c.xorwow=s,c.xorshift7=a,c.xor4096=o,c.tychei=u,t.exports=c},{"./lib/alea":9,"./lib/tychei":10,"./lib/xor128":11,"./lib/xor4096":12,"./lib/xorshift7":13,"./lib/xorwow":14,"./seedrandom":15}],9:[function(e,t,i){!function(e,t,i){function r(e){var t=this,i=a();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=i(" "),t.s1=i(" "),t.s2=i(" "),t.s0-=i(e),t.s0<0&&(t.s0+=1),t.s1-=i(e),t.s1<0&&(t.s1+=1),t.s2-=i(e),t.s2<0&&(t.s2+=1),i=null}function n(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var i=new r(e),s=t&&t.state,a=i.next;return a.int32=function(){return 4294967296*i.next()|0},a.double=function(){return a()+1.1102230246251565e-16*(2097152*a()|0)},a.quick=a,s&&("object"==typeof s&&n(s,i),a.state=function(){return n(i,{})}),a}function a(){var e=4022871197;return function(t){t=t.toString();for(var i=0;i<t.length;i++){var r=.02519603282416938*(e+=t.charCodeAt(i));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.alea=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],10:[function(e,t,i){!function(e,t,i){function r(e){var t=this,i="";t.next=function(){var e=t.b,i=t.c,r=t.d,n=t.a;return e=e<<25^e>>>7^i,i=i-r|0,r=r<<24^r>>>8^n,n=n-e|0,t.b=e=e<<20^e>>>12^i,t.c=i=i-r|0,t.d=r<<16^i>>>16^n,t.a=n-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):i+=e;for(var r=0;r<i.length+20;r++)t.b^=0|i.charCodeAt(r),t.next()}function n(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var i=new r(e),s=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,s&&("object"==typeof s&&n(s,i),a.state=function(){return n(i,{})}),a}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.tychei=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],11:[function(e,t,i){!function(e,t,i){function r(e){var t=this,i="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:i+=e;for(var r=0;r<i.length+64;r++)t.x^=0|i.charCodeAt(r),t.next()}function n(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var i=new r(e),s=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,s&&("object"==typeof s&&n(s,i),a.state=function(){return n(i,{})}),a}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xor128=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],12:[function(e,t,i){!function(e,t,i){function r(e){var t=this;t.next=function(){var e,i,r=t.w,n=t.X,s=t.i;return t.w=r=r+1640531527|0,i=n[s+34&127],e=n[s=s+1&127],i^=i<<13,e^=e<<17,i^=i>>>15,e^=e>>>12,i=n[s]=i^e,t.i=s,i+(r^r>>>16)|0},function(e,t){var i,r,n,s,a,o=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),n=0,s=-32;s<u;++s)t&&(r^=t.charCodeAt((s+32)%t.length)),0===s&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,s>=0&&(a=a+1640531527|0,n=0==(i=o[127&s]^=r+a)?n+1:0);for(n>=128&&(o[127&(t&&t.length||0)]=-1),n=127,s=512;s>0;--s)r=o[n+34&127],i=o[n=n+1&127],r^=r<<13,i^=i<<17,r^=r>>>15,i^=i>>>12,o[n]=r^i;e.w=a,e.X=o,e.i=n}(t,e)}function n(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var i=new r(e),s=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,s&&(s.X&&n(s,i),a.state=function(){return n(i,{})}),a}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xor4096=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],13:[function(e,t,i){!function(e,t,i){function r(e){var t=this;t.next=function(){var e,i,r=t.x,n=t.i;return e=r[n],e^=e>>>7,i=e^e<<24,e=r[n+1&7],i^=e^e>>>10,e=r[n+3&7],i^=e^e>>>3,e=r[n+4&7],i^=e^e<<7,e=r[n+7&7],e^=e<<13,i^=e^e<<9,r[n]=i,t.i=n+1&7,i},function(e,t){var i,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,i=0;i<t.length;++i)r[7&i]=r[7&i]<<15^t.charCodeAt(i)+r[i+1&7]<<13;for(;r.length<8;)r.push(0);for(i=0;i<8&&0===r[i];++i);for(8==i?r[7]=-1:r[i],e.x=r,e.i=0,i=256;i>0;--i)e.next()}(t,e)}function n(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var i=new r(e),s=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,s&&(s.x&&n(s,i),a.state=function(){return n(i,{})}),a}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xorshift7=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],14:[function(e,t,i){!function(e,t,i){function r(e){var t=this,i="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:i+=e;for(var r=0;r<i.length+64;r++)t.x^=0|i.charCodeAt(r),r==i.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function n(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var i=new r(e),s=t&&t.state,a=function(){return(i.next()>>>0)/4294967296};return a.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=i.next,a.quick=a,s&&("object"==typeof s&&n(s,i),a.state=function(){return n(i,{})}),a}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xorwow=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)},{}],15:[function(e,t,i){!function(i,r){function n(e,t,n){var h=[],f=u(o((t=1==t?{entropy:!0}:t||{}).entropy?[e,l(i)]:null==e?c():e,3),h),m=new s(h),k=function(){for(var e=m.g(d),t=b,i=0;e<g;)e=(e+i)*_,t*=_,i=m.g(1);for(;e>=y;)e/=2,t/=2,i>>>=1;return(e+i)/t};return k.int32=function(){return 0|m.g(4)},k.quick=function(){return m.g(4)/4294967296},k.double=k,u(l(m.S),i),(t.pass||n||function(e,t,i,n){return n&&(n.S&&a(n,m),e.state=function(){return a(m,{})}),i?(r[p]=e,t):e})(k,f,"global"in t?t.global:this==r,t.state)}function s(e){var t,i=e.length,r=this,n=0,s=r.i=r.j=0,a=r.S=[];for(i||(e=[i++]);n<_;)a[n]=n++;for(n=0;n<_;n++)a[n]=a[s=m&s+e[n%i]+(t=a[n])],a[s]=t;(r.g=function(e){for(var t,i=0,n=r.i,s=r.j,a=r.S;e--;)t=a[n=m&n+1],i=i*_+a[m&(a[n]=a[s=m&s+t])+(a[s]=t)];return r.i=n,r.j=s,i})(_)}function a(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function o(e,t){var i,r=[],n=typeof e;if(t&&"object"==n)for(i in e)try{r.push(o(e[i],t-1))}catch(e){}return r.length?r:"string"==n?e:e+"\0"}function u(e,t){for(var i,r=e+"",n=0;n<r.length;)t[m&n]=m&(i^=19*t[m&n])+r.charCodeAt(n++);return l(t)}function c(){try{var e;return h&&(e=h.randomBytes)?e=e(_):(e=new Uint8Array(_),(f.crypto||f.msCrypto).getRandomValues(e)),l(e)}catch(e){var t=f.navigator,r=t&&t.plugins;return[+new Date,f,r,f.screen,l(i)]}}function l(e){return String.fromCharCode.apply(0,e)}var h,f=this,_=256,d=6,p="random",b=r.pow(_,d),g=r.pow(2,52),y=2*g,m=_-1;if(r["seed"+p]=n,u(r.random(),i),"object"==typeof t&&t.exports){t.exports=n;try{h=e("crypto")}catch(e){}}else"function"==typeof define&&define.amd&&define(function(){return n})}([],Math)},{crypto:3}],16:[function(e,t,i){!function(e,r){"object"==typeof i&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.immediate=r()}(this,function(){"use strict";function e(e){var t=Array.prototype.slice.call(arguments,1),i=t.length;return i?1===i?function(){return e.call(void 0,t[0])}:2===i?function(){return e.call(void 0,t[0],t[1])}:3===i?function(){return e.call(void 0,t[0],t[1],t[2])}:function(){return e.apply(void 0,t)}:function(){return e.call(void 0)}}function t(t){return c[o]=e.apply(void 0,t),o++}function i(e){delete c[e]}function r(t){if(u)s.setTimeout(e(r,t),0);else{var n=c[t];if(n){u=!0;try{n()}finally{i(t),u=!1}}}}function n(){var i=function(){var i=t(arguments);return s.setTimeout(e(r,i),0),i};return i.usePolifill="setTimeout",i}var s=function(){return this||(0,eval)("this")}(),a=!(s.navigator&&/Trident|Edge/.test(s.navigator.userAgent)),o=1,u=!1,c={},l=Object.freeze({init:n,canUse:function(){return"setTimeout"in s}}),h=[Object.freeze({init:function(){var i=function(){var i=t(arguments);return s.process.nextTick(e(r,i)),i};return i.usePolifill="nextTick",i},canUse:function(){return"[object process]"===Object.prototype.toString.call(s.process)}}),Object.freeze({init:function(){var e="setImmediate$"+Math.random()+"$",i=function(t){t.source===s&&"string"==typeof t.data&&0===t.data.indexOf(e)&&r(Number(t.data.slice(e.length)))};s.addEventListener?s.addEventListener("message",i,!1):s.attachEvent("onmessage",i);var n=function(){var i=t(arguments);return s.postMessage(e+i,"*"),i};return n.usePolifill="postMessage",n},canUse:function(){if(s.importScripts||!s.postMessage)return!1;if(s.navigator&&/Chrome/.test(s.navigator.userAgent))return!1;var e=!0,t=s.onmessage;return s.onmessage=function(){e=!1},s.postMessage("","*"),s.onmessage=t,e}}),Object.freeze({init:function(){var e=new s.MessageChannel;e.port1.onmessage=function(e){r(Number(e.data))};var i=function(){var i=t(arguments);return e.port2.postMessage(i),i};return i.usePolifill="messageChannel",i},canUse:function(){return Boolean(s.MessageChannel)}}),Object.freeze({init:function(){var e=s.document.documentElement,i=function(){var i=t(arguments),n=s.document.createElement("script");return n.onreadystatechange=function(){r(i),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n),i};return i.usePolifill="readyStateChange",i},canUse:function(){return s.document&&"onreadystatechange"in s.document.createElement("script")}})],f=a?s.setImmediate||s.msSetImmediate||function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.canUse())return r.init()}return t.init()}(h,l):n(),_=a?s.clearImmediate||s.msClearImmediate||i:i;return{setImmediate:f,clearImmediate:_,polifill:function(){s.setImmediate!==f&&(s.setImmediate=f,s.msSetImmediate=f,s.clearImmediate=_,s.msClearImmediate=_)}}})},{}],17:[function(e,t,i){"use strict";var r,n=e("microevent.ts");!function(e){!function(e){e[e.signal=0]="signal",e[e.rpc=1]="rpc",e[e.internal=2]="internal"}(e.MessageType||(e.MessageType={}));e.MessageType}((r=function(){function e(e,t){void 0===t&&(t=0),this._dispatch=e,this._rpcTimeout=t,this.error=new n.Event,this._rpcHandlers={},this._signalHandlers={},this._pendingTransactions={},this._nextTransactionId=0}return e.prototype.dispatch=function(t){var i=t;switch(i.type){case e.MessageType.signal:return this._handleSignal(i);case e.MessageType.rpc:return this._handeRpc(i);case e.MessageType.internal:return this._handleInternal(i);default:this._raiseError("invalid message type "+i.type)}},e.prototype.rpc=function(t,i,r){var n=this,s=this._nextTransactionId++;return this._dispatch({type:e.MessageType.rpc,transactionId:s,id:t,payload:i},r||void 0),new Promise(function(e,t){var i=n._pendingTransactions[s]={id:s,resolve:e,reject:t};n._rpcTimeout>0&&(n._pendingTransactions[s].timeoutHandle=setTimeout(function(){return n._transactionTimeout(i)},n._rpcTimeout))})},e.prototype.signal=function(t,i,r){return this._dispatch({type:e.MessageType.signal,id:t,payload:i},r||void 0),this},e.prototype.registerRpcHandler=function(e,t){if(this._rpcHandlers[e])throw new Error("rpc handler for "+e+" already registered");return this._rpcHandlers[e]=t,this},e.prototype.registerSignalHandler=function(e,t){return this._signalHandlers[e]||(this._signalHandlers[e]=[]),this._signalHandlers[e].push(t),this},e.prototype.deregisterRpcHandler=function(e,t){return this._rpcHandlers[e]&&delete this._rpcHandlers[e],this},e.prototype.deregisterSignalHandler=function(e,t){return this._signalHandlers[e]&&(this._signalHandlers[e]=this._signalHandlers[e].filter(function(e){return t!==e})),this},e.prototype._raiseError=function(t){this.error.dispatch(new Error(t)),this._dispatch({type:e.MessageType.internal,id:"error",payload:t})},e.prototype._handleSignal=function(e){if(!this._signalHandlers[e.id])return this._raiseError("invalid signal "+e.id);this._signalHandlers[e.id].forEach(function(t){return t(e.payload)})},e.prototype._handeRpc=function(t){var i=this;if(!this._rpcHandlers[t.id])return this._raiseError("invalid rpc "+t.id);Promise.resolve(this._rpcHandlers[t.id](t.payload)).then(function(r){return i._dispatch({type:e.MessageType.internal,id:"resolve_transaction",transactionId:t.transactionId,payload:r})},function(r){return i._dispatch({type:e.MessageType.internal,id:"reject_transaction",transactionId:t.transactionId,payload:r})})},e.prototype._handleInternal=function(e){switch(e.id){case"resolve_transaction":if(!this._pendingTransactions[e.transactionId])return this._raiseError("no pending transaction with id "+e.transactionId);this._pendingTransactions[e.transactionId].resolve(e.payload),this._clearTransaction(this._pendingTransactions[e.transactionId]);break;case"reject_transaction":if(!this._pendingTransactions[e.transactionId])return this._raiseError("no pending transaction with id "+e.transactionId);this._pendingTransactions[e.transactionId].reject(e.payload),this._clearTransaction(this._pendingTransactions[e.transactionId]);break;case"error":this.error.dispatch(new Error("remote error: "+e.payload));break;default:this._raiseError("unhandled internal message "+e.id)}},e.prototype._transactionTimeout=function(e){e.reject("transaction timed out"),this._raiseError("transaction "+e.id+" timed out"),delete this._pendingTransactions[e.id]},e.prototype._clearTransaction=function(e){void 0!==e.timeoutHandle&&clearTimeout(e.timeoutHandle),delete this._pendingTransactions[e.id]},e}())||(r={})),Object.defineProperty(i,"__esModule",{value:!0}),i.default=r},{"microevent.ts":5}],18:[function(e,t,i){"use strict";var r=e("./RpcProvider");i.RpcProvider=r.default},{"./RpcProvider":17}],19:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){!function(e){e[e.cpu=0]="cpu",e[e.bus=1]="bus",e[e.debug=2]="debug",e[e.board=3]="board"}(e.TrapReason||(e.TrapReason={}));!function(e){e[e.instruction=0]="instruction",e[e.lazy=1]="lazy"}(e.ClockMode||(e.ClockMode={}));var t=function(){return function(e,t,i){this.reason=e,this.board=t,this.message=i}}();e.TrapPayload=t}(r||(r={})),i.default=r},{}],20:[function(e,t,i){"use strict";function r(e,t){e.s=e.s+1&255,e.flags=-17&(32|t.read(256+e.s))}function n(e,t){e.flags=-131&e.flags|128&t|(t?0:2)}function s(e,t,i){var r=e.p;e.nmi&&(i=65530),e.nmi=e.irq=!1,t.write(e.s+256,r>>>8&255),e.s=e.s+255&255,t.write(e.s+256,255&r),e.s=e.s+255&255,t.write(e.s+256,-17&e.flags),e.s=e.s+255&255,e.flags|=4,e.p=t.readWord(i)}function a(e,t){s(e,t,65534)}function o(e,t){s(e,t,65530)}function u(e,t){e.p=t.readWord(65532)}function c(e,t,i){if(8&e.flags){var r=(15&i)+(15&e.a)+(1&e.flags),n=(i>>>4)+(e.a>>>4)+(r>9?1:0);e.a=r%10|n%10<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(n>9?1:0)}else{var s=e.a+i+(1&e.flags),a=255&s;e.flags=-196&e.flags|128&a|(a?0:2)|s>>>8|(~(i^e.a)&(a^i)&128)>>>1,e.a=a}}function l(e,t,i){e.a&=i,n(e,e.a)}function h(e){var t=e.a;e.a=e.a<<1&255,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|t>>>7}function f(e,t,i){var r=t.read(i),n=r<<1&255;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|r>>>7}function _(e,t,i){e.flags=-195&e.flags|192&i|(i&e.a?0:2)}function d(e,t){var i=e.p+1&65535,r=65534;e.nmi&&(r=65530,e.nmi=!1),e.nmi=e.irq=!1,t.write(e.s+256,i>>>8&255),e.s=e.s+255&255,t.write(e.s+256,255&i),e.s=e.s+255&255,t.write(e.s+256,16|e.flags),e.s=e.s+255&255,e.flags|=4,e.p=t.readWord(r)}function p(e){e.flags&=-2}function b(e){e.flags&=-9}function g(e){e.flags&=-5}function y(e){e.flags&=-65}function m(e,t,i){var r=e.a+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function k(e,t,i){var r=e.x+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function v(e,t,i){var r=e.y+(255&~i)+1;e.flags=-132&e.flags|128&r|(255&r?0:2)|r>>>8}function w(e,t,i){var r=t.read(i)+255&255;t.write(i,r),n(e,r)}function C(e){e.x=e.x+255&255,n(e,e.x)}function M(e,t,i){e.a=e.a^i,n(e,e.a)}function A(e){e.y=e.y+255&255,n(e,e.y)}function T(e,t,i){var r=t.read(i)+1&255;t.write(i,r),n(e,r)}function S(e){e.x=e.x+1&255,n(e,e.x)}function P(e){e.y=e.y+1&255,n(e,e.y)}function E(e,t,i){e.p=i}function x(e,t,i){var r=e.p+1&65535,n=t.read(e.p);t.read(256+e.s),t.write(256+e.s,r>>>8),e.s=e.s+255&255,t.write(256+e.s,255&r),e.s=e.s+255&255,e.p=n|t.read(e.p+1&65535)<<8}function R(e,t,i,r){e.a=1===r?i:t.read(i),n(e,e.a)}function O(e,t,i,r){e.x=1===r?i:t.read(i),n(e,e.x)}function I(e,t,i,r){e.y=1===r?i:t.read(i),n(e,e.y)}function L(e){var t=e.a;e.a=e.a>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&t}function F(e,t,i){var r=t.read(i),n=r>>>1;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|1&r}function B(){}function H(e,t,i){e.a|=i,n(e,e.a)}function N(e,t){t.write(256+e.s,16|e.flags),e.s=e.s+255&255}function D(e,t){r(e,t)}function U(e,t){t.write(256+e.s,e.a),e.s=e.s+255&255}function j(e,t){e.s=e.s+1&255,e.a=t.read(256+e.s),n(e,e.a)}function V(e){var t=e.a;e.a=e.a<<1&255|1&e.flags,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|t>>>7}function W(e,t,i){var r=t.read(i),n=r<<1&255|1&e.flags;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|r>>>7}function z(e){var t=e.a;e.a=e.a>>>1|(1&e.flags)<<7,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&t}function q(e,t,i){var r=t.read(i),n=r>>>1|(1&e.flags)<<7;t.write(i,n),e.flags=-132&e.flags|128&n|(n?0:2)|1&r}function Y(e,t){var i;r(e,t),e.s=e.s+1&255,i=t.read(256+e.s),e.s=e.s+1&255,i|=t.read(256+e.s)<<8,e.p=i}function K(e,t){var i;t.read(256+e.s),e.s=e.s+1&255,i=t.read(256+e.s),e.s=e.s+1&255,i+=t.read(256+e.s)<<8,e.p=i+1&65535}function G(e,t,i){if(8&e.flags){var r=(15&e.a)-(15&i)-(1&~e.flags),n=(e.a>>>4)-(i>>>4)-(r<0?1:0);e.a=(r<0?10+r:r)|(n<0?10+n:n)<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(n<0?0:1)}else{i=255&~i;var s=e.a+i+(1&e.flags),a=255&s;e.flags=-196&e.flags|128&a|(a?0:2)|s>>>8|(~(i^e.a)&(a^i)&128)>>>1,e.a=a}}function X(e){e.flags|=1}function J(e){e.flags|=8}function Q(e){e.flags|=4}function $(e,t,i){t.write(i,e.a)}function Z(e,t,i){t.write(i,e.x)}function ee(e,t,i){t.write(i,e.y)}function te(e){e.x=e.a,n(e,e.a)}function ie(e){e.y=e.a,n(e,e.a)}function re(e){e.x=e.s,n(e,e.x)}function ne(e){e.a=e.x,n(e,e.a)}function se(e){e.s=e.x}function ae(e){e.a=e.y,n(e,e.a)}function oe(e,t,i){var r=e.a&i;e.a=r>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&r}function ue(e,t,i){var r=(e.a&e.x)+(255&~i)+1;e.x=255&r,e.flags=-132&e.flags|128&e.x|(255&e.x?0:2)|r>>>8}function ce(e,t,i){var r=t.read(i)+255&255;t.write(i,r);var n=e.a+(255&~r)+1;e.flags=-132&e.flags|128&n|(255&n?0:2)|n>>>8}function le(e,t,i){e.a=i,e.x=i,n(e,i)}function he(e,t,i){e.a=(e.a&i)>>>1|(1&e.flags?128:0),e.flags=-196&e.flags|(64&e.a)>>>6|(e.a?0:2)|128&e.a|64&e.a^(32&e.a)<<1}function fe(e,t,i){var r=t.read(i);e.flags=-2&e.flags|r>>>7,r<<=1,t.write(i,r),e.a=e.a|r,n(e,e.a)}function _e(e,t,i){var r=e.x&e.a;t.write(i,r),n(e,r)}function de(e,t,i){e.s=e.a=e.x=e.s&i,n(e,e.a)}function pe(e,t,i){var r=t.read(i)+1;t.write(i,r),G(e,t,r)}function be(e,t,i){e.a&=i,n(e,e.a),e.flags=-2&e.flags|(128&e.a)>>>7}Object.defineProperty(i,"__esModule",{value:!0});var ge,ye=e("./Instruction"),me=e("./CpuInterface");!function(e){e[e.endOfInstruction=0]="endOfInstruction",e[e.beforeOp=1]="beforeOp"}(ge||(ge={}));var ke=function(){function e(e,t){this._bus=e,this._rng=t,this.executionState=0,this.state=new me.default.State,this._opCycles=0,this._instructionCallback=null,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._interuptCheck=0,this._halted=!1,this._operand=0,this._lastInstructionPointer=0,this._currentAddressingMode=12,this.reset()}return e.prototype.setInterrupt=function(e){return this._interruptPending=e,this},e.prototype.isInterrupt=function(){return this._interruptPending},e.prototype.nmi=function(){return this._nmiPending=!0,this},e.prototype.halt=function(){return this._halted=!0,this},e.prototype.resume=function(){return this._halted=!1,this},e.prototype.isHalt=function(){return this._halted},e.prototype.setInvalidInstructionCallback=function(e){return this._invalidInstructionCallback=e,this},e.prototype.getInvalidInstructionCallback=function(){return this._invalidInstructionCallback},e.prototype.getLastInstructionPointer=function(){return this._lastInstructionPointer},e.prototype.reset=function(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._opCycles=7,this._interruptPending=!1,this._nmiPending=!1,this._instructionCallback=u,this},e.prototype.cycle=function(){if(!this._halted){switch(this.executionState){case 0:case 2:0==--this._opCycles&&(1===this._interuptCheck&&this._checkForInterrupts(),this._instructionCallback(this.state,this._bus,this._operand,this._currentAddressingMode),this.executionState=1,0===this._interuptCheck&&this._checkForInterrupts());break;case 1:if(this.state.nmi)return this._instructionCallback=o,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;if(this.state.irq)return this._instructionCallback=a,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;this._fetch()}return this}},e.prototype._fetch=function(){var e=ye.default.opcodes[this._bus.read(this.state.p)],t=e.addressingMode,i=!1,r=!1;switch(this._lastInstructionPointer=this.state.p,this._currentAddressingMode=t,this._interuptCheck=0,e.operation){case 0:this._opCycles=0,this._instructionCallback=c,i=!0;break;case 1:this._opCycles=0,this._instructionCallback=l,i=!0;break;case 2:0===t?(this._opCycles=1,this._instructionCallback=h):(this._opCycles=3,this._instructionCallback=f,r=!0);break;case 3:1&this.state.flags?(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=E,this._opCycles=0);break;case 4:1&this.state.flags?(this._instructionCallback=E,this._opCycles=0):(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 5:2&this.state.flags?(this._instructionCallback=E,this._opCycles=0):(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 6:this._opCycles=0,this._instructionCallback=_,i=!0;break;case 7:128&this.state.flags?(this._instructionCallback=E,this._opCycles=0):(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 8:2&this.state.flags?(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=E,this._opCycles=0);break;case 9:128&this.state.flags?(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=E,this._opCycles=0);break;case 11:64&this.state.flags?(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=E,this._opCycles=0);break;case 12:64&this.state.flags?(this._instructionCallback=E,this._opCycles=0):(t=0,this._instructionCallback=B,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 10:this._opCycles=6,this._instructionCallback=d,this._interuptCheck=1;break;case 13:this._opCycles=1,this._instructionCallback=p;break;case 14:this._opCycles=1,this._instructionCallback=b;break;case 15:this._opCycles=1,this._instructionCallback=g,this._interuptCheck=1;break;case 16:this._opCycles=1,this._instructionCallback=y;break;case 17:this._opCycles=0,this._instructionCallback=m,i=!0;break;case 18:this._opCycles=0,this._instructionCallback=k,i=!0;break;case 19:this._opCycles=0,this._instructionCallback=v,i=!0;break;case 20:this._opCycles=3,this._instructionCallback=w,r=!0;break;case 21:this._opCycles=1,this._instructionCallback=C;break;case 22:this._opCycles=1,this._instructionCallback=A;break;case 23:this._opCycles=0,this._instructionCallback=M,i=!0;break;case 24:this._opCycles=3,this._instructionCallback=T,r=!0;break;case 25:this._opCycles=1,this._instructionCallback=S;break;case 26:this._opCycles=1,this._instructionCallback=P;break;case 27:this._opCycles=0,this._instructionCallback=E;break;case 28:this._opCycles=5,this._instructionCallback=x;break;case 29:this._opCycles=1===t?0:1,this._instructionCallback=R;break;case 30:this._opCycles=1===t?0:1,this._instructionCallback=O;break;case 31:this._opCycles=1===t?0:1,this._instructionCallback=I;break;case 32:0===t?(this._opCycles=1,this._instructionCallback=L):(this._opCycles=3,this._instructionCallback=F,r=!0);break;case 33:this._opCycles=1,this._instructionCallback=B;break;case 56:case 57:this._opCycles=0,i=!0,this._instructionCallback=B;break;case 34:this._opCycles=0,this._instructionCallback=H,i=!0;break;case 36:this._opCycles=2,this._instructionCallback=N;break;case 35:this._opCycles=2,this._instructionCallback=U;break;case 37:this._opCycles=3,this._instructionCallback=j;break;case 38:this._opCycles=3,this._instructionCallback=D,this._interuptCheck=1;break;case 39:0===t?(this._opCycles=1,this._instructionCallback=V):(this._opCycles=3,this._instructionCallback=W,r=!0);break;case 40:0===t?(this._opCycles=1,this._instructionCallback=z):(this._opCycles=3,this._instructionCallback=q,r=!0);break;case 41:this._opCycles=5,this._instructionCallback=Y;break;case 42:this._opCycles=5,this._instructionCallback=K;break;case 43:this._opCycles=0,this._instructionCallback=G,i=!0;break;case 44:this._opCycles=1,this._instructionCallback=X;break;case 45:this._opCycles=1,this._instructionCallback=J;break;case 46:this._opCycles=1,this._instructionCallback=Q,this._interuptCheck=1;break;case 47:this._opCycles=1,this._instructionCallback=$,r=!0;break;case 48:this._opCycles=1,this._instructionCallback=Z,r=!0;break;case 49:this._opCycles=1,this._instructionCallback=ee,r=!0;break;case 50:this._opCycles=1,this._instructionCallback=te;break;case 51:this._opCycles=1,this._instructionCallback=ie;break;case 52:this._opCycles=1,this._instructionCallback=re;break;case 53:this._opCycles=1,this._instructionCallback=ne;break;case 54:this._opCycles=1,this._instructionCallback=se;break;case 55:this._opCycles=1,this._instructionCallback=ae;break;case 62:this._opCycles=0,this._instructionCallback=he;break;case 58:this._opCycles=0,this._instructionCallback=oe;break;case 59:this._opCycles=0,this._instructionCallback=ue;break;case 60:this._opCycles=3,this._instructionCallback=ce,r=!0;break;case 61:this._opCycles=0,this._instructionCallback=le,i=!0;break;case 63:this._opCycles=2,this._instructionCallback=fe,r=!0;break;case 64:this._opCycles=1,this._instructionCallback=_e;break;case 65:this._opCycles=0,this._instructionCallback=de,i=!0;break;case 66:this._opCycles=3,this._instructionCallback=pe;break;case 67:this._opCycles=0,this._instructionCallback=be;break;default:return void(this._invalidInstructionCallback&&this._invalidInstructionCallback(this))}this.state.p=this.state.p+1&65535;var n,s;switch(t){case 1:this._operand=this._bus.read(this.state.p),i=!1,this.state.p=this.state.p+1&65535,this._opCycles++;break;case 2:this._operand=this._bus.read(this.state.p),this.state.p=this.state.p+1&65535,this._opCycles++;break;case 3:this._operand=this._bus.readWord(this.state.p),this.state.p=this.state.p+2&65535,this._opCycles+=2;break;case 4:n=this._bus.readWord(this.state.p),this._operand=255==(255&n)?this._bus.read(n)+(this._bus.read(65280&n)<<8):this._bus.readWord(n),this.state.p=this.state.p+2&65535,this._opCycles+=4;break;case 5:n=128&(n=this._bus.read(this.state.p))?-(255&~(n-1)):n,this._operand=this.state.p+n+65537&65535,this.state.p=this.state.p+1&65535,this._opCycles+=(65280&this._operand)!=(65280&this.state.p)?3:2;break;case 6:s=this._bus.read(this.state.p),this._bus.read(s),this._operand=s+this.state.x&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 7:n=this._bus.readWord(this.state.p),this._operand=n+this.state.x&65535,(65280&this._operand)!=(65280&n)&&this._bus.read(65280&n|255&this._operand),this._opCycles+=r||(65280&this._operand)!=(65280&n)?3:2,this.state.p=this.state.p+2&65535;break;case 9:s=this._bus.read(this.state.p),this._bus.read(s),this._operand=s+this.state.y&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 10:n=this._bus.readWord(this.state.p),this._operand=n+this.state.y&65535,(65280&this._operand)!=(65280&n)&&this._bus.read(65280&n|255&this._operand),this._opCycles+=r||(65280&this._operand)!=(65280&n)?3:2,this.state.p=this.state.p+2&65535;break;case 8:s=this._bus.read(this.state.p),this._bus.read(s),n=s+this.state.x&255,this._operand=255===n?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(n),this._opCycles+=4,this.state.p=this.state.p+1&65535;break;case 11:n=255===(n=this._bus.read(this.state.p))?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(n),this._operand=n+this.state.y&65535,(65280&this._operand)!=(65280&n)&&this._bus.read(65280&n|255&this._operand),this._opCycles+=r||(65280&n)!=(65280&this._operand)?4:3,this.state.p=this.state.p+1&65535}i&&(this._operand=this._bus.read(this._operand),this._opCycles++),this.executionState=2},e.prototype._checkForInterrupts=function(){this._nmiPending&&(this.state.irq=!1,this.state.nmi=!0,this._nmiPending=!1),!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)},e}();i.default=ke},{"./CpuInterface":21,"./Instruction":22}],21:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){!function(e){e[e.boot=0]="boot",e[e.fetch=1]="fetch",e[e.execute=2]="execute"}(e.ExecutionState||(e.ExecutionState={}));var t=function(){return function(){this.a=0,this.x=0,this.y=0,this.s=0,this.p=0,this.flags=0,this.irq=!1,this.nmi=!1}}();e.State=t;!function(e){e[e.c=1]="c",e[e.z=2]="z",e[e.i=4]="i",e[e.d=8]="d",e[e.b=16]="b",e[e.e=32]="e",e[e.v=64]="v",e[e.n=128]="n"}(e.Flags||(e.Flags={}))}(r||(r={})),i.default=r},{}],22:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this.operation=e,this.addressingMode=t}return e.prototype.getSize=function(){switch(this.addressingMode){case 1:case 2:case 6:case 9:case 8:case 11:case 5:return 2;case 3:case 7:case 10:case 4:return 3;default:return 1}},e}();!function(e){!function(e){e[e.adc=0]="adc",e[e.and=1]="and",e[e.asl=2]="asl",e[e.bcc=3]="bcc",e[e.bcs=4]="bcs",e[e.beq=5]="beq",e[e.bit=6]="bit",e[e.bmi=7]="bmi",e[e.bne=8]="bne",e[e.bpl=9]="bpl",e[e.brk=10]="brk",e[e.bvc=11]="bvc",e[e.bvs=12]="bvs",e[e.clc=13]="clc",e[e.cld=14]="cld",e[e.cli=15]="cli",e[e.clv=16]="clv",e[e.cmp=17]="cmp",e[e.cpx=18]="cpx",e[e.cpy=19]="cpy",e[e.dec=20]="dec",e[e.dex=21]="dex",e[e.dey=22]="dey",e[e.eor=23]="eor",e[e.inc=24]="inc",e[e.inx=25]="inx",e[e.iny=26]="iny",e[e.jmp=27]="jmp",e[e.jsr=28]="jsr",e[e.lda=29]="lda",e[e.ldx=30]="ldx",e[e.ldy=31]="ldy",e[e.lsr=32]="lsr",e[e.nop=33]="nop",e[e.ora=34]="ora",e[e.pha=35]="pha",e[e.php=36]="php",e[e.pla=37]="pla",e[e.plp=38]="plp",e[e.rol=39]="rol",e[e.ror=40]="ror",e[e.rti=41]="rti",e[e.rts=42]="rts",e[e.sbc=43]="sbc",e[e.sec=44]="sec",e[e.sed=45]="sed",e[e.sei=46]="sei",e[e.sta=47]="sta",e[e.stx=48]="stx",e[e.sty=49]="sty",e[e.tax=50]="tax",e[e.tay=51]="tay",e[e.tsx=52]="tsx",e[e.txa=53]="txa",e[e.txs=54]="txs",e[e.tya=55]="tya",e[e.dop=56]="dop",e[e.top=57]="top",e[e.alr=58]="alr",e[e.axs=59]="axs",e[e.dcp=60]="dcp",e[e.lax=61]="lax",e[e.arr=62]="arr",e[e.slo=63]="slo",e[e.aax=64]="aax",e[e.lar=65]="lar",e[e.isc=66]="isc",e[e.aac=67]="aac",e[e.invalid=68]="invalid"}(e.Operation||(e.Operation={}));!function(e){e[e.adc=0]="adc",e[e.and=1]="and",e[e.asl=2]="asl",e[e.bcc=3]="bcc",e[e.bcs=4]="bcs",e[e.beq=5]="beq",e[e.bit=6]="bit",e[e.bmi=7]="bmi",e[e.bne=8]="bne",e[e.bpl=9]="bpl",e[e.brk=10]="brk",e[e.bvc=11]="bvc",e[e.bvs=12]="bvs",e[e.clc=13]="clc",e[e.cld=14]="cld",e[e.cli=15]="cli",e[e.clv=16]="clv",e[e.cmp=17]="cmp",e[e.cpx=18]="cpx",e[e.cpy=19]="cpy",e[e.dec=20]="dec",e[e.dex=21]="dex",e[e.dey=22]="dey",e[e.eor=23]="eor",e[e.inc=24]="inc",e[e.inx=25]="inx",e[e.iny=26]="iny",e[e.jmp=27]="jmp",e[e.jsr=28]="jsr",e[e.lda=29]="lda",e[e.ldx=30]="ldx",e[e.ldy=31]="ldy",e[e.lsr=32]="lsr",e[e.nop=33]="nop",e[e.ora=34]="ora",e[e.pha=35]="pha",e[e.php=36]="php",e[e.pla=37]="pla",e[e.plp=38]="plp",e[e.rol=39]="rol",e[e.ror=40]="ror",e[e.rti=41]="rti",e[e.rts=42]="rts",e[e.sbc=43]="sbc",e[e.sec=44]="sec",e[e.sed=45]="sed",e[e.sei=46]="sei",e[e.sta=47]="sta",e[e.stx=48]="stx",e[e.sty=49]="sty",e[e.tax=50]="tax",e[e.tay=51]="tay",e[e.tsx=52]="tsx",e[e.txa=53]="txa",e[e.txs=54]="txs",e[e.tya=55]="tya",e[e.dop=56]="dop",e[e.top=57]="top",e[e.alr=58]="alr",e[e.axs=59]="axs",e[e.dcp=60]="dcp",e[e.lax=61]="lax",e[e.arr=62]="arr",e[e.slo=63]="slo",e[e.aax=64]="aax",e[e.lar=65]="lar",e[e.isc=66]="isc",e[e.aac=67]="aac",e[e.invalid=68]="invalid"}(e.OperationMap||(e.OperationMap={}));!function(e){e[e.implied=0]="implied",e[e.immediate=1]="immediate",e[e.zeroPage=2]="zeroPage",e[e.absolute=3]="absolute",e[e.indirect=4]="indirect",e[e.relative=5]="relative",e[e.zeroPageX=6]="zeroPageX",e[e.absoluteX=7]="absoluteX",e[e.indexedIndirectX=8]="indexedIndirectX",e[e.zeroPageY=9]="zeroPageY",e[e.absoluteY=10]="absoluteY",e[e.indirectIndexedY=11]="indirectIndexedY",e[e.invalid=12]="invalid"}(e.AddressingMode||(e.AddressingMode={})),e.opcodes=new Array(256)}(r||(r={})),i.default=r,function(e){!function(t){function i(t,i,r){if(68!==e.opcodes[t].operation)throw new Error("entry for opcode "+t+" already exists");e.opcodes[t].operation=i,e.opcodes[t].addressingMode=r}for(a=0;a<256;a++)e.opcodes[a]=new e(68,12);for(var r,n,s,a=0;a<8;a++){switch(a){case 0:r=34;break;case 1:r=1;break;case 2:r=23;break;case 3:r=0;break;case 4:r=47;break;case 5:r=29;break;case 6:r=17;break;case 7:r=43}for(var o=0;o<8;o++){switch(o){case 0:n=8;break;case 1:n=2;break;case 2:n=1;break;case 3:n=3;break;case 4:n=11;break;case 5:n=6;break;case 6:n=10;break;case 7:n=7}47===r&&1===n&&(n=12),68!==r&&12!==n&&(s=a<<5|o<<2|1,e.opcodes[s].operation=r,e.opcodes[s].addressingMode=n)}}i(6,2,2),i(10,2,0),i(14,2,3),i(22,2,6),i(30,2,7),i(38,39,2),i(42,39,0),i(46,39,3),i(54,39,6),i(62,39,7),i(70,32,2),i(74,32,0),i(78,32,3),i(86,32,6),i(94,32,7),i(102,40,2),i(106,40,0),i(110,40,3),i(118,40,6),i(126,40,7),i(134,48,2),i(142,48,3),i(150,48,9),i(162,30,1),i(166,30,2),i(174,30,3),i(182,30,9),i(190,30,10),i(198,20,2),i(206,20,3),i(214,20,6),i(222,20,7),i(230,24,2),i(238,24,3),i(246,24,6),i(254,24,7),i(36,6,2),i(44,6,3),i(76,27,3),i(108,27,4),i(132,49,2),i(140,49,3),i(148,49,6),i(160,31,1),i(164,31,2),i(172,31,3),i(180,31,6),i(188,31,7),i(192,19,1),i(196,19,2),i(204,19,3),i(224,18,1),i(228,18,2),i(236,18,3),i(16,9,5),i(48,7,5),i(80,11,5),i(112,12,5),i(144,3,5),i(176,4,5),i(208,8,5),i(240,5,5),i(0,10,0),i(32,28,0),i(64,41,0),i(96,42,0),i(8,36,0),i(40,38,0),i(72,35,0),i(104,37,0),i(136,22,0),i(168,51,0),i(200,26,0),i(232,25,0),i(24,13,0),i(56,44,0),i(88,15,0),i(120,46,0),i(152,55,0),i(184,16,0),i(216,14,0),i(248,45,0),i(138,53,0),i(154,54,0),i(170,50,0),i(186,52,0),i(202,21,0),i(234,33,0),i(26,33,0),i(58,33,0),i(90,33,0),i(122,33,0),i(218,33,0),i(250,33,0),i(4,56,2),i(20,56,6),i(52,56,6),i(68,56,2),i(84,56,6),i(100,56,2),i(116,56,6),i(128,56,1),i(130,56,1),i(137,56,1),i(194,56,1),i(212,56,6),i(226,56,1),i(244,56,6),i(12,57,3),i(28,57,7),i(60,57,7),i(92,57,7),i(124,57,7),i(220,57,7),i(252,57,7),i(235,43,1),i(75,58,1),i(203,59,1),i(199,60,2),i(215,60,6),i(207,60,3),i(223,60,7),i(219,60,10),i(195,60,8),i(211,60,11),i(167,61,2),i(183,61,9),i(175,61,3),i(191,61,10),i(163,61,8),i(179,61,11),i(107,62,1),i(7,63,2),i(23,63,6),i(15,63,3),i(31,63,7),i(27,63,10),i(3,63,8),i(19,63,11),i(135,64,2),i(151,64,9),i(131,64,8),i(143,64,3),i(187,65,10),i(231,66,2),i(247,66,6),i(239,66,3),i(255,66,7),i(251,66,10),i(227,66,8),i(243,66,11),i(11,67,1),i(43,67,1)}(e.__init||(e.__init={}))}(r||(r={}))},{}],23:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./Switch"),n=function(){function e(){this._left=new r.default,this._right=new r.default,this._up=new r.default,this._down=new r.default,this._fire=new r.default}return e.prototype.getLeft=function(){return this._left},e.prototype.getRight=function(){return this._right},e.prototype.getUp=function(){return this._up},e.prototype.getDown=function(){return this._down},e.prototype.getFire=function(){return this._fire},e}();i.default=n},{"./Switch":25}],24:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./Switch"),s=function(){function e(){this.valueChanged=new r.Event,this._fireSwitch=new n.default,this._value=.5}return e.prototype.setValue=function(e){this._value=e,this.valueChanged.dispatch(e)},e.prototype.getValue=function(){return this._value},e.prototype.getFire=function(){return this._fireSwitch},e}();i.default=s},{"./Switch":25,"microevent.ts":5}],25:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e){void 0===e&&(e=!1),this._state=e,this.stateChanged=new r.Event,this.beforeRead=new r.Event}return e.prototype.read=function(){return this.beforeRead.dispatch(this),this._state},e.prototype.peek=function(){return this._state},e.prototype.toggle=function(e){this._state!==e&&(this._state=e,this.stateChanged.dispatch(e))},e}();i.default=n},{"microevent.ts":5}],26:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("../board/BoardInterface"),s=(e("../cpu/CpuInterface"),e("../cpu/Cpu")),a=e("./Bus"),o=e("./Pia"),u=e("./tia/Tia"),c=e("./Config"),l=e("./ControlPanel"),h=e("../io/DigitalJoystick"),f=e("../io/Paddle"),_=e("../../tools/rng/factory"),d=function(){function e(e,t,i){var n=this;this._config=e,this.trap=new r.Event,this.clock=new r.Event,this.cpuClock=new r.Event,this._clockMode=1,this._trap=!1,this._audioEnabled=!0,this._suspended=!0,this._subClock=0,this._clockMhz=0,this._sliceSize=0,this._timer={tick:function(e){return n._tick(e)},start:function(e){return n._start(e)},stop:function(){return n._stop()},isRunning:function(){return!!n._runTask}},this._rng=_.createRng(e.randomSeed<0?Math.random():e.randomSeed),t.randomize(this._rng);var d=new a.default;void 0===i&&(i=function(e,t){return new s.default(e,t)});for(var p=new l.default,b=new h.default,g=new h.default,y=new Array(4),m=0;m<4;m++)y[m]=new f.default;var k=i(d,this._rng),v=new o.default(p,b,g,this._rng),w=new u.default(e,b,g,y);k.setInvalidInstructionCallback(function(){return n._onInvalidInstruction()}),w.setCpu(k).setBus(d),t.setCpu(k).setBus(d),v.setBus(d),d.setTia(w).setPia(v).setCartridge(t),this._bus=d,this._cpu=k,this._tia=w,this._pia=v,this._cartridge=t,this._controlPanel=p,this._joystick0=b,this._joystick1=g,this._paddles=y,this._bus.event.trap.addHandler(function(e){return n.triggerTrap(1,e.message)}),this._clockMhz=c.default.getClockMhz(e),this._sliceSize=228*(0===e.tvMode?262:312),this.reset()}return e.prototype.getCpu=function(){return this._cpu},e.prototype.getBus=function(){return this._bus},e.prototype.getVideoOutput=function(){return this._tia},e.prototype.getAudioOutput=function(){return{channel0:this._tia.getAudioChannel0(),channel1:this._tia.getAudioChannel1()}},e.prototype.getTimer=function(){return this._timer},e.prototype.reset=function(){return this._cpu.reset(),this._tia.reset(),this._pia.reset(),this._cartridge.reset(),this._controlPanel.getResetButton().toggle(!1),this._controlPanel.getSelectSwitch().toggle(!1),this._controlPanel.getColorSwitch().toggle(!1),this._controlPanel.getDifficultySwitchP0().toggle(!0),this._controlPanel.getDifficultySwitchP1().toggle(!0),this._subClock=0,this},e.prototype.boot=function(){var e=0,t=0;if(this.reset(),0!==this._cpu.executionState)throw new Error("Already booted!");for(;1!==this._cpu.executionState;)this._cycle(),e++,0===this._subClock&&t++;return this.cpuClock.dispatch(t),this.clock.dispatch(e),this},e.prototype.suspend=function(){this._suspended=!0,this._updateAudioState()},e.prototype.resume=function(){this._suspended=!1,this._updateAudioState()},e.prototype.setAudioEnabled=function(e){this._audioEnabled=e,this._updateAudioState()},e.prototype._updateAudioState=function(){this._tia.setAudioEnabled(this._audioEnabled&&!this._suspended)},e.prototype.triggerTrap=function(e,t){if(this._stop(),this._trap=!0,!this.trap.hasHandlers)throw new Error(t);return this.trap.dispatch(new n.default.TrapPayload(e,this,t)),this},e.prototype.getControlPanel=function(){return this._controlPanel},e.prototype.getJoystick0=function(){return this._joystick0},e.prototype.getJoystick1=function(){return this._joystick1},e.prototype.getBoardStateDebug=function(){var e="============";return"TIA:\n"+e+"\n"+this._tia.getDebugState()+"\n\nPIA:\n"+e+"\n"+this._pia.getDebugState()+"\n"},e.prototype.setClockMode=function(e){return this._clockMode=e,this},e.prototype.getClockMode=function(){return this._clockMode},e.prototype.getPaddle=function(e){return this._paddles[e]},e._executeSlice=function(e,t){var i=t?Math.round(t*e._clockMhz*1e3):e._sliceSize;return e._tick(i)/e._clockMhz/1e3},e.prototype._cycle=function(){this._tia.cycle(),this._subClock++>=2&&(this._pia.cycle(),this._cpu.cycle(),this._subClock=0)},e.prototype._tick=function(e){var t=0,i=0,r=0,n=this._cpu.executionState;for(this._trap=!1;t++<e&&!this._trap;)this._cycle(),i++,0===this._subClock&&r++,n!==this._cpu.executionState&&(n=this._cpu.executionState,1===this._cpu.executionState&&(this._cartridge.notifyCpuCycleComplete(),0===this._clockMode&&r>0&&this.cpuClock.hasHandlers&&(this.cpuClock.dispatch(r),r=0)));return r>0&&this.cpuClock.hasHandlers&&this.cpuClock.dispatch(r),i>0&&this.clock.hasHandlers&&this.clock.dispatch(i),i},e.prototype._start=function(t){this._runTask||(this._runTask=t.start(e._executeSlice,this,1e3/(0===this._config.tvMode?60:50)))},e.prototype._stop=function(){this._runTask&&(this._runTask.stop(),this._runTask=void 0)},e.prototype._onInvalidInstruction=function(){this.triggerTrap(0,"invalid instruction")},e}();i.default=d},{"../../tools/rng/factory":79,"../board/BoardInterface":19,"../cpu/Cpu":20,"../cpu/CpuInterface":21,"../io/DigitalJoystick":23,"../io/Paddle":24,"./Bus":27,"./Config":28,"./ControlPanel":29,"./Pia":30,"./tia/Tia":67,"microevent.ts":5}],27:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(){this.event={trap:new r.Event,read:new r.Event,write:new r.Event},this._tia=null,this._pia=null,this._cartridge=null,this._lastDataBusValue=0,this._lastAddressBusValue=0}return e.prototype.setTia=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(0,"TIA: "+(e.message||""))}),this._tia=e,this},e.prototype.setPia=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(1,"PIA: "+(e.message||""))}),this._pia=e,this},e.prototype.setCartridge=function(e){var t=this;return e.trap.addHandler(function(e){return t.triggerTrap(2,"CARTRIDGE: "+(e.message||""))}),this._cartridge=e,this},e.prototype.readWord=function(e){return this.read(e)|this.read(e+1&65535)<<8},e.prototype.read=function(e){return this._lastAddressBusValue=e,4096&(e&=8191)?(this._lastDataBusValue=this._cartridge.read(e),this.event.read.dispatch(2)):128&e?(this._lastDataBusValue=this._pia.read(e),this.event.read.dispatch(1)):(this._lastDataBusValue=this._tia.read(e),this.event.read.dispatch(0)),this._lastDataBusValue},e.prototype.write=function(e,t){this._lastDataBusValue=t,this._lastAddressBusValue=e,4096&(e&=8191)?(this._cartridge.write(e,t),this.event.write.dispatch(2)):128&e?(this._pia.write(e,t),this.event.write.dispatch(1)):(this._tia.write(e,t),this.event.write.dispatch(0))},e.prototype.peek=function(e){return 4096&(e&=8191)?this._cartridge.peek(e):128&e?this._pia.peek(e):this._tia.peek(e)},e.prototype.poke=function(e,t){},e.prototype.getLastDataBusValue=function(){return this._lastDataBusValue},e.prototype.getLastAddresBusValue=function(){return this._lastAddressBusValue},e.prototype.triggerTrap=function(t,i){if(!this.event.trap.hasHandlers)throw new Error(i);this.event.trap.dispatch(new e.TrapPayload(t,this,i))},e}();!function(e){!function(e){e[e.tia=0]="tia",e[e.pia=1]="pia",e[e.cartridge=2]="cartridge"}(e.TrapReason||(e.TrapReason={}));!function(e){e[e.tia=0]="tia",e[e.pia=1]="pia",e[e.cartridge=2]="cartridge"}(e.AccessType||(e.AccessType={}));var t=function(){return function(e,t,i){this.reason=e,this.bus=t,this.message=i}}();e.TrapPayload=t}(n||(n={})),i.default=n},{"microevent.ts":5}],28:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=!0),void 0===i&&(i=-1),void 0===r&&(r=!0),this.tvMode=e,this.enableAudio=t,this.randomSeed=i,this.emulatePaddles=r}return e.getClockMhz=function(e){switch(e.tvMode){case 0:return 3.579545;case 1:case 2:return 3.546894}},e}();!function(e){!function(e){e[e.ntsc=0]="ntsc",e[e.pal=1]="pal",e[e.secam=2]="secam"}(e.TvMode||(e.TvMode={}))}(r||(r={})),i.default=r},{}],29:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../io/Switch"),n=function(){function e(){this._selectSwitch=new r.default,this._resetButton=new r.default,this._colorSwitch=new r.default,this._difficutlyP0=new r.default,this._difficutlyP1=new r.default}return e.prototype.getSelectSwitch=function(){return this._selectSwitch},e.prototype.getResetButton=function(){return this._resetButton},e.prototype.getColorSwitch=function(){return this._colorSwitch},e.prototype.getDifficultySwitchP0=function(){return this._difficutlyP0},e.prototype.getDifficultySwitchP1=function(){return this._difficutlyP1},e}();i.default=n},{"../io/Switch":25}],30:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e,t,i,n){this._controlPanel=e,this._joystick0=t,this._joystick1=i,this._rng=n,this.trap=new r.Event,this.ram=new Uint8Array(128),this._bus=null,this._timerValue=255,this._subTimer=0,this._timerDivide=1024,this._interruptFlag=0,this._timerWrapped=!1,this._flagSetDuringThisCycle=!1,this.reset()}return e.prototype.reset=function(){for(var e=0;e<128;e++)this.ram[e]=this._rng?this._rng.int(255):0;this._interruptFlag=0,this._flagSetDuringThisCycle=!1,this._timerDivide=1024,this._subTimer=0,this._rng.int(255),this._timerValue=0,this._timerWrapped=!1},e.prototype.read=function(e){return 512&e?4&e?this._readTimer(e):this._readIo(e):this.ram[127&e]},e.prototype.peek=function(e){return 512&e?4&e?this._peekTimer(e):this._readIo(e):this.ram[127&e]},e.prototype.write=function(e,t){if(512&e)return 4&e?this._writeTimer(e,t):this._writeIo(e,t);this.ram[127&e]=t},e.prototype.cycle=function(){this._cycleTimer()},e.prototype.getDebugState=function(){return"divider: "+this._timerDivide+" raw timer: INTIM: "+this._timerValue},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype._writeIo=function(e,t){},e.prototype._writeTimer=function(e,t){switch(this._interruptFlag=0,663&e){case 663:return this._setTimer(1024,t);case 662:return this._setTimer(64,t);case 661:return this._setTimer(8,t);case 660:return this._setTimer(1,t)}},e.prototype._setTimer=function(e,t){this._timerDivide=e,this._timerValue=t,this._subTimer=0,this._timerWrapped=!1},e.prototype._readIo=function(e){switch(643&e){case 640:return(this._joystick1.getUp().read()?0:1)|(this._joystick1.getDown().read()?0:2)|(this._joystick1.getLeft().read()?0:4)|(this._joystick1.getRight().read()?0:8)|(this._joystick0.getUp().read()?0:16)|(this._joystick0.getDown().read()?0:32)|(this._joystick0.getLeft().read()?0:64)|(this._joystick0.getRight().read()?0:128);case 642:return(this._controlPanel.getResetButton().read()?0:1)|(this._controlPanel.getSelectSwitch().read()?0:2)|(this._controlPanel.getColorSwitch().read()?0:8)|(this._controlPanel.getDifficultySwitchP0().read()?0:64)|(this._controlPanel.getDifficultySwitchP1().read()?0:128)}return this._bus.getLastDataBusValue()},e.prototype._readTimer=function(e){return 1&e?128&this._interruptFlag:(this._flagSetDuringThisCycle||(this._interruptFlag=0,this._timerWrapped=!1),this._timerValue)},e.prototype._peekTimer=function(e){return 1&e?128&this._interruptFlag:this._timerValue},e.prototype._cycleTimer=function(){this._flagSetDuringThisCycle=!1,this._timerWrapped?this._timerValue=this._timerValue+255&255:0===this._subTimer&&--this._timerValue<0&&(this._timerValue=255,this._flagSetDuringThisCycle=!0,this._interruptFlag=255,this._timerWrapped=!0),++this._subTimer===this._timerDivide&&(this._subTimer=0)},e}();!function(e){!function(e){e[e.swcha=640]="swcha",e[e.swacnt=641]="swacnt",e[e.swchb=642]="swchb",e[e.swncnt=643]="swncnt",e[e.intim=644]="intim",e[e.instat=645]="instat",e[e.tim1t=660]="tim1t",e[e.tim8t=661]="tim8t",e[e.tim64t=662]="tim64t",e[e.t1024t=663]="t1024t"}(e.Registers||(e.Registers={}));!function(e){e[e.invalidRead=0]="invalidRead",e[e.invalidWrite=1]="invalidWrite"}(e.TrapReason||(e.TrapReason={}));var t=function(){return function(e,t,i){this.reason=e,this.pia=t,this.message=i}}();e.TrapPayload=t}(n||(n={})),i.default=n},{"microevent.ts":5}],31:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./CartridgeInterface"),s=e("./CartridgeInfo"),a=function(){function e(){this.trap=new r.Event}return e.prototype.reset=function(){},e.prototype.read=function(e){return 0},e.prototype.peek=function(e){return this.read(e)},e.prototype.write=function(e,t){},e.prototype.getType=function(){return s.default.CartridgeType.unknown},e.prototype.setCpu=function(e){return this},e.prototype.setBus=function(e){return this},e.prototype.notifyCpuCycleComplete=function(){},e.prototype.randomize=function(e){},e.prototype.triggerTrap=function(e,t){if(!this.trap.hasHandlers)throw new Error(t);this.trap.dispatch(new n.default.TrapPayload(e,this,t))},e}();i.default=a},{"./CartridgeInfo":49,"./CartridgeInterface":50,"microevent.ts":5}],32:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t){var i=e.call(this)||this;if(i._rom=new Uint8Array(2048),t.length>2048)throw new Error("buffer is not a 2k cartridge image: wrong length "+t.length);for(var r=0;r<t.length&&r<2048;r++)i._rom[2047-r]=t[t.length-1-r];return i}return r(t,e),t.prototype.read=function(e){return this._rom[2047&e]},t.prototype.getType=function(){return s.default.CartridgeType.vanilla_2k},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],33:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(e){function t(t){var i=e.call(this)||this;if(i._banks=null,i._ramSelect=!1,i._ramBanks=new Array(256),i._bus=null,0!=(2047&t.length))throw new Error("buffer length "+t.length+" is not a multiple of 2k");var r=t.length>>>11;if(r<2)throw new Error("image must have at least 2k");i._banks=new Array(r);for(n=0;n<r;n++)i._banks[n]=new Uint8Array(2048);for(n=0;n<=255;n++)i._ramBanks[n]=new Uint8Array(1024);i._ramBank=i._ramBanks[0],i._bank1=i._banks[r-1],i._bank0=i._banks[0];for(var n=0;n<2048;n++)for(var s=0;s<r;s++)i._banks[s][n]=t[2048*s+n];return i}return r(t,e),t.matchesBuffer=function(e){return s.searchForSignatures(e,[[133,62,169,0]])[0]>=1},t.prototype.reset=function(){this._bank0=this._banks[0]},t.prototype.randomize=function(e){for(var t=0;t<this._ramBanks.length;t++)for(var i=0;i<1024;i++)this._ramBanks[t][i]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.read=function(e){return e&=4095,this._ramSelect?e<1024?this._ramBank[e]:e<2048?this._ramBank[1023&e]=this._bus.getLastDataBusValue():this._bank1[2047&e]:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.peek=function(e){return e&=4095,this._ramSelect?e<1024?this._ramBank[e]:e<2048?this._bus.getLastDataBusValue():this._bank1[2047&e]:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.write=function(e,t){this._ramSelect&&(e&=4095)>=1024&&e<2048&&(this._ramBank[1023&e]=t)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_3E},t._onBusAccess=function(e,t){switch(t._bus.getLastAddresBusValue()){case 63:t._ramSelect=!1,t._bank0=t._banks[t._bus.getLastDataBusValue()%t._banks.length];break;case 62:t._ramSelect=!0,t._ramBank=t._ramBanks[t._bus.getLastDataBusValue()%32]}},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],34:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(e){function t(t){var i=e.call(this)||this;if(i._banks=new Array(4),i._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(r=0;r<4;r++)i._banks[r]=new Uint8Array(2048);i._bank1=i._banks[3],i._bank0=i._banks[0];for(var r=0;r<2048;r++)for(var n=0;n<4;n++)i._banks[n][r]=t[2048*n+r];return i}return r(t,e),t.matchesBuffer=function(e){return s.searchForSignatures(e,[[133,63]])[0]>=2},t.prototype.reset=function(){this._bank0=this._banks[0]},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.read=function(e){return(e&=4095)<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_3F},t._onBusAccess=function(e,t){63===t._bus.getLastAddresBusValue()&&(t._bank0=t._banks[3&t._bus.getLastDataBusValue()])},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],35:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t){var i=e.call(this)||this;i._rom=new Uint8Array(4096),4096!==t.length&&console.warn("buffer has invalid size for 4K image: "+t.length+" bytes");for(var r=Math.min(4096,t.length),n=0;n<4096&&n<t.length;n++)i._rom[4095-n]=t[r-1-n];return i}return r(t,e),t.prototype.read=function(e){return this._rom[4095&e]},t.prototype.getType=function(){return s.default.CartridgeType.vanilla_4k},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],36:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t){var i=e.call(this)||this;if(i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),i._fetcherData=new Uint8Array(2048),i._fetchers=new Array(8),i._rng=1,t.length<10240)throw new Error("buffer is not a DPC image: too small "+t.length);for(r=0;r<8;r++)i._fetchers[r]=new o;for(r=0;r<4096;r++)i._bank0[r]=t[r],i._bank1[r]=t[4096+r];for(var r=0;r<2048;r++)i._fetcherData[r]=t[8192+r];return i.reset(),i}return r(t,e),t.prototype.reset=function(){this._bank=this._bank1,this._rng=1,this._fetchers.forEach(function(e){return e.reset()})},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_DPC},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},t.prototype.peek=function(e){return this._bank[4095&e]},t.prototype.write=function(e,t){this._access(e,t)},t.prototype._access=function(e,t){if((e&=4095)>127){switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}return this._bank[e]}if(e<8)return 4&e?0:this._randomNext();if(e<64){var i=(n=this._fetchers[e-8&7]).mask,r=this._fetcherData[2047-n.pointer];switch(n.next(),e-8>>>3){case 0:return r;case 1:return r&i;case 2:return 255&((r&=i)<<4|r>>>4);case 3:return(1&(r&=i))<<7|(2&r)<<5|(4&r)<<3|(8&r)<<1|(16&r)>>>1|(32&r)>>>3|(64&r)>>>5|(128&r)>>>7;case 4:return(r&i)>>>1;case 5:return r<<1&i;case 6:return i}}if(e<96){var n=this._fetchers[e-64&7];switch(e-64>>>3){case 0:n.setStart(t);break;case 1:n.setEnd(t);break;case 2:n.setLow(t);break;case 3:n.setHigh(t),e>92&&n.setMusicMode(t)}return this._bank[e]}return e>=112&&e<120?(this._rng=1,this._bank[e]):this._bank[e]},t.prototype._randomNext=function(){var e=this._rng;return this._rng=255&(this._rng<<1|1&~(this._rng>>>7^this._rng>>>5^this._rng>>>4^this._rng>>>3)),e},t}(n.default),o=function(){function e(){this.pointer=0,this.start=0,this.end=0,this.musicMode=!1,this.mask=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.start=this.end=this.mask=0,this.musicMode=!1},e.prototype.next=function(){this.pointer=this.pointer+2047&2047,this._updateMask()},e.prototype.setStart=function(e){this.start=e,this.mask=0,this._updateMask()},e.prototype.setEnd=function(e){this.end=e,this._updateMask()},e.prototype.setLow=function(e){this.pointer=1792&this.pointer|e,this._updateMask()},e.prototype.setHigh=function(e){this.pointer=255&this.pointer|(7&e)<<8,this._updateMask()},e.prototype.setMusicMode=function(e){this.musicMode=0!=(16&e)},e.prototype._updateMask=function(){(255&this.pointer)===this.start&&(this.mask=255),(255&this.pointer)===this.end&&(this.mask=0)},e}();i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],37:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./thumbulator/Thumbulator"),u=(e("./CartridgeInterface"),e("./util")),c=e("../../../tools/hex");!function(e){e[e.returnAddress=32772]="returnAddress",e[e.trapReturn=255]="trapReturn"}(n||(n={}));var l=function(e){function t(t){var i=e.call(this)||this;if(i._romBuffer=new ArrayBuffer(32768),i._banks=new Array(6),i._ramBuffer=new ArrayBuffer(8192),i._fetchers=new Array(8),i._fractionalFetchers=new Array(8),i._parameters=new Uint8Array(8),i._parameterIndex=0,i._rng=0,i._fastFetch=!1,i._ldaPending=!1,i._thumbulatorBus={read16:function(e){if(1&e)i.triggerTrap(2,"unaligned 16 bit ARM read from "+c.encode(e,8,!1));else{var t=268435455&e;switch(e>>>28){case 0:if(t<32768)return i._rom16[t>>>1];break;case 4:if(t<8192)return i._ram16[t>>>1];break;case 14:switch(t){case 2080768:return i._armMamcr}}i.triggerTrap(2,"invalid 16 bit ARM read from "+c.encode(e,8,!1))}},read32:function(e){if(3&e)i.triggerTrap(2,"unaligned 32 bit ARM read from "+c.encode(e,8,!1));else{var t=268435455&e;switch(e>>>28){case 0:if(t<32768)return i._rom32[t>>>2];break;case 4:if(t<8192)return i._ram32[t>>>2];break;case 14:switch(t){case 32772:case 32776:return 0}}i.triggerTrap(2,"invalid 32 bit ARM read from "+c.encode(e,8,!1))}},write16:function(e,t){if(1&e)i.triggerTrap(2,"unaligned 16 bit ARM write: "+c.encode(t,4)+" -> "+c.encode(e,8,!1));else{var r=268435455&e;switch(e>>>28){case 4:if(r<8192)return void(i._ram16[r>>>1]=65535&t);break;case 14:switch(r){case 2080768:return void(i._armMamcr=t)}}i.triggerTrap(2,"invalid 16 bit ARM write: "+c.encode(t,4)+" -> "+c.encode(e,8,!1))}},write32:function(e,t){if(3&e)i.triggerTrap(2,"unaligned 32 bit ARM write: "+c.encode(t,8,!1)+" -> "+c.encode(e,8,!1));else{var r=268435455&e;switch(e>>>28){case 4:if(r<8192)return void(i._ram32[r>>>2]=t);case 14:switch(r){case 32772:case 32776:return}}i.triggerTrap(2,"invalid 32 bit ARM write: "+c.encode(t,8,!1)+" -> "+c.encode(e,8,!1))}}},i._armMamcr=0,i._thumbulator=new o.default(i._thumbulatorBus,{trapOnInstructionFetch:function(e){return 32772===e?255:0}}),t.length<28672||t.length>32768)throw new Error("not a DPC+ image: invalid lenght "+t.length);i._rom8=new Uint8Array(i._romBuffer),i._rom16=new Uint16Array(i._romBuffer),i._rom32=new Uint32Array(i._romBuffer),i._imageRom=new Uint8Array(i._romBuffer,27648,4096),i._frequencyRom=new Uint8Array(i._romBuffer,31744);for(s=0;s<6;s++)i._banks[s]=new Uint8Array(i._romBuffer,3072+4096*s,4096);i._ram8=new Uint8Array(i._ramBuffer),i._ram16=new Uint16Array(i._ramBuffer),i._ram32=new Uint32Array(i._ramBuffer),i._imageRam=new Uint8Array(i._ramBuffer,3072,4096),i._frequencyRam=new Uint8Array(i._ramBuffer,7168);for(var r=new Uint8Array(i._romBuffer),n=32768-t.length,s=0;s<t.length;s++)r[n+s]=t[s];for(s=0;s<8;s++)i._fetchers[s]=new h,i._fractionalFetchers[s]=new f;return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){return 2===u.searchForSignatures(e,["DPC+".split("").map(function(e){return e.charCodeAt(0)})])[0]},t.prototype.reset=function(){this._currentBank=this._banks[5];for(e=0;e<768;e++)this._ram32[e]=this._rom32[e];for(e=6912;e<8192;e++)this._ram32[768+e-6912]=this._rom32[e];this._currentBank=this._banks[5];for(var e=0;e<8;e++)this._parameters[e]=0;this._parameterIndex=0,this._fastFetch=this._ldaPending=!1,this._rng=725831748},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_dpc_plus},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype.read=function(e){return this._access(e,this._bus.getLastDataBusValue())},t.prototype.peek=function(e){return this._currentBank[4095&e]},t.prototype.write=function(e,t){this._access(e,t)},t.prototype._access=function(e,t){e&=4095;var i=this._currentBank[e];if(this._fastFetch&&this._ldaPending&&e>127&&e<4086&&i<40&&(e=i),this._ldaPending=!1,e<40){var r=7&e,n=this._fetchers[r],s=this._fractionalFetchers[r],a=0;switch(e>>>3&7){case 0:switch(r){case 0:return this._advanceRng(),255&this._rng;case 1:return this._rewindRng(),255&this._rng;case 2:return this._rng>>>8&255;case 3:return this._rng>>>16&255;case 4:return this._rng>>>24&255}return 0;case 1:return a=this._imageRam[n.pointer],n.increment(),a;case 2:return a=this._imageRam[n.pointer]&n.mask(),n.increment(),a;case 3:return a=this._imageRam[s.pointer>>>8],s.increment(),a;case 4:return r<4?n.mask():0;default:return 0}}else if(e<128){var r=7&e,n=this._fetchers[r],s=this._fractionalFetchers[r];switch(e-40>>>3&15){case 0:s.setPointerLo(t);break;case 1:s.setPointerHi(t);break;case 2:s.setFraction(t);break;case 3:n.top=t;break;case 4:n.bottom=t;break;case 5:n.setPointerLo(t);break;case 6:switch(r){case 0:this._fastFetch=0===t;break;case 1:this._parameterIndex<8&&(this._parameters[this._parameterIndex++]=t);break;case 2:this._dispatchFunction(t)}break;case 7:n.decrement(),this._imageRam[n.pointer]=t;break;case 8:n.setPointerHi(t);break;case 9:switch(r){case 0:this._rng=725831748;break;case 1:this._rng=4294967040&this._rng|t;break;case 2:this._rng=4294902015&this._rng|t<<8;break;case 3:this._rng=4278255615&this._rng|t<<16;break;case 4:this._rng=16777215&this._rng|t<<24}break;case 10:this._imageRam[n.pointer]=t,n.increment()}}else e>4085&&e<4092&&(this._currentBank=this._banks[e-4086]);return this._fastFetch&&e>127&&e<4086&&(this._ldaPending=169===i),i},t.prototype._dispatchFunction=function(e){var t=this._parameters[0]+(this._parameters[1]<<8);switch(e){case 0:this._parameterIndex=0;break;case 1:for(i=0;i<this._parameters[3];i++)this._ram8[3072+(this._fetchers[7&this._parameters[2]].pointer+i&4095)]=this._rom8[3072+(t+i)%29696];this._parameterIndex=0;break;case 2:for(var i=0;i<this._parameters[3];i++)this._ram8[3072+(this._fetchers[7&this._parameters[2]].pointer+i&4095)]=this._parameters[0];this._parameterIndex=0;break;case 254:case 255:this._dispatchArm()}},t.prototype._dispatchArm=function(){this._thumbulator.reset(),this._thumbulator.enableDebug(!1);for(var e=0;e<=12;e++)this._thumbulator.writeRegister(e,0);this._thumbulator.writeRegister(13,1073749940),this._thumbulator.writeRegister(14,32771),this._thumbulator.writeRegister(15,3083),this._armMamcr=0;var t=this._thumbulator.run(5e5);255!==t&&this.triggerTrap(2,"ARM execution trapped: "+t)},t.prototype._advanceRng=function(){this._rng=(1024&this._rng?279816990:0)^(this._rng>>>11|this._rng<<21)},t.prototype._rewindRng=function(){this._rng=this._rng&1<<31?(279816990^this._rng)<<11|(279816990^this._rng)>>>21:this._rng<<11|this._rng>>>21},t}(s.default),h=function(){function e(){this.pointer=0,this.top=0,this.bottom=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.top=this.bottom=0},e.prototype.setPointerHi=function(e){this.pointer=255&this.pointer|(15&e)<<8},e.prototype.setPointerLo=function(e){this.pointer=3840&this.pointer|255&e},e.prototype.increment=function(){this.pointer=this.pointer+1&4095},e.prototype.decrement=function(){this.pointer=this.pointer+4095&4095},e.prototype.mask=function(){return(this.top-(255&this.pointer)&255)>(this.top-this.bottom&255)?255:0},e}(),f=function(){function e(){this.pointer=0,this.fraction=0}return e.prototype.contructor=function(){this.reset()},e.prototype.reset=function(){this.pointer=this.fraction=0},e.prototype.setPointerHi=function(e){this.pointer=65535&this.pointer|(15&e)<<16},e.prototype.setPointerLo=function(e){this.pointer=983295&this.pointer|(255&e)<<8},e.prototype.setFraction=function(e){this.fraction=e,this.pointer&=1048320},e.prototype.increment=function(){this.pointer=this.pointer+this.fraction&1048575},e}();i.default=l},{"../../../tools/hex":73,"./AbstractCartridge":31,"./CartridgeInfo":49,"./CartridgeInterface":50,"./thumbulator/Thumbulator":55,"./util":57}],38:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./CartridgeInfo"),n=e("./CartridgeF8"),s=e("./CartridgeE0"),a=e("./Cartridge3F"),o=e("./Cartridge3E"),u=e("./CartridgeFE"),c=e("./CartridgeUA"),l=e("./CartridgeE7"),h=e("./CartridgeFA2"),f=e("./CartridgeDPCPlus"),_=function(){function e(){}return e.prototype.detectCartridgeType=function(e){if(e.length%8448==0)return r.default.CartridgeType.bankswitch_supercharger;if(e.length<=2048)return r.default.CartridgeType.vanilla_2k;if(e.length>=10240&&e.length<=10496)return r.default.CartridgeType.bankswitch_8k_DPC;switch(e.length){case 4096:return r.default.CartridgeType.vanilla_4k;case 8192:return this._detect8k(e);case 12288:return r.default.CartridgeType.bankswitch_12k_FA;case 16384:return this._detect16k(e);case 28672:return r.default.CartridgeType.bankswitch_FA2;case 29696:return this._detect29k(e);case 32768:return this._detect32k(e);case 65536:return r.default.CartridgeType.bankswitch_64k_F0;default:return r.default.CartridgeType.unknown}},e.prototype._detect8k=function(e){var t=n.default.matchesBuffer(e);return s.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_E0:a.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_3F:c.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_UA:!t&&u.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_8k_FE:r.default.CartridgeType.bankswitch_8k_F8},e.prototype._detect16k=function(e){return l.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_16k_E7:r.default.CartridgeType.bankswitch_16k_F6},e.prototype._detect29k=function(e){return h.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_FA2:r.default.CartridgeType.bankswitch_dpc_plus},e.prototype._detect32k=function(e){return o.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_3E:f.default.matchesBuffer(e)?r.default.CartridgeType.bankswitch_dpc_plus:r.default.CartridgeType.bankswitch_32k_F4},e}();i.default=_},{"./Cartridge3E":33,"./Cartridge3F":34,"./CartridgeDPCPlus":37,"./CartridgeE0":39,"./CartridgeE7":40,"./CartridgeF8":44,"./CartridgeFA2":46,"./CartridgeFE":47,"./CartridgeInfo":49,"./CartridgeUA":52}],39:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(e){function t(t){var i=e.call(this)||this;if(i._banks=new Array(8),i._activeBanks=new Array(4),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(r=0;r<8;r++)i._banks[r]=new Uint8Array(1024);for(var r=0;r<1024;r++)for(var n=0;n<8;n++)i._banks[n][r]=t[1024*n+r];return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){for(var t=s.searchForSignatures(e,[[141,224,31],[141,224,95],[141,233,255],[12,224,31],[173,224,31],[173,233,255],[173,237,255],[173,243,191]]),i=0;i<t.length;i++)if(t[i]>0)return!0;return!1},t.prototype.reset=function(){for(var e=0;e<4;e++)this._activeBanks[e]=this._banks[7]},t.prototype.read=function(e){return(e&=4095)>=4064&&e<4088&&this._handleBankswitch(e),this._activeBanks[e>>10][1023&e]},t.prototype.peek=function(e){return e&=4095,this._activeBanks[e>>10][1023&e]},t.prototype.write=function(t,i){var r=4095&t;return r>=4064&&r<4088&&this._handleBankswitch(r),e.prototype.write.call(this,t,i)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_8k_E0},t.prototype._handleBankswitch=function(e){e<4072?this._activeBanks[0]=this._banks[e-4064]:e<4080?this._activeBanks[1]=this._banks[e-4072]:this._activeBanks[2]=this._banks[e-4080]},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],40:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./util"),a=e("./CartridgeInfo"),o=function(e){function t(t){var i=e.call(this)||this;if(i._banks=new Array(8),i._ram0=new Uint8Array(1024),i._ram1Banks=new Array(4),i._ram0Enabled=!1,16384!==t.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+t.length);for(r=0;r<8;r++)i._banks[r]=new Uint8Array(2048);for(r=0;r<4;r++)i._ram1Banks[r]=new Uint8Array(256);for(var r=0;r<2048;r++)for(var n=0;n<8;n++)i._banks[n][r]=t[2048*n+r];return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){for(var t=s.searchForSignatures(e,[[173,226,255],[173,229,255],[173,229,31],[173,231,31],[12,231,31],[141,231,255],[141,231,31]]),i=0;i<t.length;i++)if(t[i]>0)return!0;return!1},t.prototype.reset=function(){this._bank0=this._banks[0],this._ram1=this._ram1Banks[0],this._ram0Enabled=!1},t.prototype.read=function(e){return this._handleBankswitch(4095&e),this.peek(e)},t.prototype.peek=function(e){return(e&=4095)<2048?this._ram0Enabled?e>=1024?this._ram0[e-1024]:0:this._bank0[e]:e<=2559?e>=2304?this._ram1[e-2304]:0:this._banks[7][2047-(4095-e)]},t.prototype.write=function(t,i){t&=4095,this._handleBankswitch(t),t<1024?this._ram0Enabled?this._ram0[t]=i:e.prototype.write.call(this,t,i):t<2048?e.prototype.write.call(this,t,i):t<2303?this._ram1[t-2048]=i:e.prototype.write.call(this,t,i)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_16k_E7},t.prototype.randomize=function(e){for(i=0;i<4;i++)for(var t=0;t<this._ram1Banks[i].length;t++)this._ram1Banks[i][t]=e.int(255);for(var i=0;i<this._ram0.length;i++)this._ram0[i]=e.int(255)},t.prototype._handleBankswitch=function(e){e<4064||(e<=4070?(this._bank0=this._banks[15&e],this._ram0Enabled=!1):4071===e?this._ram0Enabled=!0:e<=4075&&(this._ram1=this._ram1Banks[e-4072]))},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],41:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t){var i=e.call(this)||this;if(i._banks=new Array(16),i._bankIdx=0,65536!==t.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+t.length);for(r=0;r<16;r++)i._banks[r]=new Uint8Array(4096);for(var r=0;r<4096;r++)for(var n=0;n<16;n++)i._banks[n][r]=t[4096*n+r];return i.reset(),i}return r(t,e),t.prototype.reset=function(){this._bankIdx=0,this._currentBank=this._banks[this._bankIdx]},t.prototype.read=function(e){return e&=4095,this._handleBankswitch(e),this._currentBank[e]},t.prototype.peek=function(e){return this._currentBank[4095&e]},t.prototype.write=function(t,i){t&=4095,this._handleBankswitch(t),e.prototype.write.call(this,t,i)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_64k_F0},t.prototype._handleBankswitch=function(e){4080===e&&(this._bankIdx=this._bankIdx+1&15,this._currentBank=this._banks[this._bankIdx])},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],42:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t,i){void 0===i&&(i=!0);var r=e.call(this)||this;if(r._supportSC=i,r._bus=null,r._banks=new Array(8),r._ram=new Uint8Array(128),r._hasSC=!1,32768!==t.length)throw new Error("buffer is not a 32k cartridge image: wrong length "+t.length);for(n=0;n<8;n++)r._banks[n]=new Uint8Array(4096);for(var n=0;n<4096;n++)for(var s=0;s<8;s++)r._banks[s][n]=t[4096*s+n];return r.reset(),r}return r(t,e),t.prototype.reset=function(){this._bank=this._banks[0],this._hasSC=!1},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_32k_F4},t.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},t.prototype.peek=function(e){return e&=4095,this._hasSC&&e>=128&&e<256?this._ram[e-128]:this._bank[e]},t.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},t.prototype._access=function(e,t){e<128&&this._hasSC?this._ram[e]=t:e>=4084&&e<=4091&&(this._bank=this._banks[e-4084])},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],43:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t,i){void 0===i&&(i=!0);var r=e.call(this)||this;if(r._supportSC=i,r._bank=null,r._bank0=new Uint8Array(4096),r._bank1=new Uint8Array(4096),r._bank2=new Uint8Array(4096),r._bank3=new Uint8Array(4096),r._hasSC=!1,r._saraRAM=new Uint8Array(128),r._bus=null,16384!==t.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+t.length);for(var n=0;n<4096;n++)r._bank0[n]=t[n],r._bank1[n]=t[4096+n],r._bank2[n]=t[8192+n],r._bank3[n]=t[12288+n];return r.reset(),r}return r(t,e),t.prototype.reset=function(){this._bank=this._bank0,this._hasSC=!1},t.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},t.prototype.peek=function(e){return e&=4095,this._hasSC&&e>=128&&e<256?this._saraRAM[e-128]:this._bank[e]},t.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_16k_F6},t.prototype.randomize=function(e){for(var t=0;t<this._saraRAM.length;t++)this._saraRAM[t]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype._access=function(e,t){if(e<128&&this._hasSC)this._saraRAM[e]=255&t;else switch(e){case 4086:this._bank=this._bank0;break;case 4087:this._bank=this._bank1;break;case 4088:this._bank=this._bank2;break;case 4089:this._bank=this._bank3}},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],44:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(e){function t(t,i){void 0===i&&(i=!0);var r=e.call(this)||this;if(r._supportSC=i,r._bank=null,r._bank0=new Uint8Array(4096),r._bank1=new Uint8Array(4096),r._hasSC=!1,r._saraRAM=new Uint8Array(128),r._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var n=0;n<4096;n++)r._bank0[n]=t[n],r._bank1[n]=t[4096+n];return r.reset(),r}return r(t,e),t.matchesBuffer=function(e){return a.searchForSignatures(e,[[141,249,31]])[0]>=2},t.prototype.reset=function(){this._bank=this._bank1,this._hasSC=!1},t.prototype.read=function(e){return this._access(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},t.prototype.peek=function(e){return e&=4095,this._hasSC&&e>=128&&e<256?this._saraRAM[e-128]:this._bank[e]},t.prototype.write=function(e,t){(e&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(e,t)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_F8},t.prototype.randomize=function(e){for(var t=0;t<this._saraRAM.length;t++)this._saraRAM[t]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype._access=function(e,t){if(e<128&&this._hasSC)this._saraRAM[e]=255&t;else switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],45:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=function(e){function t(t){var i=e.call(this)||this;if(i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),i._bank2=new Uint8Array(4096),i._ram=new Uint8Array(256),12288!==t.length)throw new Error("buffer is not a 12k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)i._bank0[r]=t[r],i._bank1[r]=t[4096+r],i._bank2[r]=t[8192+r];return i.reset(),i}return r(t,e),t.prototype.reset=function(){this._bank=this._bank0},t.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},t.prototype.read=function(e){return this._handleBankswitch(4095&e),this.peek(e)},t.prototype.peek=function(e){return(e&=4095)>=256&&e<512?this._ram[255&e]:this._bank[e]},t.prototype.write=function(t,i){t&=4095,this._handleBankswitch(t),t<256?this._ram[t]=255&i:e.prototype.write.call(this,t,i)},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_12k_FA},t.prototype._handleBankswitch=function(e){switch(e){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1;break;case 4090:this._bank=this._bank2}},t}(n.default);i.default=a},{"./AbstractCartridge":31,"./CartridgeInfo":49}],46:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./util");!function(e){e[e.load=10]="load",e[e.save=100]="save"}(n||(n={}));var u=function(e){function t(t){var i=e.call(this)||this;if(i._banks=new Array(7),i._ram=new Uint8Array(256),i._savedRam=new Uint8Array(256),i._accessCounter=0,i._accessCounterLimit=0,28672!==t.length&&29696!==t.length)throw new Error("buffer is not a 28k/29k cartridge image: wrong length "+t.length);for(n=0;n<7;n++)i._banks[n]=new Uint8Array(4096);for(var r=28672===t.length?0:1024,n=0;n<4096;n++)for(var s=0;s<7;s++)i._banks[s][n]=t[4096*s+n+r];return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){var t=o.searchForSignatures(e,[[160,193,31,224],[0,128,2,224]]);return t[0]>0||t[1]>0},t.prototype.reset=function(){this._accessCounter=0,this._accessCounterLimit=0,this._bank=this._banks[0]},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_FA2},t.prototype.randomize=function(e){for(var t=0;t<this._ram.length;t++)this._ram[t]=e.int(255)},t.prototype.setBus=function(e){return this._bus=e,this},t.prototype.read=function(e){return this.write(4095&e,this._bus.getLastDataBusValue()),this.peek(e)},t.prototype.peek=function(e){return(e&=4095)>=256&&e<512?this._ram[e-256]:4084===e?this._accessCounter>=this._accessCounterLimit?-65&this._bank[e]:64|this._bank[e]:this._bank[e]},t.prototype.write=function(e,t){if(e&=4095,this._accessCounter++,!(e<256))return 4084===e?this._handleIo():void(e>=4085&&e<=4091&&(this._bank=this._banks[e-4085]));this._ram[e]=t},t.prototype._handleIo=function(){if(!(this._accessCounter<this._accessCounterLimit)){if(1===this._ram[255]){for(e=0;e<256;e++)this._ram[e]=this._savedRam[e];this._accessCounterLimit=10}else{if(2!==this._ram[255])return;for(var e=0;e<256;e++)this._savedRam[e]=this._ram[e];this._accessCounterLimit=100}this._accessCounter=0,this._ram[255]=0}},t}(s.default);i.default=u},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],47:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(e){function t(t){var i=e.call(this)||this;if(i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),i._lastAccessWasFE=!1,i._lastAddressBusValue=-1,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)i._bank0[r]=t[r],i._bank1[r]=t[4096+r];return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){for(var t=a.searchForSignatures(e,[[32,0,208,198,197],[32,195,248,165,130],[208,251,32,115,254],[32,0,240,132,214]]),i=0;i<t.length;i++)if(t[i]>0)return!0;return!1},t.prototype.reset=function(){this._bank=this._bank0,this._lastAccessWasFE=!1,this._lastAddressBusValue=-1},t.prototype.read=function(e){return this._bank[4095&e]},t.prototype.write=function(t,i){e.prototype.write.call(this,t,i)},t.prototype.setCpu=function(e){return this._cpu=e,this},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_FE},t._onBusAccess=function(e,t){var i=t._lastAddressBusValue;t._lastAddressBusValue=t._bus.getLastAddresBusValue(),t._lastAddressBusValue!==i&&(t._lastAccessWasFE&&(t._bank=(32&t._bus.getLastDataBusValue())>0?t._bank0:t._bank1),t._lastAccessWasFE=510===t._bus.getLastAddresBusValue())},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],48:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./Cartridge2k"),n=e("./Cartridge4k"),s=e("./CartridgeF8"),a=e("./CartridgeF6"),o=e("./CartridgeE0"),u=e("./CartridgeFE"),c=e("./Cartridge3F"),l=e("./Cartridge3E"),h=e("./CartridgeUA"),f=e("./CartridgeFA"),_=e("./CartridgeE7"),d=e("./CartridgeF0"),p=e("./CartridgeF4"),b=e("./CartridgeFA2"),g=e("./CartridgeSupercharger"),y=e("./CartridgeDPC"),m=e("./CartridgeDPCPlus"),k=e("./CartridgeInfo"),v=e("./CartridgeDetector"),w=function(){function e(){}return e.prototype.createCartridge=function(e,t){switch(void 0===t&&(t=(new v.default).detectCartridgeType(e)),t){case k.default.CartridgeType.vanilla_2k:return new r.default(e);case k.default.CartridgeType.vanilla_4k:return new n.default(e);case k.default.CartridgeType.bankswitch_8k_F8:return new s.default(e);case k.default.CartridgeType.bankswitch_8k_E0:return new o.default(e);case k.default.CartridgeType.bankswitch_8k_3F:return new c.default(e);case k.default.CartridgeType.bankswitch_8k_FE:return new u.default(e);case k.default.CartridgeType.bankswitch_8k_UA:return new h.default(e);case k.default.CartridgeType.bankswitch_8k_DPC:return new y.default(e);case k.default.CartridgeType.bankswitch_12k_FA:return new f.default(e);case k.default.CartridgeType.bankswitch_16k_F6:return new a.default(e);case k.default.CartridgeType.bankswitch_16k_E7:return new _.default(e);case k.default.CartridgeType.bankswitch_FA2:return new b.default(e);case k.default.CartridgeType.bankswitch_32k_F4:return new p.default(e);case k.default.CartridgeType.bankswitch_64k_F0:return new d.default(e);case k.default.CartridgeType.bankswitch_3E:return new l.default(e);case k.default.CartridgeType.bankswitch_supercharger:return new g.default(e);case k.default.CartridgeType.bankswitch_dpc_plus:return new m.default(e);default:throw new Error("invalid or unsupported cartridge image")}},e}();i.default=w},{"./Cartridge2k":32,"./Cartridge3E":33,"./Cartridge3F":34,"./Cartridge4k":35,"./CartridgeDPC":36,"./CartridgeDPCPlus":37,"./CartridgeDetector":38,"./CartridgeE0":39,"./CartridgeE7":40,"./CartridgeF0":41,"./CartridgeF4":42,"./CartridgeF6":43,"./CartridgeF8":44,"./CartridgeFA":45,"./CartridgeFA2":46,"./CartridgeFE":47,"./CartridgeInfo":49,"./CartridgeSupercharger":51,"./CartridgeUA":52}],49:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){var t;!function(e){e[e.vanilla_2k=0]="vanilla_2k",e[e.vanilla_4k=1]="vanilla_4k",e[e.bankswitch_8k_F8=2]="bankswitch_8k_F8",e[e.bankswitch_8k_E0=3]="bankswitch_8k_E0",e[e.bankswitch_8k_3F=4]="bankswitch_8k_3F",e[e.bankswitch_8k_FE=5]="bankswitch_8k_FE",e[e.bankswitch_8k_UA=6]="bankswitch_8k_UA",e[e.bankswitch_8k_DPC=7]="bankswitch_8k_DPC",e[e.bankswitch_12k_FA=8]="bankswitch_12k_FA",e[e.bankswitch_16k_F6=9]="bankswitch_16k_F6",e[e.bankswitch_16k_E7=10]="bankswitch_16k_E7",e[e.bankswitch_FA2=11]="bankswitch_FA2",e[e.bankswitch_32k_F4=12]="bankswitch_32k_F4",e[e.bankswitch_64k_F0=13]="bankswitch_64k_F0",e[e.bankswitch_3E=14]="bankswitch_3E",e[e.bankswitch_supercharger=15]="bankswitch_supercharger",e[e.bankswitch_dpc_plus=16]="bankswitch_dpc_plus",e[e.unknown=17]="unknown"}(t=e.CartridgeType||(e.CartridgeType={})),e.getAllTypes=function(){return[t.vanilla_2k,t.vanilla_4k,t.bankswitch_8k_F8,t.bankswitch_8k_E0,t.bankswitch_8k_3F,t.bankswitch_8k_FE,t.bankswitch_8k_UA,t.bankswitch_12k_FA,t.bankswitch_8k_DPC,t.bankswitch_16k_F6,t.bankswitch_16k_E7,t.bankswitch_FA2,t.bankswitch_32k_F4,t.bankswitch_3E,t.bankswitch_64k_F0,t.bankswitch_supercharger,t.bankswitch_dpc_plus,t.unknown]},e.describeCartridgeType=function(e){switch(e){case t.vanilla_2k:return"plain 2k";case t.vanilla_4k:return"plain 4k";case t.bankswitch_8k_F8:return"bankswitched 8k, F8 (Atari) scheme";case t.bankswitch_8k_E0:return"bankswitched 8k, E0 (Parker Bros.) scheme";case t.bankswitch_8k_3F:return"bankswitched 8k, 3F (Tigervision) scheme";case t.bankswitch_8k_FE:return"bankswitched 8k, FE (Activision) scheme";case t.bankswitch_8k_UA:return"bankswitched 8k, UA (Pleiades) scheme";case t.bankswitch_12k_FA:return"bankswitched 12k, FA (CBS) scheme";case t.bankswitch_8k_DPC:return"bankswitched 8k + DPC";case t.bankswitch_16k_F6:return"bankswitched 16k, F6 (Atari) scheme";case t.bankswitch_16k_E7:return"bankswitched 16k, E7 (M-Network) scheme";case t.bankswitch_FA2:return"bankswitched 28k/29k, FA2 (modified CBS) scheme";case t.bankswitch_32k_F4:return"bankswitched 32k, F4 (Atari) scheme";case t.bankswitch_3E:return"bankswitched 3E (Tigervision + RAM) scheme";case t.bankswitch_64k_F0:return"bankswitched 64k, F0 (Megaboy) scheme";case t.bankswitch_supercharger:return"bankswitched supercharger";case t.bankswitch_dpc_plus:return"bankswitched DPC+";case t.unknown:return"unknown"}}}(r||(r={})),i.default=r},{}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){!function(e){e[e.invalidRead=0]="invalidRead",e[e.invalidWrite=1]="invalidWrite",e[e.other=2]="other"}(e.TrapReason||(e.TrapReason={}));var t=function(){return function(e,t,i){this.reason=e,this.cartridge=t,this.message=i}}();e.TrapPayload=t}(r||(r={})),i.default=r},{}],51:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./AbstractCartridge"),a=e("./CartridgeInfo"),o=e("./supercharger/Header"),u=e("./supercharger/blob");!function(e){e[e.ram=0]="ram",e[e.rom=1]="rom"}(n||(n={}));var c=function(e){function t(t,i){void 0===i&&(i=!0);var r=e.call(this)||this;if(r._showLoadingBars=i,r._loadCount=0,r._loads=null,r._headers=null,r._rom=new Uint8Array(2048),r._ramBanks=new Array(3),r._bank0=null,r._bank1=null,r._bank1Type=1,r._transitionCount=0,r._pendingWriteData=0,r._pendingWrite=!1,r._lastAddressBusValue=-1,r._writeRamEnabled=!1,t.length%8448!=0)throw new Error("not a supercharger image --- invalid size");r._loadCount=t.length/8448,r._loads=new Array(r._loadCount),r._headers=new Array(r._loadCount);for(s=0;s<r._loadCount;s++)r._loads[s]=new Uint8Array(8448);for(s=0;s<8448;s++)for(var n=0;n<r._loadCount;n++)r._loads[n][s]=t[8448*n+s];for(s=0;s<r._loadCount;s++)r._headers[s]=new o.default(r._loads[s]),r._headers[s].verify()||console.log("load "+s+" has invalid checksum");for(var s=0;s<3;s++)r._ramBanks[s]=new Uint8Array(2048);return r._loadBios(),r.reset(),r}return r(t,e),t.prototype.reset=function(){this._setBankswitchMode(0),this._transitionCount=0,this._pendingWrite=!1,this._pendingWriteData=0,this._lastAddressBusValue=-1,this._writeRamEnabled=!1},t.prototype.setBus=function(e){return this._bus=e,this._bus.event.read.addHandler(t._onBusAccess,this),this._bus.event.write.addHandler(t._onBusAccess,this),this},t.prototype.read=function(e){2128===(e&=4095)&&1===this._bank1Type&&this._loadIntoRam(this._bus.peek(128));var t=this._access(e,this._bus.getLastDataBusValue());return t>=0?t:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.peek=function(e){return e&=4095,this._pendingWrite&&this._writeRamEnabled&&5===this._transitionCount?this._pendingWriteData:e<2048?this._bank0[e]:this._bank1[2047&e]},t.prototype.write=function(e,t){this._access(e,t)},t.prototype.getType=function(){return a.default.CartridgeType.bankswitch_supercharger},t._onBusAccess=function(e,t){var i=t._bus.getLastAddresBusValue();i!==t._lastAddressBusValue&&(++t._transitionCount>5&&(t._pendingWrite=!1),t._lastAddressBusValue=i)},t.prototype._access=function(e,t){return 0!=(3840&(e&=4095))||this._pendingWrite&&this._writeRamEnabled?4088===e?(this._setBankswitchMode((28&this._pendingWriteData)>>>2),this._writeRamEnabled=(2&this._pendingWriteData)>0,this._pendingWrite=!1,-1):this._pendingWrite&&this._writeRamEnabled&&5===this._transitionCount?(e<2048?this._bank0[e]=this._pendingWriteData:0===this._bank1Type&&(this._bank1[2047&e]=this._pendingWriteData),this._pendingWrite=!1,this._pendingWriteData):-1:(this._pendingWriteData=255&e,this._transitionCount=0,this._pendingWrite=!0,-1)},t.prototype._setBankswitchMode=function(e){switch(e){case 0:return this._configureBanks(2,1);case 1:return this._configureBanks(0,1);case 2:return this._configureBanks(2,0,0);case 3:return this._configureBanks(0,0,2);case 4:return this._configureBanks(2,1);case 5:return this._configureBanks(1,1);case 6:return this._configureBanks(2,0,1);case 7:return this._configureBanks(1,0,2);default:throw new Error("invalid bankswitching mode")}},t.prototype._configureBanks=function(e,t,i){void 0===i&&(i=0),this._bank0=this._ramBanks[e],this._bank1Type=t,this._bank1=0===t?this._ramBanks[i]:this._rom},t.prototype._loadBios=function(){for(var e=0;e<2048;e++)this._rom[e]=e<u.bios.length?u.bios[e]:2;this._rom[109]=this._showLoadingBars?0:255,this._rom[2047]=this._rom[2045]=248,this._rom[2046]=this._rom[2044]=10},t.prototype._loadIntoRam=function(e){var t;for(t=0;t<this._loadCount&&(this._headers[t].multiloadId!==e&&1!==this._loadCount);t++);t>=this._loadCount&&console.log("no load with id "+e);for(var i=this._headers[t],r=this._loads[t],n=0;n<i.blockCount;n++){var s=i.blockLocation[n],a=3&s;a>2&&(a=0,console.log("invalid bank for block "+n+", load "+t));for(var o=256*((28&s)>>>2),u=s+i.blockChecksum[n],c=0;c<256;c++)u+=r[256*n+c],this._ramBanks[a][o+c]=r[256*n+c];85!=(255&u)&&console.log("load "+t+", block "+n+": invalid checksum")}this._bus.write(254,i.startAddressLow),this._bus.write(255,i.startAddressHigh),this._bus.write(128,i.controlWord)},t}(s.default);i.default=c},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./supercharger/Header":53,"./supercharger/blob":54}],52:[function(e,t,i){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=e("./AbstractCartridge"),s=e("./CartridgeInfo"),a=e("./util"),o=function(e){function t(t){var i=e.call(this)||this;if(i._bus=null,i._bank=null,i._bank0=new Uint8Array(4096),i._bank1=new Uint8Array(4096),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(var r=0;r<4096;r++)i._bank0[r]=t[r],i._bank1[r]=t[4096+r];return i.reset(),i}return r(t,e),t.matchesBuffer=function(e){for(var t=a.searchForSignatures(e,[[141,64,2],[173,64,2],[189,31,2]]),i=0;i<t.length;i++)if(t[i]>0)return!0;return!1},t.prototype.reset=function(){this._bank=this._bank0},t.prototype.read=function(e){return this._bank[4095&e]},t.prototype.setBus=function(e){return this._bus=e,e.event.read.addHandler(t._onBusAccess,this),e.event.write.addHandler(t._onBusAccess,this),this},t.prototype.getType=function(){return s.default.CartridgeType.bankswitch_8k_UA},t._onBusAccess=function(e,t){switch(t._bus.getLastAddresBusValue()){case 544:t._bank=t._bank0;break;case 576:t._bank=t._bank1}},t}(n.default);i.default=o},{"./AbstractCartridge":31,"./CartridgeInfo":49,"./util":57}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this.blockLocation=null,this.blockChecksum=null,this.startAddressLow=e[8192],this.startAddressHigh=e[8193],this.controlWord=e[8194],this.blockCount=e[8195],this.checksum=e[8196],this.multiloadId=e[8197],this.progressBarSpeedLow=e[8198],this.progressBarSpeedHigh=e[8199],this.blockLocation=new Uint8Array(this.blockCount),this.blockChecksum=new Uint8Array(this.blockCount);for(var t=0;t<this.blockCount;t++)this.blockLocation[t]=e[8208+t],this.blockChecksum[t]=e[8256+t]}return e.prototype.verify=function(){return 85==(255&this.startAddressLow+this.startAddressHigh+this.controlWord+this.blockCount+this.checksum+this.multiloadId+this.progressBarSpeedLow+this.progressBarSpeedHigh)},e}();i.default=r},{}],54:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.bios=new Uint8Array([165,250,133,128,76,24,248,255,255,255,120,216,160,0,162,0,148,0,232,208,251,76,80,248,162,0,189,6,240,173,248,255,162,0,173,0,240,234,189,0,247,202,208,246,76,80,248,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,162,3,188,34,249,148,250,202,16,248,160,0,162,40,148,4,202,16,251,162,28,148,129,202,16,251,169,255,201,0,208,3,76,19,249,169,0,133,27,133,28,133,29,133,30,133,31,133,25,133,26,133,8,133,1,169,16,133,33,133,2,162,7,202,202,208,253,169,0,133,32,133,16,133,17,133,2,133,42,169,5,133,10,169,255,133,13,133,14,133,15,133,132,133,133,169,240,133,131,169,116,133,9,169,12,133,21,169,31,133,23,133,130,169,7,133,25,162,8,160,0,133,2,136,208,251,133,2,133,2,169,2,133,2,133,0,133,2,133,2,133,2,169,0,133,0,202,16,228,6,131,102,132,38,133,165,131,133,13,165,132,133,14,165,133,133,15,166,130,202,134,130,134,23,224,10,208,195,169,2,133,1,162,28,160,0,132,25,132,9,148,129,202,16,251,166,128,221,0,240,169,154,162,255,160,0,154,76,250,0,205,248,255,76]),i.defaultHeader=new Uint8Array([172,250,15,24,98,0,36,2,255,255,255,255,255,255,255,255,0,4,8,12,16,20,24,28,1,5,9,13,17,21,25,29,2,6,10,14,18,22,26,30,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0])},{}],55:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./native/thumbulator"),n=function(){function e(e,t){void 0===t&&(t={}),this._module=null,this._module=r(this._getApi(e,t)),this.enableDebug(!1)}return e.prototype.run=function(e){return this._module._run(e)},e.prototype.enableDebug=function(e){this._module._enable_debug(e?1:0)},e.prototype.reset=function(){this._module._reset()},e.prototype.readRegister=function(e){if(e<0||e>15)throw new Error("illegal thumb register "+e);return this._module._read_register(e)},e.prototype.writeRegister=function(e,t){if(e<0||e>15)throw new Error("illegal thumb register "+e);this._module._write_register(e,t)},e.prototype._getApi=function(e,t){var i=t.printer||function(e){return console.log("thumbulator: "+e)};return{print:i,printErr:i,trapOnInstructionFetch:t.trapOnInstructionFetch||function(){return 0},busRead16:e.read16,busRead32:e.read32||function(t){return 65535&e.read16(t)|e.read16(t+2)<<16},busWrite16:e.write16,busWrite32:e.write32||function(t,i){return e.write16(t,65535&i),e.write16(t+2,i>>>16)}}},e}();!function(e){!function(e){e[e.noTrap=0]="noTrap",e[e.breakpoint=1]="breakpoint",e[e.blxLeaveThumb=2]="blxLeaveThumb",e[e.bxLeaveThumb=3]="bxLeaveThumb"}(e.TrapReason||(e.TrapReason={}))}(n||(n={})),i.default=n},{"./native/thumbulator":56}],56:[function(require,module,exports){(function(process){var Module=function(Module){function globalEval(e){eval.call(null,e)}function assert(e,t){e||abort("Assertion failed: "+t)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(e){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(e,t,i,r){switch("*"===(i=i||"i8").charAt(i.length-1)&&(i="i32"),i){case"i1":case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,+Math_abs(tempDouble)>=1?tempDouble>0?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+i)}}function getValue(e,t,i){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}function allocate(e,t,i,r){var n,s;"number"==typeof e?(n=!0,s=e):(n=!1,s=e.length);var a,o="string"==typeof t?t:null;if(a=i==ALLOC_NONE?r:["function"==typeof _malloc?_malloc:Runtime.staticAlloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===i?ALLOC_STATIC:i](Math.max(s,o?1:t.length)),n){var u,r=a;for(assert(0==(3&a)),u=a+(-4&s);r<u;r+=4)HEAP32[r>>2]=0;for(u=a+s;r<u;)HEAP8[r++>>0]=0;return a}if("i8"===o)return e.subarray||e.slice?HEAPU8.set(e,a):HEAPU8.set(new Uint8Array(e),a),a;for(var c,l,h,f=0;f<s;){var _=e[f];"function"==typeof _&&(_=Runtime.getFunctionIndex(_)),0!==(c=o||t[f])?("i64"==c&&(c="i32"),setValue(a+f,_,c),h!==c&&(l=Runtime.getNativeTypeSize(c),h=c),f+=l):f++}return a}function getMemory(e){return staticSealed?runtimeInitialized?_malloc(e):Runtime.dynamicAlloc(e):Runtime.staticAlloc(e)}function Pointer_stringify(e,t){if(0===t||!e)return"";for(var i,r=0,n=0;;){if(i=HEAPU8[e+n>>0],r|=i,0==i&&!t)break;if(n++,t&&n==t)break}t||(t=n);var s="";if(r<128){for(var a;t>0;)a=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,1024))),s=s?s+a:a,e+=1024,t-=1024;return s}return Module.UTF8ToString(e)}function AsciiToString(e){for(var t="";;){var i=HEAP8[e++>>0];if(!i)return t;t+=String.fromCharCode(i)}}function stringToAscii(e,t){return writeAsciiToMemory(e,t,!1)}function UTF8ArrayToString(e,t){for(var i=t;e[i];)++i;if(i-t>16&&e.subarray&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(t,i));for(var r,n,s,a,o,u="";;){if(!(r=e[t++]))return u;if(128&r)if(n=63&e[t++],192!=(224&r))if(s=63&e[t++],224==(240&r)?r=(15&r)<<12|n<<6|s:(a=63&e[t++],240==(248&r)?r=(7&r)<<18|n<<12|s<<6|a:(o=63&e[t++],r=248==(252&r)?(3&r)<<24|n<<18|s<<12|a<<6|o:(1&r)<<30|n<<24|s<<18|a<<12|o<<6|63&e[t++])),r<65536)u+=String.fromCharCode(r);else{var c=r-65536;u+=String.fromCharCode(55296|c>>10,56320|1023&c)}else u+=String.fromCharCode((31&r)<<6|n);else u+=String.fromCharCode(r)}}function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}function stringToUTF8Array(e,t,i,r){if(!(r>0))return 0;for(var n=i,s=i+r-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(i>=s)break;t[i++]=o}else if(o<=2047){if(i+1>=s)break;t[i++]=192|o>>6,t[i++]=128|63&o}else if(o<=65535){if(i+2>=s)break;t[i++]=224|o>>12,t[i++]=128|o>>6&63,t[i++]=128|63&o}else if(o<=2097151){if(i+3>=s)break;t[i++]=240|o>>18,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}else if(o<=67108863){if(i+4>=s)break;t[i++]=248|o>>24,t[i++]=128|o>>18&63,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}else{if(i+5>=s)break;t[i++]=252|o>>30,t[i++]=128|o>>24&63,t[i++]=128|o>>18&63,t[i++]=128|o>>12&63,t[i++]=128|o>>6&63,t[i++]=128|63&o}}return t[i]=0,i-n}function stringToUTF8(e,t,i){return stringToUTF8Array(e,HEAPU8,t,i)}function lengthBytesUTF8(e){for(var t=0,i=0;i<e.length;++i){var r=e.charCodeAt(i);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++i)),r<=127?++t:t+=r<=2047?2:r<=65535?3:r<=2097151?4:r<=67108863?5:6}return t}function demangle(e){if(!!Module.___cxa_demangle){try{var t=e.substr(1),i=lengthBytesUTF8(t)+1,r=_malloc(i);stringToUTF8(t,r,i);var n=_malloc(4),s=Module.___cxa_demangle(r,0,0,n);if(0===getValue(n,"i32")&&s)return Pointer_stringify(s)}catch(e){}finally{r&&_free(r),n&&_free(n),s&&_free(s)}return e}return Runtime.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function stackTrace(){var e=jsStackTrace();return Module.extraStackTrace&&(e+="\n"+Module.extraStackTrace()),demangleAll(e)}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){abortOnCannotGrowMemory()}function getTotalMemory(){return TOTAL_MEMORY}function callRuntimeCallbacks(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?Runtime.dynCall("v",i):Runtime.dynCall("vi",i,[t.arg]):i(void 0===t.arg?null:t.arg)}else t()}}function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}function addOnInit(e){__ATINIT__.unshift(e)}function addOnPreMain(e){__ATMAIN__.unshift(e)}function addOnExit(e){__ATEXIT__.unshift(e)}function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}function intArrayFromString(e,t,i){var r=i>0?i:lengthBytesUTF8(e)+1,n=new Array(r),s=stringToUTF8Array(e,n,0,n.length);return t&&(n.length=s),n}function intArrayToString(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];r>255&&(r&=255),t.push(String.fromCharCode(r))}return t.join("")}function writeStringToMemory(e,t,i){Runtime.warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!");var r,n;i&&(n=t+lengthBytesUTF8(e),r=HEAP8[n]),stringToUTF8(e,t,1/0),i&&(HEAP8[n]=r)}function writeArrayToMemory(e,t){HEAP8.set(e,t)}function writeAsciiToMemory(e,t,i){for(var r=0;r<e.length;++r)HEAP8[t++>>0]=e.charCodeAt(r);i||(HEAP8[t>>0]=0)}function addRunDependency(e){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var t=dependenciesFulfilled;dependenciesFulfilled=null,t()}}function _emscripten_asm_const_ii(e,t){return ASM_CONSTS[e](t)}function _emscripten_asm_const_iii(e,t,i){return ASM_CONSTS[e](t,i)}function __exit(e){Module.exit(e)}function _exit(e){__exit(e)}function _pthread_cleanup_push(e,t){__ATEXIT__.push(function(){Runtime.dynCall("vi",e,[t])}),_pthread_cleanup_push.level=__ATEXIT__.length}function _pthread_cleanup_pop(){assert(_pthread_cleanup_push.level==__ATEXIT__.length,"cannot pop if something else added meanwhile!"),__ATEXIT__.pop(),_pthread_cleanup_push.level=__ATEXIT__.length}function _abort(){Module.abort()}function _emscripten_memcpy_big(e,t,i){return HEAPU8.set(HEAPU8.subarray(t,t+i),e),e}function ___syscall6(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.getStreamFromFD();return FS.close(i),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___setErrNo(e){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=e),e}function ___syscall140(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.getStreamFromFD(),r=SYSCALLS.get(),n=SYSCALLS.get(),s=SYSCALLS.get(),a=SYSCALLS.get(),o=n;return assert(0===r),FS.llseek(i,o,a),HEAP32[s>>2]=i.position,i.getdents&&0===o&&0===a&&(i.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___syscall146(e,t){SYSCALLS.varargs=t;try{var i=SYSCALLS.get(),r=SYSCALLS.get(),n=SYSCALLS.get(),s=0;___syscall146.buffer||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(e,t){var i=___syscall146.buffers[e];assert(i),0===t||10===t?((1===e?Module.print:Module.printErr)(UTF8ArrayToString(i,0)),i.length=0):i.push(t)});for(var a=0;a<n;a++){for(var o=HEAP32[r+8*a>>2],u=HEAP32[r+(8*a+4)>>2],c=0;c<u;c++)___syscall146.printChar(i,HEAPU8[o+c]);s+=u}return s}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function invoke_ii(e,t){try{return Module.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;asm.setThrew(1,0)}}function invoke_iiii(e,t,i,r){try{return Module.dynCall_iiii(e,t,i,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;asm.setThrew(1,0)}}function invoke_vi(e,t){try{Module.dynCall_vi(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;asm.setThrew(1,0)}}function ExitStatus(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function run(e){function t(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(e),postRun()))}e=e||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),runDependencies>0||(preRun(),runDependencies>0||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),t()},1)):t()))}function exit(e,t){if(!t||!Module.noExitRuntime)throw Module.noExitRuntime||(ABORT=!0,EXITSTATUS=e,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(e)),ENVIRONMENT_IS_NODE?process.exit(e):ENVIRONMENT_IS_SHELL&&"function"==typeof quit&&quit(e),new ExitStatus(e)}function abort(e){void 0!==e?(Module.print(e),Module.printErr(e),e=JSON.stringify(e)):e="",ABORT=!0,EXITSTATUS=1;var t="abort("+e+") at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw abortDecorators&&abortDecorators.forEach(function(i){t=i(t,e)}),t}Module=Module||{};var Module=Module,Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"function"==typeof require&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){Module.print||(Module.print=console.log),Module.printErr||(Module.printErr=console.warn);var nodeFS,nodePath;Module.read=function(e,t){nodeFS||nodePath||(nodePath=require("path")),e=nodePath.normalize(e);var i=nodeFS.readFileSync(e);return t?i:i.toString()},Module.readBinary=function(e){var t=Module.read(e,!0);return t.buffer||(t=new Uint8Array(t)),assert(t.buffer),t},Module.load=function(e){globalEval(read(e))},Module.thisProgram||(process.argv.length>1?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),void 0!==module&&(module.exports=Module),process.on("uncaughtException",function(e){if(!(e instanceof ExitStatus))throw e}),Module.inspect=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available"},Module.readBinary=function(e){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));var t=read(e,"binary");return assert("object"==typeof t),t},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments);else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},Module.readAsync=function(e,t,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):i()},r.onerror=i,r.send(null)},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(e){console.log(e)}),Module.printErr||(Module.printErr=function(e){console.warn(e)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(e){dump(e)}:function(e){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),void 0===Module.setWindowTitle&&(Module.setWindowTitle=function(e){document.title=e})}!Module.load&&Module.read&&(Module.load=function(e){globalEval(Module.read(e))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[];for(var key in moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var Runtime={setTempRet0:function(e){tempRet0=e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return Runtime.QUANTUM_SIZE;if("i"===e[0]){var t=parseInt(e.substr(1));return assert(t%8==0),t/8}return 0}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},getAlignSize:function(e,t,i){return i||"i64"!=e&&"double"!=e?e?Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE):Math.min(t,8):8},dynCall:function(e,t,i){return i&&i.length?Module["dynCall_"+e].apply(null,[t].concat(i)):Module["dynCall_"+e].call(null,t)},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++)if(!Runtime.functionPointers[t])return Runtime.functionPointers[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[e]||(Runtime.warnOnce.shown[e]=1,Module.printErr(e))},funcWrappers:{},getFuncWrapper:function(e,t){assert(t),Runtime.funcWrappers[t]||(Runtime.funcWrappers[t]={});var i=Runtime.funcWrappers[t];return i[e]||(1===t.length?i[e]=function(){return Runtime.dynCall(t,e)}:2===t.length?i[e]=function(i){return Runtime.dynCall(t,e,[i])}:i[e]=function(){return Runtime.dynCall(t,e,Array.prototype.slice.call(arguments))}),i[e]},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;return STACKTOP=STACKTOP+e|0,STACKTOP=STACKTOP+15&-16,t},staticAlloc:function(e){var t=STATICTOP;return STATICTOP=STATICTOP+e|0,STATICTOP=STATICTOP+15&-16,t},dynamicAlloc:function(e){var t=HEAP32[DYNAMICTOP_PTR>>2],i=-16&(t+e+15|0);return HEAP32[DYNAMICTOP_PTR>>2]=i,i>=TOTAL_MEMORY&&!enlargeMemory()?(HEAP32[DYNAMICTOP_PTR>>2]=t,0):t},alignMemory:function(e,t){return e=Math.ceil(e/(t||16))*(t||16)},makeBigInt:function(e,t,i){return i?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=0,EXITSTATUS=0,cwrap,ccall;!function(){function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}function ensureJSsource(){if(!JSsource){JSsource={};for(var e in JSfuncs)JSfuncs.hasOwnProperty(e)&&(JSsource[e]=parseJSFunc(JSfuncs[e]))}}var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);return writeArrayToMemory(e,t),t},stringToC:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);stringToUTF8(e,t=Runtime.stackAlloc(i),i)}return t}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(e,t,i,r,n){var s=getCFunc(e),a=[],o=0;if(r)for(var u=0;u<r.length;u++){var c=toC[i[u]];c?(0===o&&(o=Runtime.stackSave()),a[u]=c(r[u])):a[u]=r[u]}var l=s.apply(null,a);if("string"===t&&(l=Pointer_stringify(l)),0!==o){if(n&&n.async)return void EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(o)});Runtime.stackRestore(o)}return l};var sourceRegex=/^function\s*[a-zA-Z$_0-9]*\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/,JSsource=null;cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(e){return"number"===e}),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(e,t){return"$"+t}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){ensureJSsource(),funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"=("+convertCode.returnValue+");"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(ensureJSsource(),funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.ccall=ccall,Module.cwrap=cwrap,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.getMemory=getMemory,Module.Pointer_stringify=Pointer_stringify,Module.AsciiToString=AsciiToString,Module.stringToAscii=stringToAscii;var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;Module.UTF8ArrayToString=UTF8ArrayToString,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8Array=stringToUTF8Array,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8;var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;Module.stackTrace=stackTrace;var HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR;STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1;for(var TOTAL_STACK=Module.TOTAL_STACK||10240,TOTAL_MEMORY=Module.TOTAL_MEMORY||1048576,WASM_PAGE_SIZE=65536,totalMemory=WASM_PAGE_SIZE;totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK;)totalMemory<16777216?totalMemory*=2:totalMemory+=16777216;if(totalMemory!==TOTAL_MEMORY&&(TOTAL_MEMORY=totalMemory),buffer=Module.buffer?Module.buffer:new ArrayBuffer(TOTAL_MEMORY),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;Module.addOnPreRun=addOnPreRun,Module.addOnInit=addOnInit,Module.addOnPreMain=addOnPreMain,Module.addOnExit=addOnExit,Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var i=65535&e,r=65535&t;return i*r+((e>>>16)*r+i*(t>>>16)<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;t<32;t++)if(e&1<<31-t)return t;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Math.trunc=Math.trunc;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var ASM_CONSTS=[function(e){return Module.trapOnInstructionFetch(e)},function(e){return Module.busRead32(e)},function(e,t){Module.busWrite32(e,t)},function(e){return Module.busRead16(e)},function(e,t){Module.busWrite16(e,t)}];STATIC_BASE=8,STATICTOP=STATIC_BASE+4992,__ATINIT__.push(),allocate([12,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,117,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,49,54,40,36,48,41,59,32,125,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,98,117,115,82,101,97,100,51,50,40,36,48,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,49,54,40,36,48,44,32,36,49,41,59,32,125,0,123,32,77,111,100,117,108,101,46,98,117,115,87,114,105,116,101,51,50,40,36,48,44,32,36,49,41,59,32,125,0,112,99,32,104,97,115,32,108,115,98,105,116,32,115,101,116,32,48,120,37,48,56,88,10,0,123,32,114,101,116,117,114,110,32,77,111,100,117,108,101,46,116,114,97,112,79,110,73,110,115,116,114,117,99,116,105,111,110,70,101,116,99,104,40,36,48,41,59,32,125,0,45,45,45,32,48,120,37,48,56,88,58,32,48,120,37,48,52,88,32,0,97,100,99,32,114,37,117,44,114,37,117,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,100,100,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,97,100,100,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,97,100,100,32,114,37,117,44,114,37,117,10,0,97,100,100,32,112,99,44,46,46,46,32,112,114,111,100,117,99,101,100,32,97,110,32,97,114,109,32,97,100,100,114,101,115,115,32,48,120,37,48,56,88,32,48,120,37,48,56,88,10,0,97,100,100,32,114,37,117,44,80,67,44,35,48,120,37,48,50,88,10,0,97,100,100,32,114,37,117,44,83,80,44,35,48,120,37,48,50,88,10,0,97,100,100,32,83,80,44,35,48,120,37,48,50,88,10,0,97,110,100,115,32,114,37,117,44,114,37,117,10,0,97,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,97,115,114,115,32,114,37,117,44,114,37,117,10,0,98,101,113,32,48,120,37,48,56,88,10,0,98,110,101,32,48,120,37,48,56,88,10,0,98,99,115,32,48,120,37,48,56,88,10,0,98,99,99,32,48,120,37,48,56,88,10,0,98,109,105,32,48,120,37,48,56,88,10,0,98,112,108,32,48,120,37,48,56,88,10,0,98,118,115,32,48,120,37,48,56,88,10,0,98,118,99,32,48,120,37,48,56,88,10,0,98,104,105,32,48,120,37,48,56,88,10,0,98,108,115,32,48,120,37,48,56,88,10,0,98,103,101,32,48,120,37,48,56,88,10,0,98,108,116,32,48,120,37,48,56,88,10,0,98,103,116,32,48,120,37,48,56,88,10,0,98,108,101,32,48,120,37,48,56,88,10,0,66,32,48,120,37,48,56,88,10,0,98,105,99,115,32,114,37,117,44,114,37,117,10,0,98,107,112,116,32,48,120,37,48,50,88,10,0,98,108,32,48,120,37,48,56,88,10,0,98,108,120,32,114,37,117,10,0,99,97,110,110,111,116,32,98,114,97,110,99,104,32,116,111,32,97,114,109,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,98,120,32,114,37,117,10,0,99,109,110,115,32,114,37,117,44,114,37,117,10,0,99,109,112,32,114,37,117,44,35,48,120,37,48,50,88,10,0,99,109,112,115,32,114,37,117,44,114,37,117,10,0,99,112,115,32,84,79,68,79,10,0,99,112,121,32,114,37,117,44,114,37,117,10,0,101,111,114,115,32,114,37,117,44,114,37,117,10,0,108,100,109,105,97,32,114,37,117,33,44,123,0,114,37,117,0,125,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,32,114,37,117,44,91,80,67,43,35,48,120,37,88,93,32,0,59,64,32,48,120,37,88,10,0,108,100,114,32,114,37,117,44,91,83,80,43,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,108,100,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,100,114,115,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,108,115,108,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,108,115,32,114,37,117,44,114,37,117,10,0,108,115,114,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,108,115,114,115,32,114,37,117,44,114,37,117,10,0,109,111,118,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,109,111,118,115,32,114,37,117,44,114,37,117,10,0,109,111,118,32,114,37,117,44,114,37,117,10,0,109,117,108,115,32,114,37,117,44,114,37,117,10,0,109,118,110,115,32,114,37,117,44,114,37,117,10,0,110,101,103,115,32,114,37,117,44,114,37,117,10,0,111,114,114,115,32,114,37,117,44,114,37,117,10,0,112,111,112,32,123,0,112,99,0,112,111,112,32,123,114,99,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,112,117,115,104,32,123,0,108,114,0,112,117,115,104,32,123,108,114,125,32,119,105,116,104,32,97,110,32,65,82,77,32,97,100,100,114,101,115,115,32,112,99,32,48,120,37,48,56,88,32,112,111,112,112,101,100,32,48,120,37,48,56,88,10,0,114,101,118,32,114,37,117,44,114,37,117,10,0,114,101,118,49,54,32,114,37,117,44,114,37,117,10,0,114,101,118,115,104,32,114,37,117,44,114,37,117,10,0,114,111,114,115,32,114,37,117,44,114,37,117,10,0,115,98,99,32,114,37,117,44,114,37,117,10,0,115,101,116,101,110,100,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,10,0,115,116,109,105,97,32,114,37,117,33,44,123,0,115,116,114,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,32,114,37,117,44,91,83,80,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,98,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,35,48,120,37,88,93,10,0,115,116,114,104,32,114,37,117,44,91,114,37,117,44,114,37,117,93,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,35,48,120,37,88,10,0,115,117,98,115,32,114,37,117,44,35,48,120,37,48,50,88,10,0,115,117,98,115,32,114,37,117,44,114,37,117,44,114,37,117,10,0,115,117,98,32,83,80,44,35,48,120,37,48,50,88,10,0,115,119,105,32,48,120,37,48,50,88,10,0,10,10,115,119,105,32,48,120,37,48,50,88,10,0,115,120,116,98,32,114,37,117,44,114,37,117,10,0,115,120,116,104,32,114,37,117,44,114,37,117,10,0,116,115,116,32,114,37,117,44,114,37,117,10,0,117,120,116,98,32,114,37,117,44,114,37,117,10,0,117,120,116,104,32,114,37,117,44,114,37,117,10,0,105,110,118,97,108,105,100,32,105,110,115,116,114,117,99,116,105,111,110,32,48,120,37,48,56,88,32,48,120,37,48,52,88,10,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,46,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);var tempDoublePtr=STATICTOP;STATICTOP+=16,Module._i64Subtract=_i64Subtract,Module._i64Add=_i64Add,Module._memset=_memset,Module._bitshift64Lshr=_bitshift64Lshr,Module._bitshift64Shl=_bitshift64Shl,Module._memcpy=_memcpy;var SYSCALLS={varargs:0,get:function(e){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();return assert(e>=0?0===t:-1===t),e},getZero:function(){assert(0===SYSCALLS.get())}},cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_STATIC);Module._llvm_cttz_i32=_llvm_cttz_i32,Module.___udivmoddi4=___udivmoddi4,Module.___udivdi3=___udivdi3,Module._sbrk=_sbrk,Module.___uremdi3=___uremdi3,Module._llvm_bswap_i32=_llvm_bswap_i32,Module._pthread_self=_pthread_self,__ATEXIT__.push(function(){var e=Module._fflush;e&&e(0);var t=___syscall146.printChar;if(t){var i=___syscall146.buffers;i[1].length&&t(1,10),i[2].length&&t(2,10)}}),DYNAMICTOP_PTR=allocate(1,"i32",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=Runtime.alignMemory(STACK_MAX),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0,Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_ii:invoke_ii,invoke_iiii:invoke_iiii,invoke_vi:invoke_vi,_pthread_cleanup_pop:_pthread_cleanup_pop,_emscripten_asm_const_ii:_emscripten_asm_const_ii,_abort:_abort,___setErrNo:___setErrNo,___syscall6:___syscall6,___syscall146:___syscall146,_pthread_cleanup_push:_pthread_cleanup_push,_emscripten_memcpy_big:_emscripten_memcpy_big,___syscall140:___syscall140,_exit:_exit,__exit:__exit,_emscripten_asm_const_iii:_emscripten_asm_const_iii,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,cttz_i8:cttz_i8};var asm=function(e,t,i){"use asm";var r=new e.Int8Array(i);var n=new e.Int16Array(i);var s=new e.Int32Array(i);var a=new e.Uint8Array(i);var o=new e.Uint16Array(i);var u=new e.Uint32Array(i);var c=new e.Float32Array(i);var l=new e.Float64Array(i);var h=t.STACKTOP|0;var f=t.STACK_MAX|0;var _=t.DYNAMICTOP_PTR|0;var d=t.tempDoublePtr|0;var p=t.ABORT|0;var b=t.cttz_i8|0;var g=0;var y=0;var m=0;var k=0;var v=e.NaN,w=e.Infinity;var C=0,M=0,A=0,T=0,S=0,P=0,E=0,x=0,R=0;var O=0;var I=e.Math.floor;var L=e.Math.abs;var F=e.Math.sqrt;var B=e.Math.pow;var H=e.Math.cos;var N=e.Math.sin;var D=e.Math.tan;var U=e.Math.acos;var j=e.Math.asin;var V=e.Math.atan;var W=e.Math.atan2;var z=e.Math.exp;var q=e.Math.log;var Y=e.Math.ceil;var K=e.Math.imul;var G=e.Math.min;var X=e.Math.max;var J=e.Math.clz32;var Q=t.abort;var $=t.assert;var Z=t.enlargeMemory;var ee=t.getTotalMemory;var te=t.abortOnCannotGrowMemory;var ie=t.invoke_ii;var re=t.invoke_iiii;var ne=t.invoke_vi;var se=t._pthread_cleanup_pop;var ae=t._emscripten_asm_const_ii;var oe=t._abort;var ue=t.___setErrNo;var ce=t.___syscall6;var le=t.___syscall146;var he=t._pthread_cleanup_push;var fe=t._emscripten_memcpy_big;var _e=t.___syscall140;var de=t._exit;var pe=t.__exit;var be=t._emscripten_asm_const_iii;var ge=0;function ye(e){e=e|0;var t=0;t=h;h=h+e|0;h=h+15&-16;return t|0}function me(){return h|0}function ke(e){e=e|0;h=e}function ve(e,t){e=e|0;t=t|0;h=e;f=t}function we(e,t){e=e|0;t=t|0;if(!g){g=e;y=t}}function Ce(e){e=e|0;O=e}function Me(){return O|0}function Ae(e){e=e|0;var t=0,i=0;e:do{if(!e)t=0;else{i=0;while(1){t=xe()|0;i=i+1|0;if(t|0)break e;if(i>>>0>=e>>>0){t=0;break}}}}while(0);return t|0}function Te(e){e=e|0;r[4972]=e;return}function Se(e){e=e|0;var t=0,i=0;i=h;h=h+16|0;t=s[4356+((e&15)<<2)>>2]|0;if((e&15|0)!=15){h=i;return t|0}if(t&1|0){e=s[2]|0;s[i>>2]=t;$e(e,252,i)|0}t=t&-2;h=i;return t|0}function Pe(e,t){e=e|0;t=t|0;s[4356+((e&15)<<2)>>2]=(e&15|0)==15?t&-2:t;return}function Ee(){s[1086]=4;s[1087]=0;s[1088]=0;s[1105]=0;s[1106]=0;return 0}function xe(){var e=0,t=0,i=0,n=0,a=0,o=0,u=0,l=0,f=0,_=0,d=0,p=0,b=0,g=0,y=0,m=0;a=0;m=h;h=h+4896|0;e=s[1104]|0;if(e&1|0){o=s[2]|0;s[m>>2]=e;$e(o,252,m)|0}t=ae(0,e&-2|0)|0;if(t|0){y=t;h=m;return y|0}if((e&-2)>>>0>4026531839&(s[1105]|0)!=0){s[1105]=0;o=s[1102]|0;s[1089]=ae(1,o|0)|0;s[1090]=ae(1,o+4|0)|0;s[1091]=ae(1,o+8|0)|0;s[1092]=ae(1,o+12|0)|0;s[1101]=ae(1,o+16|0)|0;s[1103]=ae(1,o+20|0)|0;n=ae(1,o+24|0)|0;s[1106]=ae(1,o+28|0)|0;s[1102]=o+32}else n=e&-2;e=s[1086]|0;do{if(e&1){t=s[1088]|0;if(!t){s[1088]=s[1087];s[1086]=e|65536;e=e|65536;break}else{s[1088]=t+-1;break}}}while(0);if((e&3|0)==3)if((e&65536|0)!=0&(s[1105]|0)==0){o=s[1102]|0;t=s[1106]|0;e:do{if((o+-4&-268435456|0)==-536870912)switch(o|0){case-536813548:{s[1086]=t&65543;if((e&1|0)!=0|(t&1|0)==0){p=-536813580;break e}s[1088]=s[1087];p=-536813580;break e}case-536813544:{s[1087]=t&16777215;a=22;break e}case-536813540:{s[1088]=t&16777215;a=24;break e}case-536813536:{a=25;break e}default:{a=20;break e}}else{be(2,o+-4|0,t|0)|0;a=20}}while(0);e:do{if((a|0)==20){t:do{if((o+-8&-268435456|0)==-536870912){switch(o|0){case-536813544:{a=22;break e}case-536813540:{a=24;break e}case-536813536:{a=25;break e}case-536813532:break;default:break t}a=28;break e}else be(2,o+-8|0,n|0)|0}while(0);e=s[1103]|0;if((o+-12&-268435456|0)==-536870912){i=e;a=30}else{be(2,o+-12|0,e|0)|0;a=38}}}while(0);if((a|0)==22){a=s[1086]|0;s[1086]=n&65543;if((n&1|0)==0|(a&1|0)!=0)a=28;else{s[1088]=s[1087];a=28}}else if((a|0)==24){s[1087]=n&16777215;a=28}else if((a|0)==25){s[1088]=n&16777215;a=28}if((a|0)==28){i=s[1103]|0;a=30}e:do{if((a|0)==30){switch(o|0){case-536813540:{u=s[1086]|0;s[1086]=i&65543;if(!((i&1|0)==0|(u&1|0)!=0))s[1088]=s[1087];break}case-536813536:{s[1087]=i&16777215;break}case-536813532:{s[1088]=i&16777215;break}case-536813528:break;default:{a=38;break e}}u=s[1101]|0;a=39}}while(0);if((a|0)==38){e=s[1101]|0;if((o+-16&-268435456|0)==-536870912){u=e;a=39}else{be(2,o+-16|0,e|0)|0;a=47}}e:do{if((a|0)==39){switch(o|0){case-536813536:{l=s[1086]|0;s[1086]=u&65543;if(!((u&1|0)==0|(l&1|0)!=0))s[1088]=s[1087];break}case-536813532:{s[1087]=u&16777215;break}case-536813528:{s[1088]=u&16777215;break}case-536813524:break;default:{a=47;break e}}l=s[1092]|0;a=48}}while(0);if((a|0)==47){e=s[1092]|0;if((o+-20&-268435456|0)==-536870912){l=e;a=48}else{be(2,o+-20|0,e|0)|0;a=56}}e:do{if((a|0)==48){switch(o|0){case-536813532:{f=s[1086]|0;s[1086]=l&65543;if(!((l&1|0)==0|(f&1|0)!=0))s[1088]=s[1087];break}case-536813528:{s[1087]=l&16777215;break}case-536813524:{s[1088]=l&16777215;break}case-536813520:break;default:{a=56;break e}}f=s[1091]|0;a=57}}while(0);if((a|0)==56){e=s[1091]|0;if((o+-24&-268435456|0)==-536870912){f=e;a=57}else{be(2,o+-24|0,e|0)|0;a=65}}e:do{if((a|0)==57){switch(o|0){case-536813528:{_=s[1086]|0;s[1086]=f&65543;if(!((f&1|0)==0|(_&1|0)!=0))s[1088]=s[1087];break}case-536813524:{s[1087]=f&16777215;break}case-536813520:{s[1088]=f&16777215;break}case-536813516:break;default:{a=65;break e}}_=s[1090]|0;a=66}}while(0);if((a|0)==65){e=s[1090]|0;if((o+-28&-268435456|0)==-536870912){_=e;a=66}else{be(2,o+-28|0,e|0)|0;a=74}}e:do{if((a|0)==66){switch(o|0){case-536813524:{b=s[1086]|0;s[1086]=_&65543;if(!((_&1|0)==0|(b&1|0)!=0))s[1088]=s[1087];break}case-536813520:{s[1087]=_&16777215;break}case-536813516:{s[1088]=_&16777215;break}case-536813512:break;default:{a=74;break e}}d=s[1089]|0;b=o+-32|0;a=75}}while(0);if((a|0)==74){e=s[1089]|0;if((o+-32&-268435456|0)==-536870912){d=e;b=o+-32|0;a=75}else{be(2,o+-32|0,e|0)|0;p=o+-32|0}}e:do{if((a|0)==75)switch(o|0){case-536813520:{p=s[1086]|0;s[1086]=d&65543;if((d&1|0)==0|(p&1|0)!=0){p=b;break e}s[1088]=s[1087];p=b;break e}case-536813516:{s[1087]=d&16777215;p=b;break e}case-536813512:{s[1088]=d&16777215;p=b;break e}case-536813508:{p=b;break e}default:{p=b;break e}}}while(0);s[1102]=p;n=(ae(1,60)|0)+2|0;s[1103]=-7;s[1105]=1}i=n+-2|0;o=ae(3,i|0)|0;a=n+2|0;s[1104]=a&-2;if(r[4972]|0){b=s[2]|0;s[m+8>>2]=i;s[m+8+4>>2]=o;$e(b,323,m+8|0)|0}if((o&65472|0)==16704){if(r[4972]|0){y=s[2]|0;s[m+16>>2]=o&7;s[m+16+4>>2]=o>>>3&7;$e(y,343,m+16|0)|0}t=s[4356+((o&7)<<2)>>2]|0;i=s[4356+((o>>>3&7)<<2)>>2]|0;y=s[1106]|0;s[4356+((o&7)<<2)>>2]=i+t+(y>>>29&1);e=(i+t+(y>>>29&1)|0)<0?y|-2147483648:y&2147483647;e=(i+t+(y>>>29&1)|0)==0?e|1073741824:e&-1073741825;s[1106]=e;if(!(e&536870912)){y=((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)|0)>>>31)&2|0)==0?e&-536870913:e|536870912;s[1106]=(((i&2147483647)+(t&2147483647)|0)>>>31|0)==(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}else{y=(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)+1|0)>>>31)|0)&2|0)==0?e&-536870913:e|536870912;s[1106]=(((i&2147483647)+(t&2147483647)+1|0)>>>31|0)==(((i>>>31)+(t>>>31)+(((i&2147483647)+(t&2147483647)+1|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}}if((o&65024|0)==7168)if(o>>>6&7|0){if(r[4972]|0){y=s[2]|0;s[m+24>>2]=o&7;s[m+24+4>>2]=o>>>3&7;s[m+24+8>>2]=o>>>6&7;$e(y,356,m+24|0)|0}g=s[4356+((o>>>3&7)<<2)>>2]|0;s[4356+((o&7)<<2)>>2]=g+(o>>>6&7);y=s[1106]|0;y=(g+(o>>>6&7)|0)<0?y|-2147483648:y&2147483647;y=(g+(o>>>6&7)|0)==0?y|1073741824:y&-1073741825;y=((((g&2147483647)+(o>>>6&7)|0)>>>31)+(g>>>31)&2|0)==0?y&-536870913:y|536870912;s[1106]=(((g&2147483647)+(o>>>6&7)|0)>>>31|0)==(((((g&2147483647)+(o>>>6&7)|0)>>>31)+(g>>>31)|0)>>>1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&63488|0)==12288){if(r[4972]|0){y=s[2]|0;s[m+40>>2]=o>>>8&7;s[m+40+4>>2]=o&255;$e(y,376,m+40|0)|0}g=s[4356+((o>>>8&7)<<2)>>2]|0;s[4356+((o>>>8&7)<<2)>>2]=g+(o&255);y=s[1106]|0;y=(g+(o&255)|0)<0?y|-2147483648:y&2147483647;y=(g+(o&255)|0)==0?y|1073741824:y&-1073741825;y=((((g&2147483647)+(o&255)|0)>>>31)+(g>>>31)&2|0)==0?y&-536870913:y|536870912;s[1106]=(((g&2147483647)+(o&255)|0)>>>31|0)==(((((g&2147483647)+(o&255)|0)>>>31)+(g>>>31)|0)>>>1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&65024|0)==6144){if(r[4972]|0){y=s[2]|0;s[m+48>>2]=o&7;s[m+48+4>>2]=o>>>3&7;s[m+48+8>>2]=o>>>6&7;$e(y,394,m+48|0)|0}g=s[4356+((o>>>3&7)<<2)>>2]|0;b=s[4356+((o>>>6&7)<<2)>>2]|0;s[4356+((o&7)<<2)>>2]=b+g;y=s[1106]|0;y=(b+g|0)<0?y|-2147483648:y&2147483647;y=(b+g|0)==0?y|1073741824:y&-1073741825;y=((b>>>31)+(g>>>31)+(((b&2147483647)+(g&2147483647)|0)>>>31)&2|0)==0?y&-536870913:y|536870912;s[1106]=(((b&2147483647)+(g&2147483647)|0)>>>31|0)==(((b>>>31)+(g>>>31)+(((b&2147483647)+(g&2147483647)|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&65280|0)==17408){if(r[4972]|0){y=s[2]|0;s[m+64>>2]=o>>>4&8|o&7;s[m+64+4>>2]=o>>>3&15;$e(y,412,m+64|0)|0}e=s[4356+((o>>>4&8|o&7)<<2)>>2]|0;if((o>>>4&8|o&7|0)==15){if(e&1|0){y=s[2]|0;s[m+72>>2]=e;$e(y,252,m+72|0)|0}e=e&-2}t=s[4356+((o>>>3&15)<<2)>>2]|0;if((o>>>3&15|0)==15){if(t&1|0){y=s[2]|0;s[m+80>>2]=t;$e(y,252,m+80|0)|0}t=t&-2}e=t+e|0;do{if((o>>>4&8|o&7|0)==15)if(!(e&1)){y=s[2]|0;s[m+88>>2]=a;s[m+88+4>>2]=e;$e(y,425,m+88|0)|0;de(1)}else{g=e+2&-2;break}else g=e}while(0);s[4356+((o>>>4&8|o&7)<<2)>>2]=(o>>>4&8|o&7|0)==15?g&-2:g;y=0;h=m;return y|0}e=1;t=(o&63488)<<16>>16;if(e)switch(t|0){case-24576:{if(r[4972]|0){y=s[2]|0;s[m+96>>2]=o>>>8&7;s[m+96+4>>2]=o<<2&1020;$e(y,475,m+96|0)|0}e=s[1104]|0;if(e&1|0){y=s[2]|0;s[m+104>>2]=e;$e(y,252,m+104|0)|0}s[4356+((o>>>8&7)<<2)>>2]=(e&-4)+(o<<2&1020);y=0;h=m;return y|0}case-22528:{if(r[4972]|0){y=s[2]|0;s[m+112>>2]=o>>>8&7;s[m+112+4>>2]=o<<2&1020;$e(y,495,m+112|0)|0}s[4356+((o>>>8&7)<<2)>>2]=(s[1102]|0)+(o<<2&1020);y=0;h=m;return y|0}default:e=1}if(e)switch(t|0){default:{if((o&65408|0)==45056){if(r[4972]|0){y=s[2]|0;s[m+120>>2]=o<<2&508;$e(y,515,m+120|0)|0}s[1102]=(s[1102]|0)+(o<<2&508);y=0;h=m;return y|0}if((o&65472|0)==16384){if(r[4972]|0){y=s[2]|0;s[m+128>>2]=o&7;s[m+128+4>>2]=o>>>3&7;$e(y,531,m+128|0)|0}g=s[4356+((o>>>3&7)<<2)>>2]&s[4356+((o&7)<<2)>>2];s[4356+((o&7)<<2)>>2]=g;y=s[1106]|0;y=(g|0)<0?y|-2147483648:y&2147483647;s[1106]=(g|0)==0?y|1073741824:y&-1073741825;y=0;h=m;return y|0}if((o&63488|0)==4096){if(r[4972]|0){y=s[2]|0;s[m+136>>2]=o&7;s[m+136+4>>2]=o>>>3&7;s[m+136+8>>2]=o>>>6&31;$e(y,545,m+136|0)|0}e=s[4356+((o>>>3&7)<<2)>>2]|0;do{if(!(o>>>6&31)){i=s[1106]|0;if((e|0)<0){s[1106]=i|536870912;t=-1;e=i|536870912;break}else{s[1106]=i&-536870913;t=0;e=i&-536870913;break}}else{y=s[1106]|0;y=(e&1<<(o>>>6&31)+-1|0)==0?y&-536870913:y|536870912;s[1106]=y;t=((e|0)<0?-1<<32-(o>>>6&31):0)|e>>>(o>>>6&31);e=y}}while(0);s[4356+((o&7)<<2)>>2]=t;y=(t|0)<0?e|-2147483648:e&2147483647;s[1106]=(t|0)==0?y|1073741824:y&-1073741825;y=0;h=m;return y|0}if((o&65472|0)==16640){if(r[4972]|0){y=s[2]|0;s[m+152>>2]=o&7;s[m+152+4>>2]=o>>>3&7;$e(y,565,m+152|0)|0}t=s[4356+((o&7)<<2)>>2]|0;e=s[4356+((o>>>3&7)<<2)>>2]&255;do{if(!e)e=s[1106]|0;else{if(e>>>0<32){y=s[1106]|0;y=(1<<e+-1&t|0)==0?y&-536870913:y|536870912;s[1106]=y;t=((t|0)<0?-1<<32-e:0)|t>>>e;e=y;break}e=s[1106]|0;if((t|0)<0){s[1106]=e|536870912;t=-1;e=e|536870912;break}else{s[1106]=e&-536870913;t=0;e=e&-536870913;break}}}while(0);s[4356+((o&7)<<2)>>2]=t;y=(t|0)<0?e|-2147483648:e&2147483647;s[1106]=(t|0)==0?y|1073741824:y&-1073741825;y=0;h=m;return y|0}e:do{if((o&61440|0)==53248){t=(((o&128|0)==0?o&255:o|-256)<<1)+a|0;do{switch(o>>>8&15){case 0:{if(r[4972]|0){y=s[2]|0;s[m+160>>2]=t+-1;$e(y,579,m+160|0)|0}if(!(s[1106]&1073741824)){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 1:{if(r[4972]|0){y=s[2]|0;s[m+168>>2]=t+-1;$e(y,591,m+168|0)|0}if(s[1106]&1073741824|0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 2:{if(r[4972]|0){y=s[2]|0;s[m+176>>2]=t+-1;$e(y,603,m+176|0)|0}if(!(s[1106]&536870912)){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 3:{if(r[4972]|0){y=s[2]|0;s[m+184>>2]=t+-1;$e(y,615,m+184|0)|0}if(s[1106]&536870912|0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 4:{if(r[4972]|0){y=s[2]|0;s[m+192>>2]=t+-1;$e(y,627,m+192|0)|0}if((s[1106]|0)>=0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 5:{if(r[4972]|0){y=s[2]|0;s[m+200>>2]=t+-1;$e(y,639,m+200|0)|0}if((s[1106]|0)<0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 6:{if(r[4972]|0){y=s[2]|0;s[m+208>>2]=t+-1;$e(y,651,m+208|0)|0}if(!(s[1106]&268435456)){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 7:{if(r[4972]|0){y=s[2]|0;s[m+216>>2]=t+-1;$e(y,663,m+216|0)|0}if(s[1106]&268435456|0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 8:{if(r[4972]|0){y=s[2]|0;s[m+224>>2]=t+-1;$e(y,675,m+224|0)|0}if((s[1106]&1610612736|0)!=536870912){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 9:{if(r[4972]|0){y=s[2]|0;s[m+232>>2]=t+-1;$e(y,687,m+232|0)|0}if((s[1106]&1610612736|0)==536870912){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 10:{if(r[4972]|0){y=s[2]|0;s[m+240>>2]=t+-1;$e(y,699,m+240|0)|0}e=s[1106]&-1879048192;t:do{if((e|0)<0){switch(e|0){case-1879048192:break t;default:y=0}h=m;return y|0}else{switch(e|0){case 0:break t;default:y=0}h=m;return y|0}}while(0);s[1104]=t+2&-2;y=0;h=m;return y|0}case 11:{if(r[4972]|0){y=s[2]|0;s[m+248>>2]=t+-1;$e(y,711,m+248|0)|0}e=s[1106]&-1879048192;t:do{if((e|0)<268435456){switch(e|0){case-2147483648:break t;default:y=0}h=m;return y|0}else{switch(e|0){case 268435456:break t;default:y=0}h=m;return y|0}}while(0);s[1104]=t+2&-2;y=0;h=m;return y|0}case 12:{if(r[4972]|0){y=s[2]|0;s[m+256>>2]=t+-1;$e(y,723,m+256|0)|0}y=s[1106]|0;if(y&1073741824|0?1:(((y&-1879048192|0)==0?(y&-1879048192|0)==-1879048192?2:1:(y&-1879048192|0)==-1879048192&1)|0)==0){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}case 13:{if(r[4972]|0){y=s[2]|0;s[m+264>>2]=t+-1;$e(y,735,m+264|0)|0}y=s[1106]|0;if((((y&-1879048192|0)==-2147483648?(y&-1879048192|0)==268435456?2:1:(y&-1879048192|0)==268435456&1)|0)==(0-(y>>>30&1)|0)){y=0;h=m;return y|0}s[1104]=t+2&-2;y=0;h=m;return y|0}default:break e}}while(0)}}while(0);if((o&63488|0)==57344){e=(((o&1024|0)==0?o&2047:o|-2048)<<1)+a|0;if(r[4972]|0){y=s[2]|0;s[m+272>>2]=e+-1;$e(y,747,m+272|0)|0}s[1104]=e+2&-2;y=0;h=m;return y|0}if((o&65472|0)==17280){if(r[4972]|0){y=s[2]|0;s[m+280>>2]=o&7;s[m+280+4>>2]=o>>>3&7;$e(y,757,m+280|0)|0}g=s[4356+((o&7)<<2)>>2]&~s[4356+((o>>>3&7)<<2)>>2];s[4356+((o&7)<<2)>>2]=g;y=s[1106]|0;y=(g|0)<0?y|-2147483648:y&2147483647;s[1106]=(g|0)==0?y|1073741824:y&-1073741825;y=0;h=m;return y|0}if((o&65280|0)==48640){y=s[2]|0;s[m+288>>2]=o&255;$e(y,771,m+288|0)|0;y=1;h=m;return y|0}e:do{if((o&57344|0)==57344){if((o&6144)<4096){switch(o&6144){case 2048:break;default:break e}e=(s[1103]|0)+(o<<1&4094)&-4|2;if(r[4972]|0){y=s[2]|0;s[m+304>>2]=e+-3;$e(y,784,m+304|0)|0}s[1103]=n|1;s[1104]=e;y=0;h=m;return y|0}switch(o&6144){case 4096:{if(r[4972]|0)tt(10,s[2]|0)|0;s[1103]=(((o&1024|0)==0?o&2047:o|1046528)<<12)+a;y=0;h=m;return y|0}case 6144:{e=(s[1103]|0)+(o<<1&4094)|0;if(r[4972]|0){y=s[2]|0;s[m+296>>2]=e+-1;$e(y,784,m+296|0)|0}s[1103]=n|1;s[1104]=e+2&-2;y=0;h=m;return y|0}default:break e}}}while(0);e=1;t=(o&65415)<<16>>16;if(e)switch(t|0){case 18304:{if(r[4972]|0){y=s[2]|0;s[m+312>>2]=o>>>3&15;$e(y,795,m+312|0)|0}e=s[4356+((o>>>3&15)<<2)>>2]|0;if((o>>>3&15|0)==15){if(e&1|0){y=s[2]|0;s[m+320>>2]=e;$e(y,252,m+320|0)|0}e=e&-2}e=e+2|0;if(!(e&1)){y=s[2]|0;s[m+328>>2]=a;s[m+328+4>>2]=o;$e(y,804,m+328|0)|0;y=2;h=m;return y|0}else{s[1103]=n|1;s[1104]=e&-2;y=0;h=m;return y|0}}case 18176:{if(r[4972]|0){y=s[2]|0;s[m+336>>2]=o>>>3&15;$e(y,840,m+336|0)|0}e=s[4356+((o>>>3&15)<<2)>>2]|0;if((o>>>3&15|0)==15){if(e&1|0){y=s[2]|0;s[m+344>>2]=e;$e(y,252,m+344|0)|0}e=e&-2}e=e+2|0;if(!(e&1)){y=s[2]|0;s[m+352>>2]=a;s[m+352+4>>2]=o;$e(y,804,m+352|0)|0;y=3;h=m;return y|0}else{s[1104]=e&-2;y=0;h=m;return y|0}}default:e=1}if(e)switch(t|0){default:{if((o&65472|0)==17088){if(r[4972]|0){y=s[2]|0;s[m+360>>2]=o&7;s[m+360+4>>2]=o>>>3&7;$e(y,848,m+360|0)|0}g=s[4356+((o&7)<<2)>>2]|0;b=s[4356+((o>>>3&7)<<2)>>2]|0;y=s[1106]|0;y=(b+g|0)<0?y|-2147483648:y&2147483647;y=(b+g|0)==0?y|1073741824:y&-1073741825;y=((b>>>31)+(g>>>31)+(((b&2147483647)+(g&2147483647)|0)>>>31)&2|0)==0?y&-536870913:y|536870912;s[1106]=(((b&2147483647)+(g&2147483647)|0)>>>31|0)==(((b>>>31)+(g>>>31)+(((b&2147483647)+(g&2147483647)|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&63488|0)==10240){if(r[4972]|0){y=s[2]|0;s[m+368>>2]=o>>>8&7;s[m+368+4>>2]=o&255;$e(y,862,m+368|0)|0}g=s[4356+((o>>>8&7)<<2)>>2]|0;y=s[1106]|0;y=(g-(o&255)|0)<0?y|-2147483648:y&2147483647;y=(g-(o&255)|0)==0?y|1073741824:y&-1073741825;y=(((g>>>31)+1+((-2147483648-(o&255)+(g&2147483647)|0)>>>31)|0)&2|0)==0?y&-536870913:y|536870912;s[1106]=((-2147483648-(o&255)+(g&2147483647)|0)>>>31|0)==(((g>>>31)+1+((-2147483648-(o&255)+(g&2147483647)|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&65472|0)==17024){if(r[4972]|0){y=s[2]|0;s[m+376>>2]=o&7;s[m+376+4>>2]=o>>>3&7;$e(y,879,m+376|0)|0}b=s[4356+((o&7)<<2)>>2]|0;g=s[4356+((o>>>3&7)<<2)>>2]|0;y=s[1106]|0;y=(b-g|0)<0?y|-2147483648:y&2147483647;y=(b-g|0)==0?y|1073741824:y&-1073741825;y=(((~g>>>31)+(b>>>31)+(((b&2147483647)+1+(~g&2147483647)|0)>>>31)|0)&2|0)==0?y&-536870913:y|536870912;s[1106]=(((b&2147483647)+1+(~g&2147483647)|0)>>>31|0)==(((~g>>>31)+(b>>>31)+(((b&2147483647)+1+(~g&2147483647)|0)>>>31)|0)>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&65280|0)==17664){if(r[4972]|0){y=s[2]|0;s[m+384>>2]=o>>>4&8|o&7;s[m+384+4>>2]=o>>>3&15;$e(y,879,m+384|0)|0}e=s[4356+((o>>>4&8|o&7)<<2)>>2]|0;if((o>>>4&8|o&7|0)==15){if(e&1|0){y=s[2]|0;s[m+392>>2]=e;$e(y,252,m+392|0)|0}t=e&-2}else t=e;e=s[4356+((o>>>3&15)<<2)>>2]|0;if((o>>>3&15|0)==15){if(e&1|0){y=s[2]|0;s[m+400>>2]=e;$e(y,252,m+400|0)|0}e=e&-2}g=t-e|0;y=s[1106]|0;y=(g|0)<0?y|-2147483648:y&2147483647;y=(g|0)==0?y|1073741824:y&-1073741825;g=~e;b=((t&2147483647)+1+(g&2147483647)|0)>>>31;g=(g>>>31)+(t>>>31)+b|0;y=(g&2|0)==0?y&-536870913:y|536870912;s[1106]=(b|0)==(g>>>1&1|0)?y&-268435457:y|268435456;y=0;h=m;return y|0}if((o&65512|0)==46688&(r[4972]|0)!=0)Ze(893,9,1,s[2]|0)|0;e=1;t=(o&65472)<<16>>16;if(e)switch(t|0){case 17920:{if(r[4972]|0){y=s[2]|0;s[m+408>>2]=o&7;s[m+408+4>>2]=o>>>3&7;$e(y,903,m+408|0)|0}s[4356+((o&7)<<2)>>2]=s[4356+((o>>>3&7)<<2)>>2];y=0;h=m;return y|0}case 16448:{if(r[4972]|0){y=s[2]|0;s[m+416>>2]=o&7;s[m+416+4>>2]=o>>>3&7;$e(y,916,m+416|0)|0}g=s[4356+((o>>>3&7)<<2)>>2]^s[4356+((o&7)<<2)>>2];s[4356+((o&7)<<2)>>2]=g;y=s[1106]|0;y=(g|0)<0?y|-2147483648:y&2147483647;s[1106]=(g|0)==0?y|1073741824:y&-1073741825;y=0;h=m;return y|0}default:e=1}if(e)switch(t|0){default:{e:do{if((o&63488)<<16>>16<26624){switch((o&63488)<<16>>16){case-14336:break;default:break e}if(!(r[4972]|0))t=o&1;else{t=s[2]|0;s[m+424>>2]=o>>>8&7;$e(t,930,m+424|0)|0;if(!(o&1))e=0;else{s[m+432>>2]=0;$e(t,943,m+432|0)|0;e=1}if(o&2){if(e|0)tt(44,t)|0;s[m+1184>>2]=1;$e(t,943,m+1184|0)|0;e=e+1|0}if(o&4){if(e|0)tt(44,t)|0;s[m+1192>>2]=2;$e(t,943,m+1192|0)|0;e=e+1|0}if(o&8){if(e|0)tt(44,t)|0;s[m+1200>>2]=3;$e(t,943,m+1200|0)|0;e=e+1|0}if(o&16){if(e|0)tt(44,t)|0;s[m+1208>>2]=4;$e(t,943,m+1208|0)|0;e=e+1|0}if(o&32){if(e|0)tt(44,t)|0;s[m+1216>>2]=5;$e(t,943,m+1216|0)|0;e=e+1|0}if(o&64){if(e|0)tt(44,t)|0;s[m+1224>>2]=6;$e(t,943,m+1224|0)|0;e=e+1|0}if(o&128|0){if(e|0)tt(44,t)|0;s[m+1232>>2]=7;$e(t,943,m+1232|0)|0}Ze(947,2,1,t)|0;t=o&1}e=s[4356+((o>>>8&7)<<2)>>2]|0;if(t){s[1089]=ae(1,e|0)|0;e=e+4|0}if(o&2){s[1090]=ae(1,e|0)|0;e=e+4|0}if(o&4){s[1091]=ae(1,e|0)|0;e=e+4|0}if(o&8){s[1092]=ae(1,e|0)|0;e=e+4|0}if(o&16){s[1093]=ae(1,e|0)|0;e=e+4|0}if(o&32){s[1094]=ae(1,e|0)|0;e=e+4|0}if(o&64){s[1095]=ae(1,e|0)|0;e=e+4|0}if(o&128){s[1096]=ae(1,e|0)|0;e=e+4|0}if(1<<(o>>>8&7)&o|0){y=0;h=m;return y|0}s[4356+((o>>>8&7)<<2)>>2]=e;y=0;h=m;return y|0}else{switch((o&63488)<<16>>16){case 26624:break;default:break e}if(r[4972]|0){y=s[2]|0;s[m+440>>2]=o&7;s[m+440+4>>2]=o>>>3&7;s[m+440+8>>2]=o>>>4&124;$e(y,950,m+440|0)|0}s[4356+((o&7)<<2)>>2]=ae(1,(s[4356+((o>>>3&7)<<2)>>2]|0)+(o>>>4&124)|0)|0;y=0;h=m;return y|0}}while(0);if((o&65024|0)==22528){if(r[4972]|0){y=s[2]|0;s[m+456>>2]=o&7;s[m+456+4>>2]=o>>>3&7;s[m+456+8>>2]=o>>>6&7;$e(y,971,m+456|0)|0}s[4356+((o&7)<<2)>>2]=ae(1,(s[4356+((o>>>6&7)<<2)>>2]|0)+(s[4356+((o>>>3&7)<<2)>>2]|0)|0)|0;y=0;h=m;return y|0}s[m+1384>>2]=y;s[m+2880>>2]=i;s[m+2896>>2]=o;s[m+2928>>2]=a;s[m+4840>>2]=0;s[m+4844>>2]=0;Mt(m);x=s[m+4840>>2]|0;C=s[m+4844>>2]|0;R=+c[m+4844>>2];s[m+4840>>2]=0;s[m+4844>>2]=0;if((x|0)==6)return C|0}}}}}}return 0}function Re(e){e=e|0;var t=0;t=h;h=h+16|0;s[t>>2]=s[e+60>>2];e=Ie(ce(6,t|0)|0)|0;h=t;return e|0}function Oe(e,t,i){e=e|0;t=t|0;i=i|0;var r=0;r=h;h=h+32|0;s[r>>2]=s[e+60>>2];s[r+4>>2]=0;s[r+8>>2]=t;s[r+12>>2]=r+20;s[r+16>>2]=i;if((Ie(_e(140,r|0)|0)|0)<0){s[r+20>>2]=-1;e=-1}else e=s[r+20>>2]|0;h=r;return e|0}function Ie(e){e=e|0;if(e>>>0>4294963200){s[(Le()|0)>>2]=0-e;e=-1}return e|0}function Le(){var e=0;if(!0)e=4472;else e=s[(gt()|0)+64>>2]|0;return e|0}function Fe(e){e=e|0;return}function Be(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,a=0,o=0,u=0,c=0;c=h;h=h+48|0;u=s[e+28>>2]|0;s[c+32>>2]=u;u=(s[e+20>>2]|0)-u|0;s[c+32+4>>2]=u;s[c+32+8>>2]=t;s[c+32+12>>2]=i;a=2;t=u+i|0;u=c+32|0;while(1){if(!(s[1107]|0)){s[c+16>>2]=s[e+60>>2];s[c+16+4>>2]=u;s[c+16+8>>2]=a;n=Ie(le(146,c+16|0)|0)|0}else{he(1,e|0);s[c>>2]=s[e+60>>2];s[c+4>>2]=u;s[c+8>>2]=a;n=Ie(le(146,c|0)|0)|0;se(0)}if((t|0)==(n|0)){t=6;break}if((n|0)<0){t=8;break}t=t-n|0;r=s[u+4>>2]|0;if(n>>>0>r>>>0){o=s[e+44>>2]|0;s[e+28>>2]=o;s[e+20>>2]=o;n=n-r|0;a=a+-1|0;o=u+8|0;r=s[u+12>>2]|0}else if((a|0)==2){s[e+28>>2]=(s[e+28>>2]|0)+n;a=2;o=u}else o=u;s[o>>2]=(s[o>>2]|0)+n;s[o+4>>2]=r-n;u=o}if((t|0)==6){u=s[e+44>>2]|0;s[e+16>>2]=u+(s[e+48>>2]|0);s[e+28>>2]=u;s[e+20>>2]=u}else if((t|0)==8){s[e+16>>2]=0;s[e+28>>2]=0;s[e+20>>2]=0;s[e>>2]=s[e>>2]|32;if((a|0)==2)i=0;else i=i-(s[u+4>>2]|0)|0}h=c;return i|0}function He(e){e=e|0;if(!(s[e+68>>2]|0))Fe(e);return}function Ne(e){e=e|0;var t=0,i=0;i=0;while(1){if((a[1915+i>>0]|0)==(e|0)){e=2;break}t=i+1|0;if((t|0)==87){t=2003;i=87;e=5;break}else i=t}if((e|0)==2)if(!i)t=2003;else{t=2003;e=5}if((e|0)==5)while(1){do{e=t;t=t+1|0}while((r[e>>0]|0)!=0);i=i+-1|0;if(!i)break;else e=5}return t|0}function De(e,t,i){e=e|0;t=t|0;i=i|0;var n=0,a=0,o=0,u=0;u=h;h=h+224|0;n=u+80|0;a=n+40|0;do{s[n>>2]=0;n=n+4|0}while((n|0)<(a|0));s[u+120>>2]=s[i>>2];if((Ue(0,t,u+120|0,u,u+80|0)|0)<0)i=-1;else{if((s[e+76>>2]|0)>-1)o=je(e)|0;else o=0;a=s[e>>2]|0;if((r[e+74>>0]|0)<1)s[e>>2]=a&-33;if(!(s[e+48>>2]|0)){n=s[e+44>>2]|0;s[e+44>>2]=u+136;s[e+28>>2]=u+136;s[e+20>>2]=u+136;s[e+48>>2]=80;s[e+16>>2]=u+136+80;i=Ue(e,t,u+120|0,u,u+80|0)|0;if(n){Tt[s[e+36>>2]&3](e,0,0)|0;i=(s[e+20>>2]|0)==0?-1:i;s[e+44>>2]=n;s[e+48>>2]=0;s[e+16>>2]=0;s[e+28>>2]=0;s[e+20>>2]=0}}else i=Ue(e,t,u+120|0,u,u+80|0)|0;n=s[e>>2]|0;s[e>>2]=n|a&32;if(o|0)Fe(e);i=(n&32|0)==0?i:-1}h=u;return i|0}function Ue(e,t,i,o,u){e=e|0;t=t|0;i=i|0;o=o|0;u=u|0;var c=0,f=0,_=0,p=0,b=0,g=0,y=0,m=0,k=0,v=0,w=0,C=0,M=0,A=0,T=0,S=0,P=0,E=0,x=0,R=0,I=0,L=0,F=0,B=0,H=0,N=0,D=0;D=h;h=h+624|0;F=D+536+40|0;B=D+588|0;H=D+576+12|0;N=D+588+9|0;f=0;c=0;g=0;e:while(1){do{if((c|0)>-1)if((f|0)>(2147483647-c|0)){s[(Le()|0)>>2]=75;c=-1;break}else{c=f+c|0;break}}while(0);f=r[t>>0]|0;if(!(f<<24>>24)){L=243;break}else _=t;t:while(1){switch(f<<24>>24){case 37:{f=_;L=9;break t}case 0:{f=_;break t}default:{}}f=_+1|0;_=f;f=r[f>>0]|0}t:do{if((L|0)==9)while(1){L=0;if((r[_+1>>0]|0)!=37)break t;f=f+1|0;_=_+2|0;if((r[_>>0]|0)==37)L=9;else break}}while(0);f=f-t|0;if(e|0)if(!(s[e>>2]&32))Ve(t,f,e)|0;if(f|0){t=_;continue}p=_+1|0;f=r[p>>0]|0;if(((f<<24>>24)+-48|0)>>>0<10){k=(r[_+2>>0]|0)==36;p=k?_+3|0:p;C=k?(f<<24>>24)+-48|0:-1;k=k?1:g;f=r[p>>0]|0}else{C=-1;k=g}_=(f<<24>>24)+-32|0;t:do{if(_>>>0<32){g=0;do{if(!(1<<_&75913))break t;g=1<<(f<<24>>24)+-32|g;p=p+1|0;f=r[p>>0]|0;_=(f<<24>>24)+-32|0}while(_>>>0<32)}else g=0}while(0);do{if(f<<24>>24==42){m=p+1|0;f=r[m>>0]|0;if(((f<<24>>24)+-48|0)>>>0<10)if((r[p+2>>0]|0)==36){s[u+((f<<24>>24)+-48<<2)>>2]=10;f=s[o+((r[m>>0]|0)+-48<<3)>>2]|0;_=1;m=p+3|0}else L=24;else L=24;if((L|0)==24){L=0;if(k|0){c=-1;break e}if(!e){y=0;I=0;p=m;break}_=(s[i>>2]|0)+(4-1)&~(4-1);f=s[_>>2]|0;s[i>>2]=_+4;_=0}I=(f|0)<0;y=I?0-f|0:f;g=I?g|8192:g;I=_;p=m;f=r[m>>0]|0}else{_=(f<<24>>24)+-48|0;if(_>>>0<10){y=0;do{y=(y*10|0)+_|0;p=p+1|0;f=r[p>>0]|0;_=(f<<24>>24)+-48|0}while(_>>>0<10);if((y|0)<0){c=-1;break e}else I=k}else{y=0;I=k}}}while(0);t:do{if(f<<24>>24==46){f=p+1|0;m=r[f>>0]|0;if(m<<24>>24!=42){if(((m<<24>>24)+-48|0)>>>0<10){_=0;p=(m<<24>>24)+-48|0}else{m=0;break}while(1){_=(_*10|0)+p|0;f=f+1|0;p=(r[f>>0]|0)+-48|0;if(p>>>0>=10){m=_;break t}}}f=p+2|0;_=(r[f>>0]|0)+-48|0;if(_>>>0<10)if((r[p+3>>0]|0)==36){s[u+(_<<2)>>2]=10;m=s[o+((r[f>>0]|0)+-48<<3)>>2]|0;f=p+4|0;break}if(I|0){c=-1;break e}if(e|0){R=(s[i>>2]|0)+(4-1)&~(4-1);m=s[R>>2]|0;s[i>>2]=R+4}else m=0}else{m=-1;f=p}}while(0);w=0;while(1){_=(r[f>>0]|0)+-65|0;if(_>>>0>57){c=-1;break e}R=f+1|0;_=r[3807+(w*58|0)+_>>0]|0;if(((_&255)+-1|0)>>>0<8){w=_&255;f=R}else break}if(!(_<<24>>24)){c=-1;break}p=(C|0)>-1;do{if(_<<24>>24==19)if(p){c=-1;break e}else L=51;else{if(p){s[u+(C<<2)>>2]=_&255;x=o+(C<<3)|0;L=s[x+4>>2]|0;s[D>>2]=s[x>>2];s[D+4>>2]=L;L=51;break}if(!e){c=0;break e}We(D,_&255,i)}}while(0);if((L|0)==51){L=0;if(!e){f=0;g=I;t=R;continue}}T=r[f>>0]|0;T=(w|0)!=0&(T&15|0)==3?T&-33:T;p=g&-65537;k=(g&8192|0)==0?g:p;t:do{switch(T|0){case 110:switch((w&255)<<24>>24){case 0:{s[s[D>>2]>>2]=c;f=0;g=I;t=R;continue e}case 1:{s[s[D>>2]>>2]=c;f=0;g=I;t=R;continue e}case 2:{f=s[D>>2]|0;s[f>>2]=c;s[f+4>>2]=((c|0)<0)<<31>>31;f=0;g=I;t=R;continue e}case 3:{n[s[D>>2]>>1]=c;f=0;g=I;t=R;continue e}case 4:{r[s[D>>2]>>0]=c;f=0;g=I;t=R;continue e}case 6:{s[s[D>>2]>>2]=c;f=0;g=I;t=R;continue e}case 7:{f=s[D>>2]|0;s[f>>2]=c;s[f+4>>2]=((c|0)<0)<<31>>31;f=0;g=I;t=R;continue e}default:{f=0;g=I;t=R;continue e}}case 112:{w=120;m=m>>>0>8?m:8;f=k|8;L=63;break}case 88:case 120:{w=T;f=k;L=63;break}case 111:{f=s[D>>2]|0;_=s[D+4>>2]|0;if((f|0)==0&(_|0)==0)t=F;else{t=F;do{t=t+-1|0;r[t>>0]=f&7|48;f=ut(f|0,_|0,3)|0;_=O}while(!((f|0)==0&(_|0)==0))}if(!(k&8)){_=0;p=4287;f=k;L=76}else{f=F-t|0;_=0;p=4287;m=(m|0)>(f|0)?m:f+1|0;f=k;L=76}break}case 105:case 100:{f=s[D>>2]|0;t=s[D+4>>2]|0;if((t|0)<0){f=st(0,0,f|0,t|0)|0;t=O;s[D>>2]=f;s[D+4>>2]=t;_=1;p=4287;L=75;break t}if(!(k&2048)){_=k&1;p=(k&1|0)==0?4287:4289;L=75}else{_=1;p=4288;L=75}break}case 117:{_=0;p=4287;f=s[D>>2]|0;t=s[D+4>>2]|0;L=75;break}case 99:{r[D+536+39>>0]=s[D>>2];t=D+536+39|0;C=0;w=4287;_=F;m=1;k=p;break}case 109:{f=Ne(s[(Le()|0)>>2]|0)|0;L=81;break}case 115:{f=s[D>>2]|0;f=f|0?f:4297;L=81;break}case 67:{s[D+8>>2]=s[D>>2];s[D+8+4>>2]=0;s[D>>2]=D+8;m=-1;_=D+8|0;L=85;break}case 83:{f=s[D>>2]|0;if(!m){Ye(e,32,y,0,k);f=0;L=96}else{_=f;L=85}break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{b=+l[D>>3];s[D+16>>2]=0;l[d>>3]=b;if((s[d+4>>2]|0)<0){b=-b;P=1;x=4304}else if(!(k&2048)){P=k&1;x=(k&1|0)==0?4305:4310}else{P=1;x=4307}l[d>>3]=b;E=s[d+4>>2]&2146435072;do{if(E>>>0<2146435072|(E|0)==2146435072&0<0){v=+Ge(b,D+16|0)*2;if(v!=0)s[D+16>>2]=(s[D+16>>2]|0)+-1;if((T|32|0)==97){w=(T&32|0)==0?x:x+9|0;g=P|2;f=12-m|0;do{if(m>>>0>11|(f|0)==0)b=v;else{b=8;do{f=f+-1|0;b=b*16}while((f|0)!=0);if((r[w>>0]|0)==45){b=-(b+(-v-b));break}else{b=v+b-b;break}}}while(0);t=s[D+16>>2]|0;f=(t|0)<0?0-t|0:t;f=ze(f,((f|0)<0)<<31>>31,D+576+12|0)|0;if((f|0)==(D+576+12|0)){r[D+576+11>>0]=48;f=D+576+11|0}r[f+-1>>0]=(t>>31&2)+43;p=f+-2|0;r[p>>0]=T+15;_=(m|0)<1;t=D+588|0;do{x=~~b;f=t+1|0;r[t>>0]=a[4271+x>>0]|T&32;b=(b-+(x|0))*16;do{if((f-B|0)==1){if((k&8|0)==0&(_&b==0)){t=f;break}r[f>>0]=46;t=t+2|0}else t=f}while(0)}while(b!=0);f=(m|0)!=0&(-2-B+t|0)<(m|0)?H+2+m-p|0:H-B-p+t|0;Ye(e,32,y,f+g|0,k);if(!(s[e>>2]&32))Ve(w,g,e)|0;Ye(e,48,y,f+g|0,k^65536);if(!(s[e>>2]&32))Ve(D+588|0,t-B|0,e)|0;Ye(e,48,f-(t-B+(H-p))|0,0,0);if(!(s[e>>2]&32))Ve(p,H-p|0,e)|0;Ye(e,32,y,f+g|0,k^8192);f=(f+g|0)<(y|0)?y:f+g|0;break}f=(m|0)<0?6:m;if(v!=0){_=(s[D+16>>2]|0)+-28|0;s[D+16>>2]=_;b=v*268435456}else{b=v;_=s[D+16>>2]|0}E=(_|0)<0?D+24|0:D+24+288|0;t=E;do{S=~~b>>>0;s[t>>2]=S;t=t+4|0;b=(b-+(S>>>0))*1e9}while(b!=0);if((_|0)>0){m=E;while(1){g=(_|0)>29?29:_;_=t+-4|0;do{if(_>>>0<m>>>0)p=m;else{p=0;do{A=ct(s[_>>2]|0,0,g|0)|0;A=at(A|0,O|0,p|0,0)|0;S=O;M=pt(A|0,S|0,1e9,0)|0;s[_>>2]=M;p=_t(A|0,S|0,1e9,0)|0;_=_+-4|0}while(_>>>0>=m>>>0);if(!p){p=m;break}S=m+-4|0;s[S>>2]=p;p=S}}while(0);while(1){if(t>>>0<=p>>>0)break;_=t+-4|0;if(!(s[_>>2]|0))t=_;else break}_=(s[D+16>>2]|0)-g|0;s[D+16>>2]=_;if((_|0)>0)m=p;else break}}else p=E;if((_|0)<0){do{m=0-_|0;m=(m|0)>9?9:m;do{if(p>>>0<t>>>0){g=0;_=p;do{S=s[_>>2]|0;s[_>>2]=(S>>>m)+g;g=K(S&(1<<m)+-1,1e9>>>m)|0;_=_+4|0}while(_>>>0<t>>>0);_=(s[p>>2]|0)==0?p+4|0:p;if(!g){p=_;break}s[t>>2]=g;p=_;t=t+4|0}else p=(s[p>>2]|0)==0?p+4|0:p}while(0);_=(T|32|0)==102?E:p;t=(t-_>>2|0)>(((f+25|0)/9|0)+1|0)?_+(((f+25|0)/9|0)+1<<2)|0:t;_=(s[D+16>>2]|0)+m|0;s[D+16>>2]=_}while((_|0)<0);_=p}else _=p;do{if(_>>>0<t>>>0){p=(E-_>>2)*9|0;m=s[_>>2]|0;if(m>>>0<10)break;else g=10;do{g=g*10|0;p=p+1|0}while(m>>>0>=g>>>0)}else p=0}while(0);g=f-((T|32|0)!=102?p:0)+(((f|0)!=0&(T|32|0)==103)<<31>>31)|0;if((g|0)<(((t-E>>2)*9|0)+-9|0)){w=E+4+(((g+9216|0)/9|0)+-1024<<2)|0;if((((g+9216|0)%9|0)+1|0)<9){m=((g+9216|0)%9|0)+1|0;g=10;do{g=g*10|0;m=m+1|0}while((m|0)!=9)}else g=10;M=s[w>>2]|0;A=(M>>>0)%(g>>>0)|0;m=(w+4|0)==(t|0);do{if(m&(A|0)==0)g=w;else{v=(((M>>>0)/(g>>>0)|0)&1|0)==0?9007199254740992:9007199254740994;C=(g|0)/2|0;if(A>>>0<C>>>0)b=.5;else b=m&(A|0)==(C|0)?1:1.5;do{if(P){if((r[x>>0]|0)!=45)break;b=-b;v=-v}}while(0);s[w>>2]=M-A;if(!(v+b!=v)){g=w;break}S=M-A+g|0;s[w>>2]=S;if(S>>>0>999999999){g=w;while(1){p=g+-4|0;s[g>>2]=0;if(p>>>0<_>>>0){_=_+-4|0;s[_>>2]=0}S=(s[p>>2]|0)+1|0;s[p>>2]=S;if(S>>>0>999999999)g=p;else{w=p;break}}}p=(E-_>>2)*9|0;m=s[_>>2]|0;if(m>>>0<10){g=w;break}else g=10;do{g=g*10|0;p=p+1|0}while(m>>>0>=g>>>0);g=w}}while(0);S=g+4|0;t=t>>>0>S>>>0?S:t}C=0-p|0;S=t;while(1){if(S>>>0<=_>>>0){A=0;break}t=S+-4|0;if(!(s[t>>2]|0))S=t;else{A=1;break}}do{if((T|32|0)==103){if((((f|0)!=0^1)+f|0)>(p|0)&(p|0)>-5){w=T+-1|0;f=((f|0)!=0^1)+f+-1-p|0}else{w=T+-2|0;f=((f|0)!=0^1)+f+-1|0}if(k&8|0){m=k&8;break}do{if(A){m=s[S+-4>>2]|0;if(!m){t=9;break}if(!((m>>>0)%10|0)){t=0;g=10}else{t=0;break}do{g=g*10|0;t=t+1|0}while(!((m>>>0)%(g>>>0)|0|0))}else t=9}while(0);g=((S-E>>2)*9|0)+-9|0;if((w|32|0)==102){m=g-t|0;m=(m|0)<0?0:m;f=(f|0)<(m|0)?f:m;m=0;break}else{m=g+p-t|0;m=(m|0)<0?0:m;f=(f|0)<(m|0)?f:m;m=0;break}}else{w=T;m=k&8}}while(0);M=f|m;g=(w|32|0)==102;if(g){C=0;t=(p|0)>0?p:0}else{t=(p|0)<0?C:p;t=ze(t,((t|0)<0)<<31>>31,D+576+12|0)|0;if((H-t|0)<2)do{t=t+-1|0;r[t>>0]=48}while((H-t|0)<2);r[t+-1>>0]=(p>>31&2)+43;t=t+-2|0;r[t>>0]=w;C=t;t=H-t|0}T=P+1+f+((M|0)!=0&1)+t|0;Ye(e,32,y,T,k);if(!(s[e>>2]&32))Ve(x,P,e)|0;Ye(e,48,y,T,k^65536);do{if(g){p=_>>>0>E>>>0?E:_;_=p;do{t=ze(s[_>>2]|0,0,N)|0;do{if((_|0)==(p|0)){if((t|0)!=(N|0))break;r[D+588+8>>0]=48;t=D+588+8|0}else{if(t>>>0<=(D+588|0)>>>0)break;ot(D+588|0,48,t-B|0)|0;do{t=t+-1|0}while(t>>>0>(D+588|0)>>>0)}}while(0);if(!(s[e>>2]&32))Ve(t,N-t|0,e)|0;_=_+4|0}while(_>>>0<=E>>>0);do{if(M|0){if(s[e>>2]&32|0)break;Ve(4339,1,e)|0}}while(0);if((f|0)>0&_>>>0<S>>>0)while(1){t=ze(s[_>>2]|0,0,N)|0;if(t>>>0>(D+588|0)>>>0){ot(D+588|0,48,t-B|0)|0;do{t=t+-1|0}while(t>>>0>(D+588|0)>>>0)}if(!(s[e>>2]&32))Ve(t,(f|0)>9?9:f,e)|0;_=_+4|0;t=f+-9|0;if(!((f|0)>9&_>>>0<S>>>0)){f=t;break}else f=t}Ye(e,48,f+9|0,9,0)}else{w=A?S:_+4|0;if((f|0)>-1){m=(m|0)==0;g=_;do{t=ze(s[g>>2]|0,0,N)|0;if((t|0)==(N|0)){r[D+588+8>>0]=48;t=D+588+8|0}do{if((g|0)==(_|0)){p=t+1|0;if(!(s[e>>2]&32))Ve(t,1,e)|0;if(m&(f|0)<1){t=p;break}if(s[e>>2]&32|0){t=p;break}Ve(4339,1,e)|0;t=p}else{if(t>>>0<=(D+588|0)>>>0)break;ot(D+588|0,48,t+(0-B)|0)|0;do{t=t+-1|0}while(t>>>0>(D+588|0)>>>0)}}while(0);p=N-t|0;if(!(s[e>>2]&32))Ve(t,(f|0)>(p|0)?p:f,e)|0;f=f-p|0;g=g+4|0}while(g>>>0<w>>>0&(f|0)>-1)}Ye(e,48,f+18|0,18,0);if(s[e>>2]&32|0)break;Ve(C,H-C|0,e)|0}}while(0);Ye(e,32,y,T,k^8192);f=(T|0)<(y|0)?y:T}else{_=b!=b|0!=0;t=_?0:P;Ye(e,32,y,t+3|0,p);f=s[e>>2]|0;if(!(f&32)){Ve(x,t,e)|0;f=s[e>>2]|0}if(!(f&32))Ve(_?T&32|0?4331:4335:T&32|0?4323:4327,3,e)|0;Ye(e,32,y,t+3|0,k^8192);f=(t+3|0)<(y|0)?y:t+3|0}}while(0);g=I;t=R;continue e}default:{C=0;w=4287;_=F}}}while(0);t:do{if((L|0)==63){_=s[D>>2]|0;p=s[D+4>>2]|0;g=w&32;if((_|0)==0&(p|0)==0){t=F;_=0;p=0}else{t=F;do{t=t+-1|0;r[t>>0]=a[4271+(_&15)>>0]|g;_=ut(_|0,p|0,4)|0;p=O}while(!((_|0)==0&(p|0)==0));_=s[D>>2]|0;p=s[D+4>>2]|0}p=(f&8|0)==0|(_|0)==0&(p|0)==0;_=p?0:2;p=p?4287:4287+(w>>4)|0;L=76}else if((L|0)==75){t=ze(f,t,F)|0;f=k;L=76}else if((L|0)==81){L=0;k=qe(f,0,m)|0;t=f;C=0;w=4287;_=(k|0)==0?f+m|0:k;m=(k|0)==0?m:k-f|0;k=p}else if((L|0)==85){L=0;g=_;f=0;t=0;while(1){p=s[g>>2]|0;if(!p)break;t=Ke(D+528|0,p)|0;if((t|0)<0|t>>>0>(m-f|0)>>>0)break;f=t+f|0;if(m>>>0>f>>>0)g=g+4|0;else break}if((t|0)<0){c=-1;break e}Ye(e,32,y,f,k);if(!f){f=0;L=96}else{p=0;while(1){t=s[_>>2]|0;if(!t){L=96;break t}t=Ke(D+528|0,t)|0;p=t+p|0;if((p|0)>(f|0)){L=96;break t}if(!(s[e>>2]&32))Ve(D+528|0,t,e)|0;if(p>>>0>=f>>>0){L=96;break}else _=_+4|0}}}}while(0);if((L|0)==96){L=0;Ye(e,32,y,f,k^8192);f=(y|0)>(f|0)?y:f;g=I;t=R;continue}if((L|0)==76){L=0;k=(m|0)>-1?f&-65537:f;f=(s[D>>2]|0)!=0|(s[D+4>>2]|0)!=0;if((m|0)!=0|f){x=(f&1^1)+(F-t)|0;C=_;w=p;_=F;m=(m|0)>(x|0)?m:x}else{t=F;C=_;w=p;_=F;m=0}}g=_-t|0;_=(m|0)<(g|0)?g:m;p=_+C|0;f=(y|0)<(p|0)?p:y;Ye(e,32,f,p,k);if(!(s[e>>2]&32))Ve(w,C,e)|0;Ye(e,48,f,p,k^65536);Ye(e,48,_,g,0);if(!(s[e>>2]&32))Ve(t,g,e)|0;Ye(e,32,f,p,k^8192);g=I;t=R}e:do{if((L|0)==243)if(!e)if(!g)c=0;else{c=1;while(1){f=s[u+(c<<2)>>2]|0;if(!f)break;We(o+(c<<3)|0,f,i);c=c+1|0;if((c|0)>=10){c=1;break e}}while(1){if(s[u+(c<<2)>>2]|0){c=-1;break e}c=c+1|0;if((c|0)>=10){c=1;break}}}}while(0);h=D;return c|0}function je(e){e=e|0;return 0}function Ve(e,t,i){e=e|0;t=t|0;i=i|0;var n=0,a=0,o=0;n=s[i+16>>2]|0;if(!n)if(!(Qe(i)|0)){n=s[i+16>>2]|0;a=5}else n=0;else a=5;e:do{if((a|0)==5){a=s[i+20>>2]|0;if((n-a|0)>>>0<t>>>0){n=Tt[s[i+36>>2]&3](i,e,t)|0;break}t:do{if((r[i+75>>0]|0)>-1){n=t;while(1){if(!n){o=e;n=0;break t}o=n+-1|0;if((r[e+o>>0]|0)==10)break;else n=o}if((Tt[s[i+36>>2]&3](i,e,n)|0)>>>0<n>>>0)break e;t=t-n|0;o=e+n|0;a=s[i+20>>2]|0}else{o=e;n=0}}while(0);lt(a|0,o|0,t|0)|0;s[i+20>>2]=(s[i+20>>2]|0)+t;n=n+t|0}}while(0);return n|0}function We(e,t,i){e=e|0;t=t|0;i=i|0;var r=0,n=0,a=0;e:do{if(t>>>0<=20)do{switch(t|0){case 9:{r=(s[i>>2]|0)+(4-1)&~(4-1);t=s[r>>2]|0;s[i>>2]=r+4;s[e>>2]=t;break e}case 10:{t=(s[i>>2]|0)+(4-1)&~(4-1);r=s[t>>2]|0;s[i>>2]=t+4;s[e>>2]=r;s[e+4>>2]=((r|0)<0)<<31>>31;break e}case 11:{t=(s[i>>2]|0)+(4-1)&~(4-1);r=s[t>>2]|0;s[i>>2]=t+4;s[e>>2]=r;s[e+4>>2]=0;break e}case 12:{n=(s[i>>2]|0)+(8-1)&~(8-1);t=s[n>>2]|0;r=s[n+4>>2]|0;s[i>>2]=n+8;s[e>>2]=t;s[e+4>>2]=r;break e}case 13:{r=(s[i>>2]|0)+(4-1)&~(4-1);n=s[r>>2]|0;s[i>>2]=r+4;s[e>>2]=(n&65535)<<16>>16;s[e+4>>2]=(((n&65535)<<16>>16|0)<0)<<31>>31;break e}case 14:{r=(s[i>>2]|0)+(4-1)&~(4-1);n=s[r>>2]|0;s[i>>2]=r+4;s[e>>2]=n&65535;s[e+4>>2]=0;break e}case 15:{r=(s[i>>2]|0)+(4-1)&~(4-1);n=s[r>>2]|0;s[i>>2]=r+4;s[e>>2]=(n&255)<<24>>24;s[e+4>>2]=(((n&255)<<24>>24|0)<0)<<31>>31;break e}case 16:{r=(s[i>>2]|0)+(4-1)&~(4-1);n=s[r>>2]|0;s[i>>2]=r+4;s[e>>2]=n&255;s[e+4>>2]=0;break e}case 17:{n=(s[i>>2]|0)+(8-1)&~(8-1);a=+l[n>>3];s[i>>2]=n+8;l[e>>3]=a;break e}case 18:{n=(s[i>>2]|0)+(8-1)&~(8-1);a=+l[n>>3];s[i>>2]=n+8;l[e>>3]=a;break e}default:break e}}while(0)}while(0);return}function ze(e,t,i){e=e|0;t=t|0;i=i|0;var n=0;if(t>>>0>0|(t|0)==0&e>>>0>4294967295){while(1){n=pt(e|0,t|0,10,0)|0;i=i+-1|0;r[i>>0]=n|48;n=e;e=_t(e|0,t|0,10,0)|0;if(!(t>>>0>9|(t|0)==9&n>>>0>4294967295))break;else t=O}t=e}else t=e;if(t)while(1){i=i+-1|0;r[i>>0]=(t>>>0)%10|0|48;if(t>>>0<10)break;else t=(t>>>0)/10|0}return i|0}function qe(e,t,i){e=e|0;t=t|0;i=i|0;var n=0,a=0,o=0;e:do{if((i|0)!=0&(e&3|0)!=0){n=e;e=i;while(1){if((r[n>>0]|0)==(t&255)<<24>>24){a=6;break e}n=n+1|0;i=e+-1|0;if((i|0)!=0&(n&3|0)!=0)e=i;else{e=i;i=(i|0)!=0;a=5;break}}}else{n=e;e=i;i=(i|0)!=0;a=5}}while(0);if((a|0)==5)if(i)a=6;else e=0;e:do{if((a|0)==6)if((r[n>>0]|0)!=(t&255)<<24>>24){i=K(t&255,16843009)|0;t:do{if(e>>>0>3)while(1){o=s[n>>2]^i;if((o&-2139062144^-2139062144)&o+-16843009|0)break;n=n+4|0;e=e+-4|0;if(e>>>0<=3){a=11;break t}}else a=11}while(0);if((a|0)==11)if(!e){e=0;break}while(1){if((r[n>>0]|0)==(t&255)<<24>>24)break e;n=n+1|0;e=e+-1|0;if(!e){e=0;break}}}}while(0);return(e|0?n:0)|0}function Ye(e,t,i,r,n){e=e|0;t=t|0;i=i|0;r=r|0;n=n|0;var a=0,o=0,u=0;u=h;h=h+256|0;do{if((i|0)>(r|0)&(n&73728|0)==0){ot(u|0,t|0,((i-r|0)>>>0>256?256:i-r|0)|0)|0;t=s[e>>2]|0;if((i-r|0)>>>0>255){o=i-r|0;n=t;a=(t&32|0)==0;while(1){if(a){Ve(u,256,e)|0;t=s[e>>2]|0}else t=n;o=o+-256|0;a=(t&32|0)==0;if(o>>>0<=255)break;else n=t}if(a)t=i-r&255;else break}else if(!(t&32))t=i-r|0;else break;Ve(u,t,e)|0}}while(0);h=u;return}function Ke(e,t){e=e|0;t=t|0;if(!e)e=0;else e=Je(e,t,0)|0;return e|0}function Ge(e,t){e=+e;t=t|0;return+ +Xe(e,t)}function Xe(e,t){e=+e;t=t|0;var i=0,r=0,n=0;l[d>>3]=e;i=s[d>>2]|0;r=s[d+4>>2]|0;n=ut(i|0,r|0,52)|0;switch(n&2047){case 0:{if(e!=0){e=+Xe(e*0x10000000000000000,t);i=(s[t>>2]|0)+-64|0}else i=0;s[t>>2]=i;break}case 2047:break;default:{s[t>>2]=(n&2047)+-1022;s[d>>2]=i;s[d+4>>2]=r&-2146435073|1071644672;e=+l[d>>3]}}return+e}function Je(e,t,i){e=e|0;t=t|0;i=i|0;do{if(!e)e=1;else{if(t>>>0<128){r[e>>0]=t;e=1;break}if(t>>>0<2048){r[e>>0]=t>>>6|192;r[e+1>>0]=t&63|128;e=2;break}if(t>>>0<55296|(t&-8192|0)==57344){r[e>>0]=t>>>12|224;r[e+1>>0]=t>>>6&63|128;r[e+2>>0]=t&63|128;e=3;break}if((t+-65536|0)>>>0<1048576){r[e>>0]=t>>>18|240;r[e+1>>0]=t>>>12&63|128;r[e+2>>0]=t>>>6&63|128;r[e+3>>0]=t&63|128;e=4;break}else{s[(Le()|0)>>2]=84;e=-1;break}}}while(0);return e|0}function Qe(e){e=e|0;var t=0;t=r[e+74>>0]|0;r[e+74>>0]=t+255|t;t=s[e>>2]|0;if(!(t&8)){s[e+8>>2]=0;s[e+4>>2]=0;t=s[e+44>>2]|0;s[e+28>>2]=t;s[e+20>>2]=t;s[e+16>>2]=t+(s[e+48>>2]|0);e=0}else{s[e>>2]=t|32;e=-1}return e|0}function $e(e,t,i){e=e|0;t=t|0;i=i|0;var r=0;r=h;h=h+16|0;s[r>>2]=i;i=De(e,t,r)|0;h=r;return i|0}function Ze(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;var n=0,a=0;n=K(i,t)|0;if((s[r+76>>2]|0)>-1){a=(je(r)|0)==0;e=Ve(e,n,r)|0;if(!a)Fe(r)}else e=Ve(e,n,r)|0;if((e|0)!=(n|0))i=(e>>>0)/(t>>>0)|0;return i|0}function et(e,t){e=e|0;t=t|0;var i=0,n=0,o=0,u=0;u=h;h=h+16|0;r[u>>0]=t;i=s[e+16>>2]|0;if(!i)if(!(Qe(e)|0)){n=s[e+16>>2]|0;o=4}else i=-1;else{n=i;o=4}do{if((o|0)==4){i=s[e+20>>2]|0;if(i>>>0<n>>>0)if((t&255|0)!=(r[e+75>>0]|0)){s[e+20>>2]=i+1;r[i>>0]=t;i=t&255;break}if((Tt[s[e+36>>2]&3](e,u,1)|0)==1)i=a[u>>0]|0;else i=-1}}while(0);h=u;return i|0}function tt(e,t){e=e|0;t=t|0;var i=0,n=0;if((s[t+76>>2]|0)<0)n=3;else if(!(je(t)|0))n=3;else{if((r[t+75>>0]|0)==(e|0))n=10;else{i=s[t+20>>2]|0;if(i>>>0<(s[t+16>>2]|0)>>>0){s[t+20>>2]=i+1;r[i>>0]=e;i=e&255}else n=10}if((n|0)==10)i=et(t,e)|0;Fe(t)}do{if((n|0)==3){if((r[t+75>>0]|0)!=(e|0)){i=s[t+20>>2]|0;if(i>>>0<(s[t+16>>2]|0)>>>0){s[t+20>>2]=i+1;r[i>>0]=e;i=e&255;break}}i=et(t,e)|0}}while(0);return i|0}function it(e){e=e|0;var t=0,i=0,r=0,n=0,a=0,o=0,u=0,c=0,l=0,f=0,_=0,d=0,p=0,b=0,g=0,y=0,m=0,k=0,v=0,w=0,C=0,M=0,A=0,T=0,S=0;S=h;h=h+16|0;do{if(e>>>0<245){g=e>>>0<11?16:e+11&-8;b=s[1119]|0;if(b>>>(g>>>3)&3|0){e=4516+((b>>>(g>>>3)&1^1)+(g>>>3)<<1<<2)|0;t=s[e+8>>2]|0;i=s[t+8>>2]|0;do{if((e|0)==(i|0))s[1119]=b&~(1<<(b>>>(g>>>3)&1^1)+(g>>>3));else{if(i>>>0<(s[1123]|0)>>>0)oe();if((s[i+12>>2]|0)==(t|0)){s[i+12>>2]=e;s[e+8>>2]=i;break}else oe()}}while(0);T=(b>>>(g>>>3)&1^1)+(g>>>3)<<3;s[t+4>>2]=T|3;s[t+T+4>>2]=s[t+T+4>>2]|1;T=t+8|0;h=S;return T|0}p=s[1121]|0;if(g>>>0>p>>>0){if(b>>>(g>>>3)|0){e=b>>>(g>>>3)<<(g>>>3)&(2<<(g>>>3)|0-(2<<(g>>>3)));r=((e&0-e)+-1|0)>>>(((e&0-e)+-1|0)>>>12&16);i=r>>>(r>>>5&8)>>>(r>>>(r>>>5&8)>>>2&4);i=(r>>>5&8|((e&0-e)+-1|0)>>>12&16|r>>>(r>>>5&8)>>>2&4|i>>>1&2|i>>>(i>>>1&2)>>>1&1)+(i>>>(i>>>1&2)>>>(i>>>(i>>>1&2)>>>1&1))|0;r=s[4516+(i<<1<<2)+8>>2]|0;e=s[r+8>>2]|0;do{if((4516+(i<<1<<2)|0)==(e|0)){s[1119]=b&~(1<<i);n=b&~(1<<i)}else{if(e>>>0<(s[1123]|0)>>>0)oe();if((s[e+12>>2]|0)==(r|0)){s[e+12>>2]=4516+(i<<1<<2);s[4516+(i<<1<<2)+8>>2]=e;n=b;break}else oe()}}while(0);s[r+4>>2]=g|3;s[r+g+4>>2]=(i<<3)-g|1;s[r+g+((i<<3)-g)>>2]=(i<<3)-g;if(p|0){t=s[1124]|0;if(!(n&1<<(p>>>3))){s[1119]=n|1<<(p>>>3);a=4516+(p>>>3<<1<<2)|0;o=4516+(p>>>3<<1<<2)+8|0}else{e=s[4516+(p>>>3<<1<<2)+8>>2]|0;if(e>>>0<(s[1123]|0)>>>0)oe();else{a=e;o=4516+(p>>>3<<1<<2)+8|0}}s[o>>2]=t;s[a+12>>2]=t;s[t+8>>2]=a;s[t+12>>2]=4516+(p>>>3<<1<<2)}s[1121]=(i<<3)-g;s[1124]=r+g;T=r+8|0;h=S;return T|0}l=s[1120]|0;if(l){t=((l&0-l)+-1|0)>>>(((l&0-l)+-1|0)>>>12&16);c=t>>>(t>>>5&8)>>>(t>>>(t>>>5&8)>>>2&4);c=s[4780+((t>>>5&8|((l&0-l)+-1|0)>>>12&16|t>>>(t>>>5&8)>>>2&4|c>>>1&2|c>>>(c>>>1&2)>>>1&1)+(c>>>(c>>>1&2)>>>(c>>>(c>>>1&2)>>>1&1))<<2)>>2]|0;t=c;u=c;c=(s[c+4>>2]&-8)-g|0;while(1){e=s[t+16>>2]|0;if(!e){e=s[t+20>>2]|0;if(!e)break}T=(s[e+4>>2]&-8)-g|0;A=T>>>0<c>>>0;t=e;u=A?e:u;c=A?T:c}n=s[1123]|0;if(u>>>0<n>>>0)oe();o=u+g|0;if(u>>>0>=o>>>0)oe();a=s[u+24>>2]|0;e=s[u+12>>2]|0;do{if((e|0)==(u|0)){t=u+20|0;e=s[t>>2]|0;if(!e){t=u+16|0;e=s[t>>2]|0;if(!e){f=0;break}}while(1){i=e+20|0;r=s[i>>2]|0;if(r|0){e=r;t=i;continue}i=e+16|0;r=s[i>>2]|0;if(!r)break;else{e=r;t=i}}if(t>>>0<n>>>0)oe();else{s[t>>2]=0;f=e;break}}else{t=s[u+8>>2]|0;if(t>>>0<n>>>0)oe();if((s[t+12>>2]|0)!=(u|0))oe();if((s[e+8>>2]|0)==(u|0)){s[t+12>>2]=e;s[e+8>>2]=t;f=e;break}else oe()}}while(0);do{if(a|0){e=s[u+28>>2]|0;if((u|0)==(s[4780+(e<<2)>>2]|0)){s[4780+(e<<2)>>2]=f;if(!f){s[1120]=l&~(1<<e);break}}else{if(a>>>0<(s[1123]|0)>>>0)oe();if((s[a+16>>2]|0)==(u|0))s[a+16>>2]=f;else s[a+20>>2]=f;if(!f)break}t=s[1123]|0;if(f>>>0<t>>>0)oe();s[f+24>>2]=a;e=s[u+16>>2]|0;do{if(e|0)if(e>>>0<t>>>0)oe();else{s[f+16>>2]=e;s[e+24>>2]=f;break}}while(0);e=s[u+20>>2]|0;if(e|0)if(e>>>0<(s[1123]|0)>>>0)oe();else{s[f+20>>2]=e;s[e+24>>2]=f;break}}}while(0);if(c>>>0<16){T=c+g|0;s[u+4>>2]=T|3;T=u+T+4|0;s[T>>2]=s[T>>2]|1}else{s[u+4>>2]=g|3;s[o+4>>2]=c|1;s[o+c>>2]=c;if(p|0){t=s[1124]|0;if(!(b&1<<(p>>>3))){s[1119]=b|1<<(p>>>3);_=4516+(p>>>3<<1<<2)|0;d=4516+(p>>>3<<1<<2)+8|0}else{e=s[4516+(p>>>3<<1<<2)+8>>2]|0;if(e>>>0<(s[1123]|0)>>>0)oe();else{_=e;d=4516+(p>>>3<<1<<2)+8|0}}s[d>>2]=t;s[_+12>>2]=t;s[t+8>>2]=_;s[t+12>>2]=4516+(p>>>3<<1<<2)}s[1121]=c;s[1124]=o}T=u+8|0;h=S;return T|0}}}else if(e>>>0>4294967231)g=-1;else{g=e+11&-8;l=s[1120]|0;if(l){if(!((e+11|0)>>>8))o=0;else if(g>>>0>16777215)o=31;else{o=(e+11|0)>>>8<<((((e+11|0)>>>8)+1048320|0)>>>16&8);o=14-((o+520192|0)>>>16&4|(((e+11|0)>>>8)+1048320|0)>>>16&8|((o<<((o+520192|0)>>>16&4))+245760|0)>>>16&2)+(o<<((o+520192|0)>>>16&4)<<(((o<<((o+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;o=g>>>(o+7|0)&1|o<<1}e=s[4780+(o<<2)>>2]|0;e:do{if(!e){e=0;i=0;t=0-g|0;k=86}else{i=0;t=0-g|0;a=g<<((o|0)==31?0:25-(o>>>1)|0);n=0;while(1){r=(s[e+4>>2]&-8)-g|0;if(r>>>0<t>>>0)if(!r){n=e;t=0;i=e;k=90;break e}else{i=e;t=r}r=s[e+20>>2]|0;e=s[e+16+(a>>>31<<2)>>2]|0;n=(r|0)==0|(r|0)==(e|0)?n:r;r=(e|0)==0;if(r){e=n;k=86;break}else a=a<<(r&1^1)}}}while(0);if((k|0)==86){if((e|0)==0&(i|0)==0){e=2<<o;if(!(l&(e|0-e)))break;_=(l&(e|0-e)&0-(l&(e|0-e)))+-1|0;d=_>>>(_>>>12&16)>>>(_>>>(_>>>12&16)>>>5&8);e=d>>>(d>>>2&4)>>>(d>>>(d>>>2&4)>>>1&2);e=s[4780+((_>>>(_>>>12&16)>>>5&8|_>>>12&16|d>>>2&4|d>>>(d>>>2&4)>>>1&2|e>>>1&1)+(e>>>(e>>>1&1))<<2)>>2]|0}if(!e){c=i;u=t}else{n=i;i=e;k=90}}if((k|0)==90)while(1){k=0;r=(s[i+4>>2]&-8)-g|0;e=r>>>0<t>>>0;t=e?r:t;e=e?i:n;r=s[i+16>>2]|0;if(r|0){n=e;i=r;k=90;continue}i=s[i+20>>2]|0;if(!i){c=e;u=t;break}else{n=e;k=90}}if(c)if(u>>>0<((s[1121]|0)-g|0)>>>0){n=s[1123]|0;if(c>>>0<n>>>0)oe();o=c+g|0;if(c>>>0>=o>>>0)oe();a=s[c+24>>2]|0;e=s[c+12>>2]|0;do{if((e|0)==(c|0)){t=c+20|0;e=s[t>>2]|0;if(!e){t=c+16|0;e=s[t>>2]|0;if(!e){p=0;break}}while(1){i=e+20|0;r=s[i>>2]|0;if(r|0){e=r;t=i;continue}i=e+16|0;r=s[i>>2]|0;if(!r)break;else{e=r;t=i}}if(t>>>0<n>>>0)oe();else{s[t>>2]=0;p=e;break}}else{t=s[c+8>>2]|0;if(t>>>0<n>>>0)oe();if((s[t+12>>2]|0)!=(c|0))oe();if((s[e+8>>2]|0)==(c|0)){s[t+12>>2]=e;s[e+8>>2]=t;p=e;break}else oe()}}while(0);do{if(!a)m=l;else{e=s[c+28>>2]|0;if((c|0)==(s[4780+(e<<2)>>2]|0)){s[4780+(e<<2)>>2]=p;if(!p){s[1120]=l&~(1<<e);m=l&~(1<<e);break}}else{if(a>>>0<(s[1123]|0)>>>0)oe();if((s[a+16>>2]|0)==(c|0))s[a+16>>2]=p;else s[a+20>>2]=p;if(!p){m=l;break}}t=s[1123]|0;if(p>>>0<t>>>0)oe();s[p+24>>2]=a;e=s[c+16>>2]|0;do{if(e|0)if(e>>>0<t>>>0)oe();else{s[p+16>>2]=e;s[e+24>>2]=p;break}}while(0);e=s[c+20>>2]|0;if(!e)m=l;else if(e>>>0<(s[1123]|0)>>>0)oe();else{s[p+20>>2]=e;s[e+24>>2]=p;m=l;break}}}while(0);do{if(u>>>0<16){T=u+g|0;s[c+4>>2]=T|3;T=c+T+4|0;s[T>>2]=s[T>>2]|1}else{s[c+4>>2]=g|3;s[o+4>>2]=u|1;s[o+u>>2]=u;t=u>>>3;if(u>>>0<256){e=s[1119]|0;if(!(e&1<<t)){s[1119]=e|1<<t;b=4516+(t<<1<<2)|0;y=4516+(t<<1<<2)+8|0}else{e=s[4516+(t<<1<<2)+8>>2]|0;if(e>>>0<(s[1123]|0)>>>0)oe();else{b=e;y=4516+(t<<1<<2)+8|0}}s[y>>2]=o;s[b+12>>2]=o;s[o+8>>2]=b;s[o+12>>2]=4516+(t<<1<<2);break}e=u>>>8;if(!e)e=0;else if(u>>>0>16777215)e=31;else{T=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(T+245760|0)>>>16&2)+(T<<((T+245760|0)>>>16&2)>>>15)|0;e=u>>>(e+7|0)&1|e<<1}i=4780+(e<<2)|0;s[o+28>>2]=e;s[o+16+4>>2]=0;s[o+16>>2]=0;t=1<<e;if(!(m&t)){s[1120]=m|t;s[i>>2]=o;s[o+24>>2]=i;s[o+12>>2]=o;s[o+8>>2]=o;break}t=u<<((e|0)==31?0:25-(e>>>1)|0);r=s[i>>2]|0;while(1){if((s[r+4>>2]&-8|0)==(u|0)){k=148;break}i=r+16+(t>>>31<<2)|0;e=s[i>>2]|0;if(!e){k=145;break}else{t=t<<1;r=e}}if((k|0)==145)if(i>>>0<(s[1123]|0)>>>0)oe();else{s[i>>2]=o;s[o+24>>2]=r;s[o+12>>2]=o;s[o+8>>2]=o;break}else if((k|0)==148){e=r+8|0;t=s[e>>2]|0;T=s[1123]|0;if(t>>>0>=T>>>0&r>>>0>=T>>>0){s[t+12>>2]=o;s[e>>2]=o;s[o+8>>2]=t;s[o+12>>2]=r;s[o+24>>2]=0;break}else oe()}}}while(0);T=c+8|0;h=S;return T|0}}}}while(0);i=s[1121]|0;if(i>>>0>=g>>>0){e=i-g|0;t=s[1124]|0;if(e>>>0>15){T=t+g|0;s[1124]=T;s[1121]=e;s[T+4>>2]=e|1;s[T+e>>2]=e;s[t+4>>2]=g|3}else{s[1121]=0;s[1124]=0;s[t+4>>2]=i|3;s[t+i+4>>2]=s[t+i+4>>2]|1}T=t+8|0;h=S;return T|0}n=s[1122]|0;if(n>>>0>g>>>0){M=n-g|0;s[1122]=M;T=s[1125]|0;A=T+g|0;s[1125]=A;s[A+4>>2]=M|1;s[T+4>>2]=g|3;T=T+8|0;h=S;return T|0}if(!(s[1237]|0)){s[1239]=4096;s[1238]=4096;s[1240]=-1;s[1241]=-1;s[1242]=0;s[1230]=0;s[S>>2]=S&-16^1431655768;s[1237]=S&-16^1431655768;e=4096}else e=s[1239]|0;a=g+48|0;o=g+47|0;c=e+o|0;u=0-e|0;if((c&u)>>>0<=g>>>0){T=0;h=S;return T|0}e=s[1229]|0;if(e|0){m=s[1227]|0;if((m+(c&u)|0)>>>0<=m>>>0?1:(m+(c&u)|0)>>>0>e>>>0){T=0;h=S;return T|0}}e:do{if(!(s[1230]&4)){i=s[1125]|0;t:do{if(!i)k=172;else{e=4924;while(1){t=s[e>>2]|0;if(t>>>0<=i>>>0){r=e+4|0;if((t+(s[r>>2]|0)|0)>>>0>i>>>0)break}e=s[e+8>>2]|0;if(!e){k=172;break t}}if((c-n&u)>>>0<2147483647){t=dt(c-n&u|0)|0;if((t|0)==((s[e>>2]|0)+(s[r>>2]|0)|0)){if((t|0)!=(-1|0)){o=c-n&u;a=t;k=190;break e}}else{r=t;e=c-n&u;k=180}}}}while(0);do{if((k|0)==172){r=dt(0)|0;if((r|0)!=(-1|0)){e=s[1238]|0;e=((e+-1&r|0)==0?0:(e+-1+r&0-e)-r|0)+(c&u)|0;t=s[1227]|0;if(e>>>0>g>>>0&e>>>0<2147483647){i=s[1229]|0;if(i|0)if((e+t|0)>>>0<=t>>>0|(e+t|0)>>>0>i>>>0)break;t=dt(e|0)|0;if((t|0)==(r|0)){o=e;a=r;k=190;break e}else{r=t;k=180}}}}}while(0);t:do{if((k|0)==180){i=0-e|0;do{if(a>>>0>e>>>0&(e>>>0<2147483647&(r|0)!=(-1|0))){t=s[1239]|0;t=o-e+t&0-t;if(t>>>0<2147483647)if((dt(t|0)|0)==(-1|0)){dt(i|0)|0;break t}else{e=t+e|0;break}}}while(0);if((r|0)!=(-1|0)){o=e;a=r;k=190;break e}}}while(0);s[1230]=s[1230]|4;k=187}else k=187}while(0);if((k|0)==187)if((c&u)>>>0<2147483647){t=dt(c&u|0)|0;e=dt(0)|0;if(t>>>0<e>>>0&((t|0)!=(-1|0)&(e|0)!=(-1|0)))if((e-t|0)>>>0>(g+40|0)>>>0){o=e-t|0;a=t;k=190}}if((k|0)==190){e=(s[1227]|0)+o|0;s[1227]=e;if(e>>>0>(s[1228]|0)>>>0)s[1228]=e;u=s[1125]|0;do{if(!u){T=s[1123]|0;if((T|0)==0|a>>>0<T>>>0)s[1123]=a;s[1231]=a;s[1232]=o;s[1234]=0;s[1128]=s[1237];s[1127]=-1;e=0;do{T=4516+(e<<1<<2)|0;s[T+12>>2]=T;s[T+8>>2]=T;e=e+1|0}while((e|0)!=32);T=a+8|0;T=(T&7|0)==0?0:0-T&7;A=a+T|0;T=o+-40-T|0;s[1125]=A;s[1122]=T;s[A+4>>2]=T|1;s[A+T+4>>2]=40;s[1126]=s[1241]}else{e=4924;do{t=s[e>>2]|0;i=e+4|0;r=s[i>>2]|0;if((a|0)==(t+r|0)){k=200;break}e=s[e+8>>2]|0}while((e|0)!=0);if((k|0)==200)if(!(s[e+12>>2]&8))if(u>>>0<a>>>0&u>>>0>=t>>>0){s[i>>2]=r+o;A=(u+8&7|0)==0?0:0-(u+8)&7;T=o-A+(s[1122]|0)|0;s[1125]=u+A;s[1122]=T;s[u+A+4>>2]=T|1;s[u+A+T+4>>2]=40;s[1126]=s[1241];break}e=s[1123]|0;if(a>>>0<e>>>0){s[1123]=a;c=a}else c=e;t=a+o|0;e=4924;while(1){if((s[e>>2]|0)==(t|0)){k=208;break}e=s[e+8>>2]|0;if(!e){t=4924;break}}if((k|0)==208)if(!(s[e+12>>2]&8)){s[e>>2]=a;f=e+4|0;s[f>>2]=(s[f>>2]|0)+o;f=a+8|0;f=a+((f&7|0)==0?0:0-f&7)|0;e=t+((t+8&7|0)==0?0:0-(t+8)&7)|0;l=f+g|0;n=e-f-g|0;s[f+4>>2]=g|3;do{if((e|0)==(u|0)){T=(s[1122]|0)+n|0;s[1122]=T;s[1125]=l;s[l+4>>2]=T|1}else{if((e|0)==(s[1124]|0)){T=(s[1121]|0)+n|0;s[1121]=T;s[1124]=l;s[l+4>>2]=T|1;s[l+T>>2]=T;break}u=s[e+4>>2]|0;if((u&3|0)==1){e:do{if(u>>>0<256){t=s[e+8>>2]|0;i=s[e+12>>2]|0;do{if((t|0)!=(4516+(u>>>3<<1<<2)|0)){if(t>>>0<c>>>0)oe();if((s[t+12>>2]|0)==(e|0))break;oe()}}while(0);if((i|0)==(t|0)){s[1119]=s[1119]&~(1<<(u>>>3));break}do{if((i|0)==(4516+(u>>>3<<1<<2)|0))v=i+8|0;else{if(i>>>0<c>>>0)oe();if((s[i+8>>2]|0)==(e|0)){v=i+8|0;break}oe()}}while(0);s[t+12>>2]=i;s[v>>2]=t}else{o=s[e+24>>2]|0;t=s[e+12>>2]|0;do{if((t|0)==(e|0)){t=s[e+16+4>>2]|0;if(!t){t=s[e+16>>2]|0;if(!t){M=0;break}else a=e+16|0}else a=e+16+4|0;while(1){i=t+20|0;r=s[i>>2]|0;if(r|0){t=r;a=i;continue}i=t+16|0;r=s[i>>2]|0;if(!r)break;else{t=r;a=i}}if(a>>>0<c>>>0)oe();else{s[a>>2]=0;M=t;break}}else{i=s[e+8>>2]|0;if(i>>>0<c>>>0)oe();if((s[i+12>>2]|0)!=(e|0))oe();if((s[t+8>>2]|0)==(e|0)){s[i+12>>2]=t;s[t+8>>2]=i;M=t;break}else oe()}}while(0);if(!o)break;t=s[e+28>>2]|0;do{if((e|0)==(s[4780+(t<<2)>>2]|0)){s[4780+(t<<2)>>2]=M;if(M|0)break;s[1120]=s[1120]&~(1<<t);break e}else{if(o>>>0<(s[1123]|0)>>>0)oe();if((s[o+16>>2]|0)==(e|0))s[o+16>>2]=M;else s[o+20>>2]=M;if(!M)break e}}while(0);i=s[1123]|0;if(M>>>0<i>>>0)oe();s[M+24>>2]=o;t=s[e+16>>2]|0;do{if(t|0)if(t>>>0<i>>>0)oe();else{s[M+16>>2]=t;s[t+24>>2]=M;break}}while(0);t=s[e+16+4>>2]|0;if(!t)break;if(t>>>0<(s[1123]|0)>>>0)oe();else{s[M+20>>2]=t;s[t+24>>2]=M;break}}}while(0);e=e+(u&-8)|0;n=(u&-8)+n|0}t=e+4|0;s[t>>2]=s[t>>2]&-2;s[l+4>>2]=n|1;s[l+n>>2]=n;t=n>>>3;if(n>>>0<256){e=s[1119]|0;do{if(!(e&1<<t)){s[1119]=e|1<<t;A=4516+(t<<1<<2)|0;T=4516+(t<<1<<2)+8|0}else{e=s[4516+(t<<1<<2)+8>>2]|0;if(e>>>0>=(s[1123]|0)>>>0){A=e;T=4516+(t<<1<<2)+8|0;break}oe()}}while(0);s[T>>2]=l;s[A+12>>2]=l;s[l+8>>2]=A;s[l+12>>2]=4516+(t<<1<<2);break}e=n>>>8;do{if(!e)e=0;else{if(n>>>0>16777215){e=31;break}T=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(T+245760|0)>>>16&2)+(T<<((T+245760|0)>>>16&2)>>>15)|0;e=n>>>(e+7|0)&1|e<<1}}while(0);r=4780+(e<<2)|0;s[l+28>>2]=e;s[l+16+4>>2]=0;s[l+16>>2]=0;t=s[1120]|0;i=1<<e;if(!(t&i)){s[1120]=t|i;s[r>>2]=l;s[l+24>>2]=r;s[l+12>>2]=l;s[l+8>>2]=l;break}t=n<<((e|0)==31?0:25-(e>>>1)|0);r=s[r>>2]|0;while(1){if((s[r+4>>2]&-8|0)==(n|0)){k=278;break}i=r+16+(t>>>31<<2)|0;e=s[i>>2]|0;if(!e){k=275;break}else{t=t<<1;r=e}}if((k|0)==275)if(i>>>0<(s[1123]|0)>>>0)oe();else{s[i>>2]=l;s[l+24>>2]=r;s[l+12>>2]=l;s[l+8>>2]=l;break}else if((k|0)==278){e=r+8|0;t=s[e>>2]|0;T=s[1123]|0;if(t>>>0>=T>>>0&r>>>0>=T>>>0){s[t+12>>2]=l;s[e>>2]=l;s[l+8>>2]=t;s[l+12>>2]=r;s[l+24>>2]=0;break}else oe()}}}while(0);T=f+8|0;h=S;return T|0}else t=4924;while(1){e=s[t>>2]|0;if(e>>>0<=u>>>0){i=e+(s[t+4>>2]|0)|0;if(i>>>0>u>>>0)break}t=s[t+8>>2]|0}n=i+-47+((i+-47+8&7|0)==0?0:0-(i+-47+8)&7)|0;n=n>>>0<(u+16|0)>>>0?u:n;e=a+8|0;e=(e&7|0)==0?0:0-e&7;T=a+e|0;e=o+-40-e|0;s[1125]=T;s[1122]=e;s[T+4>>2]=e|1;s[T+e+4>>2]=40;s[1126]=s[1241];s[n+4>>2]=27;s[n+8>>2]=s[1231];s[n+8+4>>2]=s[1232];s[n+8+8>>2]=s[1233];s[n+8+12>>2]=s[1234];s[1231]=a;s[1232]=o;s[1234]=0;s[1233]=n+8;e=n+24|0;do{e=e+4|0;s[e>>2]=7}while((e+4|0)>>>0<i>>>0);if((n|0)!=(u|0)){s[n+4>>2]=s[n+4>>2]&-2;s[u+4>>2]=n-u|1;s[n>>2]=n-u;if((n-u|0)>>>0<256){t=4516+((n-u|0)>>>3<<1<<2)|0;e=s[1119]|0;if(!(e&1<<((n-u|0)>>>3))){s[1119]=e|1<<((n-u|0)>>>3);w=t;C=t+8|0}else{e=s[t+8>>2]|0;if(e>>>0<(s[1123]|0)>>>0)oe();else{w=e;C=t+8|0}}s[C>>2]=u;s[w+12>>2]=u;s[u+8>>2]=w;s[u+12>>2]=t;break}if(!((n-u|0)>>>8))e=0;else if((n-u|0)>>>0>16777215)e=31;else{e=(n-u|0)>>>8<<((((n-u|0)>>>8)+1048320|0)>>>16&8);e=14-((e+520192|0)>>>16&4|(((n-u|0)>>>8)+1048320|0)>>>16&8|((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)+(e<<((e+520192|0)>>>16&4)<<(((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;e=(n-u|0)>>>(e+7|0)&1|e<<1}r=4780+(e<<2)|0;s[u+28>>2]=e;s[u+20>>2]=0;s[u+16>>2]=0;t=s[1120]|0;i=1<<e;if(!(t&i)){s[1120]=t|i;s[r>>2]=u;s[u+24>>2]=r;s[u+12>>2]=u;s[u+8>>2]=u;break}t=n-u<<((e|0)==31?0:25-(e>>>1)|0);r=s[r>>2]|0;while(1){if((s[r+4>>2]&-8|0)==(n-u|0)){k=304;break}i=r+16+(t>>>31<<2)|0;e=s[i>>2]|0;if(!e){k=301;break}else{t=t<<1;r=e}}if((k|0)==301)if(i>>>0<(s[1123]|0)>>>0)oe();else{s[i>>2]=u;s[u+24>>2]=r;s[u+12>>2]=u;s[u+8>>2]=u;break}else if((k|0)==304){e=r+8|0;t=s[e>>2]|0;T=s[1123]|0;if(t>>>0>=T>>>0&r>>>0>=T>>>0){s[t+12>>2]=u;s[e>>2]=u;s[u+8>>2]=t;s[u+12>>2]=r;s[u+24>>2]=0;break}else oe()}}}}while(0);e=s[1122]|0;if(e>>>0>g>>>0){M=e-g|0;s[1122]=M;T=s[1125]|0;A=T+g|0;s[1125]=A;s[A+4>>2]=M|1;s[T+4>>2]=g|3;T=T+8|0;h=S;return T|0}}s[(Le()|0)>>2]=12;T=0;h=S;return T|0}function rt(e){e=e|0;var t=0,i=0,r=0,n=0,a=0,o=0,u=0,c=0,l=0,h=0,f=0,_=0,d=0,p=0,b=0;if(!e)return;o=s[1123]|0;if((e+-8|0)>>>0<o>>>0)oe();t=s[e+-4>>2]|0;if((t&3|0)==1)oe();_=e+-8+(t&-8)|0;do{if(!(t&1)){r=s[e+-8>>2]|0;if(!(t&3))return;l=e+-8+(0-r)|0;c=r+(t&-8)|0;if(l>>>0<o>>>0)oe();if((l|0)==(s[1124]|0)){e=s[_+4>>2]|0;if((e&3|0)!=3){b=l;n=c;break}s[1121]=c;s[_+4>>2]=e&-2;s[l+4>>2]=c|1;s[l+c>>2]=c;return}if(r>>>0<256){e=s[l+8>>2]|0;t=s[l+12>>2]|0;if((e|0)!=(4516+(r>>>3<<1<<2)|0)){if(e>>>0<o>>>0)oe();if((s[e+12>>2]|0)!=(l|0))oe()}if((t|0)==(e|0)){s[1119]=s[1119]&~(1<<(r>>>3));b=l;n=c;break}if((t|0)==(4516+(r>>>3<<1<<2)|0))i=t+8|0;else{if(t>>>0<o>>>0)oe();if((s[t+8>>2]|0)==(l|0))i=t+8|0;else oe()}s[e+12>>2]=t;s[i>>2]=e;b=l;n=c;break}a=s[l+24>>2]|0;e=s[l+12>>2]|0;do{if((e|0)==(l|0)){e=s[l+16+4>>2]|0;if(!e){e=s[l+16>>2]|0;if(!e){u=0;break}else r=l+16|0}else r=l+16+4|0;while(1){t=e+20|0;i=s[t>>2]|0;if(i|0){e=i;r=t;continue}t=e+16|0;i=s[t>>2]|0;if(!i)break;else{e=i;r=t}}if(r>>>0<o>>>0)oe();else{s[r>>2]=0;u=e;break}}else{t=s[l+8>>2]|0;if(t>>>0<o>>>0)oe();if((s[t+12>>2]|0)!=(l|0))oe();if((s[e+8>>2]|0)==(l|0)){s[t+12>>2]=e;s[e+8>>2]=t;u=e;break}else oe()}}while(0);if(!a){b=l;n=c}else{e=s[l+28>>2]|0;if((l|0)==(s[4780+(e<<2)>>2]|0)){s[4780+(e<<2)>>2]=u;if(!u){s[1120]=s[1120]&~(1<<e);b=l;n=c;break}}else{if(a>>>0<(s[1123]|0)>>>0)oe();if((s[a+16>>2]|0)==(l|0))s[a+16>>2]=u;else s[a+20>>2]=u;if(!u){b=l;n=c;break}}t=s[1123]|0;if(u>>>0<t>>>0)oe();s[u+24>>2]=a;e=s[l+16>>2]|0;do{if(e|0)if(e>>>0<t>>>0)oe();else{s[u+16>>2]=e;s[e+24>>2]=u;break}}while(0);e=s[l+16+4>>2]|0;if(!e){b=l;n=c}else if(e>>>0<(s[1123]|0)>>>0)oe();else{s[u+20>>2]=e;s[e+24>>2]=u;b=l;n=c;break}}}else{b=e+-8|0;n=t&-8}}while(0);if(b>>>0>=_>>>0)oe();i=s[_+4>>2]|0;if(!(i&1))oe();if(!(i&2)){if((_|0)==(s[1125]|0)){p=(s[1122]|0)+n|0;s[1122]=p;s[1125]=b;s[b+4>>2]=p|1;if((b|0)!=(s[1124]|0))return;s[1124]=0;s[1121]=0;return}if((_|0)==(s[1124]|0)){p=(s[1121]|0)+n|0;s[1121]=p;s[1124]=b;s[b+4>>2]=p|1;s[b+p>>2]=p;return}n=(i&-8)+n|0;do{if(i>>>0<256){e=s[_+8>>2]|0;t=s[_+12>>2]|0;if((e|0)!=(4516+(i>>>3<<1<<2)|0)){if(e>>>0<(s[1123]|0)>>>0)oe();if((s[e+12>>2]|0)!=(_|0))oe()}if((t|0)==(e|0)){s[1119]=s[1119]&~(1<<(i>>>3));break}if((t|0)==(4516+(i>>>3<<1<<2)|0))h=t+8|0;else{if(t>>>0<(s[1123]|0)>>>0)oe();if((s[t+8>>2]|0)==(_|0))h=t+8|0;else oe()}s[e+12>>2]=t;s[h>>2]=e}else{a=s[_+24>>2]|0;e=s[_+12>>2]|0;do{if((e|0)==(_|0)){e=s[_+16+4>>2]|0;if(!e){e=s[_+16>>2]|0;if(!e){f=0;break}else r=_+16|0}else r=_+16+4|0;while(1){t=e+20|0;i=s[t>>2]|0;if(i|0){e=i;r=t;continue}t=e+16|0;i=s[t>>2]|0;if(!i)break;else{e=i;r=t}}if(r>>>0<(s[1123]|0)>>>0)oe();else{s[r>>2]=0;f=e;break}}else{t=s[_+8>>2]|0;if(t>>>0<(s[1123]|0)>>>0)oe();if((s[t+12>>2]|0)!=(_|0))oe();if((s[e+8>>2]|0)==(_|0)){s[t+12>>2]=e;s[e+8>>2]=t;f=e;break}else oe()}}while(0);if(a|0){e=s[_+28>>2]|0;if((_|0)==(s[4780+(e<<2)>>2]|0)){s[4780+(e<<2)>>2]=f;if(!f){s[1120]=s[1120]&~(1<<e);break}}else{if(a>>>0<(s[1123]|0)>>>0)oe();if((s[a+16>>2]|0)==(_|0))s[a+16>>2]=f;else s[a+20>>2]=f;if(!f)break}t=s[1123]|0;if(f>>>0<t>>>0)oe();s[f+24>>2]=a;e=s[_+16>>2]|0;do{if(e|0)if(e>>>0<t>>>0)oe();else{s[f+16>>2]=e;s[e+24>>2]=f;break}}while(0);e=s[_+16+4>>2]|0;if(e|0)if(e>>>0<(s[1123]|0)>>>0)oe();else{s[f+20>>2]=e;s[e+24>>2]=f;break}}}}while(0);s[b+4>>2]=n|1;s[b+n>>2]=n;if((b|0)==(s[1124]|0)){s[1121]=n;return}}else{s[_+4>>2]=i&-2;s[b+4>>2]=n|1;s[b+n>>2]=n}t=n>>>3;if(n>>>0<256){e=s[1119]|0;if(!(e&1<<t)){s[1119]=e|1<<t;d=4516+(t<<1<<2)|0;p=4516+(t<<1<<2)+8|0}else{e=s[4516+(t<<1<<2)+8>>2]|0;if(e>>>0<(s[1123]|0)>>>0)oe();else{d=e;p=4516+(t<<1<<2)+8|0}}s[p>>2]=b;s[d+12>>2]=b;s[b+8>>2]=d;s[b+12>>2]=4516+(t<<1<<2);return}e=n>>>8;if(!e)e=0;else if(n>>>0>16777215)e=31;else{p=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(p+245760|0)>>>16&2)+(p<<((p+245760|0)>>>16&2)>>>15)|0;e=n>>>(e+7|0)&1|e<<1}r=4780+(e<<2)|0;s[b+28>>2]=e;s[b+20>>2]=0;s[b+16>>2]=0;t=s[1120]|0;i=1<<e;do{if(!(t&i)){s[1120]=t|i;s[r>>2]=b;s[b+24>>2]=r;s[b+12>>2]=b;s[b+8>>2]=b}else{t=n<<((e|0)==31?0:25-(e>>>1)|0);r=s[r>>2]|0;while(1){if((s[r+4>>2]&-8|0)==(n|0)){e=130;break}i=r+16+(t>>>31<<2)|0;e=s[i>>2]|0;if(!e){e=127;break}else{t=t<<1;r=e}}if((e|0)==127)if(i>>>0<(s[1123]|0)>>>0)oe();else{s[i>>2]=b;s[b+24>>2]=r;s[b+12>>2]=b;s[b+8>>2]=b;break}else if((e|0)==130){e=r+8|0;t=s[e>>2]|0;p=s[1123]|0;if(t>>>0>=p>>>0&r>>>0>=p>>>0){s[t+12>>2]=b;s[e>>2]=b;s[b+8>>2]=t;s[b+12>>2]=r;s[b+24>>2]=0;break}else oe()}}}while(0);b=(s[1127]|0)+-1|0;s[1127]=b;if(!b)e=4932;else return;while(1){e=s[e>>2]|0;if(!e)break;else e=e+8|0}s[1127]=-1;return}function nt(){}function st(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;r=t-r-(i>>>0>e>>>0|0)>>>0;return(O=r,e-i>>>0|0)|0}function at(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return(O=t+r+(e+i>>>0>>>0<e>>>0|0)>>>0,e+i>>>0|0)|0}function ot(e,t,i){e=e|0;t=t|0;i=i|0;var n=0,a=0,o=0;n=e+i|0;if((i|0)>=20){t=t&255;a=e&3;o=t|t<<8|t<<16|t<<24;if(a){a=e+4-a|0;while((e|0)<(a|0)){r[e>>0]=t;e=e+1|0}}while((e|0)<(n&~3|0)){s[e>>2]=o;e=e+4|0}}while((e|0)<(n|0)){r[e>>0]=t;e=e+1|0}return e-i|0}function ut(e,t,i){e=e|0;t=t|0;i=i|0;if((i|0)<32){O=t>>>i;return e>>>i|(t&(1<<i)-1)<<32-i}O=0;return t>>>i-32|0}function ct(e,t,i){e=e|0;t=t|0;i=i|0;if((i|0)<32){O=t<<i|(e&(1<<i)-1<<32-i)>>>32-i;return e<<i}O=e<<i-32;return 0}function lt(e,t,i){e=e|0;t=t|0;i=i|0;var n=0;if((i|0)>=4096)return fe(e|0,t|0,i|0)|0;n=e|0;if((e&3)==(t&3)){while(e&3){if(!i)return n|0;r[e>>0]=r[t>>0]|0;e=e+1|0;t=t+1|0;i=i-1|0}while((i|0)>=4){s[e>>2]=s[t>>2];e=e+4|0;t=t+4|0;i=i-4|0}}while((i|0)>0){r[e>>0]=r[t>>0]|0;e=e+1|0;t=t+1|0;i=i-1|0}return n|0}function ht(e){e=e|0;var t=0;t=r[b+(e&255)>>0]|0;if((t|0)<8)return t|0;t=r[b+(e>>8&255)>>0]|0;if((t|0)<8)return t+8|0;t=r[b+(e>>16&255)>>0]|0;if((t|0)<8)return t+16|0;return(r[b+(e>>>24)>>0]|0)+24|0}function ft(e,t,i,r,n){e=e|0;t=t|0;i=i|0;r=r|0;n=n|0;var a=0,o=0,u=0,c=0,l=0,h=0,f=0,_=0,d=0,p=0;if(!t)if(!r){if(n|0){s[n>>2]=(e>>>0)%(i>>>0);s[n+4>>2]=0}r=0;n=(e>>>0)/(i>>>0)>>>0;return(O=r,n)|0}else{if(!n){r=0;n=0;return(O=r,n)|0}s[n>>2]=e|0;s[n+4>>2]=t&0;r=0;n=0;return(O=r,n)|0}do{if(!i){if(!r){if(n|0){s[n>>2]=(t>>>0)%(i>>>0);s[n+4>>2]=0}r=0;n=(t>>>0)/(i>>>0)>>>0;return(O=r,n)|0}if(!e){if(n|0){s[n>>2]=0;s[n+4>>2]=(t>>>0)%(r>>>0)}i=0;n=(t>>>0)/(r>>>0)>>>0;return(O=i,n)|0}if(!(r-1&r)){if(n|0){s[n>>2]=e|0;s[n+4>>2]=r-1&t|t&0}i=0;n=t>>>((ht(r|0)|0)>>>0);return(O=i,n)|0}o=(J(r|0)|0)-(J(t|0)|0)|0;if(o>>>0<=30){_=o+1|0;u=t<<31-o|e>>>((o+1|0)>>>0);f=t>>>((o+1|0)>>>0);a=0;o=e<<31-o;break}if(!n){r=0;n=0;return(O=r,n)|0}s[n>>2]=e|0;s[n+4>>2]=t|t&0;r=0;n=0;return(O=r,n)|0}else{if(r|0){o=(J(r|0)|0)-(J(t|0)|0)|0;if(o>>>0<=31){_=o+1|0;u=e>>>((o+1|0)>>>0)&o-31>>31|t<<31-o;f=t>>>((o+1|0)>>>0)&o-31>>31;a=0;o=e<<31-o;break}if(!n){r=0;n=0;return(O=r,n)|0}s[n>>2]=e|0;s[n+4>>2]=t|t&0;r=0;n=0;return(O=r,n)|0}if(i-1&i|0){o=(J(i|0)|0)+33-(J(t|0)|0)|0;_=o;u=32-o-1>>31&t>>>((o-32|0)>>>0)|(t<<32-o|e>>>(o>>>0))&o-32>>31;f=o-32>>31&t>>>(o>>>0);a=e<<64-o&32-o>>31;o=(t<<64-o|e>>>((o-32|0)>>>0))&32-o>>31|e<<32-o&o-33>>31;break}if(n|0){s[n>>2]=i-1&e;s[n+4>>2]=0}if((i|0)==1){r=t|t&0;n=e|0|0;return(O=r,n)|0}else{n=ht(i|0)|0;r=t>>>(n>>>0)|0;n=t<<32-n|e>>>(n>>>0)|0;return(O=r,n)|0}}}while(0);if(!_){c=o;t=f;e=0;o=0}else{l=at(i|0|0,r|r&0|0,-1,-1)|0;h=O;c=o;t=f;e=_;o=0;do{p=c;c=a>>>31|c<<1;a=o|a<<1;p=u<<1|p>>>31|0;d=u>>>31|t<<1|0;st(l|0,h|0,p|0,d|0)|0;_=O;f=_>>31|((_|0)<0?-1:0)<<1;o=f&1;u=st(p|0,d|0,f&(i|0)|0,(((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1)&(r|r&0)|0)|0;t=O;e=e-1|0}while((e|0)!=0);e=0}if(n|0){s[n>>2]=u;s[n+4>>2]=t}d=(a|0)>>>31|c<<1|(0<<1|a>>>31)&0|e;p=(a<<1|0>>>31)&-2|o;return(O=d,p)|0}function _t(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return ft(e,t,i,r,0)|0}function dt(e){e=e|0;var t=0,i=0;i=e+15&-16|0;t=s[_>>2]|0;e=t+i|0;if((i|0)>0&(e|0)<(t|0)|(e|0)<0){te()|0;ue(12);return-1}s[_>>2]=e;if((e|0)>(ee()|0))if(!(Z()|0)){ue(12);s[_>>2]=t;return-1}return t|0}function pt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;var n=0;n=h;h=h+16|0;ft(e,t,i,r,n|0)|0;h=n;return(O=s[n+4>>2]|0,s[n>>2]|0)|0}function bt(e){e=e|0;return(e&255)<<24|(e>>8&255)<<16|(e>>16&255)<<8|e>>>24|0}function gt(){return 0}function yt(e,t){e=e|0;t=t|0;return At[e&1](t|0)|0}function mt(e,t,i,r){e=e|0;t=t|0;i=i|0;r=r|0;return Tt[e&3](t|0,i|0,r|0)|0}function kt(e,t){e=e|0;t=t|0;St[e&1](t|0)}function vt(e){e=e|0;Q(0);return 0}function wt(e,t,i){e=e|0;t=t|0;i=i|0;Q(1);return 0}function Ct(e){e=e|0;Q(2)}function Mt(e){e=e|0;var t=0,i=0,n=0,a=0,o=0,u=0,c=0,l=0,f=0,_=0,d=0,p=0;n=s[e+1384>>2]|0;a=s[e+2880>>2]|0;p=s[e+2896>>2]|0;d=s[e+2928>>2]|0;e:{t:do{if((p&63488)<<16>>16<18432){switch((p&63488)<<16>>16){case-26624:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+496>>2]=p>>>8&7;s[e+496+4>>2]=p<<2&1020;$e(d,1019,e+496|0)|0}s[4356+((p>>>8&7)<<2)>>2]=ae(1,(s[1102]|0)+(p<<2&1020)|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{if((p&63488)<<16>>16>=30720){switch((p&63488)<<16>>16){case 30720:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+504>>2]=p&7;s[e+504+4>>2]=p>>>3&7;s[e+504+8>>2]=p>>>6&31;$e(d,1039,e+504|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|0;n=ae(3,d+(p>>>6&31)&-2|0)|0;s[4356+((p&7)<<2)>>2]=((d+(p>>>6)&1|0)==0?n:n>>>8)&255;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}switch((p&63488)<<16>>16){case 18432:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+472>>2]=p>>>8&7;s[e+472+4>>2]=p<<2&1020;$e(d,990,e+472|0)|0}t=s[1104]|0;if(t&1|0){d=s[2]|0;s[e+480>>2]=t;$e(d,252,e+480|0)|0}if(r[4972]|0){d=s[2]|0;s[e+488>>2]=(t&-4)+(p<<2&1020);$e(d,1010,e+488|0)|0}s[4356+((p>>>8&7)<<2)>>2]=ae(1,(t&-4)+(p<<2&1020)|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}while(0);if((p&65024|0)==23552){if(r[4972]|0){d=s[2]|0;s[e+520>>2]=p&7;s[e+520+4>>2]=p>>>3&7;s[e+520+8>>2]=p>>>6&7;$e(d,1061,e+520|0)|0}d=(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0;n=ae(3,d&-2|0)|0;s[4356+((p&7)<<2)>>2]=((d&1|0)==0?n:n>>>8)&255;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&63488|0)==34816){if(r[4972]|0){d=s[2]|0;s[e+536>>2]=p&7;s[e+536+4>>2]=p>>>3&7;s[e+536+8>>2]=p>>>5&62;$e(d,1081,e+536|0)|0}s[4356+((p&7)<<2)>>2]=(ae(3,(s[4356+((p>>>3&7)<<2)>>2]|0)+(p>>>5&62)|0)|0)&65535;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}t=1;i=(p&65024)<<16>>16;if(t)switch(i|0){case 23040:{if(r[4972]|0){d=s[2]|0;s[e+552>>2]=p&7;s[e+552+4>>2]=p>>>3&7;s[e+552+8>>2]=p>>>6&7;$e(d,1103,e+552|0)|0}s[4356+((p&7)<<2)>>2]=(ae(3,(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0)|0)&65535;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case 22016:{if(r[4972]|0){d=s[2]|0;s[e+568>>2]=p&7;s[e+568+4>>2]=p>>>3&7;s[e+568+8>>2]=p>>>6&7;$e(d,1123,e+568|0)|0}d=(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0;n=ae(3,d&-2|0)|0;n=(d&1|0)==0?n:n>>>8;s[4356+((p&7)<<2)>>2]=(n&128|0)==0?n&255:n|-256;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case 24064:{if(r[4972]|0){d=s[2]|0;s[e+584>>2]=p&7;s[e+584+4>>2]=p>>>3&7;s[e+584+8>>2]=p>>>6&7;$e(d,1144,e+584|0)|0}n=ae(3,(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0)|0;s[4356+((p&7)<<2)>>2]=(n&32768|0)==0?n&65535:n|-65536;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:t=1}if(t)switch(i|0){default:{if(!(p&63488)){if(r[4972]|0){d=s[2]|0;s[e+600>>2]=p&7;s[e+600+4>>2]=p>>>3&7;s[e+600+8>>2]=p>>>6&31;$e(d,1165,e+600|0)|0}t=s[4356+((p>>>3&7)<<2)>>2]|0;if(!(p>>>6&31))i=s[1106]|0;else{i=s[1106]|0;i=(t&1<<32-(p>>>6&31)|0)==0?i&-536870913:i|536870912;s[1106]=i;t=t<<(p>>>6&31)}s[4356+((p&7)<<2)>>2]=t;n=(t|0)<0?i|-2147483648:i&2147483647;s[1106]=(t|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65472|0)==16512){if(r[4972]|0){d=s[2]|0;s[e+616>>2]=p&7;s[e+616+4>>2]=p>>>3&7;$e(d,1185,e+616|0)|0}t=s[4356+((p&7)<<2)>>2]|0;i=s[4356+((p>>>3&7)<<2)>>2]&255;do{if(!i)i=s[1106]|0;else{if(i>>>0<32){d=s[1106]|0;d=(1<<32-i&t|0)==0?d&-536870913:d|536870912;s[1106]=d;t=t<<i;i=d;break}if((i|0)==32){i=s[1106]|0;i=(t&1|0)==0?i&-536870913:i|536870912;s[1106]=i;t=0;break}else{i=s[1106]&-536870913;s[1106]=i;t=0;break}}}while(0);s[4356+((p&7)<<2)>>2]=t;n=(t|0)<0?i|-2147483648:i&2147483647;s[1106]=(t|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&63488|0)==2048){if(r[4972]|0){d=s[2]|0;s[e+624>>2]=p&7;s[e+624+4>>2]=p>>>3&7;s[e+624+8>>2]=p>>>6&31;$e(d,1199,e+624|0)|0}t=s[4356+((p>>>3&7)<<2)>>2]|0;if(!(p>>>6&31)){i=s[1106]|0;i=(t|0)>-1?i&-536870913:i|536870912;s[1106]=i;t=0}else{i=s[1106]|0;i=(t&1<<(p>>>6&31)+-1|0)==0?i&-536870913:i|536870912;s[1106]=i;t=t>>>(p>>>6&31)}s[4356+((p&7)<<2)>>2]=t;n=(t|0)<0?i|-2147483648:i&2147483647;s[1106]=(t|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65472|0)==16576){if(r[4972]|0){d=s[2]|0;s[e+640>>2]=p&7;s[e+640+4>>2]=p>>>3&7;$e(d,1219,e+640|0)|0}t=s[4356+((p&7)<<2)>>2]|0;i=s[4356+((p>>>3&7)<<2)>>2]&255;do{if(!i)i=s[1106]|0;else{if(i>>>0<32){d=s[1106]|0;d=(1<<i+-1&t|0)==0?d&-536870913:d|536870912;s[1106]=d;t=t>>>i;i=d;break}if((i|0)==32){i=s[1106]|0;i=(t|0)>-1?i&-536870913:i|536870912;s[1106]=i;t=0;break}else{i=s[1106]&-536870913;s[1106]=i;t=0;break}}}while(0);s[4356+((p&7)<<2)>>2]=t;n=(t|0)<0?i|-2147483648:i&2147483647;s[1106]=(t|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&63488|0)==8192){if(r[4972]|0){d=s[2]|0;s[e+648>>2]=p>>>8&7;s[e+648+4>>2]=p&255;$e(d,1233,e+648|0)|0}s[4356+((p>>>8&7)<<2)>>2]=p&255;n=s[1106]&1073741823;s[1106]=(p&255|0)==0?n|1073741824:n;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65472|0)==7168){if(r[4972]|0){d=s[2]|0;s[e+656>>2]=p&7;s[e+656+4>>2]=p>>>3&7;$e(d,1251,e+656|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=d;n=s[1106]|0;n=(d|0)<0?n|-2147483648:n&2147483647;s[1106]=((d|0)==0?n|1073741824:n&-1879048193)&-805306369;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65280|0)==17920){if(r[4972]|0){d=s[2]|0;s[e+664>>2]=p>>>4&8|p&7;s[e+664+4>>2]=p>>>3&15;$e(d,1265,e+664|0)|0}t=s[4356+((p>>>3&15)<<2)>>2]|0;if((p>>>3&15|0)==15){if(t&1|0){d=s[2]|0;s[e+672>>2]=t;$e(d,252,e+672|0)|0}t=t&-2}s[4356+((p>>>4&8|p&7)<<2)>>2]=(p>>>4&8|p&7|0)==15?((p>>>4&8|p&7|0)==15?t+2|0:t)&-2:t;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}t=1;i=(p&65472)<<16>>16;if(t)switch(i|0){case 17216:{if(r[4972]|0){d=s[2]|0;s[e+680>>2]=p&7;s[e+680+4>>2]=p>>>3&7;$e(d,1278,e+680|0)|0}d=K(s[4356+((p>>>3&7)<<2)>>2]|0,s[4356+((p&7)<<2)>>2]|0)|0;s[4356+((p&7)<<2)>>2]=d;n=s[1106]|0;n=(d|0)<0?n|-2147483648:n&2147483647;s[1106]=(d|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case 17344:{if(r[4972]|0){d=s[2]|0;s[e+688>>2]=p&7;s[e+688+4>>2]=p>>>3&7;$e(d,1292,e+688|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=~d;n=s[1106]|0;n=(d|0)>-1?n|-2147483648:n&2147483647;s[1106]=(d|0)==-1?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case 16960:{if(r[4972]|0){d=s[2]|0;s[e+696>>2]=p&7;s[e+696+4>>2]=p>>>3&7;$e(d,1306,e+696|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=0-d;n=s[1106]|0;n=(0-d|0)<0?n|-2147483648:n&2147483647;n=(d|0)==0?n|1073741824:n&-1073741825;n=(((((~d&2147483647)+1|0)>>>31)+(~d>>>31)|0)&2|0)==0?n&-536870913:n|536870912;s[1106]=(((~d&2147483647)+1|0)>>>31|0)==(((((~d&2147483647)+1|0)>>>31)+(~d>>>31)|0)>>>1|0)?n&-268435457:n|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case 17152:{if(r[4972]|0){d=s[2]|0;s[e+704>>2]=p&7;s[e+704+4>>2]=p>>>3&7;$e(d,1320,e+704|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|s[4356+((p&7)<<2)>>2];s[4356+((p&7)<<2)>>2]=d;n=s[1106]|0;n=(d|0)<0?n|-2147483648:n&2147483647;s[1106]=(d|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:t=1}if(t)switch(i|0){default:{t=1;i=(p&65024)<<16>>16;if(t)switch(i|0){case-17408:{if(!(r[4972]|0))i=p&1;else{i=s[2]|0;Ze(1334,5,1,i)|0;if(!(p&1))t=0;else{s[e+712>>2]=0;$e(i,943,e+712|0)|0;t=1}if(p&2){if(t|0)tt(44,i)|0;s[e+1072>>2]=1;$e(i,943,e+1072|0)|0;t=t+1|0}if(p&4){if(t|0)tt(44,i)|0;s[e+1080>>2]=2;$e(i,943,e+1080|0)|0;t=t+1|0}if(p&8){if(t|0)tt(44,i)|0;s[e+1088>>2]=3;$e(i,943,e+1088|0)|0;t=t+1|0}if(p&16){if(t|0)tt(44,i)|0;s[e+1096>>2]=4;$e(i,943,e+1096|0)|0;t=t+1|0}if(p&32){if(t|0)tt(44,i)|0;s[e+1104>>2]=5;$e(i,943,e+1104|0)|0;t=t+1|0}if(p&64){if(t|0)tt(44,i)|0;s[e+1112>>2]=6;$e(i,943,e+1112|0)|0;t=t+1|0}if(p&128){if(t|0)tt(44,i)|0;s[e+1120>>2]=7;$e(i,943,e+1120|0)|0;t=t+1|0}if(p&256|0){if(t|0)tt(44,i)|0;Ze(1340,2,1,i)|0}Ze(947,2,1,i)|0;i=p&1}t=s[1102]|0;if(i){s[1089]=ae(1,t|0)|0;t=t+4|0}if(p&2){s[1090]=ae(1,t|0)|0;t=t+4|0}if(p&4){s[1091]=ae(1,t|0)|0;t=t+4|0}if(p&8){s[1092]=ae(1,t|0)|0;t=t+4|0}if(p&16){s[1093]=ae(1,t|0)|0;t=t+4|0}if(p&32){s[1094]=ae(1,t|0)|0;t=t+4|0}if(p&64){s[1095]=ae(1,t|0)|0;t=t+4|0}if(p&128){s[1096]=ae(1,t|0)|0;t=t+4|0}if(p&256){i=ae(1,t|0)|0;if(!(i&1)){p=s[2]|0;s[e+720>>2]=d;s[e+720+4>>2]=i;$e(p,1343,e+720|0)|0;i=i&-2}s[1104]=i+2&-2;t=t+4|0}s[1102]=t;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-19456:{_=s[2]|0;if(!(r[4972]|0)){t=p&2;i=p&4;n=p&8;a=p&16;o=p&32;u=p&64;c=p&128;f=p&256;l=p&1}else{Ze(1397,6,1,_)|0;if(!(p&1))t=0;else{s[e+728>>2]=0;$e(_,943,e+728|0)|0;t=1}if(p&2){if(t|0)tt(44,_)|0;s[e+1128>>2]=1;$e(_,943,e+1128|0)|0;t=t+1|0}if(p&4){if(t|0)tt(44,_)|0;s[e+1136>>2]=2;$e(_,943,e+1136|0)|0;t=t+1|0}if(p&8){if(t|0)tt(44,_)|0;s[e+1144>>2]=3;$e(_,943,e+1144|0)|0;t=t+1|0}if(p&16){if(t|0)tt(44,_)|0;s[e+1152>>2]=4;$e(_,943,e+1152|0)|0;t=t+1|0}if(p&32){if(t|0)tt(44,_)|0;s[e+1160>>2]=5;$e(_,943,e+1160|0)|0;t=t+1|0}if(p&64){if(t|0)tt(44,_)|0;s[e+1168>>2]=6;$e(_,943,e+1168|0)|0;t=t+1|0}if(p&128){if(t|0)tt(44,_)|0;s[e+1176>>2]=7;$e(_,943,e+1176|0)|0;t=t+1|0}if(p&256|0){if(t|0)tt(44,_)|0;Ze(1404,2,1,_)|0}Ze(947,2,1,_)|0;t=p&2;i=p&4;n=p&8;a=p&16;o=p&32;u=p&64;c=p&128;f=p&256;l=p&1}o=(s[1102]|0)-((c>>>7)+((u>>>6)+((o>>>5)+((a>>>4)+((n>>>3)+((i>>>2)+((t>>>1)+l))))))+(f>>>8)<<2)|0;t=o;n=0;a=1;while(1){if(!(a&p))i=t;else{i=s[4356+(n<<2)>>2]|0;t:do{if((t&-268435456|0)==-536870912)switch(t|0){case-536813552:{l=s[1086]|0;s[1086]=i&65543;if((i&1|0)==0|(l&1|0)!=0)break t;s[1088]=s[1087];break t}case-536813548:{s[1087]=i&16777215;break t}case-536813544:{s[1088]=i&16777215;break t}case-536813540:break t;default:break t}else be(2,t|0,i|0)|0}while(0);i=t+4|0}n=n+1|0;if((n|0)==8)break;else{t=i;a=a<<1&254}}do{if(f|0){t=s[1103]|0;t:do{if((i&-268435456|0)==-536870912)switch(i|0){case-536813552:{p=s[1086]|0;s[1086]=t&65543;if((t&1|0)==0|(p&1|0)!=0)break t;s[1088]=s[1087];break t}case-536813548:{s[1087]=t&16777215;break t}case-536813544:{s[1088]=t&16777215;break t}case-536813540:break t;default:break t}else be(2,i|0,t|0)|0}while(0);if(t&1|0)break;s[e+736>>2]=d;s[e+736+4>>2]=t;$e(_,1407,e+736|0)|0}}while(0);s[1102]=o;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:t=1}if(t)switch(i|0){default:{t:do{if((p&65472)<<16>>16<-17728)switch((p&65472)<<16>>16){case-17920:{if(r[4972]|0){d=s[2]|0;s[e+744>>2]=p&7;s[e+744+4>>2]=p>>>3&7;$e(d,1462,e+744|0)|0}s[4356+((p&7)<<2)>>2]=bt(s[4356+((p>>>3&7)<<2)>>2]|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-17856:{if(r[4972]|0){d=s[2]|0;s[e+752>>2]=p&7;s[e+752+4>>2]=p>>>3&7;$e(d,1475,e+752|0)|0}n=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=n<<8&65280|n>>>8&255|n>>>16<<24|n>>>24<<16;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:break t}else{if((p&65472)<<16>>16<16768){switch((p&65472)<<16>>16){case-17728:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+760>>2]=p&7;s[e+760+4>>2]=p>>>3&7;$e(d,1490,e+760|0)|0}n=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=(n<<8&32768|0)==0?n<<8&65280|n>>>8&255:n<<8&65280|n>>>8&255|-65536;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}switch((p&65472)<<16>>16){case 16832:break;case 16768:{if(r[4972]|0){d=s[2]|0;s[e+776>>2]=p&7;s[e+776+4>>2]=p>>>3&7;$e(d,1519,e+776|0)|0}i=s[4356+((p&7)<<2)>>2]|0;n=s[4356+((p>>>3&7)<<2)>>2]|0;d=s[1106]|0;s[4356+((p&7)<<2)>>2]=i-n+-1+(d>>>29&1);t=(i-n+-1+(d>>>29&1)|0)<0?d|-2147483648:d&2147483647;t=(i-n+-1+(d>>>29&1)|0)==0?t|1073741824:t&-1073741825;s[1106]=t;if(!(t&536870912)){p=(((~n>>>31)+(i>>>31)+(((~n&2147483647)+(i&2147483647)|0)>>>31)|0)&2|0)==0?t&-536870913:t|536870912;s[1106]=(((~n&2147483647)+(i&2147483647)|0)>>>31|0)==(((~n>>>31)+(i>>>31)+(((~n&2147483647)+(i&2147483647)|0)>>>31)|0)>>>1&1|0)?p&-268435457:p|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{p=(((~n>>>31)+(i>>>31)+(((~n&2147483647)+(i&2147483647)+1|0)>>>31)|0)&2|0)==0?t&-536870913:t|536870912;s[1106]=(((~n&2147483647)+(i&2147483647)+1|0)>>>31|0)==(((~n>>>31)+(i>>>31)+(((~n&2147483647)+(i&2147483647)+1|0)>>>31)|0)>>>1&1|0)?p&-268435457:p|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}default:break t}if(r[4972]|0){d=s[2]|0;s[e+768>>2]=p&7;s[e+768+4>>2]=p>>>3&7;$e(d,1505,e+768|0)|0}t=s[4356+((p&7)<<2)>>2]|0;i=s[4356+((p>>>3&7)<<2)>>2]|0;do{if(!(i&255))i=s[1106]|0;else if(!(i&31)){i=s[1106]|0;i=(t|0)>-1?i&-536870913:i|536870912;s[1106]=i;break}else{d=s[1106]|0;d=(1<<(i&31)+-1&t|0)==0?d&-536870913:d|536870912;s[1106]=d;t=t<<32-(i&31)|t>>>(i&31);i=d;break}}while(0);s[4356+((p&7)<<2)>>2]=t;n=(t|0)<0?i|-2147483648:i&2147483647;s[1106]=(t|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}while(0);if((p&65527|0)==46672){Ze(1532,23,1,s[2]|0)|0;n=1;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}t:do{if((p&63488)<<16>>16<24576){switch((p&63488)<<16>>16){case-16384:break;default:break t}if(r[4972]|0){i=s[2]|0;s[e+784>>2]=p>>>8&7;$e(i,1556,e+784|0)|0;if(!(p&1))t=0;else{s[e+792>>2]=0;$e(i,943,e+792|0)|0;t=1}if(p&2){if(t|0)tt(44,i)|0;s[e+1016>>2]=1;$e(i,943,e+1016|0)|0;t=t+1|0}if(p&4){if(t|0)tt(44,i)|0;s[e+1024>>2]=2;$e(i,943,e+1024|0)|0;t=t+1|0}if(p&8){if(t|0)tt(44,i)|0;s[e+1032>>2]=3;$e(i,943,e+1032|0)|0;t=t+1|0}if(p&16){if(t|0)tt(44,i)|0;s[e+1040>>2]=4;$e(i,943,e+1040|0)|0;t=t+1|0}if(p&32){if(t|0)tt(44,i)|0;s[e+1048>>2]=5;$e(i,943,e+1048|0)|0;t=t+1|0}if(p&64){if(t|0)tt(44,i)|0;s[e+1056>>2]=6;$e(i,943,e+1056|0)|0;t=t+1|0}if(p&128|0){if(t|0)tt(44,i)|0;s[e+1064>>2]=7;$e(i,943,e+1064|0)|0}Ze(947,2,1,i)|0}n=1;a=0;t=s[4356+((p>>>8&7)<<2)>>2]|0;while(1){if(n&p){i=s[4356+(a<<2)>>2]|0;i:do{if((t&-268435456|0)==-536870912)switch(t|0){case-536813552:{d=s[1086]|0;s[1086]=i&65543;if((i&1|0)==0|(d&1|0)!=0)break i;s[1088]=s[1087];break i}case-536813548:{s[1087]=i&16777215;break i}case-536813544:{s[1088]=i&16777215;break i}case-536813540:break i;default:break i}else be(2,t|0,i|0)|0}while(0);t=t+4|0}a=a+1|0;if((a|0)==8)break;else n=n<<1&254}s[4356+((p>>>8&7)<<2)>>2]=t;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{switch((p&63488)<<16>>16){case 24576:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+800>>2]=p&7;s[e+800+4>>2]=p>>>3&7;s[e+800+8>>2]=p>>>4&124;$e(d,1569,e+800|0)|0}i=(s[4356+((p>>>3&7)<<2)>>2]|0)+(p>>>4&124)|0;t=s[4356+((p&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){be(2,i|0,t|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}switch(i|0){case-536813552:{p=s[1086]|0;s[1086]=t&65543;if((t&1|0)==0|(p&1|0)!=0){n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}s[1088]=s[1087];n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813548:{s[1087]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813544:{s[1088]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813540:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}}}while(0);if((p&65024|0)==20480){if(r[4972]|0){d=s[2]|0;s[e+816>>2]=p&7;s[e+816+4>>2]=p>>>3&7;s[e+816+8>>2]=p>>>6&7;$e(d,1590,e+816|0)|0}i=(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0;t=s[4356+((p&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){be(2,i|0,t|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}switch(i|0){case-536813552:{p=s[1086]|0;s[1086]=t&65543;if((t&1|0)==0|(p&1|0)!=0){n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}s[1088]=s[1087];n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813548:{s[1087]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813544:{s[1088]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813540:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}}t:do{if((p&63488)<<16>>16<28672){switch((p&63488)<<16>>16){case-28672:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+832>>2]=p>>>8&7;s[e+832+4>>2]=p<<2&1020;$e(d,1609,e+832|0)|0}i=(s[1102]|0)+(p<<2&1020)|0;t=s[4356+((p>>>8&7)<<2)>>2]|0;if((i&-268435456|0)!=-536870912){be(2,i|0,t|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}switch(i|0){case-536813552:{p=s[1086]|0;s[1086]=t&65543;if((t&1|0)==0|(p&1|0)!=0){n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}s[1088]=s[1087];n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813548:{s[1087]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813544:{s[1088]=t&16777215;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-536813540:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:{n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}}else{switch((p&63488)<<16>>16){case 28672:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+840>>2]=p&7;s[e+840+4>>2]=p>>>3&7;s[e+840+8>>2]=p>>>6&31;$e(d,1629,e+840|0)|0}n=s[4356+((p>>>3&7)<<2)>>2]|0;t=s[4356+((p&7)<<2)>>2]|0;i=ae(3,n+(p>>>6&31)&-2|0)|0;if(!(n+(p>>>6)&1))t=i&65280|t&255;else t=i&255|t<<8;be(4,n+(p>>>6&31)&-2|0,t&65535|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}while(0);if((p&65024|0)==21504){if(r[4972]|0){d=s[2]|0;s[e+856>>2]=p&7;s[e+856+4>>2]=p>>>3&7;s[e+856+8>>2]=p>>>6&7;$e(d,1651,e+856|0)|0}n=(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0;t=s[4356+((p&7)<<2)>>2]|0;i=ae(3,n&-2|0)|0;if(!(n&1))t=i&65280|t&255;else t=i&255|t<<8;be(4,n&-2|0,t&65535|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&63488|0)==32768){if(r[4972]|0){d=s[2]|0;s[e+872>>2]=p&7;s[e+872+4>>2]=p>>>3&7;s[e+872+8>>2]=p>>>5&62;$e(d,1671,e+872|0)|0}be(4,(s[4356+((p>>>3&7)<<2)>>2]|0)+(p>>>5&62)|0,s[4356+((p&7)<<2)>>2]&65535|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}t:do{if((p&65024)<<16>>16<20992){switch((p&65024)<<16>>16){case 7680:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+904>>2]=p&7;s[e+904+4>>2]=p>>>3&7;s[e+904+8>>2]=p>>>6&7;$e(d,1713,e+904|0)|0}d=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=d-(p>>>6&7);n=s[1106]|0;n=(d-(p>>>6&7)|0)<0?n|-2147483648:n&2147483647;n=(d-(p>>>6&7)|0)==0?n|1073741824:n&-1073741825;n=(((d>>>31)+1+((((p>>>6|2147483640)^7)+1+(d&2147483647)|0)>>>31)|0)&2|0)==0?n&-536870913:n|536870912;s[1106]=((((p>>>6|2147483640)^7)+1+(d&2147483647)|0)>>>31|0)==(((d>>>31)+1+((((p>>>6|2147483640)^7)+1+(d&2147483647)|0)>>>31)|0)>>>1&1|0)?n&-268435457:n|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{switch((p&65024)<<16>>16){case 20992:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+888>>2]=p&7;s[e+888+4>>2]=p>>>3&7;s[e+888+8>>2]=p>>>6&7;$e(d,1693,e+888|0)|0}be(4,(s[4356+((p>>>6&7)<<2)>>2]|0)+(s[4356+((p>>>3&7)<<2)>>2]|0)|0,s[4356+((p&7)<<2)>>2]&65535|0)|0;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}while(0);if((p&63488|0)==14336){if(r[4972]|0){d=s[2]|0;s[e+920>>2]=p>>>8&7;s[e+920+4>>2]=p&255;$e(d,1733,e+920|0)|0}d=s[4356+((p>>>8&7)<<2)>>2]|0;s[4356+((p>>>8&7)<<2)>>2]=d-(p&255);n=s[1106]|0;n=(d-(p&255)|0)<0?n|-2147483648:n&2147483647;n=(d-(p&255)|0)==0?n|1073741824:n&-1073741825;n=(((d>>>31)+1+((-2147483648-(p&255)+(d&2147483647)|0)>>>31)|0)&2|0)==0?n&-536870913:n|536870912;s[1106]=((-2147483648-(p&255)+(d&2147483647)|0)>>>31|0)==(((d>>>31)+1+((-2147483648-(p&255)+(d&2147483647)|0)>>>31)|0)>>>1&1|0)?n&-268435457:n|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65024|0)==6656){if(r[4972]|0){d=s[2]|0;s[e+928>>2]=p&7;s[e+928+4>>2]=p>>>3&7;s[e+928+8>>2]=p>>>6&7;$e(d,1751,e+928|0)|0}_=s[4356+((p>>>3&7)<<2)>>2]|0;d=s[4356+((p>>>6&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=_-d;n=s[1106]|0;n=(_-d|0)<0?n|-2147483648:n&2147483647;n=(_-d|0)==0?n|1073741824:n&-1073741825;n=(((~d>>>31)+(_>>>31)+(((_&2147483647)+1+(~d&2147483647)|0)>>>31)|0)&2|0)==0?n&-536870913:n|536870912;s[1106]=(((_&2147483647)+1+(~d&2147483647)|0)>>>31|0)==(((~d>>>31)+(_>>>31)+(((_&2147483647)+1+(~d&2147483647)|0)>>>31)|0)>>>1&1|0)?n&-268435457:n|268435456;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65408|0)==45184){if(r[4972]|0){d=s[2]|0;s[e+944>>2]=p<<2&508;$e(d,1769,e+944|0)|0}s[1102]=(s[1102]|0)-(p<<2&508);n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65280|0)==57088){if(r[4972]|0){d=s[2]|0;s[e+952>>2]=p&255;$e(d,1785,e+952|0)|0}if((p&255|0)==204){s[1089]=s[1106];n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{n=s[2]|0;s[e+960>>2]=p&255;$e(n,1797,e+960|0)|0;n=1;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}t:do{if((p&65472)<<16>>16<-19840)switch((p&65472)<<16>>16){case-19904:{if(r[4972]|0){d=s[2]|0;s[e+968>>2]=p&7;s[e+968+4>>2]=p>>>3&7;$e(d,1811,e+968|0)|0}n=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=(n&128|0)==0?n&255:n|-256;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}case-19968:{if(r[4972]|0){d=s[2]|0;s[e+976>>2]=p&7;s[e+976+4>>2]=p>>>3&7;$e(d,1825,e+976|0)|0}n=s[4356+((p>>>3&7)<<2)>>2]|0;s[4356+((p&7)<<2)>>2]=(n&32768|0)==0?n&65535:n|-65536;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}default:break t}else{if((p&65472)<<16>>16<-19776){switch((p&65472)<<16>>16){case-19840:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+1e3>>2]=p&7;s[e+1e3+4>>2]=p>>>3&7;$e(d,1866,e+1e3|0)|0}s[4356+((p&7)<<2)>>2]=s[4356+((p>>>3&7)<<2)>>2]&65535;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}if((p&65472)<<16>>16<16896){switch((p&65472)<<16>>16){case-19776:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+992>>2]=p&7;s[e+992+4>>2]=p>>>3&7;$e(d,1852,e+992|0)|0}s[4356+((p&7)<<2)>>2]=s[4356+((p>>>3&7)<<2)>>2]&255;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}else{switch((p&65472)<<16>>16){case 16896:break;default:break t}if(r[4972]|0){d=s[2]|0;s[e+984>>2]=p&7;s[e+984+4>>2]=p>>>3&7;$e(d,1839,e+984|0)|0}p=s[4356+((p>>>3&7)<<2)>>2]&s[4356+((p&7)<<2)>>2];n=s[1106]|0;n=(p|0)<0?n|-2147483648:n&2147483647;s[1106]=(p|0)==0?n|1073741824:n&-1073741825;n=0;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}}while(0);n=s[2]|0;s[e+1008>>2]=a;s[e+1008+4>>2]=p;$e(n,1880,e+1008|0)|0;n=1;h=e;s[e+4840>>2]=6;s[e+4844>>2]=n|0;break e}}}}}}}s[e+1384>>2]=n}var At=[vt,Re];var Tt=[wt,Be,Oe,wt];var St=[Ct,He];return{_llvm_bswap_i32:bt,_pthread_self:gt,_run:Ae,_write_register:Pe,_free:rt,___udivmoddi4:ft,_i64Add:at,___udivdi3:_t,_enable_debug:Te,_i64Subtract:st,_llvm_cttz_i32:ht,_memset:ot,_malloc:it,_memcpy:lt,_reset:Ee,_sbrk:dt,_bitshift64Lshr:ut,_read_register:Se,___uremdi3:pt,___errno_location:Le,_bitshift64Shl:ct,runPostSets:nt,stackAlloc:ye,stackSave:me,stackRestore:ke,establishStackSpace:ve,setThrew:we,setTempRet0:Ce,getTempRet0:Me,dynCall_ii:yt,dynCall_iiii:mt,dynCall_vi:kt}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),_enable_debug=Module._enable_debug=asm._enable_debug,_i64Subtract=Module._i64Subtract=asm._i64Subtract,_llvm_cttz_i32=Module._llvm_cttz_i32=asm._llvm_cttz_i32,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_read_register=Module._read_register=asm._read_register,_bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl,_memset=Module._memset=asm._memset,_sbrk=Module._sbrk=asm._sbrk,_memcpy=Module._memcpy=asm._memcpy,_llvm_bswap_i32=Module._llvm_bswap_i32=asm._llvm_bswap_i32,___uremdi3=Module.___uremdi3=asm.___uremdi3,_run=Module._run=asm._run,___udivmoddi4=Module.___udivmoddi4=asm.___udivmoddi4,_i64Add=Module._i64Add=asm._i64Add,_pthread_self=Module._pthread_self=asm._pthread_self,___udivdi3=Module.___udivdi3=asm.___udivdi3,___errno_location=Module.___errno_location=asm.___errno_location,_free=Module._free=asm._free,runPostSets=Module.runPostSets=asm.runPostSets,_write_register=Module._write_register=asm._write_register,_malloc=Module._malloc=asm._malloc,_reset=Module._reset=asm._reset,dynCall_ii=Module.dynCall_ii=asm.dynCall_ii,dynCall_iiii=Module.dynCall_iiii=asm.dynCall_iiii,dynCall_vi=Module.dynCall_vi=asm.dynCall_vi;Runtime.stackAlloc=asm.stackAlloc,Runtime.stackSave=asm.stackSave,Runtime.stackRestore=asm.stackRestore,Runtime.establishStackSpace=asm.establishStackSpace,Runtime.setTempRet0=asm.setTempRet0,Runtime.getTempRet0=asm.getTempRet0,ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var initialStackTop,preloadStartTime=null,calledMain=!1;dependenciesFulfilled=function e(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=e)},Module.callMain=Module.callMain=function(e){function t(){for(var e=0;e<3;e++)r.push(0)}e=e||[],ensureInitRuntime();var i=e.length+1,r=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];t();for(var n=0;n<i-1;n+=1)r.push(allocate(intArrayFromString(e[n]),"i8",ALLOC_NORMAL)),t();r.push(0),r=allocate(r,"i32",ALLOC_NORMAL);try{exit(Module._main(i,r,0),!0)}catch(e){if(e instanceof ExitStatus)return;if("SimulateInfiniteLoop"==e)return void(Module.noExitRuntime=!0);throw e&&"object"==typeof e&&e.stack&&Module.printErr("exception thrown: "+[e,e.stack]),e}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit;var abortDecorators=[];if(Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!1;return Module.noInitialRun&&(shouldRunNow=!1),Module.noExitRuntime=!0,run(),Module};module.exports=Module}).call(this,require("_process"))},{_process:7,path:6}],57:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.searchForSignatures=function(e,t){for(var i=[],r=t.map(function(e){return 0}),n=0;n<e.length;n++){for(var s=0;s<i.length;s++){var a=i[s],o=t[a.signature];e[n]===o[a.nextIndex]?++a.nextIndex===o.length&&(r[a.signature]++,i.splice(s,1),s--):(i.splice(s,1),s--)}for(var u=0;u<t.length;u++)(o=t[u]).length>0&&e[n]===o[0]&&(1===o.length?r[u]++:i.push({signature:u,nextIndex:1}))}return r}},{}],58:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./ToneGenerator"),s=function(){function e(e){this._config=e,this.bufferChanged=new r.Event,this.volumeChanged=new r.Event,this.stop=new r.Event,this._volume=-1,this._tone=-1,this._frequency=-1,this._active=!1,this._toneGenerator=null,this._toneGenerator=new n.default(this._config),this.reset()}return e.prototype.reset=function(){this._volume=-1,this._tone=-1,this._frequency=-1},e.prototype.audc=function(e){(e&=15)!==this._tone&&(this._tone=e,this._dispatchBufferChanged())},e.prototype.audf=function(e){(e&=31)!==this._frequency&&(this._frequency=e,this._dispatchBufferChanged())},e.prototype.audv=function(e){(e&=15)!==this._volume&&(this._volume=e/15,this.volumeChanged.dispatch(this._volume))},e.prototype.setActive=function(e){this._active=e,e?this._dispatchBufferChanged():this.stop.dispatch(void 0)},e.prototype.getVolume=function(){return this._volume>=0?this._volume:0},e.prototype.getBuffer=function(e){return this._toneGenerator.getBuffer(e)},e.prototype._getKey=function(){return this._toneGenerator.getKey(this._tone,this._frequency)},e.prototype._dispatchBufferChanged=function(){this._active&&this.bufferChanged.hasHandlers&&this.bufferChanged.dispatch(this._getKey())},e}();i.default=s},{"./ToneGenerator":68,"microevent.ts":5}],59:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){e[e.renderCounterOffset=-4]="renderCounterOffset"}(r||(r={}));var n=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this._delaying=!1,this.reset()}return e.prototype.reset=function(){this.color=4294967295,this.collision=0,this._width=1,this._enabledOld=!1,this._enabledNew=!1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._delaying=!1,this._effectiveWidth=0,this._lastMovementTick=0},e.prototype.enabl=function(e){var t=this._enabledNew;this._enabledNew=(2&e)>0,t===this._enabledNew||this._delaying||(this._flushLineCache(),this._updateEnabled())},e.prototype.hmbl=function(e){this._hmmClocks=e>>>4^8},e.prototype.resbl=function(e){this._counter=e,this._rendering=!0,this._renderCounter=e-157-4},e.prototype.ctrlpf=function(e){var t=this._widths[(48&e)>>>4];t!==this._width&&this._flushLineCache(),this._width=t},e.prototype.vdelbl=function(e){var t=this._delaying;this._delaying=(1&e)>0,t!==this._delaying&&(this._flushLineCache(),this._updateEnabled())},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return this._lastMovementTick=this._counter,e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(!1),this._moving},e.prototype.tick=function(e){this.collision=this._rendering&&this._renderCounter>=0&&this._enabled?0:this._collisionMask;var t=this._moving&&e;if(156===this._counter){var i=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,t&&3===i&&this._width<4&&this._renderCounter++,i){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(t?this._effectiveWidth:this._width)&&(this._rendering=!1);++this._counter>=160&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.shuffleStatus=function(){var e=this._enabledOld;this._enabledOld=this._enabledNew,this._delaying&&this._enabledOld!==e&&(this._flushLineCache(),this._updateEnabled())},e.prototype.setColor=function(e){e!==this.color&&this._enabled&&this._flushLineCache(),this.color=e},e.prototype._updateEnabled=function(){this._enabled=this._delaying?this._enabledOld:this._enabledNew},e}();i.default=n},{}],60:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._length=e,this._nextIndex=0,this._indices=new Uint8Array(255),this._queue=new Array(this._length);for(var i=0;i<this._length;i++)this._queue[i]=new n(t)}return e.prototype.reset=function(){for(var e=0;e<this._length;e++)this._queue[e].nextIndex=0},e.prototype.push=function(e,t,i){if(i>=this._length)throw new Error("delay exceeds queue length");var r=this._indices[e];r<this._length&&this._queue[r].remove(e);var n=(this._nextIndex+i)%this._length;return this._queue[n].push(e,t),this._indices[e]=n,this},e.prototype.execute=function(e,t){var i=this._queue[this._nextIndex];this._nextIndex=(this._nextIndex+1)%this._length;for(var r=0;r<i.nextIndex;r++)e(i.addresses[r],i.values[r],t),this._indices[i.addresses[r]]=255;i.nextIndex=0},e}(),n=function(){function e(e){this.size=e,this.nextIndex=0,this.addresses=new Uint8Array(e),this.values=new Uint8Array(e)}return e.prototype.push=function(e,t){if(this.nextIndex>=this.size)throw new Error("delay queue overflow");this.addresses[this.nextIndex]=e,this.values[this.nextIndex]=t,this.nextIndex++},e.prototype.remove=function(e){var t;for(t=0;t<this.nextIndex&&this.addresses[t]!==e;t++);t<this.nextIndex&&(this.addresses[t]=this.addresses[this.nextIndex-1],this.values[t]=this.values[this.nextIndex-1],this.nextIndex--)},e}();i.default=r},{}],61:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("microevent.ts");e("../Config");!function(e){e[e.vblankNTSC=40]="vblankNTSC",e[e.vblankPAL=48]="vblankPAL",e[e.kernelNTSC=192]="kernelNTSC",e[e.kernelPAL=228]="kernelPAL",e[e.overscanNTSC=30]="overscanNTSC",e[e.overscanPAL=36]="overscanPAL",e[e.vsync=3]="vsync",e[e.visibleOverscan=20]="visibleOverscan",e[e.maxUnderscan=10]="maxUnderscan",e[e.maxFramesWithoutVsync=50]="maxFramesWithoutVsync"}(r||(r={}));var s;!function(e){e[e.waitForVsyncStart=0]="waitForVsyncStart",e[e.waitForVsyncEnd=1]="waitForVsyncEnd",e[e.waitForFrameStart=2]="waitForFrameStart",e[e.frame=3]="frame",e[e.overscan=4]="overscan"}(s||(s={}));var a=function(){function e(e){switch(this._config=e,this.newFrame=new n.Event,this.vblank=!1,this.surfaceBuffer=null,this._vblankLines=0,this._kernelLines=0,this._overscanLines=0,this._frameLines=0,this._maxLinesWithoutVsync=0,this._waitForVsync=!0,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surfaceFactory=null,this._surface=null,this._config.tvMode){case 0:this._vblankLines=40,this._kernelLines=192,this._overscanLines=30;break;case 1:case 2:this._vblankLines=48,this._kernelLines=228,this._overscanLines=36;break;default:throw new Error("invalid tv mode "+this._config.tvMode)}this._frameLines=this._vblankLines+this._kernelLines+this._overscanLines+3,this._maxLinesWithoutVsync=50*this._frameLines,this.reset()}return e.prototype.reset=function(){this.vblank=!1,this.surfaceBuffer=null,this._waitForVsync=!0,this._linesWithoutVsync=0,this._state=0,this._vsync=!1,this._lineInState=0,this._surface=null},e.prototype.nextLine=function(){if(this._surfaceFactory){switch(this._lineInState++,this._state){case 0:case 1:this._linesWithoutVsync>this._maxLinesWithoutVsync&&(this._waitForVsync=!1,this._setState(2));break;case 2:this._waitForVsync?this._lineInState>=(this.vblank?this._vblankLines:this._vblankLines-10)&&this._startFrame():this.vblank||this._startFrame();break;case 3:this._lineInState>=this._kernelLines+20&&this._finalizeFrame();break;case 4:this._lineInState>=this._overscanLines-20&&this._setState(this._waitForVsync?0:2)}this._waitForVsync&&this._linesWithoutVsync++}},e.prototype.isRendering=function(){return 3===this._state&&!!this._surface},e.prototype.setVblank=function(e){this._surfaceFactory&&(this.vblank=e)},e.prototype.setVsync=function(e){if(this._surfaceFactory&&this._waitForVsync&&e!==this._vsync)switch(this._vsync=e,this._state){case 0:case 2:case 4:e&&this._setState(1);break;case 1:e||(this._setState(2),this._linesWithoutVsync=0);break;case 3:e&&this._finalizeFrame()}},e.prototype.getHeight=function(){return this._kernelLines+20},e.prototype.setSurfaceFactory=function(e){this._surfaceFactory=e},e.prototype.getCurrentLine=function(){return 3===this._state?this._lineInState:0},e.prototype.getDebugState=function(){return this._getReadableState()+", line = "+this._lineInState+", vblank = "+(this.vblank?"1":"0")+", "+(this._waitForVsync?"":"given up on vsync")},e.prototype._getReadableState=function(){switch(this._state){case 0:return"wait for vsync start";case 1:return"wait for vsync end";case 2:return"wait for frame start";case 3:return"frame";case 4:return"overscan"}},e.prototype._startFrame=function(){this._setState(3),this._surface=this._surfaceFactory(),this.surfaceBuffer=this._surface.getBuffer()},e.prototype._finalizeFrame=function(){if(3!==this._state)throw new Error("finalize frame in invalid state "+this._state);this.newFrame.dispatch(this._surface),this._setState(4)},e.prototype._setState=function(e){this._state=e,this._lineInState=0},e}();i.default=a},{"../Config":28,"microevent.ts":5}],62:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._switch=e,this._modeLatched=!1,this._latchedValue=0,this.reset()}return e.prototype.reset=function(){this._modeLatched=!1,this._latchedValue=0},e.prototype.vblank=function(e){64&e?this._modeLatched=!0:(this._modeLatched=!1,this._latchedValue=128)},e.prototype.inpt=function(){var e=this._switch.read()?0:128;return this._modeLatched&&(this._latchedValue&=e,e=this._latchedValue),e},e}();i.default=r},{}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("./drawCounterDecodes");!function(e){e[e.renderCounterOffset=-4]="renderCounterOffset"}(r||(r={}));var s=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._enabled=!1,this._enam=!1,this._resmp=-1,this._hmmClocks=0,this._counter=0,this._moving=!1,this._width=1,this._effectiveWidth=0,this._lastMovementTick=0,this._rendering=!1,this._renderCounter=-4,this._widths=new Uint8Array([1,2,4,8]),this.reset()}return e.prototype.reset=function(){this.color=4294967295,this._width=1,this._enabled=!1,this._counter=0,this._rendering=!1,this._renderCounter=-4,this._moving=!1,this._hmmClocks=0,this._decodes=n.decodesMissile[0],this._resmp=-1,this._enam=!1,this._effectiveWidth=0,this._lastMovementTick=0},e.prototype.enam=function(e){var t=(2&e)>0,i=t&&0===this._resmp;t===this._enam&&i===this._enabled||this._flushLineCache(),this._enam=t,this._enabled=i},e.prototype.hmm=function(e){this._hmmClocks=e>>>4^8},e.prototype.resm=function(e,t){if(this._counter=e,this._rendering)if(this._renderCounter<0)this._renderCounter=e-157-4;else switch(this._width){case 8:this._renderCounter=e-157+(this._renderCounter>=4?4:0);break;case 4:this._renderCounter=e-157;break;case 2:t?this._rendering=this._renderCounter>1:0===this._renderCounter&&this._renderCounter++;break;default:t&&(this._rendering=this._renderCounter>0)}},e.prototype.resmp=function(e,t){var i=2&e;i!==this._resmp&&(this._flushLineCache(),this._resmp=i,i?this._enabled=!1:(this._enabled=this._enam,this._counter=t.getRespClock()))},e.prototype.nusiz=function(e){this._width=this._widths[(48&e)>>>4],this._decodes=n.decodesMissile[7&e],this._rendering&&this._renderCounter>=this._width&&(this._rendering=!1)},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return this._lastMovementTick=this._counter,e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(!1),this._moving},e.prototype.tick=function(e){this.collision=this._rendering&&this._renderCounter>=0&&this._enabled?0:this._collisionMask;var t=this._moving&&e;if(this._decodes[this._counter]&&!this._resmp){var i=(this._counter-this._lastMovementTick+160)%4;switch(this._rendering=!0,this._renderCounter=-4,t&&3===i&&this._width<4&&this._renderCounter++,i){case 3:this._effectiveWidth=1===this._width?2:this._width;break;case 2:this._effectiveWidth=0;break;default:this._effectiveWidth=this._width}}else this._rendering&&++this._renderCounter>=(t?this._effectiveWidth:this._width)&&(this._rendering=!1);++this._counter>=160&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.setColor=function(e){e!==this.color&&this._enabled&&this._flushLineCache(),this.color=e},e}();i.default=s},{"./drawCounterDecodes":69}],64:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=6.8e-8,n=1e6,s=1800,a=5,o=380,u=function(){function e(e,t,i){var u=this;this._clockFreq=e,this._timestampRef=t,this._paddle=i,this._uThresh=0,this._u=0,this._dumped=!1,this._value=.5,this._timestamp=0,this._uThresh=a*(1-Math.exp(228*-o/this._clockFreq/(n+s)/r)),this._paddle.valueChanged.addHandler(function(e){u._updateValue(),u._value=e}),this.reset()}return e.prototype.reset=function(){this._u=0,this._value=this._paddle.getValue(),this._dumped=!1,this._timestamp=this._timestampRef()},e.prototype.vblank=function(e){var t=this._dumped;128&e?(this._dumped=!0,this._u=0):t&&(this._dumped=!1,this._timestamp=this._timestampRef())},e.prototype.inpt=function(){return this._updateValue(),!this._dumped&&this._u>=this._uThresh?128:0},e.prototype._updateValue=function(){if(!this._dumped){var e=this._timestampRef();this._u=a*(1-(1-this._u/a)*Math.exp(-(e-this._timestamp)/(this._value*n+s)/r/this._clockFreq)),this._timestamp=e}},e}();i.default=u},{}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("./drawCounterDecodes");!function(e){e[e.renderCounterOffset=-5]="renderCounterOffset"}(r||(r={}));var s=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._divider=1,this._dividerPending=1,this._dividerChangeCounter=-1,this._sampleCounter=0,this._rendering=!1,this._renderCounter=-5,this._renderCounterTripPoint=0,this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this.reset()}return e.prototype.reset=function(){this.color=4294967295,this.collision=0,this._hmmClocks=0,this._counter=0,this._moving=!1,this._rendering=!1,this._renderCounter=-5,this._decodes=n.decodesPlayer[0],this._patternNew=0,this._patternOld=0,this._pattern=0,this._reflected=!1,this._delaying=!1,this._sampleCounter=0,this._dividerPending=0,this._dividerChangeCounter=-1,this._setDivider(1)},e.prototype.grp=function(e){e!==this._patternNew&&(this._patternNew=e,this._delaying||(this._flushLineCache(),this._updatePattern()))},e.prototype.hmp=function(e){this._hmmClocks=e>>>4^8},e.prototype.nusiz=function(e,t){var i=7&e;switch(i){case 5:this._dividerPending=2;break;case 7:this._dividerPending=4;break;default:this._dividerPending=1}var r=this._decodes;if(this._decodes=n.decodesPlayer[i],this._decodes!==r&&this._rendering&&this._renderCounter- -5<2&&!this._decodes[(this._counter-this._renderCounter-5+159)%160]&&(this._rendering=!1),this._dividerPending!==this._divider)if(this._rendering){var s=this._renderCounter- -5;switch(this._divider<<4|this._dividerPending){case 18:case 20:t?s<4?this._setDivider(this._dividerPending):this._dividerChangeCounter=s<5?1:0:s<3?this._setDivider(this._dividerPending):this._dividerChangeCounter=1;break;case 33:case 65:s<(t?4:3)?this._setDivider(this._dividerPending):s<(t?6:5)?(this._setDivider(this._dividerPending),this._renderCounter--):this._dividerChangeCounter=t?0:1;break;case 66:case 36:this._renderCounter<1||t&&this._renderCounter%this._divider==1?this._setDivider(this._dividerPending):this._dividerChangeCounter=this._divider-(this._renderCounter-1)%this._divider;break;default:throw new Error("cannot happen")}}else this._setDivider(this._dividerPending)},e.prototype.resp=function(e){this._counter=e,this._rendering&&this._renderCounter- -5<4&&(this._renderCounter=e-157-5)},e.prototype.refp=function(e){var t=this._reflected;this._reflected=(8&e)>0,this._reflected!==t&&(this._flushLineCache(),this._updatePattern())},e.prototype.vdelp=function(e){var t=this._delaying;this._delaying=(1&e)>0,this._delaying!==t&&(this._flushLineCache(),this._updatePattern())},e.prototype.startMovement=function(){this._moving=!0},e.prototype.movementTick=function(e,t){return e===this._hmmClocks&&(this._moving=!1),this._moving&&t&&this.tick(),this._moving},e.prototype.tick=function(){if(this.collision=this._rendering&&this._renderCounter>=this._renderCounterTripPoint&&this._pattern&1<<this._sampleCounter?0:this._collisionMask,this._decodes[this._counter])this._rendering=!0,this._renderCounter=-5,this._sampleCounter=0;else if(this._rendering){switch(this._renderCounter++,this._divider){case 1:this._renderCounter>0&&this._sampleCounter++,this._renderCounter>=0&&this._dividerChangeCounter>=0&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending);break;default:this._renderCounter>1&&(this._renderCounter-1)%this._divider==0&&this._sampleCounter++,this._renderCounter>0&&this._dividerChangeCounter>=0&&0==this._dividerChangeCounter--&&this._setDivider(this._dividerPending)}this._sampleCounter>7&&(this._rendering=!1)}++this._counter>=160&&(this._counter=0)},e.prototype.getPixel=function(e){return this.collision?e:this.color},e.prototype.shufflePatterns=function(){var e=this._patternOld;this._patternOld=this._patternNew,this._delaying&&e!==this._patternOld&&(this._flushLineCache(),this._updatePattern())},e.prototype.getRespClock=function(){switch(this._divider){case 1:return(this._counter-5+160)%160;case 2:return(this._counter-9+160)%160;case 4:return(this._counter-12+160)%160;default:throw new Error("cannot happen: invalid divider "+this._divider)}},e.prototype.setColor=function(e){e!==this.color&&this._pattern&&this._flushLineCache(),this.color=e},e.prototype._updatePattern=function(){this._pattern=this._delaying?this._patternOld:this._patternNew,this._reflected||(this._pattern=(1&this._pattern)<<7|(2&this._pattern)<<5|(4&this._pattern)<<3|(8&this._pattern)<<1|(16&this._pattern)>>>1|(32&this._pattern)>>>3|(64&this._pattern)>>>5|(128&this._pattern)>>>7)},e.prototype._setDivider=function(e){this._divider=e,this._renderCounterTripPoint=1===e?0:1},e}();i.default=s},{"./drawCounterDecodes":69}],66:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){e[e.normal=0]="normal",e[e.score=1]="score"}(r||(r={}));var n=function(){function e(e,t){this._collisionMask=e,this._flushLineCache=t,this.collision=0,this._colorLeft=0,this._colorRight=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._pattern=0,this._refp=!1,this._reflected=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._x=0,this.reset()}return e.prototype.reset=function(){this._pattern=0,this._reflected=!1,this._refp=!1,this._pf0=0,this._pf1=0,this._pf2=0,this._color=0,this._colorP0=0,this._colorP1=0,this._colorMode=0,this._applyColors()},e.prototype.pf0=function(e){this._pf0!==e>>>4&&(this._flushLineCache(),this._pf0=e>>>4,this._pattern=1048560&this._pattern|this._pf0)},e.prototype.pf1=function(e){this._pf1!==e&&(this._flushLineCache(),this._pf1=e,this._pattern=1044495&this._pattern|(128&e)>>>3|(64&e)>>>1|(32&e)<<1|(16&e)<<3|(8&e)<<5|(4&e)<<7|(2&e)<<9|(1&e)<<11)},e.prototype.pf2=function(e){this._pf2!==e&&(this._flushLineCache(),this._pf2=e,this._pattern=4095&this._pattern|(255&e)<<12)},e.prototype.ctrlpf=function(e){var t=(1&e)>0,i=2==(6&e)?1:0;t===this._reflected&&i===this._colorMode||(this._flushLineCache(),this._reflected=t,this._colorMode=i,this._applyColors())},e.prototype.setColor=function(e){e!==this._color&&0===this._colorMode&&this._flushLineCache(),this._color=e,this._applyColors()},e.prototype.setColorP0=function(e){e!==this._colorP0&&1===this._colorMode&&this._flushLineCache(),this._colorP0=e,this._applyColors()},e.prototype.setColorP1=function(e){e!==this._colorP1&&1===this._colorMode&&this._flushLineCache(),this._colorP1=e,this._applyColors()},e.prototype.tick=function(e){if(this._x=e,80!==e&&0!==e||(this._refp=this._reflected),!(3&e)){var t;t=0===this._pattern?0:e<80?this._pattern&1<<(e>>>2):this._refp?this._pattern&1<<39-(e>>>2):this._pattern&1<<(e>>>2)-20,this.collision=t?0:this._collisionMask}},e.prototype.getPixel=function(e){return this.collision?e:this._x<80?this._colorLeft:this._colorRight},e.prototype._applyColors=function(){switch(this._colorMode){case 0:this._colorLeft=this._colorRight=this._color;break;case 1:this._colorLeft=this._colorP0,this._colorRight=this._colorP1}},e}();i.default=n},{}],67:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("microevent.ts"),s=(e("../Config"),e("./Audio")),a=e("./Missile"),o=e("./Playfield"),u=e("./Player"),c=e("./Ball"),l=e("./LatchedInput"),h=e("./PaddleReader"),f=e("./FrameManager"),_=e("./DelayQueue"),d=e("./palette");!function(e){e[e.frameLinesPAL=312]="frameLinesPAL",e[e.frameLinesNTSC=262]="frameLinesNTSC"}(r||(r={}));var p;!function(e){e[e.hmove=6]="hmove",e[e.pf=2]="pf",e[e.grp=1]="grp",e[e.shufflePlayer=1]="shufflePlayer",e[e.shuffleBall=1]="shuffleBall",e[e.hmp=2]="hmp",e[e.hmm=2]="hmm",e[e.hmbl=2]="hmbl",e[e.hmclr=2]="hmclr",e[e.refp=1]="refp",e[e.vblank=1]="vblank",e[e.enabl=1]="enabl",e[e.enam=1]="enam"}(p||(p={}));var b;!function(e){e[e.hblank=159]="hblank",e[e.lateHblank=158]="lateHblank",e[e.frame=157]="frame",e[e.lateHblankThreshold=73]="lateHblankThreshold"}(b||(b={}));var g;!function(e){e[e.player0=31744]="player0",e[e.player1=17344]="player1",e[e.missile0=8760]="missile0",e[e.missile1=4390]="missile1",e[e.ball=2197]="ball",e[e.playfield=1099]="playfield"}(g||(g={}));var y;!function(e){e[e.blank=0]="blank",e[e.frame=1]="frame"}(y||(y={}));var m;!function(e){e[e.normal=0]="normal",e[e.pfp=1]="pfp",e[e.score=2]="score"}(m||(m={}));var k=function(){function e(t,i,r,d){var p=this;this._config=t,this.newFrame=new n.Event,this.trap=new n.Event,this._cpu=null,this._bus=null,this._delayQueue=new _.default(10,20),this._hstate=0,this._hblankCtr=0,this._hctr=0,this._collisionUpdateRequired=!1,this._movementClock=0,this._movementInProgress=!1,this._extendedHblank=!1,this._xDelta=0,this._clock=0,this._linesSinceChange=0,this._maxLinesTotal=0,this._colorBk=4278190080,this._priority=0,this._collisionMask=0,this._player0=new u.default(31744,function(){return p._flushLineCache()}),this._player1=new u.default(17344,function(){return p._flushLineCache()}),this._missile0=new a.default(8760,function(){return p._flushLineCache()}),this._missile1=new a.default(4390,function(){return p._flushLineCache()}),this._playfield=new o.default(1099,function(){return p._flushLineCache()}),this._ball=new c.default(2197,function(){return p._flushLineCache()}),this._frameManager=new f.default(this._config),this._frameManager.newFrame.addHandler(e._onNewFrame,this),this._palette=this._getPalette(this._config),this._input0=new l.default(i.getFire()),this._input1=new l.default(r.getFire()),this._audio0=new s.default(this._config),this._audio1=new s.default(this._config);var b=this._getClockFreq(this._config);this._paddles=new Array(4);for(var g=0;g<4;g++)this._paddles[g]=new h.default(b,function(){return p._clock},d[g]);this.reset()}return e.prototype.reset=function(){this._hblankCtr=0,this._hctr=0,this._movementInProgress=!1,this._extendedHblank=!1,this._movementClock=0,this._priority=0,this._hstate=0,this._collisionMask=0,this._colorBk=4278190080,this._linesSinceChange=0,this._collisionUpdateRequired=!1,this._clock=0,this._maxLinesTotal=0,this._xDelta=0,this._delayQueue.reset(),this._frameManager.reset(),this._missile0.reset(),this._missile1.reset(),this._player0.reset(),this._player1.reset(),this._playfield.reset(),this._ball.reset(),this._audio0.reset(),this._audio1.reset(),this._input0.reset(),this._input1.reset();for(var e=0;e<4;e++)this._paddles[e].reset();this._cpu&&this._cpu.resume()},e.prototype.setCpu=function(e){return this._cpu=e,this},e.prototype.getWidth=function(){return 160},e.prototype.getHeight=function(){return this._frameManager.getHeight()},e.prototype.setSurfaceFactory=function(e){return this._frameManager.setSurfaceFactory(e),this},e.prototype.getAudioChannel0=function(){return this._audio0},e.prototype.getAudioChannel1=function(){return this._audio1},e.prototype.setAudioEnabled=function(e){this._audio0.setActive(e&&this._config.enableAudio),this._audio1.setActive(e&&this._config.enableAudio)},e.prototype.read=function(e){var t,i=this._bus.getLastDataBusValue();switch(15&e){case 8:t=this._config.emulatePaddles?this._paddles[0].inpt():0;break;case 9:t=this._config.emulatePaddles?this._paddles[1].inpt():0;break;case 10:t=this._config.emulatePaddles?this._paddles[2].inpt():0;break;case 11:t=this._config.emulatePaddles?this._paddles[3].inpt():0;break;case 12:t=this._input0.inpt();break;case 13:t=this._input1.inpt();break;case 0:t=(8192&this._collisionMask?64:0)|(512&this._collisionMask?128:0);break;case 1:t=(256&this._collisionMask?64:0)|(4096&this._collisionMask?128:0);break;case 2:t=(2048&this._collisionMask?64:0)|(1024&this._collisionMask?128:0);break;case 3:t=(128&this._collisionMask?64:0)|(64&this._collisionMask?128:0);break;case 4:t=(16&this._collisionMask?64:0)|(8&this._collisionMask?128:0);break;case 5:t=(4&this._collisionMask?64:0)|(2&this._collisionMask?128:0);break;case 7:t=(32&this._collisionMask?64:0)|(16384&this._collisionMask?128:0);break;case 6:t=1&this._collisionMask?128:0;break;default:t=i}return 192&t|63&i},e.prototype.peek=function(e){return this.read(e)},e.prototype.write=function(e,t){var i=0;switch(63&e){case 2:this._cpu.halt();break;case 3:this._flushLineCache(),this._rsync();break;case 0:this._frameManager.setVsync((2&t)>0);break;case 1:this._input0.vblank(t),this._input1.vblank(t);for(var r=0;r<4;r++)this._paddles[r].vblank(t);this._delayQueue.push(1,t,1);break;case 29:this._delayQueue.push(29,t,1);break;case 30:this._delayQueue.push(30,t,1);break;case 34:this._delayQueue.push(34,t,2);break;case 35:this._delayQueue.push(35,t,2);break;case 18:this._flushLineCache(),this._missile0.resm(this._resxCounter(),0===this._hstate);break;case 19:this._flushLineCache(),this._missile1.resm(this._resxCounter(),0===this._hstate);break;case 40:this._missile0.resmp(t,this._player0);break;case 41:this._missile1.resmp(t,this._player1);break;case 43:this._delayQueue.push(43,t,2);break;case 4:this._flushLineCache(),this._missile0.nusiz(t),this._player0.nusiz(t,0===this._hstate);break;case 5:this._flushLineCache(),this._missile1.nusiz(t),this._player1.nusiz(t,0===this._hstate);break;case 42:this._delayQueue.push(42,t,6);break;case 9:this._flushLineCache(),this._colorBk=this._palette[(255&t)>>>1];break;case 6:i=this._palette[(255&t)>>>1],this._missile0.setColor(i),this._player0.setColor(i),this._playfield.setColorP0(i);break;case 7:i=this._palette[(255&t)>>>1],this._missile1.setColor(i),this._player1.setColor(i),this._playfield.setColorP1(i);break;case 13:this._delayQueue.push(13,t,2);break;case 14:this._delayQueue.push(14,t,2);break;case 15:this._delayQueue.push(15,t,2);break;case 10:this._setPriority(t),this._playfield.ctrlpf(t),this._ball.ctrlpf(t);break;case 8:this._flushLineCache(),i=this._palette[(255&t)>>>1],this._playfield.setColor(i),this._ball.color=i;break;case 27:this._delayQueue.push(27,t,1).push(241,0,1);break;case 28:this._delayQueue.push(28,t,1).push(240,0,1).push(242,0,1);break;case 16:this._flushLineCache(),this._player0.resp(this._resxCounter());break;case 17:this._flushLineCache(),this._player1.resp(this._resxCounter());break;case 11:this._delayQueue.push(11,t,1);break;case 12:this._delayQueue.push(12,t,1);break;case 32:this._delayQueue.push(32,t,2);break;case 33:this._delayQueue.push(33,t,2);break;case 37:this._player0.vdelp(t);break;case 38:this._player1.vdelp(t);break;case 31:this._delayQueue.push(31,t,1);break;case 36:this._delayQueue.push(36,t,2);break;case 20:this._flushLineCache(),this._ball.resbl(this._resxCounter());break;case 39:this._ball.vdelbl(t);break;case 44:this._flushLineCache(),this._collisionMask=0;break;case 21:this._audio0.audc(t);break;case 22:this._audio1.audc(t);break;case 23:this._audio0.audf(t);break;case 24:this._audio1.audf(t);break;case 25:this._audio0.audv(t);break;case 26:this._audio1.audv(t)}},e.prototype.getDebugState=function(){return"hclock: "+this._hctr+"   line: "+this._frameManager.getCurrentLine()+"\n"+this._frameManager.getDebugState()},e.prototype.setBus=function(e){return this._bus=e,this},e.prototype.cycle=function(){this._delayQueue.execute(e._delayedWrite,this),this._collisionUpdateRequired=!1,this._linesSinceChange<2?(this._tickMovement(),0===this._hstate?this._tickHblank():this._tickHframe(),this._collisionUpdateRequired&&this._updateCollision()):0===this._hctr&&this._cpu.resume(),++this._hctr>=228&&this._nextLine(),this._clock++},e._delayedWrite=function(e,t,i){switch(e){case 1:i._flushLineCache(),i._frameManager.setVblank((2&t)>0);break;case 42:i._flushLineCache(),i._movementClock=0,i._movementInProgress=!0,i._extendedHblank||(i._hblankCtr-=8,i._clearHmoveComb(),i._extendedHblank=!0),i._missile0.startMovement(),i._missile1.startMovement(),i._player0.startMovement(),i._player1.startMovement(),i._ball.startMovement();break;case 13:i._playfield.pf0(t);break;case 14:i._playfield.pf1(t);break;case 15:i._playfield.pf2(t);break;case 27:i._player0.grp(t);break;case 28:i._player1.grp(t);break;case 240:i._player0.shufflePatterns();break;case 241:i._player1.shufflePatterns();break;case 32:i._player0.hmp(t);break;case 33:i._player1.hmp(t);break;case 34:i._missile0.hmm(t);break;case 35:i._missile1.hmm(t);break;case 36:i._ball.hmbl(t);break;case 43:i._missile0.hmm(0),i._missile1.hmm(0),i._player0.hmp(0),i._player1.hmp(0),i._ball.hmbl(0);break;case 11:i._player0.refp(t);break;case 12:i._player1.refp(t);break;case 242:i._ball.shuffleStatus();break;case 31:i._ball.enabl(t);break;case 29:i._missile0.enam(t);break;case 30:i._missile1.enam(t)}},e._onNewFrame=function(e,t){var i=t._frameManager.getCurrentLine();if(i>t._maxLinesTotal&&(t._maxLinesTotal=i),i<t._maxLinesTotal)for(var r=e.getBuffer(),n=160*i,s=160*t._maxLinesTotal,a=n;a<s;a++)r[a]=4278190080;t.newFrame.dispatch(e)},e.prototype._tickMovement=function(){if(this._movementInProgress&&0==(3&this._hctr)){var e=0===this._hstate,t=!1,i=this._movementClock>15?0:this._movementClock;t=this._missile0.movementTick(i,e)||t,t=this._missile1.movementTick(i,e)||t,t=this._player0.movementTick(i,e)||t,t=this._player1.movementTick(i,e)||t,t=this._ball.movementTick(i,e)||t,this._movementInProgress=t,this._collisionUpdateRequired=t,this._movementClock++}},e.prototype._tickHblank=function(){0===this._hctr&&(this._hblankCtr=0,this._cpu.resume()),++this._hblankCtr>=68&&(this._hstate=1)},e.prototype._tickHframe=function(){var e=this._frameManager.getCurrentLine(),t=this._hctr-68+this._xDelta;this._collisionUpdateRequired=!0,this._playfield.tick(t),this._tickSprites(),this._frameManager.isRendering()&&this._renderPixel(t,e)},e.prototype._tickSprites=function(){this._missile0.tick(!0),this._missile1.tick(!0),this._player0.tick(),this._player1.tick(),this._ball.tick(!0)},e.prototype._nextLine=function(){this._linesSinceChange>=2&&this._cloneLastLine(),this._hctr=0,this._movementInProgress||this._linesSinceChange++,this._hstate=0,this._extendedHblank=!1,this._xDelta=0,this._frameManager.nextLine(),this._frameManager.isRendering()&&0===this._frameManager.getCurrentLine()&&this._flushLineCache()},e.prototype._cloneLastLine=function(){var e=this._frameManager.getCurrentLine();if(this._frameManager.isRendering()&&0!==e)for(var t=160*e,i=160*(e-1),r=0;r<160;r++)this._frameManager.surfaceBuffer[t+r]=this._frameManager.surfaceBuffer[i+r]},e.prototype._getPalette=function(e){switch(e.tvMode){case 0:return d.NTSC;case 1:return d.PAL;case 2:return d.SECAM;default:throw new Error("invalid TV mode")}},e.prototype._getClockFreq=function(e){return 0===e.tvMode?3584160:3556800},e.prototype._renderPixel=function(e,t){var i=this._colorBk;switch(this._priority){case 0:i=this._playfield.getPixel(i),i=this._ball.getPixel(i),i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i);break;case 1:i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i),i=this._playfield.getPixel(i),i=this._ball.getPixel(i);break;case 2:i=this._ball.getPixel(i),i=this._missile1.getPixel(i),i=this._player1.getPixel(i),i=this._playfield.getPixel(i),i=this._missile0.getPixel(i),i=this._player0.getPixel(i);break;default:throw new Error("invalid priority")}this._frameManager.surfaceBuffer[160*t+e]=this._frameManager.vblank?4278190080:i},e.prototype._updateCollision=function(){this._collisionMask|=~this._player0.collision&~this._player1.collision&~this._missile0.collision&~this._missile1.collision&~this._ball.collision&~this._playfield.collision},e.prototype._clearHmoveComb=function(){if(this._frameManager.isRendering()&&0===this._hstate)for(var e=160*this._frameManager.getCurrentLine(),t=0;t<8;t++)this._frameManager.surfaceBuffer[e+t]=4278190080},e.prototype._resxCounter=function(){return 0===this._hstate?this._hctr>=73?158:159:157},e.prototype._rsync=function(){var e=this._hctr>68?this._hctr-68:0;if(this._xDelta=157-e,this._frameManager.isRendering())for(var t=this._frameManager.getCurrentLine(),i=160*t+e,r=i+160*(t+1),n=i;n<r;n++)this._frameManager.surfaceBuffer[n]=4278190080;this._hctr=225},e.prototype._setPriority=function(e){var t=4&e?1:2&e?2:0;t!==this._priority&&(this._flushLineCache(),this._priority=t)},e.prototype._flushLineCache=function(){var e=this._linesSinceChange>=2;if(this._linesSinceChange=0,e){var t=this._hctr;for(this._hctr=0;this._hctr<t;this._hctr++)0===this._hstate?this._tickHblank():this._tickHframe()}},e}();!function(e){!function(e){e[e.vsync=0]="vsync",e[e.vblank=1]="vblank",e[e.wsync=2]="wsync",e[e.rsync=3]="rsync",e[e.nusiz0=4]="nusiz0",e[e.nusiz1=5]="nusiz1",e[e.colup0=6]="colup0",e[e.colup1=7]="colup1",e[e.colupf=8]="colupf",e[e.colubk=9]="colubk",e[e.ctrlpf=10]="ctrlpf",e[e.refp0=11]="refp0",e[e.refp1=12]="refp1",e[e.pf0=13]="pf0",e[e.pf1=14]="pf1",e[e.pf2=15]="pf2",e[e.resp0=16]="resp0",e[e.resp1=17]="resp1",e[e.resm0=18]="resm0",e[e.resm1=19]="resm1",e[e.resbl=20]="resbl",e[e.audc0=21]="audc0",e[e.audc1=22]="audc1",e[e.audf0=23]="audf0",e[e.audf1=24]="audf1",e[e.audv0=25]="audv0",e[e.audv1=26]="audv1",e[e.grp0=27]="grp0",e[e.grp1=28]="grp1",e[e.enam0=29]="enam0",e[e.enam1=30]="enam1",e[e.enabl=31]="enabl",e[e.hmp0=32]="hmp0",e[e.hmp1=33]="hmp1",e[e.hmm0=34]="hmm0",e[e.hmm1=35]="hmm1",e[e.hmbl=36]="hmbl",e[e.vdelp0=37]="vdelp0",e[e.vdelp1=38]="vdelp1",e[e.vdelbl=39]="vdelbl",e[e.resmp0=40]="resmp0",e[e.resmp1=41]="resmp1",e[e.hmove=42]="hmove",e[e.hmclr=43]="hmclr",e[e.cxclr=44]="cxclr",e[e.cxm0p=0]="cxm0p",e[e.cxm1p=1]="cxm1p",e[e.cxp0fb=2]="cxp0fb",e[e.cxp1fb=3]="cxp1fb",e[e.cxm0fb=4]="cxm0fb",e[e.cxm1fb=5]="cxm1fb",e[e.cxblpf=6]="cxblpf",e[e.cxppmm=7]="cxppmm",e[e.inpt0=8]="inpt0",e[e.inpt1=9]="inpt1",e[e.inpt2=10]="inpt2",e[e.inpt3=11]="inpt3",e[e.inpt4=12]="inpt4",e[e.inpt5=13]="inpt5",e[e._shuffleP0=240]="_shuffleP0",e[e._shuffleP1=241]="_shuffleP1",e[e._shuffleBL=242]="_shuffleBL"}(e.Registers||(e.Registers={}));!function(e){e[e.invalidRead=0]="invalidRead",e[e.invalidWrite=1]="invalidWrite"}(e.TrapReason||(e.TrapReason={}));var t=function(){return function(e,t,i){this.reason=e,this.tia=t,this.message=i}}();e.TrapPayload=t}(k||(k={})),i.default=k},{"../Config":28,"./Audio":58,"./Ball":59,"./DelayQueue":60,"./FrameManager":61,"./LatchedInput":62,"./Missile":63,"./PaddleReader":64,"./Player":65,"./Playfield":66,"./palette":70,"microevent.ts":5}],68:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../Config"),n=e("../../../tools/AudioOutputBuffer"),s=new Int8Array([1,1,15,1,1,1,1,1,1,1,1,1,3,3,3,1]),a=new Int8Array([1]),o=new Int8Array([1,1]),u=new Int8Array([16,15]),c=new Int8Array([1,2,2,1,1,1,4,3]),l=new Int8Array([1,2,1,1,2,2,5,4,2,1,3,1,1,1,1,4]),h=new Int8Array([1,4,1,3,2,4,1,2,3,2,1,1,1,1,1,1,2,4,2,1,4,1,1,2,2,1,3,2,1,3,1,1,1,4,1,1,1,1,2,1,1,2,6,1,2,2,1,2,1,2,1,1,2,1,6,2,1,2,2,1,1,1,1,2,2,2,2,7,2,3,2,2,1,1,1,3,2,1,1,2,1,1,7,1,1,3,1,1,2,3,3,1,1,1,2,2,1,1,2,2,4,3,5,1,3,1,1,5,2,1,1,1,2,1,2,1,3,1,2,5,1,1,2,1,1,1,5,1,1,1,1,1,1,1,1,6,1,1,1,2,1,1,1,1,4,2,1,1,3,1,3,6,3,2,3,1,1,2,1,2,4,1,1,1,3,1,1,1,1,3,1,2,1,4,2,2,3,4,1,1,4,1,2,1,2,2,2,1,1,4,3,1,4,4,9,5,4,1,5,3,1,1,3,2,2,2,1,5,1,2,1,1,1,2,3,1,2,1,1,3,4,2,5,2,2,1,2,3,1,1,1,1,1,2,1,3,3,3,2,1,2,1,1,1,1,1,3,3,1,2,2,3,1,3,1,8]),f=new Int8Array([5,6,4,5,10,5,3,7,4,10,6,3,6,4,9,6]),_=[a,c,c,new Int8Array([2,3,2,1,4,1,6,10,2,4,2,1,1,4,5,9,3,3,4,1,1,1,8,5,5,5,4,1,1,1,8,4,2,8,3,3,1,1,7,4,2,7,5,1,3,1,7,4,1,4,8,2,1,3,4,7,1,3,7,3,2,1,6,6,2,2,4,5,3,2,6,6,1,3,3,2,5,3,7,3,4,3,2,2,2,5,9,3,1,5,3,1,2,2,11,5,1,5,3,1,1,2,12,5,1,2,5,2,1,1,12,6,1,2,5,1,2,1,10,6,3,2,2,4,1,2,6,10]),o,o,u,l,h,l,u,a,o,o,u,f],d=function(){function e(e){this._config=e}return e.prototype.setConfig=function(e){this._config=e},e.prototype.getKey=function(e,t){return e<<5|t},e.prototype.getBuffer=function(e){for(var t=e>>>5&15,i=31&e,a=_[t],o=0,u=0;u<a.length;u++)o+=a[u];o=o*s[t]*(i+1);for(var c=new Float32Array(o),l=1e6*r.default.getClockMhz(this._config)/114,h=0,f=0,d=0,p=!0,u=0;u<o;u++)++h===s[t]*(i+1)&&(h=0,++f===a[d]&&(d++,f=0,a.length===d&&(d=0)),p=!(1&d)),c[u]=p?1:-1;return new n.default(c,l)},e}();i.default=d},{"../../../tools/AudioOutputBuffer":71,"../Config":28}],69:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=new Uint8Array(160),n=new Uint8Array(160),s=new Uint8Array(160),a=new Uint8Array(160),o=new Uint8Array(160),u=new Uint8Array(160);i.decodesMissile=[r,n,s,a,o,r,u,r],i.decodesPlayer=[r,n,s,a,o,r,u,r],[r,n,s,a,o,u].forEach(function(e){for(var t=0;t<160;t++)e[t]=0;e[156]=1}),n[12]=1,s[28]=1,a[12]=a[28]=1,o[60]=1,u[28]=u[60]=1},{}],70:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NTSC=new Uint32Array([4278190080,4283058762,4285493103,4287532686,4289374890,4290822336,4292269782,4293717228,4278208584,4279200105,4280125062,4280984226,4281711547,4282438354,4283099368,4283759868,4278201468,4279322768,4280378018,4281367220,4282224835,4283081938,4283807711,4284532972,4278197392,4279581091,4280832949,4282019014,4283073237,4284061667,4284984048,4285840636,4278190228,4279900839,4281479864,4282927304,4284243158,4285493220,4286611696,4287664380,4284743812,4286192023,4287574184,4288825016,4289944006,4290997460,4291984608,4292906220,4286840912,4288289128,4289540221,4290791058,4291844516,4292897973,4293819589,4294741204,4287627284,4288879155,4290064974,4291184744,4292172927,4293095317,4293951657,4294742204,4287889408,4289141272,4290261549,4291315778,4292238420,4293160805,4293951605,4294742148,4287110144,4288494360,4289746733,4290933314,4291988052,4292976741,4293899637,4294756484,4284755968,4286599192,4288179501,4289759298,4291141716,4292458341,4293643381,4294762628,4281352192,4283327e3,4285104429,4286750274,4288264276,4289646949,4290963317,4292148356,4278207488,4279920154,4281500722,4282949704,4284267100,4285518447,4286638208,4287691920,4278205460,4279787317,4281171538,4282555502,4283742087,4284862622,4285917108,4286905544,4278204464,4279654736,4281038445,4282290824,4283411360,4284465847,4285454540,4286377184,4278201416,4279520617,4280707718,4281894562,4282884027,4283872978,4284730600,4285587708]),i.PAL=new Uint32Array([4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278212736,4279923094,4281501611,4282948798,4284264399,4285513951,4286632430,4287684860,4278213700,4279925086,4281504630,4282952844,4284269216,4285519795,4286638788,4287691988,4278203504,4279914889,4281494432,4282942646,4284259017,4285509596,4286628588,4287681788,4279526400,4281696282,4283602994,4285444168,4287087964,4288600431,4290046848,4291361936,4279500912,4281670281,4283576992,4285417654,4287061193,4288573404,4290019564,4291334396,4284242944,4285953562,4287532594,4288980040,4290295900,4291545967,4292664448,4293717136,4284219504,4285799044,4287181462,4288563368,4289748151,4290867142,4291920083,4292907232,4285545472,4287191577,4288705839,4290154052,4291405143,4292655720,4293709433,4294762632,4285530200,4287175278,4288688771,4290136214,4291386535,4292636599,4293689542,4294742228,4285538304,4287184665,4288698927,4290147396,4291398487,4292649320,4293703033,4294756488,4286578740,4288027210,4289409631,4290660466,4291779715,4292833171,4293820578,4294742192,4287102976,4288485914,4289737266,4290922568,4291976284,4292964207,4293886080,4294742160,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228,4278190080,4281019179,4283585106,4285953654,4288124823,4290164406,4292006610,4293717228]),i.SECAM=new Uint32Array([4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295,4278190080,4294910241,4286135536,4294922495,4278255487,4294967167,4282384383,4294967295])},{}],71:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._content=e,this._sampleRate=t}return e.prototype.getLength=function(){return this._content.length},e.prototype.getContent=function(){return this._content},e.prototype.getSampleRate=function(){return this._sampleRate},e}();i.default=r},{}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(e){this._scheduler=e,this.frequencyUpdate=new r.Event,this._counter=0,this._frequency=0}return e.prototype.attach=function(e){return this._clock&&this.detach(),this._clock=e,e.addHandler(this._clockHandler,this),this},e.prototype.start=function(){if(!this._measurementTask)return this._timestamp=Date.now(),this._counter=0,this._measurementTask=this._scheduler.start(this._updateMeasurement,this),this},e.prototype.detach=function(){if(this._clock)return this._clock.removeHandler(this._clockHandler,this),this._clock=void 0,this},e.prototype.stop=function(){if(this._measurementTask)return this._measurementTask.stop(),this._measurementTask=void 0,this},e.prototype.getFrequency=function(){return this._frequency},e.prototype._updateMeasurement=function(e){var t=Date.now();e._frequency=e._counter/(t-e._timestamp)*1e3,e._counter=0,e._timestamp=t,e.frequencyUpdate.dispatch(e._frequency)},e.prototype._clockHandler=function(e,t){t._counter+=e},e}();i.default=n},{"microevent.ts":5}],73:[function(e,t,i){"use strict";function r(e,t,i,n){if(void 0===i&&(i=!0),void 0===n&&(n=""),!i&&e<0)return r(e>>>16,t&&t>8?t-4:4,!1,n)+r(65535&e,4);var s=Math.abs(e).toString(16).toUpperCase();if(void 0!==t)for(;s.length<t;)s="0"+s;return(e<0?"-":"")+n+s}Object.defineProperty(i,"__esModule",{value:!0}),i.encode=function(e,t,i){return void 0===i&&(i=!0),r(e,t,i,"$")},i.decode=function(e){var t=e.match(/^-/)?-1:1,i=e.replace(/^-/,"").toUpperCase();if(i.match(/^0X[0-9A-F]+$/))i=i.replace(/^0x/,"");else{if(!i.match(/^\$[0-9A-F]+$/))throw new TypeError("invalid hex number "+e);i=i.replace(/^\$/,"")}return t*parseInt(i,16)}},{}],74:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){this._value=e,this._mapper=t}return e.prototype.get=function(){return this._mapper(this._value.get())},e.prototype.release=function(){this._value.release()},e.prototype.dispose=function(){this._value.dispose()},e}();i.default=r},{}],75:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./InducedMember"),n=function(){function e(e){this._mapper=e,this._map=new WeakMap}return e.prototype.get=function(e){return this._map.has(e)||this._map.set(e,new r.default(e,this._mapper)),this._map.get(e)},e}();i.default=n},{"./InducedMember":74}],76:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("./PoolMember"),s=function(){function e(e){this._factory=e,this.event={release:new r.Event,dispose:new r.Event},this._pool=[],this._poolSize=0}return e.prototype.get=function(){var e,t=this;if(0===this._poolSize){var i=this._factory();e=i&&new n.default(i,function(e){return t._releaseMember(e)},function(e){return t._disposeMember(e)})}else(e=this._pool[--this._poolSize])._isAvailable=!1;return e},e.prototype._releaseMember=function(e){if(e._isAvailable)throw new Error("Trying to release an already released pool member");if(e._isDisposed)throw new Error("Trying to release an already disposed pool member");var t=this._poolSize++;this._pool[t]=e,e._isAvailable=!0,e._poolPosition=t,this.event.release.dispatch(e.get())},e.prototype._disposeMember=function(e){if(e._isDisposed)throw new Error("Trying to dispose of an already disposed pool member");e._isAvailable&&(this._poolSize>1&&(this._pool[e._poolPosition]=this._pool[this._poolSize-1]),this._poolSize--),e._isDisposed=!0,this.event.dispose.dispatch(e.get())},e}();i.default=s},{"./PoolMember":77,"microevent.ts":5}],77:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t,i){this._value=e,this._releaseCB=t,this._disposeCB=i,this._isAvailable=!1,this._isDisposed=!1}return e.prototype.adopt=function(e){this._value=e},e.prototype.get=function(){return this._value},e.prototype.release=function(){this._releaseCB(this)},e.prototype.dispose=function(){this._disposeCB(this)},e}();i.default=r},{}],78:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._rng=e}return e.prototype.single=function(){return this._rng.quick()},e.prototype.double=function(){return this._rng.double()},e.prototype.int32=function(){return this._rng.int32()},e.prototype.int=function(e){return(this._rng.int32()>>>0)%(e+1)},e.prototype.saveState=function(){return this._rng.state()},e}();i.default=r},{}],79:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("seedrandom"),n=e("./SeedrandomGenerator");i.createRng=function(e){return e<0&&(e=Math.random()),new n.default(r.alea(e,{state:!0}))},i.restoreRng=function(e){return new n.default(r.alea("",{state:e}))}},{"./SeedrandomGenerator":78,seedrandom:8}],80:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./PeriodicScheduler"),n=e("./ImmedateScheduler"),s=e("./limiting/BusyWait"),a=e("./limiting/ConstantCycles"),o=e("./limiting/ConstantTimeslice"),u=function(){function e(){}return e.prototype.createPeriodicScheduler=function(e){return new r.default(e)},e.prototype.createImmediateScheduler=function(){return new n.default},e.prototype.createLimitingScheduler=function(e){switch(void 0===e&&(e=1),e){case 0:return new s.default;case 1:return new a.default;case 2:return new o.default;default:throw new Error("invalud limiting scheduling strategy")}},e.prototype.getLimitingSchedulingStrategies=function(){return[0,1,2]},e.prototype.describeLimitingSchedulingStrategy=function(e){switch(e){case 0:return"Busy wait, constant timeslice length";case 1:return"Constant cycle count";case 2:return"Constant timeslice length";default:throw new Error("invalid limiting scheduling strategy")}},e}();!function(e){!function(e){e[e.busyWait=0]="busyWait",e[e.constantCycles=1]="constantCycles",e[e.constantTimeslice=2]="constantTimeslice"}(e.LimitingSchedulingStrategy||(e.LimitingSchedulingStrategy={}))}(u||(u={})),i.default=u},{"./ImmedateScheduler":81,"./PeriodicScheduler":82,"./limiting/BusyWait":84,"./limiting/ConstantCycles":85,"./limiting/ConstantTimeslice":86}],81:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./setImmediate"),n=function(){function e(){}return e.prototype.start=function(e,t){function i(){n||(e(t),r.setImmediate(i))}var n=!1;return r.setImmediate(i),{stop:function(){return n=!0}}},e}();i.default=n},{"./setImmediate":87}],82:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e){this._period=e}return e.prototype.setPeriod=function(e){return this._period=e,this},e.prototype.getPeriod=function(){return this._period},e.prototype.start=function(e,t){var i=this,r=!1,n=function(){r||(e(t),setTimeout(n,i._period))};return setTimeout(n,this._period),{stop:function(){return r=!0}}},e}();i.default=r},{}],83:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=self.performance&&self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};i.default=r},{}],84:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../getTimestamp"),n=e("../setImmediate"),s=1,a=function(){function e(){}return e.prototype.start=function(e,t,i){function a(){if(u){for(var i=r.default(),c=0,l=0;r.default()-i<o;){do{l=r.default()-i-c}while(l<s);c+=e(t,l)}(l=r.default()-i-c)>0&&(c+=e(t,l)),u&&n.setImmediate(a)}}var o=i||50,u=!0;return n.setImmediate(a),{stop:function(){return u=!1}}},e}();i.default=a},{"../getTimestamp":83,"../setImmediate":87}],85:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../getTimestamp"),n=e("../setImmediate"),s=3,a=100,o=function(){function e(){}return e.prototype.start=function(e,t){function i(){if(!o){var h=r.default(),f=(e(t)||0)-r.default()+h;u>=0&&(l+=u-h+c),l>a?l=a:l<-a&&(l=-a),Math.abs(l)>s&&(f+=l,l=0),f<0&&(l=f=0),f>0?setTimeout(i,Math.round(f)):n.setImmediate(i),u=f,c=r.default()}}var o=!1,u=-1,c=0,l=0;return n.setImmediate(i),{stop:function(){return o=!0}}},e}();i.default=o},{"../getTimestamp":83,"../setImmediate":87}],86:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../getTimestamp"),n=e("../setImmediate"),s=3,a=function(){function e(){}return e.prototype.start=function(e,t,i){function a(){if(l){var i=r.default(),h=i-u-c;h>s*o&&(u=i-(h=s*o),c=0),c+=e(t,h);var f=o-r.default()+i;f>0?setTimeout(a,f):n.setImmediate(a)}}var o=i||100,u=r.default(),c=0,l=!0;return n.setImmediate(a),{stop:function(){return l=!1}}},e}();i.default=a},{"../getTimestamp":83,"../setImmediate":87}],87:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=e("setimmediate2");!function(e){e[e.setTimeoutRecurrence=10]="setTimeoutRecurrence"}(r||(r={}));var s=0;i.setImmediate=function(e){0===s?setTimeout(e,0):n.setImmediate(e),s=(s+1)%10}},{setimmediate2:16}],88:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(){this.emit=new r.Event,this._framesOnHold=new Array(2),this._nFramesOnHold=0,this._width=0,this._height=0}return e.prototype.init=function(e,t){this.flush(),this._width=e,this._height=t},e.prototype.flush=function(){for(var e=0;e<this._nFramesOnHold;e++)this._framesOnHold[e].release(),this._framesOnHold[e]=null;this._nFramesOnHold=0},e.prototype.processSurface=function(e){var t=e.get();if(t.getHeight()!==this._height||t.getWidth()!==this._width)throw new Error("surface dimensions do not match");this._framesOnHold[this._nFramesOnHold++]=e,2===this._nFramesOnHold&&this._process()},e.prototype._process=function(){for(var e=this._framesOnHold[0].get().getBuffer(),t=this._framesOnHold[1].get().getBuffer(),i=0;i<this._width*this._height;i++)e[i]=4278190080|(16711680&e[i])+(16711680&t[i])>>>1&16711680|(65280&e[i])+(65280&t[i])>>>1&65280|(255&e[i])+(255&t[i])>>>1&255;this.emit.dispatch(this._framesOnHold[0]),this._framesOnHold[1].release(),this._nFramesOnHold=0},e}();i.default=n},{"microevent.ts":5}],89:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=function(){function e(){this.emit=new r.Event}return e.prototype.init=function(){},e.prototype.flush=function(){},e.prototype.processSurface=function(e){this.emit.dispatch(e)},e}();i.default=n},{"microevent.ts":5}],90:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});e("./config");var r=e("./PassthroughProcessor"),n=e("./FrameMergeProcessor"),s=function(){function e(){}return e.prototype.create=function(e){switch(e.type){case 0:return new r.default;case 1:return new n.default;default:throw new Error("cannot happen: invalid processor type")}},e}();i.default=s},{"./FrameMergeProcessor":88,"./PassthroughProcessor":89,"./config":92}],91:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./ProcessorFactory"),n=function(){function e(e){var t=this;e&&0!==e.length||(e=[{type:0}]);var i=new r.default;this._processors=e.map(function(e){return i.create(e)});for(var n=this,s=1;s<this._processors.length;s++)!function(e){n._processors[e-1].emit.addHandler(function(i){return t._processors[e].processSurface(i)})}(s);this.emit=this._processors[this._processors.length-1].emit}return e.prototype.init=function(e,t){this._processors.forEach(function(i){return i.init(e,t)})},e.prototype.flush=function(){this._processors.forEach(function(e){return e.flush()})},e.prototype.processSurface=function(e){this._processors[0].processSurface(e)},e}();i.default=n},{"./ProcessorFactory":90}],92:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});!function(e){e[e.passthrough=0]="passthrough",e[e.merge=1]="merge"}(i.Type||(i.Type={}))},{}],93:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("worker-rpc"),n=e("microevent.ts"),s=e("./messages"),a=function(){function e(e){this._rpc=e,this.emit=new n.Event,this._nextId=0,this._surfaces=new Map,this._rpc.registerSignalHandler(s.messageIds.emit,this._onMessageEmit.bind(this)).registerSignalHandler(s.messageIds.release,this._onMessageRelease.bind(this))}return e.spawn=function(t){void 0===t&&(t="video-pipeline.js");var i=new Worker(t),n=new r.RpcProvider(function(e,t){return i.postMessage(e,t)});return i.onmessage=function(e){return n.dispatch(e.data)},new e(n)},e.prototype.configure=function(e,t,i){return this._rpc.rpc(s.messageIds.configure,{width:e,height:t,config:i})},e.prototype.flush=function(){return this._rpc.rpc(s.messageIds.flush)},e.prototype.processSurface=function(e){var t=this._nextId++,i=e.get(),r=i.getUnderlyingBuffer();this._surfaces.set(t,e),this._rpc.signal(s.messageIds.process,{id:t,width:i.getWidth(),height:i.getHeight(),buffer:r},[r])},e.prototype._onMessageEmit=function(e){if(!this._surfaces.has(e.id))throw new Error("no surface with id "+e.id);var t=this._surfaces.get(e.id),i=t.get();this._surfaces.delete(e.id),i.replaceUnderlyingBuffer(i.getWidth(),i.getHeight(),e.buffer),this.emit.dispatch(t)},e.prototype._onMessageRelease=function(e){if(!this._surfaces.has(e.id))throw new Error("no surface with id "+e.id);var t=this._surfaces.get(e.id),i=t.get();this._surfaces.delete(e.id),i.replaceUnderlyingBuffer(i.getWidth(),i.getHeight(),e.buffer),t.release()},e}();i.default=a},{"./messages":94,"microevent.ts":5,"worker-rpc":18}],94:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.messageIds={configure:"pipeline/configure",flush:"pipeline/flush",process:"pipeline/process",emit:"pipeline/emit",release:"pipeline/release"},Object.freeze(i.messageIds)},{}],95:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(){this._height=0,this._width=0,this._buffer=null}return e.createFromArrayBuffer=function(t,i,r){return(new e).replaceUnderlyingBuffer(t,i,r)},e.prototype.replaceUnderlyingBuffer=function(e,t,i){if(e*t*4!==i.byteLength)throw new Error("surface size mismatch");return this._width=e,this._height=t,this._underlyingBuffer=i,this._buffer=new Uint32Array(this._underlyingBuffer),this},e.prototype.getUnderlyingBuffer=function(){return this._underlyingBuffer},e.prototype.resetUnderlyingBuffer=function(){return this._width=this._height=0,this._underlyingBuffer=this._buffer=null,this},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getByteOrder=function(){return 0},e.prototype.fill=function(e){for(var t=0;t<this._buffer.length;t++)this._buffer[t]=e;return this},e}();i.default=r},{}],96:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("../../tools/pool/Pool"),s=e("../../video/surface/ArrayBufferSurface"),a=e("../../tools/pool/InducedPool"),o=e("../../video/processing/ProcessorPipeline"),u=function(){function e(e,t){var i=this;this._video=e,this.newFrame=new r.Event,this._poolMembers=new WeakMap,this._surfaces=new WeakMap,this._surfacePool=new a.default(function(e){return i._surfaces.get(e)}),this._videoProcessor=new o.default(t),this._videoProcessor.init(this._video.getWidth(),this._video.getHeight()),this._pool=new n.default(function(){return new ImageData(i._video.getWidth(),i._video.getHeight())}),this._video.setSurfaceFactory(function(){var e=i._pool.get(),t=e.get();if(!i._surfaces.has(t)){var r=s.default.createFromArrayBuffer(t.width,t.height,t.data.buffer);i._surfaces.set(t,r.fill(4278190080))}var n=i._surfaces.get(t);return i._poolMembers.set(n,e),n}),this._video.newFrame.addHandler(function(e){return i._videoProcessor.processSurface(i._surfacePool.get(i._poolMembers.get(e)))}),this._videoProcessor.emit.addHandler(function(e){return i.newFrame.dispatch(i._poolMembers.get(e.get()))})}return e.prototype.getWidth=function(){return this._video.getWidth()},e.prototype.getHeight=function(){return this._video.getHeight()},e}();i.default=u},{"../../tools/pool/InducedPool":75,"../../tools/pool/Pool":76,"../../video/processing/ProcessorPipeline":91,"../../video/surface/ArrayBufferSurface":95,"microevent.ts":5}],97:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./EmulationServiceInterface"),n=function(){function e(){this._drivers=new Map,this._driversBound=!1}return e.prototype.bind=function(t){return this._driversBound?this:(this._emulationService=t,this._shouldBindDrivers()&&this._bindDrivers(),this._emulationService.stateChanged.addHandler(e._onEmuStateChange,this),this)},e.prototype.unbind=function(){return this._emulationService?(this._unbindDrivers(),this._emulationService.stateChanged.removeHandler(e._onEmuStateChange,this),this._emulationService=null,this):this},e.prototype.addDriver=function(t,i){return this._drivers.set(t,new e.DriverContext(t,i)),this._driversBound&&i(this._emulationService.getEmulationContext(),t),this},e.prototype.removeDriver=function(e){return this._drivers.get(e)?(e.unbind(),this._drivers.delete(e),this):this},e._onEmuStateChange=function(e,t){t._shouldBindDrivers(e)?t._bindDrivers():t._unbindDrivers()},e.prototype._shouldBindDrivers=function(e){return void 0===e&&(e=this._emulationService?this._emulationService.getState():void 0),this._emulationService&&(e===r.default.State.running||e===r.default.State.paused)},e.prototype._bindDrivers=function(){var e=this;this._driversBound||(this._drivers.forEach(function(t){return t.binder(e._emulationService.getEmulationContext(),t.driver)}),this._driversBound=!0)},e.prototype._unbindDrivers=function(){this._driversBound&&(this._drivers.forEach(function(e){return e.driver.unbind()}),this._driversBound=!1)},e}();!function(e){var t=function(){return function(e,t){this.driver=e,this.binder=t}}();e.DriverContext=t}(n||(n={})),i.default=n},{"./EmulationServiceInterface":98}],98:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r;!function(e){!function(e){e[e.stopped=0]="stopped",e[e.running=1]="running",e[e.paused=2]="paused",e[e.error=3]="error"}(e.State||(e.State={}))}(r||(r={})),i.default=r},{}],99:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../../../driver/VideoEndpoint"),n=function(){function e(e,t){this._board=e,this._videoProcessing=t,this._videoEndpoint=null}return e.prototype.getVideo=function(){return this._videoEndpoint||(this._videoEndpoint=new r.default(this._board.getVideoOutput(),this._videoProcessing)),this._videoEndpoint},e.prototype.getJoystick=function(e){switch(e){case 0:return this._board.getJoystick0();case 1:return this._board.getJoystick1();default:throw new Error("invalid joystick index "+e)}},e.prototype.getControlPanel=function(){return this._board.getControlPanel()},e.prototype.getPaddle=function(e){if(e>=0&&e<4)return this._board.getPaddle(e);throw new Error("invalid paddle index "+e)},e.prototype.getAudio=function(){return this._board.getAudioOutput()},e.prototype.getRawVideo=function(){if(this._videoEndpoint)throw new Error("video endpoint already initialized; raw video unavailable");return this._board.getVideoOutput()},e}();i.default=n},{"../../../driver/VideoEndpoint":96}],100:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("microevent.ts"),n=e("../EmulationServiceInterface"),s=e("./EmulationContext"),a=e("../../../../machine/stella/Board"),o=e("../../../../machine/stella/cartridge/CartridgeFactory"),u=e("../../../../tools/scheduler/Factory"),c=e("../../../../tools/ClockProbe"),l=e("../../../../tools/scheduler/PeriodicScheduler"),h=e("async-mutex"),f=2e3,_=function(){function e(){this.stateChanged=new r.Event,this.emulationError=new r.Event,this._enforceRateLimit=!0,this._state=n.default.State.stopped,this._lastError=null,this._scheduler=null,this._clockProbe=new c.default(new l.default(f)),this._mutex=new h.Mutex,this._schedulerFactory=new u.default,this.frequencyUpdate=this._clockProbe.frequencyUpdate,this._updateScheduler()}return e.prototype.init=function(){return Promise.resolve()},e.prototype.start=function(t,i,r,u){var c=this,l=new o.default;return this._mutex.runExclusive(function(){try{if(c._stop(),c._state===n.default.State.error)return c._state;var o=l.createCartridge(t,r),h=new a.default(i,o);c._board=h,c._board.trap.addHandler(e._trapHandler,c),c._context=new s.default(h,u),c._clockProbe.attach(c._board.clock),c._setState(n.default.State.paused)}catch(e){c._setError(e)}return c._state})},e.prototype.stop=function(){var e=this;return this._mutex.runExclusive(function(){return e._stop()})},e.prototype.pause=function(){var e=this;return this._mutex.runExclusive(function(){try{e._state===n.default.State.running&&(e._board.getTimer().stop(),e._board.suspend(),e._setState(n.default.State.paused),e._clockProbe.stop())}catch(t){e._setError(t)}return e._state})},e.prototype.resume=function(){var e=this;return this._mutex.runExclusive(function(){if(e._state===n.default.State.paused)try{e._tryToResume()}catch(t){e._setError(t)}return e._state})},e.prototype.reset=function(){var e=this;return this._mutex.runExclusive(function(){try{switch(e._state){case n.default.State.running:case n.default.State.paused:e._board.reset();break;case n.default.State.error:e._board.reset(),e._tryToResume()}}catch(t){e._setError(t)}return e._state})},e.prototype.getState=function(){return this._state},e.prototype.getEmulationContext=function(){switch(this._state){case n.default.State.running:case n.default.State.paused:return this._context;default:return null}},e.prototype.getLastError=function(){return this._lastError},e.prototype.getFrequency=function(){return this._clockProbe.getFrequency()},e.prototype.getRateLimit=function(){return this._enforceRateLimit},e.prototype.setRateLimit=function(e){var t=this;return this._enforceRateLimit===e?Promise.resolve(void 0):this._mutex.runExclusive(function(){t._state===n.default.State.running&&t._board.getTimer().stop(),t._enforceRateLimit=e,t._updateScheduler(),t._state===n.default.State.running&&t._board.getTimer().start(t._scheduler)})},e._trapHandler=function(e,t){t._setError(new Error("TRAP: "+e.message)),t.emulationError.dispatch(t._lastError)},e.prototype._stop=function(){try{this._state===n.default.State.running&&(this._board.getTimer().stop(),this._board.suspend(),this._board.trap.removeHandler(e._trapHandler,this),this._clockProbe.stop().detach()),this._board=null,this._context=null,this._setState(n.default.State.stopped)}catch(e){this._setError(e)}return this._state},e.prototype._tryToResume=function(){this._state!==n.default.State.running&&(this._board.getTimer().start(this._scheduler),this._board.resume(),this._setState(n.default.State.running),this._clockProbe.start())},e.prototype._setError=function(e){this._lastError=e,this._setState(n.default.State.error)},e.prototype._setState=function(e){return e!==this._state&&(this._state=e,this.stateChanged.dispatch(e)),this._state},e.prototype._updateScheduler=function(){this._scheduler=this._enforceRateLimit?this._schedulerFactory.createLimitingScheduler():this._schedulerFactory.createImmediateScheduler()},e}();i.default=_},{"../../../../machine/stella/Board":26,"../../../../machine/stella/cartridge/CartridgeFactory":48,"../../../../tools/ClockProbe":72,"../../../../tools/scheduler/Factory":80,"../../../../tools/scheduler/PeriodicScheduler":82,"../EmulationServiceInterface":98,"./EmulationContext":99,"async-mutex":2,"microevent.ts":5}],101:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./messages"),n=function(){function e(e,t){this._index=e,this._rpc=t,this._audio=null,this._handlerContext=null,this._handlerContext={index:this._index,self:this}}return e.prototype.bind=function(t){this._audio||(this._audio=t,this._audio.bufferChanged.addHandler(e._onBufferChanged,this._handlerContext),this._audio.volumeChanged.addHandler(e._onVolumeChanged,this._handlerContext),this._audio.stop.addHandler(e._onStop,this._handlerContext))},e.prototype.unbind=function(){this._audio&&(this._audio.bufferChanged.removeHandler(e._onBufferChanged,this._handlerContext),this._audio.volumeChanged.removeHandler(e._onVolumeChanged,this._handlerContext),this._audio.stop.removeHandler(e._onStop,this._handlerContext),this._audio=null)},e._onBufferChanged=function(e,t){t.self._rpc.signal(r.SIGNAL_TYPE.audioBufferChange,{index:t.index,key:e})},e._onVolumeChanged=function(e,t){t.self._rpc.signal(r.SIGNAL_TYPE.audioVolumeChange,{index:t.index,value:e})},e._onStop=function(e,t){t.self._rpc.signal(r.SIGNAL_TYPE.audioStop,t.self._index)},e}();i.default=n},{"./messages":105}],102:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("./messages"),n=function(){function e(e){this._rpc=e,this._active=!1,this._emulationContext=null}return e.prototype.init=function(){this._rpc.registerSignalHandler(r.SIGNAL_TYPE.controlStateUpdate,this._onControlStateUpdate.bind(this))},e.prototype.bind=function(e){this._active||(this._active=!0,this._emulationContext=e)},e.prototype.unbind=function(){this._active&&(this._active=!1,this._emulationContext=null)},e.prototype._onControlStateUpdate=function(e){if(this._active){for(t=0;t<2;t++)this._applyJoystickState(e.joystickState[t],this._emulationContext.getJoystick(t));for(var t=0;t<4;t++)this._applyPaddleState(e.paddleState[t],this._emulationContext.getPaddle(t));this._applyControlPanelState(e.controlPanelState,this._emulationContext.getControlPanel())}},e.prototype._applyJoystickState=function(e,t){t.getUp().toggle(e.up),t.getDown().toggle(e.down),t.getLeft().toggle(e.left),t.getRight().toggle(e.right),t.getFire().toggle(e.fire)},e.prototype._applyPaddleState=function(e,t){t.setValue(e.value),t.getFire().toggle(e.fire)},e.prototype._applyControlPanelState=function(e,t){t.getDifficultySwitchP0().toggle(e.difficulty0),t.getDifficultySwitchP1().toggle(e.difficulty1),t.getResetButton().toggle(e.reset),t.getColorSwitch().toggle(e.color),t.getSelectSwitch().toggle(e.select)},e}();i.default=n},{"./messages":105}],103:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../vanilla/EmulationService"),n=e("../DriverManager"),s=e("./VideoDriver"),a=e("./ControlDriver"),o=e("./AudioDriver"),u=e("./messages"),c=function(){function e(e){this._rpc=e,this._videoDriver=null,this._service=new r.default}return e.prototype.startup=function(){this._rpc.registerRpcHandler(u.RPC_TYPE.setup,this._onSetup.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationFetchLastError,this._onFetchLastError.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationGetParameters,this._onEmulationGetParameters.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationPause,this._onEmulationPause.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationReset,this._onEmulationReset.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationResume,this._onEmulationResume.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationSetRateLimit,this._onEmulationSetRateLimit.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationStart,this._onEmulationStart.bind(this)).registerRpcHandler(u.RPC_TYPE.emulationStop,this._onEmulationStop.bind(this)),this._service.frequencyUpdate.addHandler(e._onFrequencyUpdate,this),this._service.emulationError.addHandler(e._onEmulationError,this);var t=new n.default,i=new s.default(this._rpc),r=new a.default(this._rpc),c=[new o.default(0,this._rpc),new o.default(1,this._rpc)];this._videoDriver=i,r.init(),t.addDriver(i,function(e,t){return t.bind(e.getRawVideo())}).addDriver(r,function(e,t){return t.bind(e)}).bind(this._service);for(var l=0;l<2;l++)!function(e){t.addDriver(c[e],function(t,i){return i.bind(0===e?t.getAudio().channel0:t.getAudio().channel1)})}(l)},e._onFrequencyUpdate=function(e,t){t._rpc.signal(u.SIGNAL_TYPE.emulationFrequencyUpdate,e)},e._onEmulationError=function(e,t){t._rpc.signal(u.SIGNAL_TYPE.emulationError,e?e.message:null)},e.prototype._onSetup=function(e){this._videoDriver.init(e.videoProcessorPort)},e.prototype._onFetchLastError=function(){var e=this._service.getLastError();return e?e.message:null},e.prototype._onEmulationPause=function(){return this._service.pause()},e.prototype._onEmulationReset=function(){return this._service.reset()},e.prototype._onEmulationResume=function(){return this._service.resume()},e.prototype._onEmulationStart=function(e){return this._videoDriver.setVideoProcessingConfig(e.videoProcessing),this._service.start(e.buffer,e.config,e.cartridgeType)},e.prototype._onEmulationStop=function(){return this._service.stop()},e.prototype._onEmulationSetRateLimit=function(e){return this._service.setRateLimit(e)},e.prototype._onEmulationGetParameters=function(){var e=this._service.getEmulationContext(),t=e.getAudio(),i=e&&e.getRawVideo();return Promise.resolve({width:i?i.getWidth():0,height:i?i.getHeight():0,volume:[t.channel0.getVolume(),t.channel1.getVolume()]})},e}();i.default=c},{"../DriverManager":97,"../vanilla/EmulationService":100,"./AudioDriver":101,"./ControlDriver":102,"./VideoDriver":104,"./messages":105}],104:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("async-mutex"),n=e("worker-rpc"),s=e("../../../../tools/pool/Pool"),a=e("../../../../video/surface/ArrayBufferSurface"),o=e("../../../../video/processing/worker/PipelineClient"),u=e("./messages"),c=function(){function e(e){this._rpc=e,this._active=!1,this._video=null,this._videoPipelineClient=null,this._mutex=new r.Mutex,this._videoProcessingConfig=null,this._bypassProcessingPipeline=!0,this._surfacePool=null,this._managedSurfacesById=null,this._ids=null,this._width=0,this._height=0,this._nextId=0}return e.prototype.init=function(t){this._rpc.registerSignalHandler(u.SIGNAL_TYPE.videoReturnSurface,this._onReturnSurfaceFromHost.bind(this));var i=new n.RpcProvider(function(e,i){return t.postMessage(e,i)});t.onmessage=function(e){return i.dispatch(e.data)},this._videoPipelineClient=new o.default(i),this._videoPipelineClient.emit.addHandler(e._onEmitFromPipeline,this)},e.prototype.setVideoProcessingConfig=function(e){this._videoProcessingConfig=e},e.prototype.bind=function(e){var t=this;this._mutex.runExclusive(function(){return t._bind(e)})},e.prototype.unbind=function(){var e=this;this._mutex.runExclusive(function(){return e._unbind()})},e._onEmitFromPipeline=function(e,t){if(t._active)if(t._ids.has(e)){var i=e.get().getUnderlyingBuffer(),r=t._ids.get(e);t._rpc.signal(u.SIGNAL_TYPE.videoNewFrame,{id:r,width:t._width,height:t._height,buffer:i},[i])}else console.warn("surface not registered");else console.warn("surface emmited from pipeline to inactive driver")},e._onNewFrame=function(t,i){i._active?i._managedSurfaces.has(t)?i._bypassProcessingPipeline?e._onEmitFromPipeline(i._managedSurfaces.get(t),i):i._videoPipelineClient.processSurface(i._managedSurfaces.get(t)):console.warn("surface not registered"):console.warn("new frame passed to inactive driver")},e.prototype._bind=function(t){var i=this;if(!this._active)return this._width=t.getWidth(),this._height=t.getHeight(),this._video=t,this._surfacePool=new s.default(function(){return a.default.createFromArrayBuffer(i._width,i._height,new ArrayBuffer(4*i._width*i._height))}),this._managedSurfacesById=new Map,this._managedSurfaces=new WeakMap,this._ids=new WeakMap,this._videoPipelineClient.configure(this._width,this._height,this._videoProcessingConfig).then(function(){i._video.setSurfaceFactory(function(){var e=i._surfacePool.get(),t=e.get();if(!i._ids.has(e)){var r=i._nextId++;i._ids.set(e,r),i._managedSurfacesById.set(r,e),i._managedSurfaces.set(t,e),t.fill(4278190080)}return e.get()}),i._video.newFrame.addHandler(e._onNewFrame,i),i._bypassProcessingPipeline=!i._videoProcessingConfig||0===i._videoProcessingConfig.length,i._active=!0})},e.prototype._unbind=function(){var t=this;if(this._active)return this._active=!1,this._video.setSurfaceFactory(null),this._video.newFrame.removeHandler(e._onNewFrame,this),this._videoPipelineClient.flush().then(function(){t._video=null,t._surfacePool=null,t._managedSurfacesById=null,t._ids=null})},e.prototype._onReturnSurfaceFromHost=function(e){if(this._active){var t=this._managedSurfacesById.get(e.id);t?(t.get().replaceUnderlyingBuffer(this._width,this._height,e.buffer),t.release()):console.warn("invalid member ID "+e.id)}else console.warn("surface returned from host to inactive driver")},e}();i.default=c},{"../../../../tools/pool/Pool":76,"../../../../video/processing/worker/PipelineClient":93,"../../../../video/surface/ArrayBufferSurface":95,"./messages":105,"async-mutex":2,"worker-rpc":18}],105:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.RPC_TYPE={emulationPause:"emulation/pause",emulationReset:"emulation/reset",emulationResume:"emulation/resume",emulationSetRateLimit:"emulation/setRateLimit",emulationStart:"emulation/start",emulationStop:"emulation/stop",emulationGetParameters:"emulation/getParameters",emulationFetchLastError:"emulation/fetchLastError",setup:"/setup"},Object.freeze(i.RPC_TYPE),i.SIGNAL_TYPE={emulationError:"emulation/error",emulationFrequencyUpdate:"emulation/frequencyUpdate",videoNewFrame:"video/newFrame",videoReturnSurface:"video/returnSurface",controlStateUpdate:"control/stateUpdate",audioVolumeChange:"audio/volumeChange",audioBufferChange:"audio/bufferChange",audioStop:"audio/stop"},Object.freeze(i.SIGNAL_TYPE)},{}],106:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("../rpc");new(e("../../../src/web/stella/service/worker/EmulationBackend").default)(r.getRpc()).startup()},{"../../../src/web/stella/service/worker/EmulationBackend":103,"../rpc":107}],107:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=e("worker-rpc"),n=null,s=null,a=null;(n=new r.RpcProvider(function(e,t){s?s.postMessage(e,t):postMessage(e,t),a&&((s=a).onmessage=function(e){return n.dispatch(e.data)}),a=null})).error.addHandler(function(e){console.log(e?e.message:"unknown rpc error")}),onmessage=function(e){return s||n.dispatch(e.data)},n.registerRpcHandler("/use-port",function(e){return s||a?Promise.reject("RPC already switched to message port"):(a=e,Promise.resolve())}),i.getRpc=function(){return n}},{"worker-rpc":18}]},{},[106]);