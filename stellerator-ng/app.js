!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function t(t,e,r,n){var i,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(a=(s<3?i(a):s>3?i(e,r,a):i(e,r))||a);return s>3&&a&&Object.defineProperty(e,r,a),a}function e(t,e){return function(r,n){e(r,n,t)}}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function n(t,e,r,n){return new(r||(r=Promise))((function(i,s){function a(t){try{u(n.next(t))}catch(t){s(t)}}function o(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))}function i(t,e){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}var s="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}var u=a,c=o;function h(t){if(u===setTimeout)return setTimeout(t,0);if((u===a||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}"function"==typeof s.setTimeout&&(u=setTimeout),"function"==typeof s.clearTimeout&&(c=clearTimeout);var l,f=[],d=!1,p=-1;function _(){d&&l&&(d=!1,l.length?f=l.concat(f):p=-1,f.length&&g())}function g(){if(!d){var t=h(_);d=!0;for(var e=f.length;e;){for(l=f,f=[];++p<e;)l&&l[p].run();p=-1,e=f.length}l=null,d=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function b(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];f.push(new v(t,e)),1!==f.length||d||h(g)}function v(t,e){this.fun=t,this.array=e}v.prototype.run=function(){this.fun.apply(null,this.array)};function m(){}var y=m,w=m,A=m,k=m,E=m,x=m,T=m;var C=s.performance||{},S=C.now||C.mozNow||C.msNow||C.oNow||C.webkitNow||function(){return(new Date).getTime()};var R=new Date;var I,B={nextTick:b,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:y,addListener:w,once:A,off:k,removeListener:E,removeAllListeners:x,emit:T,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*S.call(C),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-R)/1e3}},O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function P(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function M(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}
/*! *****************************************************************************
    Copyright (C) Microsoft. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */(null==e&&r.path)}},r.exports),r.exports}function D(t){return t&&t.default||t}!function(t){!function(e){var r="object"==typeof O?O:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(t);function i(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}void 0===r.Reflect?r.Reflect=t:n=i(r.Reflect,n),function(t){var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,o=!s&&!a,u={create:s?function(){return it(Object.create(null))}:a?function(){return it({__proto__:null})}:function(){return it({})},has:o?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:o?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),h="object"==typeof B&&B.env&&"true"===B.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?et():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?rt():Set,d=new(h||"function"!=typeof WeakMap?nt():WeakMap);function p(t,e,r,n){if(F(r)){if(!q(t))throw new TypeError;if(!V(e))throw new TypeError;return E(t,e)}if(!q(t))throw new TypeError;if(!N(e))throw new TypeError;if(!N(n)&&!F(n)&&!L(n))throw new TypeError;return L(n)&&(n=void 0),x(t,e,r=W(r),n)}function _(t,e){function r(r,n){if(!N(r))throw new TypeError;if(!F(n)&&!X(n))throw new TypeError;O(t,e,r,n)}return r}function g(t,e,r,n){if(!N(r))throw new TypeError;return F(n)||(n=W(n)),O(t,e,r,n)}function b(t,e,r){if(!N(e))throw new TypeError;return F(r)||(r=W(r)),C(t,e,r)}function v(t,e,r){if(!N(e))throw new TypeError;return F(r)||(r=W(r)),S(t,e,r)}function m(t,e,r){if(!N(e))throw new TypeError;return F(r)||(r=W(r)),R(t,e,r)}function y(t,e,r){if(!N(e))throw new TypeError;return F(r)||(r=W(r)),I(t,e,r)}function w(t,e){if(!N(t))throw new TypeError;return F(e)||(e=W(e)),P(t,e)}function A(t,e){if(!N(t))throw new TypeError;return F(e)||(e=W(e)),M(t,e)}function k(t,e,r){if(!N(e))throw new TypeError;F(r)||(r=W(r));var n=T(e,r,!1);if(F(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var i=d.get(e);return i.delete(r),i.size>0||d.delete(e),!0}function E(t,e){for(var r=t.length-1;r>=0;--r){var n=(0,t[r])(e);if(!F(n)&&!L(n)){if(!V(n))throw new TypeError;e=n}}return e}function x(t,e,r,n){for(var i=t.length-1;i>=0;--i){var s=(0,t[i])(e,r,n);if(!F(s)&&!L(s)){if(!N(s))throw new TypeError;n=s}}return n}function T(t,e,r){var n=d.get(t);if(F(n)){if(!r)return;n=new l,d.set(t,n)}var i=n.get(e);if(F(i)){if(!r)return;i=new l,n.set(e,i)}return i}function C(t,e,r){if(S(t,e,r))return!0;var n=tt(e);return!L(n)&&C(t,n,r)}function S(t,e,r){var n=T(e,r,!1);return!F(n)&&$(n.has(t))}function R(t,e,r){if(S(t,e,r))return I(t,e,r);var n=tt(e);return L(n)?void 0:R(t,n,r)}function I(t,e,r){var n=T(e,r,!1);if(!F(n))return n.get(t)}function O(t,e,r,n){T(r,n,!0).set(t,e)}function P(t,e){var r=M(t,e),n=tt(t);if(null===n)return r;var i=P(n,e);if(i.length<=0)return r;if(r.length<=0)return i;for(var s=new f,a=[],o=0,u=r;o<u.length;o++){var c=u[o];s.has(c)||(s.add(c),a.push(c))}for(var h=0,l=i;h<l.length;h++){c=l[h];s.has(c)||(s.add(c),a.push(c))}return a}function M(t,e){var r=[],n=T(t,e,!1);if(F(n))return r;for(var i=Y(n.keys()),s=0;;){var a=Q(i);if(!a)return r.length=s,r;var o=J(a);try{r[s]=o}catch(t){try{Z(i)}finally{throw t}}s++}}function D(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function F(t){return void 0===t}function L(t){return null===t}function j(t){return"symbol"==typeof t}function N(t){return"object"==typeof t?null!==t:"function"==typeof t}function U(t,e){switch(D(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",i=K(t,n);if(void 0!==i){var s=i.call(t,r);if(N(s))throw new TypeError;return s}return z(t,"default"===r?"number":r)}function z(t,e){if("string"===e){var r=t.toString;if(G(r))if(!N(i=r.call(t)))return i;if(G(n=t.valueOf))if(!N(i=n.call(t)))return i}else{var n;if(G(n=t.valueOf))if(!N(i=n.call(t)))return i;var i,s=t.toString;if(G(s))if(!N(i=s.call(t)))return i}throw new TypeError}function $(t){return!!t}function H(t){return""+t}function W(t){var e=U(t,3);return j(e)?e:H(e)}function q(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function G(t){return"function"==typeof t}function V(t){return"function"==typeof t}function X(t){switch(D(t)){case 3:case 4:return!0;default:return!1}}function K(t,e){var r=t[e];if(null!=r){if(!G(r))throw new TypeError;return r}}function Y(t){var e=K(t,i);if(!G(e))throw new TypeError;var r=e.call(t);if(!N(r))throw new TypeError;return r}function J(t){return t.value}function Q(t){var e=t.next();return!e.done&&e}function Z(t){var e=t.return;e&&e.call(t)}function tt(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c)return e;if(e!==c)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var i=n.constructor;return"function"!=typeof i||i===t?e:i}function et(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[i]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,n)},e.prototype.values=function(){return new r(this._keys,this._values,s)},e.prototype.entries=function(){return new r(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[i]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function n(t,e){return t}function s(t,e){return e}function a(t,e){return[t,e]}}function rt(){return function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[i]=function(){return this.keys()},t}()}function nt(){var t=16,r=u.create(),n=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=s(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=s(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){return s(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=s(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+c()}while(u.has(r,t));return r[t]=!0,t}function s(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:u.create()})}return t[n]}function a(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function o(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t)}function c(){var e=o(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",n=0;n<t;++n){var i=e[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function it(t){return t.__=void 0,delete t.__,t}t("decorate",p),t("metadata",_),t("defineMetadata",g),t("hasMetadata",b),t("hasOwnMetadata",v),t("getMetadata",m),t("getOwnMetadata",y),t("getMetadataKeys",w),t("getOwnMetadataKeys",A),t("deleteMetadata",k)}(n)}()}(I||(I={}));let F={};(function(){!function(t){function e(t,e,r){return r.a=t,r.f=e,r}function r(t){return e(2,t,(function(e){return function(r){return t(e,r)}}))}function n(t){return e(3,t,(function(e){return function(r){return function(n){return t(e,r,n)}}}))}function i(t){return e(4,t,(function(e){return function(r){return function(n){return function(i){return t(e,r,n,i)}}}}))}function s(t){return e(5,t,(function(e){return function(r){return function(n){return function(i){return function(s){return t(e,r,n,i,s)}}}}}))}function a(t){return e(6,t,(function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return t(e,r,n,i,s,a)}}}}}}))}function o(t){return e(7,t,(function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return function(o){return t(e,r,n,i,s,a,o)}}}}}}}))}function u(t){return e(8,t,(function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return function(o){return function(u){return t(e,r,n,i,s,a,o,u)}}}}}}}}))}function c(t){return e(9,t,(function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return function(o){return function(u){return function(c){return t(e,r,n,i,s,a,o,u,c)}}}}}}}}}))}function h(t,e,r){return 2===t.a?t.f(e,r):t(e)(r)}function l(t,e,r,n){return 3===t.a?t.f(e,r,n):t(e)(r)(n)}function f(t,e,r,n,i){return 4===t.a?t.f(e,r,n,i):t(e)(r)(n)(i)}function d(t,e,r,n,i,s){return 5===t.a?t.f(e,r,n,i,s):t(e)(r)(n)(i)(s)}function p(t,e,r,n,i,s,a){return 6===t.a?t.f(e,r,n,i,s,a):t(e)(r)(n)(i)(s)(a)}function _(t,e,r,n,i,s,a,o){return 7===t.a?t.f(e,r,n,i,s,a,o):t(e)(r)(n)(i)(s)(a)(o)}function g(t,e){for(var r,n=[],i=b(t,e,0,n);i&&(r=n.pop());i=b(r.a,r.b,0,n));return i}function b(t,e,r,n){if(t===e)return!0;if("object"!=typeof t||null===t||null===e)return"function"==typeof t&&D(5),!1;if(r>100)return n.push(w(t,e)),!0;for(var i in t.$<0&&(t=yr(t),e=yr(e)),t)if(!b(t[i],e[i],r+1,n))return!1;return!0}var v=r(g);r((function(t,e){return!g(t,e)}));function m(t,e,r){if("object"!=typeof t)return t===e?0:t<e?-1:1;if(void 0===t.$)return(r=m(t.a,e.a))||(r=m(t.b,e.b))?r:m(t.c,e.c);for(;t.b&&e.b&&!(r=m(t.a,e.a));t=t.b,e=e.b);return r||(t.b?1:e.b?-1:0)}r((function(t,e){return m(t,e)<0})),r((function(t,e){return m(t,e)<1})),r((function(t,e){return m(t,e)>0})),r((function(t,e){return m(t,e)>=0}));var y=r((function(t,e){var r=m(t,e);return r<0?br:r?gr:_r}));function w(t,e){return{a:t,b:e}}function A(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r}var k=r(E);function E(t,e){if("string"==typeof t)return t+e;if(!t.b)return e;var r=T(t.a,e);t=t.b;for(var n=r;t.b;t=t.b)n=n.b=T(t.a,e);return r}var x={$:0};function T(t,e){return{$:1,a:t,b:e}}var C=r(T);function S(t){for(var e=x,r=t.length;r--;)e=T(t[r],e);return e}function R(t){for(var e=[];t.b;t=t.b)e.push(t.a);return e}var I=n((function(t,e,r){for(var n=[];e.b&&r.b;e=e.b,r=r.b)n.push(h(t,e.a,r.a));return S(n)})),B=(i((function(t,e,r,n){for(var i=[];e.b&&r.b&&n.b;e=e.b,r=r.b,n=n.b)i.push(l(t,e.a,r.a,n.a));return S(i)})),s((function(t,e,r,n,i){for(var s=[];e.b&&r.b&&n.b&&i.b;e=e.b,r=r.b,n=n.b,i=i.b)s.push(f(t,e.a,r.a,n.a,i.a));return S(s)})),a((function(t,e,r,n,i,s){for(var a=[];e.b&&r.b&&n.b&&i.b&&s.b;e=e.b,r=r.b,n=n.b,i=i.b,s=s.b)a.push(d(t,e.a,r.a,n.a,i.a,s.a));return S(a)})),r((function(t,e){return S(R(e).sort((function(e,r){return m(t(e),t(r))})))})));r((function(t,e){return S(R(e).sort((function(e,r){var n=h(t,e,r);return n===_r?0:n===br?-1:1})))}));var O=n((function(t,e,r){for(var n=new Array(t),i=0;i<t;i++)n[i]=r(e+i);return n})),P=r((function(t,e){for(var r=new Array(t),n=0;n<t&&e.b;n++)r[n]=e.a,e=e.b;return r.length=n,w(r,e)})),M=(r((function(t,e){return e[t]})),n((function(t,e,r){for(var n=r.length,i=new Array(n),s=0;s<n;s++)i[s]=r[s];return i[t]=e,i})),r((function(t,e){for(var r=e.length,n=new Array(r+1),i=0;i<r;i++)n[i]=e[i];return n[r]=t,n})),n((function(t,e,r){for(var n=r.length,i=0;i<n;i++)e=h(t,r[i],e);return e})),n((function(t,e,r){for(var n=r.length-1;n>=0;n--)e=h(t,r[n],e);return e})));r((function(t,e){for(var r=e.length,n=new Array(r),i=0;i<r;i++)n[i]=t(e[i]);return n})),n((function(t,e,r){for(var n=r.length,i=new Array(n),s=0;s<n;s++)i[s]=h(t,e+s,r[s]);return i})),n((function(t,e,r){return r.slice(t,e)})),n((function(t,e,r){var n=e.length,i=t-n;i>r.length&&(i=r.length);for(var s=new Array(n+i),a=0;a<n;a++)s[a]=e[a];for(a=0;a<i;a++)s[a+n]=r[a];return s})),r((function(t,e){return e})),r((function(t,e){return console.log(t+": <internals>"),e}));function D(t){throw new Error("https://github.com/elm/core/blob/1.0.0/hints/"+t+".md")}r((function(t,e){return t+e})),r((function(t,e){return t-e})),r((function(t,e){return t*e})),r((function(t,e){return t/e})),r((function(t,e){return t/e|0})),r(Math.pow),r((function(t,e){return e%t}));var F=r((function(t,e){var r=e%t;return 0===t?D(11):r>0&&t<0||r<0&&t>0?r+t:r}));r(Math.atan2);var L=Math.ceil,j=Math.floor,N=Math.round,U=Math.log,z=isNaN;r((function(t,e){return t&&e})),r((function(t,e){return t||e})),r((function(t,e){return t!==e}));var $=r((function(t,e){return t+e}));var H=r((function(t,e){return t+e}));r((function(t,e){for(var r=e.length,n=new Array(r),i=0;i<r;){var s=e.charCodeAt(i);55296<=s&&s<=56319?(n[i]=t(e[i]+e[i+1]),i+=2):(n[i]=t(e[i]),i++)}return n.join("")}));var W=r((function(t,e){for(var r=[],n=e.length,i=0;i<n;){var s=e[i],a=e.charCodeAt(i);i++,55296<=a&&a<=56319&&(s+=e[i],i++),t(s)&&r.push(s)}return r.join("")}));var q=n((function(t,e,r){for(var n=r.length,i=0;i<n;){var s=r[i],a=r.charCodeAt(i);i++,55296<=a&&a<=56319&&(s+=r[i],i++),e=h(t,s,e)}return e})),G=n((function(t,e,r){for(var n=r.length;n--;){var i=r[n],s=r.charCodeAt(n);56320<=s&&s<=57343&&(i=r[--n]+i),e=h(t,i,e)}return e})),V=r((function(t,e){return e.split(t)})),X=r((function(t,e){return e.join(t)})),K=n((function(t,e,r){return r.slice(t,e)}));r((function(t,e){for(var r=e.length;r--;){var n=e[r],i=e.charCodeAt(r);if(56320<=i&&i<=57343&&(n=e[--r]+n),t(n))return!0}return!1}));var Y=r((function(t,e){for(var r=e.length;r--;){var n=e[r],i=e.charCodeAt(r);if(56320<=i&&i<=57343&&(n=e[--r]+n),!t(n))return!1}return!0})),J=r((function(t,e){return e.indexOf(t)>-1})),Q=r((function(t,e){return 0===e.indexOf(t)})),Z=r((function(t,e){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length})),tt=r((function(t,e){var r=t.length;if(r<1)return x;for(var n=0,i=[];(n=e.indexOf(t,n))>-1;)i.push(n),n+=r;return S(i)}));function et(t){return t+""}function rt(t){return{$:2,b:t}}var nt=rt((function(t){return"number"!=typeof t?vt("an INT",t):-2147483647<t&&t<2147483647&&(0|t)===t?Tr(t):!isFinite(t)||t%1?vt("an INT",t):Tr(t)})),it=rt((function(t){return"boolean"==typeof t?Tr(t):vt("a BOOL",t)})),st=rt((function(t){return"number"==typeof t?Tr(t):vt("a FLOAT",t)})),at=rt((function(t){return Tr(t)})),ot=rt((function(t){return"string"==typeof t?Tr(t):t instanceof String?Tr(t+""):vt("a STRING",t)}));var ut=r((function(t,e){return{$:6,d:t,b:e}}));r((function(t,e){return{$:7,e:t,b:e}}));function ct(t,e){return{$:9,f:t,g:e}}var ht=r((function(t,e){return{$:10,b:e,h:t}}));var lt=r((function(t,e){return ct(t,[e])})),ft=n((function(t,e,r){return ct(t,[e,r])})),dt=(i((function(t,e,r,n){return ct(t,[e,r,n])})),s((function(t,e,r,n,i){return ct(t,[e,r,n,i])})),a((function(t,e,r,n,i,s){return ct(t,[e,r,n,i,s])})),o((function(t,e,r,n,i,s,a){return ct(t,[e,r,n,i,s,a])})),u((function(t,e,r,n,i,s,a,o){return ct(t,[e,r,n,i,s,a,o])})),c((function(t,e,r,n,i,s,a,o,u){return ct(t,[e,r,n,i,s,a,o,u])})),r((function(t,e){try{return pt(t,JSON.parse(e))}catch(t){return Ar(h(kr,"This is not valid JSON! "+t.message,e))}})),r((function(t,e){return pt(t,e)})));function pt(t,e){switch(t.$){case 2:return t.b(e);case 5:return null===e?Tr(t.c):vt("null",e);case 3:return gt(e)?_t(t.b,e,S):vt("a LIST",e);case 4:return gt(e)?_t(t.b,e,bt):vt("an ARRAY",e);case 6:var r=t.d;if("object"!=typeof e||null===e||!(r in e))return vt("an OBJECT with a field named `"+r+"`",e);var n=pt(t.b,e[r]);return An(n)?n:Ar(h(Er,r,n.a));case 7:var i=t.e;if(!gt(e))return vt("an ARRAY",e);if(i>=e.length)return vt("a LONGER array. Need index "+i+" but only see "+e.length+" entries",e);n=pt(t.b,e[i]);return An(n)?n:Ar(h(xr,i,n.a));case 8:if("object"!=typeof e||null===e||gt(e))return vt("an OBJECT",e);var s=x;for(var a in e)if(e.hasOwnProperty(a)){n=pt(t.b,e[a]);if(!An(n))return Ar(h(Er,a,n.a));s=T(w(a,n.a),s)}return Tr(Kr(s));case 9:for(var o=t.f,u=t.g,c=0;c<u.length;c++){n=pt(u[c],e);if(!An(n))return n;o=o(n.a)}return Tr(o);case 10:n=pt(t.b,e);return An(n)?pt(t.h(n.a),e):n;case 11:for(var l=x,f=t.g;f.b;f=f.b){n=pt(f.a,e);if(An(n))return n;l=T(n.a,l)}return Ar(Cr(Kr(l)));case 1:return Ar(h(kr,t.a,e));case 0:return Tr(t.a)}}function _t(t,e,r){for(var n=e.length,i=new Array(n),s=0;s<n;s++){var a=pt(t,e[s]);if(!An(a))return Ar(h(xr,s,a.a));i[s]=a.a}return Tr(r(i))}function gt(t){return Array.isArray(t)||"undefined"!=typeof FileList&&t instanceof FileList}function bt(t){return h(wn,t.length,(function(e){return t[e]}))}function vt(t,e){return Ar(h(kr,"Expecting "+t,e))}function mt(t,e){if(t===e)return!0;if(t.$!==e.$)return!1;switch(t.$){case 0:case 1:return t.a===e.a;case 2:return t.b===e.b;case 5:return t.c===e.c;case 3:case 4:case 8:return mt(t.b,e.b);case 6:return t.d===e.d&&mt(t.b,e.b);case 7:return t.e===e.e&&mt(t.b,e.b);case 9:return t.f===e.f&&yt(t.g,e.g);case 10:return t.h===e.h&&mt(t.b,e.b);case 11:return yt(t.g,e.g)}}function yt(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(!mt(t[n],e[n]))return!1;return!0}var wt=r((function(t,e){return JSON.stringify(e,null,t)+""}));function At(t){return t}var kt=n((function(t,e,r){return r[t]=e,r}));function Et(t){return{$:0,a:t}}function xt(t){return{$:2,b:t,c:null}}var Tt=r((function(t,e){return{$:3,b:t,d:e}}));r((function(t,e){return{$:4,b:t,d:e}}));var Ct=0;function St(t){var e={$:0,e:Ct++,f:t,g:null,h:[]};return Mt(e),e}function Rt(t){return xt((function(e){e(Et(St(t)))}))}function It(t,e){t.h.push(e),Mt(t)}var Bt=r((function(t,e){return xt((function(r){It(t,e),r(Et(0))}))}));var Ot=!1,Pt=[];function Mt(t){if(Pt.push(t),!Ot){for(Ot=!0;t=Pt.shift();)Dt(t);Ot=!1}}function Dt(t){for(;t.f;){var e=t.f.$;if(0===e||1===e){for(;t.g&&t.g.$!==e;)t.g=t.g.i;if(!t.g)return;t.f=t.g.b(t.f.a),t.g=t.g.i}else{if(2===e)return void(t.f.c=t.f.b((function(e){t.f=e,Mt(t)})));if(5===e){if(0===t.h.length)return;t.f=t.f.b(t.h.shift())}else t.g={$:3===e?0:1,b:t.f.b,i:t.g},t.f=t.f.d}}}i((function(t,e,r,n){return Ft(e,n,t.dl,t.ec,t.d4,(function(){return function(){}}))}));function Ft(t,e,r,n,i,s){var a=h(dt,t,e?e.flags:void 0);An(a)||D(2);var o={},u=(a=r(a.a)).a,c=s(f,u),l=function(t,e){var r;for(var n in Lt){var i=Lt[n];i.a&&((r=r||{})[n]=i.a(n,e)),t[n]=Nt(i,e)}return r}(o,f);function f(t,e){a=h(n,t,u),c(u=a.a,e),Gt(o,a.b,i(u))}return Gt(o,a.b,i(u)),l?{ports:l}:{}}var Lt={};function jt(t,e,r,n,i){return{b:t,c:e,d:r,e:n,f:i}}function Nt(t,e){var r={g:e,h:void 0},n=t.c,i=t.d,s=t.e,a=t.f;return r.h=St(h(Tt,(function t(e){return h(Tt,t,{$:5,b:function(t){var o=t.a;return 0===t.$?l(i,r,o,e):s&&a?f(n,r,o.i,o.j,e):l(n,r,s?o.i:o.j,e)}})}),t.b))}var Ut=r((function(t,e){return xt((function(r){t.g(e),r(Et(0))}))})),zt=r((function(t,e){return h(Bt,t.h,{$:0,a:e})}));function $t(t){return function(e){return{$:1,k:t,l:e}}}function Ht(t){return{$:2,m:t}}r((function(t,e){return{$:3,n:t,o:e}}));var Wt=[],qt=!1;function Gt(t,e,r){if(Wt.push({p:t,q:e,r:r}),!qt){qt=!0;for(var n;n=Wt.shift();)Vt(n.p,n.q,n.r);qt=!1}}function Vt(t,e,r){var n={};for(var i in Xt(!0,e,n,null),Xt(!1,r,n,null),t)It(t[i],{$:"fx",a:n[i]||{i:x,j:x}})}function Xt(t,e,r,n){switch(e.$){case 1:var i=e.k,s=function(t,e,r,n){function i(t){for(var e=r;e;e=e.t)t=e.s(t);return t}return h(t?Lt[e].e:Lt[e].f,i,n)}(t,i,n,e.l);return void(r[i]=function(t,e,r){return r=r||{i:x,j:x},t?r.i=T(e,r.i):r.j=T(e,r.j),r}(t,s,r[i]));case 2:for(var a=e.m;a.b;a=a.b)Xt(t,a.a,r,n);return;case 3:return void Xt(t,e.o,r,{s:e.n,t:n})}}function Kt(t){Lt[t]&&D(3)}function Yt(t,e){return Kt(t),Lt[t]={e:Jt,u:e,a:Qt},$t(t)}var Jt=r((function(t,e){return e}));function Qt(t){var e,r=[],i=Lt[t].u,s=(e=0,xt((function(t){var r=setTimeout((function(){t(Et(0))}),e);return function(){clearTimeout(r)}})));return Lt[t].b=s,Lt[t].c=n((function(t,e,n){for(;e.b;e=e.b)for(var a=r,o=i(e.a),u=0;u<a.length;u++)a[u](o);return s})),{subscribe:function(t){r.push(t)},unsubscribe:function(t){var e=(r=r.slice()).indexOf(t);e>=0&&r.splice(e,1)}}}function Zt(t,e){return Kt(t),Lt[t]={f:ee,u:e,a:re},$t(t)}var te,ee=r((function(t,e){return function(r){return t(e(r))}}));function re(t,e){var r=x,i=Lt[t].u,s=Et(null);return Lt[t].b=s,Lt[t].c=n((function(t,e,n){return r=e,s})),{send:function(t){var n=h(dt,i,t);An(n)||D(4,n.a);for(var s=n.a,a=r;a.b;a=a.b)e(a.a(s))}}}function ne(t,e){for(var r in e)r in t?"init"==r?D(6):ne(t[r],e[r]):t[r]=e[r]}var ie="undefined"!=typeof document?document:{};function se(t,e){t.appendChild(e)}i((function(t,e,r,n){var i=n.node;return i.parentNode.replaceChild(Ee(t,(function(){})),i),{}}));function ae(t){return{$:0,a:t}}var oe=r((function(t,e){return r((function(r,n){for(var i=[],s=0;n.b;n=n.b){var a=n.a;s+=a.b||0,i.push(a)}return s+=i.length,{$:1,c:e,d:Ae(r),e:i,f:t,b:s}}))})),ue=oe(void 0),ce=r((function(t,e){return r((function(r,n){for(var i=[],s=0;n.b;n=n.b){var a=n.a;s+=a.b.b||0,i.push(a)}return s+=i.length,{$:2,c:e,d:Ae(r),e:i,f:t,b:s}}))})),he=ce(void 0);r((function(t,e){return{$:4,j:t,k:e,b:1+(e.b||0)}}));function le(t,e){return{$:5,l:t,m:e,k:void 0}}r((function(t,e){return le([t,e],(function(){return t(e)}))}));var fe=n((function(t,e,r){return le([t,e,r],(function(){return h(t,e,r)}))})),de=i((function(t,e,r,n){return le([t,e,r,n],(function(){return l(t,e,r,n)}))})),pe=(s((function(t,e,r,n,i){return le([t,e,r,n,i],(function(){return f(t,e,r,n,i)}))})),a((function(t,e,r,n,i,s){return le([t,e,r,n,i,s],(function(){return d(t,e,r,n,i,s)}))})),o((function(t,e,r,n,i,s,a){return le([t,e,r,n,i,s,a],(function(){return p(t,e,r,n,i,s,a)}))})),u((function(t,e,r,n,i,s,a,o){return le([t,e,r,n,i,s,a,o],(function(){return _(t,e,r,n,i,s,a,o)}))})),c((function(t,e,r,n,i,s,a,o,u){return le([t,e,r,n,i,s,a,o,u],(function(){return function(t,e,r,n,i,s,a,o,u){return 8===t.a?t.f(e,r,n,i,s,a,o,u):t(e)(r)(n)(i)(s)(a)(o)(u)}(t,e,r,n,i,s,a,o,u)}))})),r((function(t,e){return{$:"a0",n:t,o:e}}))),_e=(r((function(t,e){return{$:"a1",n:t,o:e}})),r((function(t,e){return{$:"a2",n:t,o:e}}))),ge=r((function(t,e){return{$:"a3",n:t,o:e}}));n((function(t,e,r){return{$:"a4",n:e,o:{f:t,o:r}}}));function be(t){return"script"==t?"p":t}function ve(t){return/^\s*(javascript:|data:text\/html)/i.test(t)?"":t}r((function(t,e){return"a0"===e.$?h(pe,e.n,function(t,e){var r=Tn(e);return{$:e.$,a:r?l(En,r<3?ye:we,xn(t),e.a):h(kn,t,e.a)}}(t,e.o)):e}));var me,ye=r((function(t,e){return w(t(e.a),e.b)})),we=r((function(t,e){return{dt:t(e.dt),d2:e.d2,dO:e.dO}}));function Ae(t){for(var e={};t.b;t=t.b){var r=t.a,n=r.$,i=r.n,s=r.o;if("a2"!==n){var a=e[n]||(e[n]={});"a3"===n&&"class"===i?ke(a,i,s):a[i]=s}else"className"===i?ke(e,i,s):e[i]=s}return e}function ke(t,e,r){var n=t[e];t[e]=n?n+" "+r:r}function Ee(t,e){var r=t.$;if(5===r)return Ee(t.k||(t.k=t.m()),e);if(0===r)return ie.createTextNode(t.a);if(4===r){for(var n=t.k,i=t.j;4===n.$;)"object"!=typeof i?i=[i,n.j]:i.push(n.j),n=n.k;var s={j:i,p:e};return(a=Ee(n,s)).elm_event_node_ref=s,a}if(3===r)return xe(a=t.h(t.g),e,t.d),a;var a=t.f?ie.createElementNS(t.f,t.c):ie.createElement(t.c);te&&"a"==t.c&&a.addEventListener("click",te(a)),xe(a,e,t.d);for(var o=t.e,u=0;u<o.length;u++)se(a,Ee(1===r?o[u]:o[u].b,e));return a}function xe(t,e,r){for(var n in r){var i=r[n];"a1"===n?Te(t,i):"a0"===n?Re(t,e,i):"a3"===n?Ce(t,i):"a4"===n?Se(t,i):("value"!==n&&"checked"!==n||t[n]!==i)&&(t[n]=i)}}function Te(t,e){var r=t.style;for(var n in e)r[n]=e[n]}function Ce(t,e){for(var r in e){var n=e[r];void 0!==n?t.setAttribute(r,n):t.removeAttribute(r)}}function Se(t,e){for(var r in e){var n=e[r],i=n.f,s=n.o;void 0!==s?t.setAttributeNS(i,r,s):t.removeAttributeNS(i,r)}}function Re(t,e,r){var n=t.elmFs||(t.elmFs={});for(var i in r){var s=r[i],a=n[i];if(s){if(a){if(a.q.$===s.$){a.q=s;continue}t.removeEventListener(i,a)}a=Ie(e,s),t.addEventListener(i,a,me&&{passive:Tn(s)<2}),n[i]=a}else t.removeEventListener(i,a),n[i]=void 0}}try{window.addEventListener("t",null,Object.defineProperty({},"passive",{get:function(){me=!0}}))}catch(t){}function Ie(t,e){function r(e){var n=r.q,i=pt(n.a,e);if(An(i)){for(var s,a=Tn(n),o=i.a,u=a?a<3?o.a:o.dt:o,c=1==a?o.b:3==a&&o.d2,h=(c&&e.stopPropagation(),(2==a?o.b:3==a&&o.dO)&&e.preventDefault(),t);s=h.j;){if("function"==typeof s)u=s(u);else for(var l=s.length;l--;)u=s[l](u);h=h.p}h(u,c)}}return r.q=e,r}function Be(t,e){return t.$==e.$&&mt(t.a,e.a)}function Oe(t,e){var r=[];return Me(t,e,r,0),r}function Pe(t,e,r,n){var i={$:e,r:r,s:n,t:void 0,u:void 0};return t.push(i),i}function Me(t,e,r,n){if(t!==e){var i=t.$,s=e.$;if(i!==s){if(1!==i||2!==s)return void Pe(r,0,n,e);e=function(t){for(var e=t.e,r=e.length,n=new Array(r),i=0;i<r;i++)n[i]=e[i].b;return{$:1,c:t.c,d:t.d,e:n,f:t.f,b:t.b}}(e),s=1}switch(s){case 5:for(var a=t.l,o=e.l,u=a.length,c=u===o.length;c&&u--;)c=a[u]===o[u];if(c)return void(e.k=t.k);e.k=e.m();var h=[];return Me(t.k,e.k,h,0),void(h.length>0&&Pe(r,1,n,h));case 4:for(var l=t.j,f=e.j,d=!1,p=t.k;4===p.$;)d=!0,"object"!=typeof l?l=[l,p.j]:l.push(p.j),p=p.k;for(var _=e.k;4===_.$;)d=!0,"object"!=typeof f?f=[f,_.j]:f.push(_.j),_=_.k;return d&&l.length!==f.length?void Pe(r,0,n,e):((d?function(t,e){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(l,f):l===f)||Pe(r,2,n,f),void Me(p,_,r,n+1));case 0:return void(t.a!==e.a&&Pe(r,3,n,e.a));case 1:return void De(t,e,r,n,Le);case 2:return void De(t,e,r,n,je);case 3:if(t.h!==e.h)return void Pe(r,0,n,e);var g=Fe(t.d,e.d);g&&Pe(r,4,n,g);var b=e.i(t.g,e.g);return void(b&&Pe(r,5,n,b))}}}function De(t,e,r,n,i){if(t.c===e.c&&t.f===e.f){var s=Fe(t.d,e.d);s&&Pe(r,4,n,s),i(t,e,r,n)}else Pe(r,0,n,e)}function Fe(t,e,r){var n;for(var i in t)if("a1"!==i&&"a0"!==i&&"a3"!==i&&"a4"!==i)if(i in e){var s=t[i],a=e[i];s===a&&"value"!==i&&"checked"!==i||"a0"===r&&Be(s,a)||((n=n||{})[i]=a)}else(n=n||{})[i]=r?"a1"===r?"":"a0"===r||"a3"===r?void 0:{f:t[i].f,o:void 0}:"string"==typeof t[i]?"":null;else{var o=Fe(t[i],e[i]||{},i);o&&((n=n||{})[i]=o)}for(var u in e)u in t||((n=n||{})[u]=e[u]);return n}function Le(t,e,r,n){var i=t.e,s=e.e,a=i.length,o=s.length;a>o?Pe(r,6,n,{v:o,i:a-o}):a<o&&Pe(r,7,n,{v:a,e:s});for(var u=a<o?a:o,c=0;c<u;c++){var h=i[c];Me(h,s[c],r,++n),n+=h.b||0}}function je(t,e,r,n){for(var i=[],s={},a=[],o=t.e,u=e.e,c=o.length,h=u.length,l=0,f=0,d=n;l<c&&f<h;){var p=o[l],_=u[f],g=p.a,b=_.a,v=p.b,m=_.b,y=void 0,w=void 0;if(g!==b){var A=o[l+1],k=u[f+1];if(A){var E=A.a,x=A.b;w=b===E}if(k){var T=k.a,C=k.b;y=g===T}if(y&&w)Me(v,C,i,++d),Ue(s,i,g,m,f,a),d+=v.b||0,ze(s,i,g,x,++d),d+=x.b||0,l+=2,f+=2;else if(y)d++,Ue(s,i,b,m,f,a),Me(v,C,i,d),d+=v.b||0,l+=1,f+=2;else if(w)ze(s,i,g,v,++d),d+=v.b||0,Me(x,m,i,++d),d+=x.b||0,l+=2,f+=1;else{if(!A||E!==T)break;ze(s,i,g,v,++d),Ue(s,i,b,m,f,a),d+=v.b||0,Me(x,C,i,++d),d+=x.b||0,l+=2,f+=2}}else Me(v,m,i,++d),d+=v.b||0,l++,f++}for(;l<c;){d++;v=(p=o[l]).b;ze(s,i,p.a,v,d),d+=v.b||0,l++}for(;f<h;){var S=S||[];Ue(s,i,(_=u[f]).a,_.b,void 0,S),f++}(i.length>0||a.length>0||S)&&Pe(r,8,n,{w:i,x:a,y:S})}var Ne="_elmW6BL";function Ue(t,e,r,n,i,s){var a=t[r];if(!a)return a={c:0,z:n,r:i,s:void 0},s.push({r:i,A:a}),void(t[r]=a);if(1===a.c){s.push({r:i,A:a}),a.c=2;var o=[];return Me(a.z,n,o,a.r),a.r=i,void(a.s.s={w:o,A:a})}Ue(t,e,r+Ne,n,i,s)}function ze(t,e,r,n,i){var s=t[r];if(s){if(0===s.c){s.c=2;var a=[];return Me(n,s.z,a,i),void Pe(e,9,i,{w:a,A:s})}ze(t,e,r+Ne,n,i)}else{var o=Pe(e,9,i,void 0);t[r]={c:1,z:n,r:i,s:o}}}function $e(t,e,r,n){He(t,e,r,0,0,e.b,n)}function He(t,e,r,n,i,s,a){for(var o=r[n],u=o.r;u===i;){var c=o.$;if(1===c)$e(t,e.k,o.s,a);else if(8===c){o.t=t,o.u=a,(h=o.s.w).length>0&&He(t,e,h,0,i,s,a)}else if(9===c){o.t=t,o.u=a;var h,l=o.s;if(l)l.A.s=t,(h=l.w).length>0&&He(t,e,h,0,i,s,a)}else o.t=t,o.u=a;if(!(o=r[++n])||(u=o.r)>s)return n}var f=e.$;if(4===f){for(var d=e.k;4===d.$;)d=d.k;return He(t,d,r,n,i+1,s,t.elm_event_node_ref)}for(var p=e.e,_=t.childNodes,g=0;g<p.length;g++){i++;var b=1===f?p[g]:p[g].b,v=i+(b.b||0);if(i<=u&&u<=v&&(!(o=r[n=He(_[g],b,r,n,i,v,a)])||(u=o.r)>s))return n;i=v}return n}function We(t,e,r,n){return 0===r.length?t:($e(t,e,r,n),qe(t,r))}function qe(t,e){for(var r=0;r<e.length;r++){var n=e[r],i=n.t,s=Ge(i,n);i===t&&(t=s)}return t}function Ge(t,e){switch(e.$){case 0:return function(t,e,r){var n=t.parentNode,i=Ee(e,r);i.elm_event_node_ref||(i.elm_event_node_ref=t.elm_event_node_ref);n&&i!==t&&n.replaceChild(i,t);return i}(t,e.s,e.u);case 4:return xe(t,e.u,e.s),t;case 3:return t.replaceData(0,t.length,e.s),t;case 1:return qe(t,e.s);case 2:return t.elm_event_node_ref?t.elm_event_node_ref.j=e.s:t.elm_event_node_ref={j:e.s,p:e.u},t;case 6:for(var r=e.s,n=0;n<r.i;n++)t.removeChild(t.childNodes[r.v]);return t;case 7:for(var i=(r=e.s).e,s=(n=r.v,t.childNodes[n]);n<i.length;n++)t.insertBefore(Ee(i[n],e.u),s);return t;case 9:if(!(r=e.s))return t.parentNode.removeChild(t),t;var a=r.A;return void 0!==a.r&&t.parentNode.removeChild(t),a.s=qe(t,r.w),t;case 8:return function(t,e){var r=e.s,n=function(t,e){if(!t)return;for(var r=ie.createDocumentFragment(),n=0;n<t.length;n++){var i=t[n].A;se(r,2===i.c?i.s:Ee(i.z,e.u))}return r}(r.y,e);t=qe(t,r.w);for(var i=r.x,s=0;s<i.length;s++){var a=i[s],o=a.A,u=2===o.c?o.s:Ee(o.z,e.u);t.insertBefore(u,t.childNodes[a.r])}n&&se(t,n);return t}(t,e);case 5:return e.s(t);default:D(10)}}function Ve(t){if(3===t.nodeType)return ae(t.textContent);if(1!==t.nodeType)return ae("");for(var e=x,r=t.attributes,n=r.length;n--;){var i=r[n],s=i.name,a=i.value;e=T(h(ge,s,a),e)}var o=t.tagName.toLowerCase(),u=x,c=t.childNodes;for(n=c.length;n--;)u=T(Ve(c[n]),u);return l(ue,o,e,u)}i((function(t,e,r,n){return Ft(e,n,t.dl,t.ec,t.d4,(function(e,r){var i=t.ee,s=n.node,a=Ve(s);return Ye(r,(function(t){var r=i(t),n=Oe(a,r);s=We(s,a,n,e),a=r}))}))}));var Xe=i((function(t,e,r,n){return Ft(e,n,t.dl,t.ec,t.d4,(function(e,r){var n=t.bp&&t.bp(e),i=t.ee,s=ie.title,a=ie.body,o=Ve(a);return Ye(r,(function(t){te=n;var r=i(t),u=ue("body")(x)(r.cM),c=Oe(o,u);a=We(a,o,c,e),o=u,te=0,s!==r.d8&&(ie.title=s=r.d8)}))}))})),Ke="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){return setTimeout(t,1e3/60)};function Ye(t,e){e(t);var r=0;function n(){r=1===r?0:(Ke(n),e(t),1)}return function(i,s){t=i,s?(e(t),2===r&&(r=1)):(0===r&&Ke(n),r=2)}}function Je(){return qn(ie.location.href).a||D(1)}r((function(t,e){return h(ui,Gn,xt((function(){e&&history.go(e),t()})))}));var Qe=r((function(t,e){return h(ui,Gn,xt((function(){history.pushState({},"",e),t()})))})),Ze=r((function(t,e){return h(ui,Gn,xt((function(){history.replaceState({},"",e),t()})))})),tr="undefined"!=typeof window?window:{addEventListener:function(){},removeEventListener:function(){}};n((function(t,e,r){return Rt(xt((function(n){function i(t){St(r(t))}return t.addEventListener(e,i,me&&{passive:!0}),function(){t.removeEventListener(e,i)}})))})),r((function(t,e){var r=pt(t,e);return An(r)?Sr(r.a):Rr}));function er(t,e){return xt((function(r){Ke((function(){var n=document.getElementById(t);r(n?Et(e(n)):function(t){return{$:1,a:t}}(In(t)))}))}))}r((function(t,e){return er(e,(function(e){return e[t](),0}))})),r((function(t,e){return r=function(){return tr.scroll(t,e),0},xt((function(t){Ke((function(){t(Et(r()))}))}));var r})),n((function(t,e,r){return er(t,(function(t){return t.scrollLeft=e,t.scrollTop=r,0}))}));var rr=n((function(t,e,r){return xt((function(n){function i(t){n(e(r.be.a(t)))}var s=new XMLHttpRequest;s.addEventListener("error",(function(){i(Ji)})),s.addEventListener("timeout",(function(){i(ts)})),s.addEventListener("load",(function(){i(function(t,e){return h(200<=e.status&&e.status<300?Yi:Xi,function(t){return{bu:t.responseURL,d0:t.status,d1:t.statusText,bT:nr(t.getAllResponseHeaders())}}(e),t(e.response))}(r.be.b,s))})),ns(r.cu)&&function(t,e,r){e.upload.addEventListener("progress",(function(n){e.c||St(h(is,t,w(r,Zi({dY:n.loaded,cn:n.total}))))})),e.addEventListener("progress",(function(n){e.c||St(h(is,t,w(r,Qi({dP:n.loaded,cn:n.lengthComputable?Sr(n.total):Rr}))))}))}(t,s,r.cu.a);try{s.open(r.dv,r.bu,!0)}catch(t){return i(Ki(r.bu))}return function(t,e){for(var r=e.bT;r.b;r=r.b)t.setRequestHeader(r.a.a,r.a.b);t.timeout=e.d7.a||0,t.responseType=e.be.d,t.withCredentials=e.cI}(s,r),r.cM.a&&s.setRequestHeader("Content-Type",r.cM.a),s.send(r.cM.b),function(){s.c=!0,s.abort()}}))}));function nr(t){if(!t)return rs;for(var e=rs,r=t.split("\r\n"),n=r.length;n--;){var i=r[n],s=i.indexOf(": ");if(s>0){var a=i.substring(0,s),o=i.substring(s+2);e=l(vs,a,(function(t){return Sr(ns(t)?o+", "+t.a:o)}),e)}}return e}var ir=n((function(t,e,r){return{$:0,d:t,b:e,a:r}})),sr=r((function(t,e){return{$:0,d:e.d,b:e.b,a:function(r){return t(e.a(r))}}}));r((function(t,e){return{$:0,a:t,b:e}})),r((function(t,e){return new Blob([e],{type:t})}));r((function(t,e){return t&e})),r((function(t,e){return t|e})),r((function(t,e){return t^e})),r((function(t,e){return e<<t})),r((function(t,e){return e>>t})),r((function(t,e){return e>>>t}));var ar=n((function(t,e,r){return function(t,e,r,n){return{$:3,d:Ae(t),g:e,h:r,i:n}}(e,{a:t,b:r},or,ur)}));function or(t){return h(lr,t,ie.createElement("div"))}function ur(t,e){return(t.b!==e.b||t.a!==e.a)&&lr(e)}var cr,hr,lr=r((function(t,e){return e.innerHTML=fr(t.b,function(t){function e(e,r){return!r&&ns(t.bL)&&(r=t.bL.a),"undefined"!=typeof hljs&&r&&hljs.listLanguages().indexOf(r)>=0?hljs.highlight(r,e,!0).value:e}var r=t.df.a;return{highlight:e,gfm:r,tables:r&&r.d5,breaks:r&&r.cN,sanitize:t.dT,smartypants:t.d$}}(t.a)),e})),fr=(hr=(cr={}).exports={},function(){var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:u,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:u,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:u,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};function e(e){this.tokens=[],this.tokens.links={},this.options=e||h.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=o(t.item,"gm")(/bull/g,t.bullet)(),t.list=o(t.list)(/bull/g,t.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+t.def.source+")")(),t.blockquote=o(t.blockquote)("def",t.def)(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",t.html=o(t.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,t._tag)(),t.paragraph=o(t.paragraph)("hr",t.hr)("heading",t.heading)("lheading",t.lheading)("blockquote",t.blockquote)("tag","<"+t._tag)("def",t.def)(),t.normal=c({},t),t.gfm=c({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=o(t.paragraph)("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|")(),t.tables=c({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=t,e.lex=function(t,r){return new e(r).lex(t)},e.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},e.prototype.token=function(e,r,n){var i,s,a,o,u,c,h,l,f;for(e=e.replace(/^ +$/gm,"");e;)if((a=this.rules.newline.exec(e))&&(e=e.substring(a[0].length),a[0].length>1&&this.tokens.push({type:"space"})),a=this.rules.code.exec(e))e=e.substring(a[0].length),a=a[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?a:a.replace(/\n+$/,"")});else if(a=this.rules.fences.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"code",lang:a[2],text:a[3]||""});else if(a=this.rules.heading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:a[1].length,text:a[2]});else if(r&&(a=this.rules.nptable.exec(e))){for(e=e.substring(a[0].length),c={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/\n$/,"").split("\n")},l=0;l<c.align.length;l++)/^ *-+: *$/.test(c.align[l])?c.align[l]="right":/^ *:-+: *$/.test(c.align[l])?c.align[l]="center":/^ *:-+ *$/.test(c.align[l])?c.align[l]="left":c.align[l]=null;for(l=0;l<c.cells.length;l++)c.cells[l]=c.cells[l].split(/ *\| */);this.tokens.push(c)}else if(a=this.rules.lheading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:"="===a[2]?1:2,text:a[1]});else if(a=this.rules.hr.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"hr"});else if(a=this.rules.blockquote.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"blockquote_start"}),a=a[0].replace(/^ *> ?/gm,""),this.token(a,r,!0),this.tokens.push({type:"blockquote_end"});else if(a=this.rules.list.exec(e)){for(e=e.substring(a[0].length),o=a[2],this.tokens.push({type:"list_start",ordered:o.length>1}),i=!1,f=(a=a[0].match(this.rules.item)).length,l=0;l<f;l++)h=(c=a[l]).length,~(c=c.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(h-=c.length,c=this.options.pedantic?c.replace(/^ {1,4}/gm,""):c.replace(new RegExp("^ {1,"+h+"}","gm"),"")),this.options.smartLists&&l!==f-1&&(o===(u=t.bullet.exec(a[l+1])[0])||o.length>1&&u.length>1||(e=a.slice(l+1).join("\n")+e,l=f-1)),s=i||/\n\n(?!\s*$)/.test(c),l!==f-1&&(i="\n"===c.charAt(c.length-1),s||(s=i)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(c,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(a=this.rules.html.exec(e))e=e.substring(a[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===a[1]||"script"===a[1]||"style"===a[1]),text:a[0]});else if(!n&&r&&(a=this.rules.def.exec(e)))e=e.substring(a[0].length),this.tokens.links[a[1].toLowerCase()]={href:a[2],title:a[3]};else if(r&&(a=this.rules.table.exec(e))){for(e=e.substring(a[0].length),c={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/(?: *\| *)?\n$/,"").split("\n")},l=0;l<c.align.length;l++)/^ *-+: *$/.test(c.align[l])?c.align[l]="right":/^ *:-+: *$/.test(c.align[l])?c.align[l]="center":/^ *:-+ *$/.test(c.align[l])?c.align[l]="left":c.align[l]=null;for(l=0;l<c.cells.length;l++)c.cells[l]=c.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(c)}else if(r&&(a=this.rules.paragraph.exec(e)))e=e.substring(a[0].length),this.tokens.push({type:"paragraph",text:"\n"===a[1].charAt(a[1].length-1)?a[1].slice(0,-1):a[1]});else if(a=this.rules.text.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"text",text:a[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:u,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^_\_([\s\S]+?)_\_(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|_\_)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:u,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};function n(t,e){if(this.options=e||h.defaults,this.links=t,this.rules=r.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=r.breaks:this.rules=r.gfm:this.options.pedantic&&(this.rules=r.pedantic)}function i(t){this.options=t||{}}function s(t){this.tokens=[],this.token=null,this.options=t||h.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(t,e){return t=t.source,e=e||"",function r(n,i){return n?(i=(i=i.source||i).replace(/(^|[^\[])\^/g,"$1"),t=t.replace(n,i),r):new RegExp(t,e)}}function u(){}function c(t){for(var e,r,n=1;n<arguments.length;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function h(t,r,n){if(n||"function"==typeof r){n||(n=r,r=null);var i,o,u=(r=c({},h.defaults,r||{})).highlight,l=0;try{i=e.lex(t,r)}catch(t){return n(t)}o=i.length;var f=function(t){if(t)return r.highlight=u,n(t);var e;try{e=s.parse(i,r)}catch(e){t=e}return r.highlight=u,t?n(t):n(null,e)};if(!u||u.length<3)return f();if(delete r.highlight,!o)return f();for(;l<i.length;l++)!function(t){"code"!==t.type?--o||f():u(t.text,t.lang,(function(e,r){return e?f(e):null==r||r===t.text?--o||f():(t.text=r,t.escaped=!0,void(--o||f()))}))}(i[l])}else try{return r&&(r=c({},h.defaults,r)),s.parse(e.lex(t,r),r)}catch(t){if(t.message+="\nPlease report this to https://github.com/chjj/marked.",(r||h.defaults).silent)return"<p>An error occured:</p><pre>"+a(t.message+"",!0)+"</pre>";throw t}}r._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,r._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,r.link=o(r.link)("inside",r._inside)("href",r._href)(),r.reflink=o(r.reflink)("inside",r._inside)(),r.normal=c({},r),r.pedantic=c({},r.normal,{strong:/^_\_(?=\S)([\s\S]*?\S)_\_(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),r.gfm=c({},r.normal,{escape:o(r.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:o(r.text)("]|","~]|")("|","|https?://|")()}),r.breaks=c({},r.gfm,{br:o(r.br)("{2,}","*")(),text:o(r.gfm.text)("{2,}","*")()}),n.rules=r,n.output=function(t,e,r){return new n(e,r).output(t)},n.prototype.output=function(t){for(var e,r,n,i,s="";t;)if(i=this.rules.escape.exec(t))t=t.substring(i[0].length),s+=i[1];else if(i=this.rules.autolink.exec(t))t=t.substring(i[0].length),"@"===i[2]?(r=":"===i[1].charAt(6)?this.mangle(i[1].substring(7)):this.mangle(i[1]),n=this.mangle("mailto:")+r):n=r=a(i[1]),s+=this.renderer.link(n,null,r);else if(this.inLink||!(i=this.rules.url.exec(t))){if(i=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),t=t.substring(i[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):a(i[0]):i[0];else if(i=this.rules.link.exec(t))t=t.substring(i[0].length),this.inLink=!0,s+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(t))||(i=this.rules.nolink.exec(t))){if(t=t.substring(i[0].length),e=(i[2]||i[1]).replace(/\s+/g," "),!(e=this.links[e.toLowerCase()])||!e.href){s+=i[0].charAt(0),t=i[0].substring(1)+t;continue}this.inLink=!0,s+=this.outputLink(i,e),this.inLink=!1}else if(i=this.rules.strong.exec(t))t=t.substring(i[0].length),s+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(t))t=t.substring(i[0].length),s+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(t))t=t.substring(i[0].length),s+=this.renderer.codespan(a(i[2],!0));else if(i=this.rules.br.exec(t))t=t.substring(i[0].length),s+=this.renderer.br();else if(i=this.rules.del.exec(t))t=t.substring(i[0].length),s+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(t))t=t.substring(i[0].length),s+=this.renderer.text(a(this.smartypants(i[0])));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else t=t.substring(i[0].length),n=r=a(i[1]),s+=this.renderer.link(n,null,r);return s},n.prototype.outputLink=function(t,e){var r=a(e.href),n=e.title?a(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(r,n,this.output(t[1])):this.renderer.image(r,n,a(t[1]))},n.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},n.prototype.mangle=function(t){if(!this.options.mangle)return t;for(var e,r="",n=t.length,i=0;i<n;i++)e=t.charCodeAt(i),Math.random()>.5&&(e="x"+e.toString(16)),r+="&#"+e+";";return r},i.prototype.code=function(t,e,r){if(this.options.highlight){var n=this.options.highlight(t,e);null!=n&&n!==t&&(r=!0,t=n)}return e?'<pre><code class="'+this.options.langPrefix+a(e,!0)+'">'+(r?t:a(t,!0))+"\n</code></pre>\n":"<pre><code>"+(r?t:a(t,!0))+"\n</code></pre>"},i.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},i.prototype.html=function(t){return t},i.prototype.heading=function(t,e,r){return"<h"+e+' id="'+this.options.headerPrefix+r.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(t,e){var r=e?"ol":"ul";return"<"+r+">\n"+t+"</"+r+">\n"},i.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},i.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},i.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},i.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},i.prototype.tablecell=function(t,e){var r=e.header?"th":"td";return(e.align?"<"+r+' style="text-align:'+e.align+'">':"<"+r+">")+t+"</"+r+">\n"},i.prototype.strong=function(t){return"<strong>"+t+"</strong>"},i.prototype.em=function(t){return"<em>"+t+"</em>"},i.prototype.codespan=function(t){return"<code>"+t+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(t){return"<del>"+t+"</del>"},i.prototype.link=function(t,e,r){if(this.options.sanitize){try{var n=decodeURIComponent((i=t,i.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,(function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})))).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return""}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return""}var i,s='<a href="'+t+'"';return e&&(s+=' title="'+e+'"'),s+=">"+r+"</a>"},i.prototype.image=function(t,e,r){var n='<img src="'+t+'" alt="'+r+'"';return e&&(n+=' title="'+e+'"'),n+=this.options.xhtml?"/>":">"},i.prototype.text=function(t){return t},s.parse=function(t,e,r){return new s(e,r).parse(t)},s.prototype.parse=function(t){this.inline=new n(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},s.prototype.next=function(){return this.token=this.tokens.pop()},s.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},s.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},s.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,r,n,i="",s="";for(r="",t=0;t<this.token.header.length;t++)this.token.align[t],r+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(i+=this.renderer.tablerow(r),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],r="",n=0;n<e.length;n++)r+=this.renderer.tablecell(this.inline.output(e[n]),{header:!1,align:this.token.align[n]});s+=this.renderer.tablerow(r)}return this.renderer.table(i,s);case"blockquote_start":for(s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":s="";for(var a=this.token.ordered;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,a);case"list_item_start":for(s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(s);case"loose_item_start":for(s="";"list_item_end"!==this.next().type;)s+=this.tok();return this.renderer.listitem(s);case"html":var o=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(o);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},u.exec=u,h.options=h.setOptions=function(t){return c(h.defaults,t),h},h.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},h.Parser=s,h.parser=s.parse,h.Renderer=i,h.Lexer=e,h.lexer=e.lex,h.InlineLexer=n,h.inlineLexer=n.output,h.parse=h,void 0!==cr&&"object"==typeof hr?cr.exports=h:"function"==typeof define&&define.amd?define((function(){return h})):this.marked=h}.call(function(){return this||("undefined"!=typeof window?window:global)}()),cr.exports);var dr=r((function(t,e){var r="g";t.dy&&(r+="m"),t.cQ&&(r+="i");try{return Sr(new RegExp(e,r))}catch(t){return Rr}})),pr=(r((function(t,e){return null!==e.match(t)})),n((function(t,e,r){for(var n,i=[],s=0,a=r,o=e.lastIndex,u=-1;s++<t&&(n=e.exec(a))&&u!=e.lastIndex;){for(var c=n.length-1,h=new Array(c);c>0;){var l=n[c];h[--c]=l?Sr(l):Rr}i.push(f(S_,n[0],n.index,s,S(h))),u=e.lastIndex}return e.lastIndex=o,S(i)})),i((function(t,e,r,n){var i=0;return n.replace(e,(function(e){if(i++>=t)return e;for(var n=arguments.length-3,s=new Array(n);n>0;){var a=arguments[n];s[--n]=a?Sr(a):Rr}return r(f(S_,e,arguments[arguments.length-2],i,S(s)))}))}))),_r=(n((function(t,e,r){for(var n=r,i=[],s=e.lastIndex,a=e.lastIndex;t--;){var o=e.exec(n);if(!o)break;i.push(n.slice(s,o.index)),s=e.lastIndex}return i.push(n.slice(s)),e.lastIndex=a,S(i)})),1),gr=2,br=0,vr=C,mr=n((function(t,e,r){for(;;){if(-2===r.$)return e;var n=r.b,i=r.c,s=r.d,a=r.e,o=t,u=l(t,n,i,l(mr,t,e,a));t=o,e=u,r=s}})),yr=function(t){return l(mr,n((function(t,e,r){return h(vr,w(t,e),r)})),x,t)},wr=M,Ar=(n((function(t,e,n){var i=n.c,s=n.d,a=r((function(e,r){if(e.$){var n=e.a;return l(wr,t,r,n)}var i=e.a;return l(wr,a,r,i)}));return l(wr,a,l(wr,t,e,s),i)})),function(t){return{$:1,a:t}}),kr=r((function(t,e){return{$:3,a:t,b:e}})),Er=r((function(t,e){return{$:0,a:t,b:e}})),xr=r((function(t,e){return{$:1,a:t,b:e}})),Tr=function(t){return{$:0,a:t}},Cr=function(t){return{$:2,a:t}},Sr=function(t){return{$:0,a:t}},Rr={$:1},Ir=Y,Br=k,Or=wt,Pr=et,Mr=r((function(t,e){return h(X,t,R(e))})),Dr=r((function(t,e){return S(h(V,t,e))})),Fr=function(t){return h(Mr,"\n    ",h(Dr,"\n",t))},Lr=n((function(t,e,r){for(;;){if(!r.b)return e;var n=r.a,i=r.b,s=t,a=h(t,n,e);t=s,e=a,r=i}})),jr=function(t){return l(Lr,r((function(t,e){return e+1})),0,t)},Nr=I,Ur=n((function(t,e,r){for(;;){if(!(m(t,e)<1))return r;var n=t,i=e-1,s=h(vr,e,r);t=n,e=i,r=s}})),zr=r((function(t,e){return l(Ur,t,e,x)})),$r=r((function(t,e){return l(Nr,t,h(zr,0,jr(e)-1),e)})),Hr=function(t){var e=t.charCodeAt(0);return 55296<=e&&e<=56319?1024*(e-55296)+t.charCodeAt(1)-56320+65536:e},Wr=function(t){var e=Hr(t);return 97<=e&&e<=122},qr=function(t){var e=Hr(t);return e<=90&&65<=e},Gr=function(t){return Wr(t)||qr(t)},Vr=function(t){var e=Hr(t);return e<=57&&48<=e},Xr=function(t){return Wr(t)||qr(t)||Vr(t)},Kr=function(t){return l(Lr,vr,x,t)},Yr=function(t){var e=t.charCodeAt(0);return isNaN(e)?Rr:Sr(55296<=e&&e<=56319?w(t[0]+t[1],t.slice(2)):w(t[0],t.slice(1)))},Jr=r((function(t,e){return"\n\n("+Pr(t+1)+") "+Fr(Qr(e))})),Qr=function(t){return h(Zr,t,x)},Zr=r((function(t,e){t:for(;;)switch(t.$){case 0:var r=t.a,n=t.b,i=function(){var t=Yr(r);if(1===t.$)return!1;var e=t.a,n=e.a,i=e.b;return Gr(n)&&h(Ir,Xr,i)}(),s=n,a=h(vr,i?"."+r:"['"+r+"']",e);t=s,e=a;continue t;case 1:var o=t.a,u=(n=t.b,"["+Pr(o)+"]");s=n,a=h(vr,u,e);t=s,e=a;continue t;case 2:var c=t.a;if(c.b){if(c.b.b){var l=(e.b?"The Json.Decode.oneOf at json"+h(Mr,"",Kr(e)):"Json.Decode.oneOf")+" failed in the following "+Pr(jr(c))+" ways:";return h(Mr,"\n\n",h(vr,l,h($r,Jr,c)))}t=s=n=c.a,e=a=e;continue t}return"Ran into a Json.Decode.oneOf with no possibilities"+(e.b?" at json"+h(Mr,"",Kr(e)):"!");default:var f=t.a,d=t.b;return(l=e.b?"Problem with the value at json"+h(Mr,"",Kr(e))+":\n\n    ":"Problem with the given value:\n\n")+(Fr(h(Or,4,d))+"\n\n")+f}})),tn=32,en=i((function(t,e,r,n){return{$:0,a:t,b:e,c:r,d:n}})),rn=[],nn=L,sn=r((function(t,e){return U(e)/U(t)})),an=function(t){return t},on=nn(h(sn,2,tn)),un=f(en,0,on,rn,rn),cn=O,hn=(r((function(t,e){return t(e)})),r((function(t,e){return e(t)}))),ln=v,fn=j,dn=function(t){return t.length},pn=r((function(t,e){return m(t,e)>0?t:e})),_n=P,gn=r((function(t,e){for(;;){var r=h(_n,tn,t),n=r.a,i=r.b,s=h(vr,{$:0,a:n},e);if(!i.b)return Kr(s);t=i,e=s}})),bn=function(t){return t.a},vn=r((function(t,e){for(;;){var r=nn(e/tn);if(1===r)return h(_n,tn,t).a;t=h(gn,t,x),e=r}})),mn=r((function(t,e){if(e.h){var r=e.h*tn,n=fn(h(sn,tn,r-1)),i=t?Kr(e.k):e.k,s=h(vn,i,e.h);return f(en,dn(e.j)+r,h(pn,5,n*on),s,e.j)}return f(en,dn(e.j),on,rn,e.j)})),yn=s((function(t,e,r,n,i){for(;;){if(e<0)return h(mn,!1,{k:n,h:r/tn|0,j:i});var s={$:1,a:l(cn,tn,e,t)};t=t,e=e-tn,r=r,n=h(vr,s,n),i=i}})),wn=r((function(t,e){if(t<=0)return un;var r=t%tn,n=l(cn,r,t-r,e);return d(yn,e,t-r-tn,t,x,n)})),An=function(t){return!t.$},kn=lt,En=ft,xn=function(t){return{$:0,a:t}},Tn=function(t){switch(t.$){case 0:return 0;case 1:return 1;case 2:return 2;default:return 3}},Cn=function(t){return{$:1,a:t}},Sn=function(t){return{$:0,a:t}},Rn=function(t){return t},In=Rn,Bn=a((function(t,e,r,n,i,s){return{dd:s,bV:e,b6:n,b8:r,cd:t,ce:i}})),On=J,Pn=function(t){return t.length},Mn=K,Dn=r((function(t,e){return t<1?e:l(Mn,t,Pn(e),e)})),Fn=tt,Ln=function(t){return""===t},jn=r((function(t,e){return t<1?"":l(Mn,0,t,e)})),Nn=function(t){for(var e=0,r=t.charCodeAt(0),n=43==r||45==r?1:0,i=n;i<t.length;++i){var s=t.charCodeAt(i);if(s<48||57<s)return Rr;e=10*e+s-48}return i==n?Rr:Sr(45==r?-e:e)},Un=s((function(t,e,r,n,i){if(Ln(i)||h(On,"@",i))return Rr;var s=h(Fn,":",i);if(s.b){if(s.b.b)return Rr;var a=s.a,o=Nn(h(Dn,a+1,i));if(1===o.$)return Rr;var u=o;return Sr(p(Bn,t,h(jn,a,i),u,e,r,n))}return Sr(p(Bn,t,i,Rr,e,r,n))})),zn=i((function(t,e,r,n){if(Ln(n))return Rr;var i=h(Fn,"/",n);if(i.b){var s=i.a;return d(Un,t,h(Dn,s,n),e,r,h(jn,s,n))}return d(Un,t,"/",e,r,n)})),$n=n((function(t,e,r){if(Ln(r))return Rr;var n=h(Fn,"?",r);if(n.b){var i=n.a;return f(zn,t,Sr(h(Dn,i+1,r)),e,h(jn,i,r))}return f(zn,t,Rr,e,r)})),Hn=r((function(t,e){if(Ln(e))return Rr;var r=h(Fn,"#",e);if(r.b){var n=r.a;return l($n,t,Sr(h(Dn,n+1,e)),h(jn,n,e))}return l($n,t,Rr,e)})),Wn=Q,qn=function(t){return h(Wn,"http://",t)?h(Hn,0,h(Dn,7,t)):h(Wn,"https://",t)?h(Hn,1,h(Dn,8,t)):Rr},Gn=function(t){},Vn=Et,Xn=Vn(0),Kn=i((function(t,e,r,n){if(n.b){var i=n.a,s=n.b;if(s.b){var a=s.a,o=s.b;if(o.b){var u=o.a,c=o.b;if(c.b){var d=c.a,p=c.b;return h(t,i,h(t,a,h(t,u,h(t,d,r>500?l(Lr,t,e,Kr(p)):f(Kn,t,e,r+1,p)))))}return h(t,i,h(t,a,h(t,u,e)))}return h(t,i,h(t,a,e))}return h(t,i,e)}return e})),Yn=n((function(t,e,r){return f(Kn,t,e,0,r)})),Jn=r((function(t,e){return l(Yn,r((function(e,r){return h(vr,t(e),r)})),x,e)})),Qn=Tt,Zn=r((function(t,e){return h(Qn,(function(e){return Vn(t(e))}),e)})),ti=n((function(t,e,r){return h(Qn,(function(e){return h(Qn,(function(r){return Vn(h(t,e,r))}),r)}),e)})),ei=function(t){return l(Yn,ti(vr),Vn(x),t)},ri=Ut,ni=r((function(t,e){var r=e;return Rt(h(Qn,ri(t),r))})),ii=n((function(t,e,r){return h(Zn,(function(t){return 0}),ei(h(Jn,ni(t),e)))})),si=n((function(t,e,r){return Vn(0)})),ai=r((function(t,e){return h(Zn,t,e)}));Lt.Task=jt(Xn,ii,si,ai);var oi=$t("Task"),ui=r((function(t,e){return oi(h(Zn,t,e))})),ci=function(t){var e=t.dI,n=t.dJ,i=function(){i.a(e(Je()))};return Xe({bp:function(t){return i.a=t,tr.addEventListener("popstate",i),tr.navigator.userAgent.indexOf("Trident")<0||tr.addEventListener("hashchange",i),r((function(e,r){if(!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&r.button<1&&!e.target&&!e.hasAttribute("download")){r.preventDefault();var i=e.href,s=Je(),a=qn(i).a;t(n(a&&s.cd===a.cd&&s.bV===a.bV&&s.b8.a===a.b8.a?Sn(a):Cn(i)))}}))},dl:function(e){return l(t.dl,e,Je(),i)},ee:t.ee,ec:t.ec,d4:t.d4})},hi={$:0},li=r((function(t,e){return{$:1,a:t,b:e}})),fi=r((function(t,e){return{$:0,a:t,b:e}})),di={$:39},pi={$:41},_i=function(t){return{$:4,a:t}},gi=function(t){return{$:3,a:t}},bi=function(t){return{$:5,a:t}},vi=Ht,mi=c((function(t,e,r,n,i,s,a,o,u){return{aP:u,aR:e,aS:t,aT:n,aW:o,aG:r,bb:i,aM:s,bv:a}})),yi=it,wi=ht,Ai=function(t){return{$:1,a:t}},ki=ot,Ei=h(wi,(function(t){switch(t){case"pcm":return xn(1);case"waveform":return xn(0);default:return Ai("invalid AudioEmulation value")}}),ki),xi=h(wi,(function(t){switch(t){case"cycle":return xn(0);case"instruction":return xn(1);default:return Ai("invalid CpuEmulation value")}}),ki),Ti=h(wi,(function(t){switch(t){case"pal":return xn(0);case"ntsc":return xn(1);case"secam":return xn(2);default:return Ai("invalid TvMode value")}}),ki),Ci=nt,Si=function(t){return{$:11,g:t}},Ri=function(t){return Si(S([h(kn,Sr,t),xn(Rr)]))},Ii=En(hn),Bi=ut,Oi=dt,Pi=function(t){return{$:5,c:t}},Mi=at,Di=n((function(t,e,r){return h(wi,(function(n){var i=h(Oi,t,n);if(i.$)return xn(r);var s=i.a,a=h(Oi,Si(S([e,Pi(r)])),s);if(a.$){var o=a.a;return Ai(Qr(o))}var u=a.a;return xn(u)}),Mi)})),Fi=i((function(t,e,r,n){return h(Ii,l(Di,h(Bi,t,Mi),e,r),n)})),Li=n((function(t,e,r){return h(Ii,h(Bi,t,e),r)})),ji=f(Fi,"phosphorLevel",Ri(Ci),Rr,f(Fi,"audioEmulation",Ri(Ei),Rr,f(Fi,"cpuEmulation",Ri(xi),Rr,f(Fi,"firstVisibleLine",Ri(Ci),Rr,f(Fi,"rngSeed",Ri(Ci),Rr,l(Li,"volume",Ci,l(Li,"emulatePaddles",yi,l(Li,"tvMode",Ti,l(Li,"cartridgeType",ki,l(Li,"name",ki,l(Li,"hash",ki,xn((function(t){return function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return function(o){return function(u){return function(c){return function(h){return{cL:c,bH:r,cW:u,bN:i,bR:o,S:t,aB:e,dM:h,ck:a,cx:n,eg:s}}}}}}}}}}}}))))))))))))),Ni=r((function(t,e){return{c1:e,dn:t}})),Ui=l(En,Ni,h(Bi,"key",ki),h(Bi,"description",ki)),zi=h(wi,(function(t){switch(t){case"wide":return xn(1);case"narrow":return xn(0);default:return Ai("invalid media value")}}),ki),$i=h(wi,(function(t){switch(t){case"qis":return xn(0);case"bilinear":return xn(1);case"none":return xn(2);default:return Ai("invalid scaling value")}}),ki),Hi=h(wi,(function(t){switch(t){case"composite":return xn(0);case"svideo":return xn(1);case"none":return xn(2);default:return Ai("invalid tv emulation value")}}),ki),Wi=st,qi=l(Li,"uiSize",Ci,f(Fi,"uiMode",Ri(zi),Rr,l(Li,"virtualJoystickSensitivity",Ci,l(Li,"leftHanded",yi,f(Fi,"touchControls",Ri(yi),Rr,l(Li,"scanlineIntensity",Ci,l(Li,"phosphorLevel",Ci,l(Li,"scaling",$i,l(Li,"tvEmulation",Hi,l(Li,"gammaCorrection",Wi,l(Li,"audioEmulation",Ei,l(Li,"volume",Ci,l(Li,"cpuEmulation",xi,xn((function(t){return function(e){return function(r){return function(n){return function(i){return function(s){return function(a){return function(o){return function(u){return function(c){return function(h){return function(l){return function(f){return{cL:r,cW:t,de:n,$7:c,dM:a,dU:s,dV:o,d9:u,ea:i,eb:l,cy:f,ef:h,eg:e}}}}}}}}}}}}}}))))))))))))))),Gi=function(t){return{$:3,b:t}},Vi=l(Li,"badGpu",yi,l(Li,"gamepadCount",Ci,l(Li,"wasUpdated",yi,l(Li,"version",ki,l(Li,"touchSupport",yi,l(Li,"defaultSettings",qi,l(Li,"settings",qi,l(Li,"cartridgeTypes",Gi(Ui),l(Li,"cartridges",Gi(ji),xn(mi)))))))))),Xi=r((function(t,e){return{$:3,a:t,b:e}})),Ki=function(t){return{$:0,a:t}},Yi=r((function(t,e){return{$:4,a:t,b:e}})),Ji={$:2},Qi=function(t){return{$:1,a:t}},Zi=function(t){return{$:0,a:t}},ts={$:1},es={$:-2},rs=es,ns=function(t){return!t.$},is=zt,ss=y,as=r((function(t,e){t:for(;;){if(-2===e.$)return Rr;var r=e.b,n=e.c,i=e.d,s=e.e;switch(h(ss,t,r)){case 0:t=t,e=i;continue t;case 1:return Sr(n);default:t=t,e=s;continue t}}})),os=s((function(t,e,r,n,i){return{$:-1,a:t,b:e,c:r,d:n,e:i}})),us=s((function(t,e,r,n,i){if(-1!==i.$||i.a){if(-1!==n.$||n.a||-1!==n.d.$||n.d.a)return d(os,t,e,r,n,i);n.a,_=n.b,g=n.c;var s=n.d,a=(s.a,s.b),o=s.c,u=s.d,c=s.e;v=n.e;return d(os,0,_,g,d(os,1,a,o,u,c),d(os,1,e,r,v,i))}i.a;var h=i.b,l=i.c,f=i.d,p=i.e;if(-1!==n.$||n.a)return d(os,t,h,l,d(os,0,e,r,n,f),p);n.a;var _=n.b,g=n.c,b=n.d,v=n.e;return d(os,0,e,r,d(os,1,_,g,b,v),d(os,1,h,l,f,p))})),cs=n((function(t,e,r){if(-2===r.$)return d(os,0,t,e,es,es);var n=r.a,i=r.b,s=r.c,a=r.d,o=r.e;switch(h(ss,t,i)){case 0:return d(us,n,i,s,l(cs,t,e,a),o);case 1:return d(os,n,i,e,a,o);default:return d(us,n,i,s,a,l(cs,t,e,o))}})),hs=n((function(t,e,r){var n=l(cs,t,e,r);if(-1!==n.$||n.a)return n;n.a;var i=n.b,s=n.c,a=n.d,o=n.e;return d(os,1,i,s,a,o)})),ls=function(t){if(-1===t.$&&-1===t.d.$&&-1===t.e.$){if(-1!==t.e.d.$||t.e.d.a){t.a,i=t.b,s=t.c;var e=t.d,r=(e.a,o=e.b,u=e.c,c=e.d,h=e.e,t.e);r.a,f=r.b,p=r.c,n=r.d,m=r.e;return d(os,1,i,s,d(os,0,o,u,c,h),d(os,0,f,p,n,m))}t.a;var n,i=t.b,s=t.c,a=t.d,o=(a.a,a.b),u=a.c,c=a.d,h=a.e,l=t.e,f=(l.a,l.b),p=l.c,_=((n=l.d).a,n.b),g=n.c,b=n.d,v=n.e,m=l.e;return d(os,0,_,g,d(os,1,i,s,d(os,0,o,u,c,h),b),d(os,1,f,p,v,m))}return t},fs=function(t){if(-1===t.$&&-1===t.d.$&&-1===t.e.$){if(-1!==t.d.d.$||t.d.d.a){t.a,i=t.b,s=t.c;var e=t.d,r=(e.a,o=e.b,u=e.c,e.d),n=(_=e.e,t.e);n.a,b=n.b,v=n.c,m=n.d,y=n.e;return d(os,1,i,s,d(os,0,o,u,r,_),d(os,0,b,v,m,y))}t.a;var i=t.b,s=t.c,a=t.d,o=(a.a,a.b),u=a.c,c=a.d,h=(c.a,c.b),l=c.c,f=c.d,p=c.e,_=a.e,g=t.e,b=(g.a,g.b),v=g.c,m=g.d,y=g.e;return d(os,0,o,u,d(os,1,h,l,f,p),d(os,1,i,s,_,d(os,0,b,v,m,y)))}return t},ds=o((function(t,e,r,n,i,s,a){if(-1!==s.$||s.a){t:for(;;){if(-1===a.$&&1===a.a){if(-1===a.d.$){if(1===a.d.a){a.a,a.d.a;return fs(e)}break t}a.a,a.d;return fs(e)}break t}return e}s.a;var o=s.b,u=s.c,c=s.d,h=s.e;return d(os,r,o,u,c,d(os,0,n,i,h,a))})),ps=function(t){if(-1===t.$&&-1===t.d.$){var e=t.a,r=t.b,n=t.c,i=t.d,s=i.a,a=i.d,o=t.e;if(1===s){if(-1!==a.$||a.a){var u=ls(t);if(-1===u.$){var c=u.a,h=u.b,l=u.c,f=u.d,p=u.e;return d(us,c,h,l,ps(f),p)}return es}a.a;return d(os,e,r,n,ps(i),o)}return d(os,e,r,n,ps(i),o)}return es},_s=r((function(t,e){if(-2===e.$)return es;var r=e.a,n=e.b,i=e.c,s=e.d,a=e.e;if(m(t,n)<0){if(-1===s.$&&1===s.a){s.a;var o=s.d;if(-1!==o.$||o.a){var u=ls(e);if(-1===u.$){var c=u.a,l=u.b,f=u.c,p=u.d,g=u.e;return d(us,c,l,f,h(_s,t,p),g)}return es}o.a;return d(os,r,n,i,h(_s,t,s),a)}return d(os,r,n,i,h(_s,t,s),a)}return h(gs,t,_(ds,t,e,r,n,i,s,a))})),gs=r((function(t,e){if(-1===e.$){var r=e.a,n=e.b,i=e.c,s=e.d,a=e.e;if(g(t,n)){var o=function(t){for(;;){if(-1!==t.$||-1!==t.d.$)return t;t=t.d}}(a);if(-1===o.$){var u=o.b,c=o.c;return d(us,r,u,c,s,ps(a))}return es}return d(us,r,n,i,s,h(_s,t,a))}return es})),bs=r((function(t,e){var r=h(_s,t,e);if(-1!==r.$||r.a)return r;r.a;var n=r.b,i=r.c,s=r.d,a=r.e;return d(os,1,n,i,s,a)})),vs=n((function(t,e,r){var n=e(h(as,t,r));if(n.$)return h(bs,t,r);var i=n.a;return l(hs,t,i,r)})),ms=n((function(t,e,r){return e(t(r))})),ys=r((function(t,e){return l(ir,"",Rn,h(ms,e,t))})),ws=function(t){return{$:4,a:t}},As={$:2},ks={$:1},Es=r((function(t,e){if(e.$){var r=e.a;return Ar(t(r))}var n=e.a;return Tr(n)})),xs=r((function(t,e){switch(e.$){case 0:var r=e.a;return Ar({$:0,a:r});case 1:return Ar(ks);case 2:return Ar(As);case 3:var n=e.a;return Ar(function(t){return{$:3,a:t}}(n.d0));default:var i=e.b;return h(Es,ws,t(i))}})),Ts={cL:1,cW:0,de:1,$7:!1,dM:50,dU:0,dV:20,d9:Rr,ea:0,eb:Rr,cy:100,ef:10,eg:80},Cs={$:0},Ss=function(t){return{$:1,a:t}},Rs=r((function(t,e){return{ch:t,cr:e}})),Is=Vn(h(Rs,rs,x)),Bs=function(t){return xt((function(e){var r=t.f;2===r.$&&r.c&&r.c(),t.f=null,e(Et(0))}))},Os=Rt,Ps=n((function(t,e,r){t:for(;;){if(e.b){var n=e.a,i=e.b;if(n.$){var s=n.a;return h(Qn,(function(e){var n=s.cu;if(1===n.$)return l(Ps,t,i,r);var a=n.a;return l(Ps,t,i,l(hs,a,e,r))}),Os(l(rr,t,ri(t),s)))}var a=n.a,o=h(as,a,r);if(1===o.$){t=t,e=i,r=r;continue t}var u=o.a;return h(Qn,(function(e){return l(Ps,t,i,h(bs,a,r))}),Bs(u))}return Vn(r)}})),Ms=i((function(t,e,r,n){return h(Qn,(function(t){return Vn(h(Rs,t,r))}),l(Ps,t,e,n.ch))})),Ds=n((function(t,e,r){var n=t(e);if(n.$)return r;var i=n.a;return h(vr,i,r)})),Fs=r((function(t,e){return l(Yn,Ds(t),x,e)})),Ls=i((function(t,e,r,n){var i=n.a,s=n.b;return g(e,i)?Sr(h(ri,t,s(r))):Rr})),js=n((function(t,e,r){var n=e.a,i=e.b;return h(Qn,(function(t){return Vn(r)}),ei(h(Fs,l(Ls,t,n,i),r.cr)))})),Ns=r((function(t,e){if(e.$){var r=e.a;return Ss({cI:r.cI,cM:r.cM,be:h(sr,t,r.be),bT:r.bT,dv:r.dv,d7:r.d7,cu:r.cu,bu:r.bu})}var n=e.a;return{$:0,a:n}})),Us=r((function(t,e){return{$:0,a:t,b:e}})),zs=r((function(t,e){var r=e.a,n=e.b;return h(Us,r,h(ms,n,t))}));Lt.Http=jt(Is,Ms,js,Ns,zs);var $s,Hs=$t("Http"),Ws=function(t){return function(t){return Hs(Ss({cI:!1,cM:t.cM,be:t.be,bT:t.bT,dv:t.dv,d7:t.d7,cu:t.cu,bu:t.bu}))}({cM:Cs,be:t.be,bT:x,dv:"GET",d7:Rr,cu:Rr,bu:t.bu})},qs=r((function(t,e){return e.$?Rr:t(e.a)})),Gs=r((function(t,e){return l(Yn,r((function(e,r){return t(e)?h(vr,e,r):r})),x,e)})),Vs=function(t){if(t.b){var e=t.a;t.b;return Sr(e)}return Rr},Xs=r((function(t,e){if(e.$)return Rr;var r=e.a;return Sr(t(r))})),Ks=S([w(2,"emulation"),w(1,"settings"),w(0,"cartridges"),w(3,"help"),w(4,"about")]),Ys=function(t){var e=t.dd;return h(qs,(function(t){return l(ms,Gs((function(e){return g(e.b,t)})),h(ms,Vs,Xs(bn)),Ks)}),e)},Js=Ze,Qs=function(t){return t.b},Zs=r((function(t,e){return e.$?t:e.a})),ta=function(t){return"#"+l(ms,Gs((function(e){return g(e.a,t)})),h(ms,Vs,h(ms,Xs(Qs),Zs(""))),Ks)},ea=r((function(t,e){return l(Lr,function(t){return r((function(e,r){return r.push(t(e)),r}))}(t),[],e)})),ra=At,na=Yt("watchMedia_",ea(ra)),ia=na,sa=function(t){return ia(S(["(max-width: "+Pr(750*t/100|0)+"px)"]))},aa=n((function(t,e,r){var n,i=h(Zs,0,Ys(e)),s=function(t){return h(ys,(function(e){if(e.$)return pi;var r=e.a;return t(r)}),xs(Tr))},a=(n=h(Oi,Vi,t)).$?{aP:!1,aR:x,aS:x,aT:Ts,aW:0,aG:Ts,bb:!1,aM:"[unknown]",bv:!1}:n.a,o={aP:a.aP,cO:"",aR:a.aR,cP:0,aS:a.aS,cS:Rr,cV:{cU:0,c2:0,c3:0},cX:Rr,cY:i,aT:a.aT,c6:!1,c7:hi,aW:a.aW,dg:Rr,dn:r,dp:Rr,dq:!0,ds:Rr,du:a.bv?w(Sr(di),h(fi,"Stellerator has been updated to version "+a.aM+".",w("Changelog","Close"))):w(Rr,h(li,"","")),dS:Rr,aG:a.aG,dZ:!1,d_:!1,bb:a.bb,aM:a.aM};return w(o,vi(S([h(Js,r,ta(i)),sa(o.aG.cy),Ws({be:s(gi),bu:"doc/stellerator.md"}),Ws({be:s(_i),bu:"CHANGELOG.md"}),Ws({be:s(bi),bu:"LICENSE.md"})])))})),oa=function(t){return{$:0,a:t}},ua=h(ms,Ys,h(ms,Xs((function(t){return{$:1,a:t}})),Zs(oa(ta(0))))),ca=r((function(t,e){if(1===t.$)return e;var r=t.a;return e+":"+Pr(r)})),ha=n((function(t,e,r){return 1===e.$?r:E(r,E(t,e.a))})),la=function(t){return{$:20,a:t}},fa=function(t){return{$:34,a:t}},da=function(t){return{$:33,a:t}},pa=function(t){return{$:40,a:t}},_a=Ht,ga=function(t){return{$:3,a:t}},ba={$:1},va=function(t){return{$:2,a:t}},ma=h(wi,(function(t){switch(t){case"stopped":return xn(hi);case"paused":return xn(ba);case"running":return h(kn,va,Ri(h(Bi,"frequency",Wi)));case"error":return h(kn,ga,h(Bi,"error",ki));default:return Ai("invalid emulation state")}}),h(Bi,"state",ki)),ya=r((function(t,e){if(e.$){var r=e.a;return Ar(r)}var n=e.a;return Tr(t(n))})),wa=Zt("onEmulationStateChange_",Mi),Aa=r((function(t,e){return e.$?t:e.a})),ka=function(t){return wa(h(ms,Oi(ma),h(ms,ya(t),Aa(pi))))},Ea=h(wi,(function(t){switch(t){case"pause":return xn(0);case"reset":return xn(1);case"fullscreen":return xn(2);default:return Ai("invalid input driver event")}}),ki),xa=Zt("onInputDriverEvent_",Mi),Ta=function(t){return xa(h(ms,Oi(Ea),h(ms,ya(t),Aa(pi))))},Ca=n((function(t,e,r){return t(e(r))})),Sa=Zt("onNewCartridges_",Mi),Ra=Zt("onUpdateGamepadCount_",Ci),Ia=Ra,Ba=Zt("onMediaUpdate_",Gi(yi)),Oa=Ba,Pa=Oa(h(ms,Vs,h(ms,Xs((function(t){return{$:2,a:t?0:1}})),Zs(pi)))),Ma={$:4},Da=function(t){return{$:9,a:t}},Fa={$:31},La=null,ja=Yt("addCartridge_",(function(t){return La})),Na=ja(0),Ua=Yt("blurCurrentElement_",(function(t){return La})),za=Ua(0),$a=r((function(t,e){for(;;){if(!e.b)return!1;var r=e.a,n=e.b;if(t(r))return!0;t=t,e=n}})),Ha=function(t){return!t},Wa=r((function(t,e){return!h($a,h(Ca,Ha,t),e)})),qa=function(t){return t.toUpperCase()},Ga=function(t){return S(t.trim().split(/\s+/g))},Va=r((function(t,e){var r=Ga(qa(t));return h(Gs,(function(t){return h(Wa,(function(e){return h(On,e,qa(t.aB))}),r)}),e)})),Xa=function(t){return h(Va,t.cO,t.aS)},Ka=Yt("deleteAllCartridges_",(function(t){return La})),Ya=Ka(0),Ja=Yt("deleteCartridge_",ra),Qa=Ja,Za=r((function(t,e){for(;;){if(!e.b)return Rr;var r=e.a,n=e.b;if(t(r))return Sr(r);t=t,e=n}})),to=B,eo=r((function(t,e){var r=h(to,h(ms,(function(t){return t.aB}),qa),t),n=function(t){if(t.b&&t.b.b){var i=t.a,s=t.b,a=s.a,o=s.b;return g(i.S,e)?Sr(a):n(h(vr,a,o))}return Vs(r)};return n(E(r,E(r,r)))})),ro=vi(x),no=Yt("pauseEmulation_",(function(t){return La})),io=no(0),so=r((function(t,e){var r=h(to,h(ms,(function(t){return t.aB}),qa),t),n=function(t){if(t.b&&t.b.b){var i=t.a,s=t.b,a=s.a,o=s.b;return g(a.S,e)?Sr(i):n(h(vr,a,o))}return Vs(Kr(r))};return n(E(r,E(r,r)))})),ao=Qe,oo=Yt("resetEmulation_",(function(t){return La})),uo=oo(0),co=Yt("resumeEmulation_",(function(t){return La})),ho=co(0),lo=Yt("saveCartridge_",ra),fo=lo,po=Yt("scrollIntoView_",(function(t){var e=t.a,r=t.b;return h(ea,Rn,S([ra(e),ra(r)]))})),_o=r((function(t,e){var r=function(){switch(t){case 0:return"start";case 1:return"center";case 2:return"end";default:return"nearest"}}();return po(w(r,e))})),go=Yt("scrollToTop_",(function(t){return La})),bo=go(0),vo=function(t){return l(ms,qs((function(e){return h(Za,(function(t){return g(t.S,e)}),Xa(t))})),Xs((function(t){return t.S})),t.cX)},mo=At,yo=Yt("setLimitFramerate_",mo),wo=yo,Ao=function(t){return ra(t?"amateur":"pro")},ko=function(t){return l(Lr,r((function(t,e){var r=t.a,n=t.b;return l(kt,r,n,e)})),{},t)},Eo=function(t){return ko(S([w("difficultyP0",Ao(t.c2)),w("difficultyP1",Ao(t.c3)),w("color",(e=t.cU,ra(e?"bw":"color")))]));var e},xo=Yt("startEmulation_",Rn),To=r((function(t,e){return xo(ko(S([w("hash",ra(t)),w("switches",Eo(e))])))})),Co=Yt("stopEmulation_",(function(t){return La})),So=Co(0),Ro=Yt("toggleFullscreen_",(function(t){return La})),Io=Ro(0),Bo=function(t){return ra(1===t?"pcm":"waveform")},Oo=function(t){return ra(t?"instruction":"cycle")},Po=i((function(t,e,r,n){return h(Zs,n,h(Xs,(function(r){return h(vr,w(t,e(r)),n)}),r))})),Mo=function(t){switch(t){case 0:return ra("pal");case 1:return ra("ntsc");default:return ra("secam")}},Do=At,Fo=Yt("updateCartridge_",Rn),Lo=function(t){return Fo(ko(f(Po,"phosphorLevel",Do,(e=t).dM,f(Po,"audioEmulation",Bo,e.cL,f(Po,"cpuEmulation",Oo,e.cW,f(Po,"firstVisibleLine",Do,e.bR,f(Po,"rngSeed",Do,e.ck,S([w("hash",ra(e.S)),w("name",ra(e.aB)),w("cartridgeType",ra(e.bH)),w("tvMode",Mo(e.cx)),w("emulatePaddles",mo(e.bN)),w("volume",Do(e.eg))]))))))));var e},jo=n((function(t,e,r){switch(e.$){case 0:var n=e.a;return A(r,{aB:n});case 1:var i=e.a,s=h(Zs,r.bH,h(Xs,(function(t){return t.dn}),h(Za,(function(t){return g(t.dn,i)}),t)));return A(r,{bH:s});case 2:var a=e.a;return A(r,{cx:a});case 3:var o=e.a;return A(r,{bN:o});case 4:var u=e.a,c=h(qs,(function(t){return t>=0?Sr(t):r.ck}),u);return A(r,{ck:c});case 5:var l=e.a,f=h(qs,(function(t){return t>=0&&t<100?Sr(t):r.bR}),l);return A(r,{bR:f});case 6:var d=e.a;return A(r,{cW:d});case 7:d=e.a;return A(r,{cL:d});case 8:var p=e.a;return A(r,{eg:p});default:var _=e.a;return A(r,{dM:_})}})),No=Yt("updateConsoleSwitches_",Rn),Uo=h(ms,Eo,No),zo=function(t){return ra(1===t?"wide":"narrow")},$o=function(t){switch(t){case 0:return ra("qis");case 1:return ra("bilinear");default:return ra("none")}},Ho=function(t){switch(t){case 0:return ra("composite");case 1:return ra("svideo");default:return ra("none")}},Wo=At,qo=Yt("updateSettings_",Rn),Go=h(ms,(function(t){return ko(f(Po,"uiMode",zo,t.eb,f(Po,"touchControls",mo,t.d9,S([w("cpuEmulation",Oo(t.cW)),w("volume",Do(t.eg)),w("audioEmulation",Bo(t.cL)),w("gammaCorrection",Wo(t.de)),w("tvEmulation",Ho(t.ea)),w("scaling",$o(t.dU)),w("phosphorLevel",Do(t.dM)),w("scanlineIntensity",Do(t.dV)),w("leftHanded",mo(t.$7)),w("virtualJoystickSensitivity",Do(t.ef)),w("uiSize",Do(t.cy))]))))}),qo),Vo=S([50,75,100,125,150]),Xo=n((function(t,e,r){switch(t.$){case 0:var n=t.a;return A(r,{cW:n});case 1:var i=t.a;return A(r,{eg:i});case 2:var s=t.a;return A(r,{cL:s});case 3:var a=t.a;return A(r,{de:a});case 4:var o=t.a;return A(r,{ea:o});case 5:var u=t.a;return A(r,{dU:u});case 6:var c=t.a;return A(r,{dM:c});case 7:var l=t.a;return A(r,{dV:l});case 8:var f=t.a;return A(r,{d9:f});case 9:var d=t.a;return A(r,{$7:d});case 10:var p=t.a;return A(r,{ef:p});case 11:var _=t.a;return A(r,{eb:_});case 12:var g=t.a;return h(Zs,r,h(Xs,(function(t){return A(r,{cy:t})}),h(Za,ln(g),Vo)));default:return e}})),Ko=r((function(t,e){t:for(;;){var i=function(t){return w(A(e,{cX:t}),h(Zs,ro,h(Xs,_o(3),t)))},s=function(t){return w(t,ro)};switch(t.$){case 0:var a=t.a;return w(e,h(ao,e.dn,a));case 1:var o=t.a,u=function(){var t=w(o,vo(e));if(t.a||t.b.$)return S([bo]);var r=t.b.a;return e.cY?S([h(_o,1,r)]):x}(),c=A(e,{cY:o,dZ:2===o,d_:!1}),f=(Y=void 0,2!==(Y=w(o,e.c6)).a||Y.b?S([io]):S([ho]));return w(c,vi(E(u,f)));case 2:var d=t.a,p=function(){var t=w(e.cY,vo(e));if(t.a||t.b.$)return ro;var r=t.b.a;return h(_o,1,r)}();return w(A(e,{cP:0,ds:Sr(d)}),p);case 7:var _=t.a;return w(c=A(e,{cO:_}),bo);case 8:p=function(){var t=e.ds;if(t.$||t.a)return h(Zs,ro,h(Xs,_o(3),e.cX));t.a;return bo}();return w(A(e,{cO:""}),p);case 9:var b=t.a;return i(Sr(b));case 10:b=t.a;return i(h(Xs,(function(t){return t.S}),h(eo,Xa(e),b)));case 11:b=t.a;return i(h(Xs,(function(t){return t.S}),h(so,Xa(e),b)));case 12:return i(h(Xs,(function(t){return t.S}),Vs(Xa(e))));case 13:return i(h(Xs,(function(t){return t.S}),Vs(Kr(Xa(e)))));case 14:return s(A(e,{cX:Rr}));case 15:b=t.a;var v=g(e.cX,Sr(b))?h(Xs,(function(t){return t.S}),h(eo,Xa(e),b)):e.cX;p=g(v,e.cX)?ro:h(Zs,ro,h(Xs,_o(3),v));return w(A(e,{cP:0,aS:h(Gs,(function(t){return!g(t.S,b)}),e.aS),cX:v}),vi(S([p,Qa(b)])));case 16:return w(A(e,{aS:x,cX:Rr}),Ya);case 17:b=t.a;var m=t.b,y=h(Jn,(function(t){return g(t.S,b)?l(jo,e.aR,m,t):t}),e.aS);p=h(Zs,ro,h(Xs,Lo,h(Za,h(Ca,ln(b),(function(t){return t.S})),y)));return w(A(e,{aS:y}),p);case 3:var k=t.a;return s(A(e,{dg:Sr(k)}));case 4:k=t.a;return s(A(e,{cS:Sr(k)}));case 5:k=t.a;return s(A(e,{dp:Sr(k)}));case 6:return s(A(e,{d_:!e.d_}));case 18:var T=t.a,C=(K=void 0,1!==(K=w(T,e.cX)).a||K.b.$?0:1);p=function(){var t,r,n,i=(t=C,r=e.cP,n=vo(e),{a:t,b:r,c:n});e:for(;;){if(i.a){if(i.b)break e;return bo}if(1!==i.b||i.c.$)break e;var s=i.c.a;return h(_o,1,s)}return ro}();return w(A(e,{cP:C}),p);case 19:return w(e,Na);case 20:var R=t.a,I=A(e,{cO:"",aS:(X=l(Lr,r((function(t,e){return l(hs,t.S,t,e)})),rs,E(e.aS,R)),l(mr,n((function(t,e,r){return h(vr,e,r)})),x,X))});if(R.b){var B=R.a;t=Da(B.S),e=I;continue t}return s(I);case 21:b=t.a;return w(e,fo(b));case 22:var O=t.a,P=l(Xo,O,e.aT,e.aG),M=g(e.aG.cy,P.cy)?ro:sa(P.cy);return w(A(e,{aG:P}),vi(S([Go(P),M])));case 23:var D=t.a,F=t.b,L=t.c;return s(A(e,{du:w(Sr(L),h(fi,D,F))}));case 24:D=t.a;var j=t.b;L=t.c;return s(A(e,{du:w(Sr(L),h(li,D,j))}));case 25:return s(A(e,{du:w(Rr,e.du.b)}));case 26:c=A(e,{du:w(Rr,e.du.b)});return h(Zs,s(c),h(Xs,(function(t){return h(Ko,t,c)}),e.du.a));case 27:b=t.a;return w(A(e,{c6:!1,c7:Ma,dS:Sr(b)}),vi(S([h(To,b,e.cV),h(ao,e.dn,ta(2))])));case 29:return w(e,So);case 28:return w(e,io);case 30:return w(e,uo);case 31:var N=!e.c6;c=A(e,{c6:N,dZ:!1}),p=N?io:ho;switch(e.c7.$){case 1:case 2:return w(c,p);default:return w(e,ro)}case 33:var U=t.a,z=(V=void 0,4!==(V=w(e.c7,U)).a.$||V.b.$?U:Ma);return s(A(e,{c7:z}));case 34:switch(t.a){case 0:t=Fa,e=e;continue t;case 1:return w(e,uo);default:return w(e,Io)}case 32:var $=t.a;return w(A(e,{dq:$}),wo($));case 35:var H=t.a,W=A(e.cV,{c2:H});return w(A(e,{cV:W}),Uo(W));case 36:H=t.a,W=A(e.cV,{c3:H});return w(A(e,{cV:W}),Uo(W));case 37:var q=t.a;W=A(e.cV,{cU:q});return w(A(e,{cV:W}),Uo(W));case 38:return w(e,za);case 39:return w(e,h(ao,e.dn,ta(4)));case 40:var G=t.a;return w(A(e,{aW:G}),ro);default:return s(e)}}var V,X,K,Y})),Yo=n((function(t,e,r){return{$:0,a:t,b:e,c:r}})),Jo=n((function(t,e,r){return{$:0,a:t,b:e,c:r}})),Qo=function(t){return{$:0,a:t}},Zo=r((function(t,e){return{$:0,a:t,b:e}})),tu=r((function(t,e){var r=h(Zo,t,x),n=l(Yo,r,x,Rr);return S([Qo(l(Jo,n,x,e))])})),eu=tu("body"),ru=function(t){return{$:0,a:t}},nu=r((function(t,e){return ru(t+":"+e)})),iu=r((function(t,e){return h(nu,t,e.E)})),su=iu("font-size"),au=function(t){return!t.b},ou=r((function(t,e){var r=e.a,n=e.b;switch(t.$){case 0:var i=t.a.c;return au(i)?w(r,n):w(r,h(vr,t,n));case 1:var s=t.b;return h(Wa,(function(t){var e=t.c;return au(e)}),s)?w(r,n):w(r,h(vr,t,n));case 2:var a=t.b;return au(a)?w(r,n):w(r,h(vr,t,n));case 3:return w(r,h(vr,t,n));case 4:i=t.b;return au(i)?w(r,n):w(r,h(vr,t,n));case 5:i=t.a;return au(i)?w(r,n):w(r,h(vr,t,n));case 6:var o=t.a;return Ln(o.c_)?w(r,n):w(l(hs,o.aB,o.c_,r),n);case 7:i=t.a;return au(i)?w(r,n):w(r,h(vr,t,n));case 8:i=t.a;return au(i)?w(r,n):w(r,h(vr,t,n));default:var u=t.a;return h(Wa,(function(t){var e=t.b;return au(e)}),u)?w(r,n):w(r,h(vr,t,n))}})),uu=function(t){return{$:6,a:t}},cu=r((function(t,e){return e.b?l(Yn,vr,e,t):t})),hu=r((function(t,e){return h(cu,h(Jn,(function(t){var e=t.a,r=t.b;return uu({c_:r,aB:e})}),yr(t)),e)})),lu=function(t){return h(Zs,"",h(Xs,(function(t){return'@charset "'+t+'"'}),t))},fu=function(t){return"("+t.bQ+h(Zs,"",h(Xs,Br(": "),t.E))+")"},du=function(t){var e=n((function(t,e,r){return t+" "+h(Mr," and ",h(vr,function(t){switch(t){case 0:return"print";case 1:return"screen";default:return"speech"}}(e),h(Jn,fu,r)))}));switch(t.$){case 0:var r=t.a;return h(Mr," and ",h(Jn,fu,r));case 1:return l(e,"only",t.a,r=t.b);case 2:return l(e,"not",t.a,r=t.b);default:return t.a}},pu=r((function(t,e){return'@import "'+t+du(e)+'"'})),_u=function(t){var e=t.a,r=t.b;return h(Mr,"\n",h(Jn,pu(e),r))},gu=function(t){return"@namespace "+t.a+'"'+t.b+'"'},bu="    ",vu=function(t){return E(bu,t)},mu=function(t){return t+";"},yu=function(t){return h(Mr,"\n",h(Jn,h(Ca,vu,mu),t))},wu=H,Au=function(t){return"::"+t},ku=function(t){switch(t){case 0:return"+";case 1:return"~";case 2:return">";default:return""}},Eu=function(t){switch(t.$){case 0:return"."+t.a;case 1:return"#"+t.a;case 2:return":"+t.a;default:return"["+t.a+"]"}},xu=function(t){switch(t.$){case 0:var e=t.a,r=t.b;return h(Mr,"",h(vr,e,h(Jn,Eu,r)));case 1:r=t.a;return au(r)?"*":h(Mr,"",h(Jn,Eu,r));default:e=t.a,r=t.b;return h(Mr,"",h(vr,e,h(Jn,Eu,r)))}},Tu=function(t){var e=t.a,r=t.b;return h(Mr," ",S([ku(e),xu(r)]))},Cu=function(t){var e=t.a,r=t.b,n=t.c,i=h(vr,xu(e),h(Jn,Tu,r)),s=h(Mr,"",S([h(Zs,"",h(Xs,Au,n))]));return h(wu,h(Mr," ",h(Gs,h(Ca,Ha,Ln),i)),s)},Su=r((function(t,e){var r=e.a,n=e.b,i=e.c,s=h(Mr,", ",h(Jn,Cu,h(vr,r,n)));return h(Mr,"",S([s," {\n",t,yu(i),"\n",t,"}"]))})),Ru=function(t){switch(t.$){case 0:var e=t.a;return h(Su,"",e);case 1:var r=t.a,n=t.b;return"@media "+h(Mr,",\n",h(Jn,du,r))+" {\n"+h(Mr,"\n\n",h(Jn,h(Ca,vu,Su(bu)),n))+"\n}";case 2:case 3:case 4:case 5:return"TODO";case 6:return"@keyframes "+t.a.aB+" {\n"+t.a.c_+"\n}";case 7:case 8:default:return"TODO"}},Iu=function(t){return l(Yn,cu,x,t)},Bu=r((function(t,e){return Iu(h(Jn,t,e))})),Ou=function(t){return{$:8,a:t}},Pu=function(t){return{$:5,a:t}},Mu=r((function(t,e){return{$:4,a:t,b:e}})),Du=n((function(t,e,r){return{$:0,a:t,b:e,c:r}})),Fu=function(t){return{$:0,a:t}},Lu=r((function(t,e){return{$:2,a:t,b:e}})),ju=function(t){return{$:7,a:t}},Nu=r((function(t,e){return{$:1,a:t,b:e}})),Uu=r((function(t,e){if(e.b){if(e.b.b){var r=e.a,n=e.b;return h(vr,r,h(Uu,t,n))}return S([t(e.a)])}return e})),zu=r((function(t,e){var r=e.a,n=e.b,i=e.c;return l(Du,r,n,E(i,S([t])))})),$u=r((function(t,e){if(!e.b)return e;if(e.b.b){var r=e.a,n=e.b;return h(vr,r,h($u,t,n))}switch(e.a.$){case 0:var i=e.a.a;return S([Fu(h(zu,t,i))]);case 1:var s=e.a,a=s.a,o=s.b;return S([h(Nu,a,h(Uu,zu(t),o))]);default:return e}})),Hu=r((function(t,e){if(e.b.b){var r=e.a,n=e.b,i=(o=e.c,h(Jn,t,n)),s=t(r);return S([l(Du,r,n,o),l(Du,s,i,x)])}var a=e.a,o=e.c;return S([l(Du,a,x,o),l(Du,t(a),x,x)])})),Wu=r((function(t,e){var r=e.a,n=e.b;return l(Yo,r,n,Sr(t))})),qu=r((function(t,e){return h(Hu,Wu(t),e)})),Gu=r((function(t,e){return{$:2,a:t,b:e}})),Vu=function(t){return{$:1,a:t}},Xu=r((function(t,e){switch(e.$){case 0:var r=e.a,n=e.b;return h(Zo,r,E(n,S([t])));case 1:n=e.a;return Vu(E(n,S([t])));default:var i=e.a;n=e.b;return h(Gu,i,E(n,S([t])))}})),Ku=r((function(t,e){if(e.b){if(e.b.b){var r=e.a,n=e.b;return h(vr,r,h(Ku,t,n))}var i=e.a,s=i.a,a=i.b;return S([w(s,h(Xu,t,a))])}return x})),Yu=r((function(t,e){if(e.b.b){var r=e.a,n=e.b;s=e.c;return l(Yo,r,h(Ku,t,n),s)}var i=e.a,s=e.c;return l(Yo,h(Xu,t,i),x,s)})),Ju=r((function(t,e){return h(Hu,Yu(t),e)})),Qu=function(t){t:for(;;){if(t.b){if(t.a.$){t=i=t.b;continue t}var e=t.a.a,r=e.a,n=e.b,i=t.b;return E(h(vr,r,n),Qu(i))}return x}},Zu=s((function(t,e,r,n,i){return{$:3,a:t,b:e,c:r,d:n,e:i}})),tc=r((function(t,e){t:for(;;){if(!e.b)return e;if(e.b.b)break t;switch(e.a.$){case 0:var r=e.a.a;return h(Jn,Fu,t(r));case 1:if(e.a.b.b){if(e.a.b.b.b){var n=e.a,i=(p=n.a,n.b),s=i.a,a=i.b,o=h(tc,t,S([h(Nu,p,a)]));if(o.b&&1===o.a.$&&!o.b.b){var u=o.a,c=u.a,l=u.b;return S([h(Nu,c,h(vr,s,l))])}return o}var d=e.a,p=d.a;r=d.b.a;return S([h(Nu,p,t(r))])}break t;case 2:var _=e.a,g=_.a,b=_.b;return S([h(Lu,g,h(tc,t,b))]);case 3:var v=e.a,m=v.a,y=v.b,w=v.c,A=v.d;r=v.e;return h(Jn,f(Zu,m,y,w,A),t(r));case 4:e.a;return e;case 5:case 6:case 7:case 8:default:return e}}s=e.a,a=e.b;return h(vr,s,h(tc,t,a))})),ec=$,rc=i((function(t,e,r,n){return{ac:n,S:r,v:e,am:t}})),nc=3432918353,ic=461845907,sc=r((function(t,e){return(65535&e)*t+(((e>>>16)*t&65535)<<16)})),ac=r((function(t,e){return e<<t|e>>>32-t})),oc=q,uc=r((function(t,e){return h(sc,5,h(ac,13,t^h(sc,ic,h(ac,15,h(sc,nc,e)))))+3864292196})),cc=r((function(t,e){var r=e.S|(255&Hr(t))<<e.am;return 24===e.am?{ac:e.ac+1,S:0,v:h(uc,e.v,r),am:0}:{ac:e.ac+1,S:r,v:e.v,am:e.am+8}})),hc=r((function(t,e){return r=l(oc,cc,f(rc,0,t,0,0),e),n=(r.S?r.v^h(sc,ic,h(ac,15,h(sc,nc,r.S))):r.v)^r.ac,i=h(sc,2246822507,n^n>>>16),((s=h(sc,3266489909,i^i>>>13))^s>>>16)>>>0;var r,n,i,s})),lc=function(t){return R(t).join("")},fc=F,dc=function(t){t:for(;;)switch(t){case 0:return"0";case 1:return"1";case 2:return"2";case 3:return"3";case 4:return"4";case 5:return"5";case 6:return"6";case 7:return"7";case 8:return"8";case 9:return"9";case 10:return"a";case 11:return"b";case 12:return"c";case 13:return"d";case 14:return"e";case 15:return"f";default:t=t;continue t}},pc=r((function(t,e){for(;;){if(e<16)return h(vr,dc(e),t);t=h(vr,dc(h(fc,16,e)),t),e=e/16|0}})),_c=function(t){return lc(t<0?h(vr,"-",h(pc,x,-t)):h(pc,x,t))},gc=function(t){t:for(;;){if(t.b){if(t.b.b){t=t.b;continue t}var e=t.a;return Sr(S([e]))}return Rr}},bc=function(t){var e,r=function(t){if(t.b){var e=t.a,n=t.b;return h(vr,e,r(n))}return x},n=r(t);return S([(e=n,{$:9,a:e})])},vc=function(t){return S([t])},mc=r((function(t,e){if(e.$)return e;var r=e.a;return h(Nu,t,S([r]))})),yc=function(t){if(t.b){t.a;var e=t.b;return Sr(e)}return Rr},wc=n((function(t,e,r){for(;;){if(t<=0)return r;if(!e.b)return r;var n=e.a;t=t-1,e=e.b,r=h(vr,n,r)}})),Ac=r((function(t,e){return Kr(l(wc,t,e,x))})),kc=n((function(t,e,r){if(e<=0)return x;var n=w(e,r);t:for(;;){e:for(;;){if(!n.b.b)return r;if(!n.b.b.b){if(1===n.a)break t;break e}switch(n.a){case 1:break t;case 2:var i=n.b;return S([a=i.a,f=i.b.a]);case 3:if(n.b.b.b.b){var s=n.b,a=s.a,o=s.b;return S([a,f=o.a,p=o.b.a])}break e;default:if(n.b.b.b.b&&n.b.b.b.b.b){var u=n.b,a=u.a,c=u.b,f=c.a,d=c.b,p=d.a,_=d.b,g=_.a,b=_.b;return h(vr,a,h(vr,f,h(vr,p,h(vr,g,t>1e3?h(Ac,e-4,b):l(kc,t+1,e-4,b)))))}break e}}return r}return S([a=n.b.a])})),Ec=r((function(t,e){return l(kc,0,t,e)})),xc=s((function(t,e,r,n,i){if(i.$)return i;var s=i.a;return d(Zu,t,e,r,n,s)})),Tc=r((function(t,e){switch(e.$){case 0:var r=e.a;return h(Nu,t,S([r]));case 1:var n=e.a,i=e.b;return h(Nu,E(t,n),i);case 2:var s=e.a,a=e.b;return h(Lu,s,h(Jn,Tc(t),a));case 3:var o=e.a,u=e.b,c=e.c,l=e.d;r=e.e;return d(Zu,o,u,c,l,r);case 4:case 5:case 6:case 7:case 8:default:return e}})),Cc=function(t){return t},Sc=i((function(t,e,r,n){var i=function(t){return h(Zs,x,yc(t))},s=h(Rc,e,h(Zs,x,gc(n))),a=function(){var t=w(Vs(s),function(t){t:for(;;){if(t.b){if(t.b.b){t=t.b;continue t}var e=t.a;return Sr(e)}return Rr}}(n));if(t.a.$||t.b.$)return n;var e=t.a.a,r=t.b.a;return E(h(Ec,jr(n)-1,n),S([g(r,e)?r:e]))}();return E(a,E(i(h(Zs,x,h(Xs,(function(e){return Iu(h(Uu,Rc(t),h(Jn,vc,h(tc,r,e))))}),gc(n)))),i(s)))})),Rc=r((function(t,e){if(!t.b)return e;switch(t.a.$){case 0:var n=t.a.a,i=t.b;return h(Rc,i,h($u,n,e));case 1:var s=t.a,a=s.a,o=s.b;i=t.b;return f(Sc,o,i,Ju(a),e);case 2:var u=t.a,c=u.a,d=u.b,p=(i=t.b,r((function(t,e){var r=t.a,n=t.b,i=t.c,s=e.a,a=e.b,o=e.c;return l(Yo,r,E(n,h(vr,w(c,s),a)),function(t){t:for(;;){if(t.b){var e=t.a,r=t.b;if(1===e.$){t=r;continue t}return e}return Rr}}(S([o,i])))})));return Iu(E(S([h(Rc,i,e)]),h(Jn,(function(t){switch(t.$){case 0:var r=t.a,n=r.a,i=r.b,s=r.c,a=h(Bu,(function(t){return h(Jn,p(t),h(vr,n,i))}),Qu(e)),o=function(){if(a.b){var t=a.a,e=a.b;return S([Fu(l(Du,t,e,x))])}return x}();return h(Rc,s,o);case 1:var u=t.a,c=t.b;return h(Oc,u,c);case 2:var d=t.a,_=t.b;return h(Pc,d,_);case 3:var g=t.a,b=t.b,v=t.c,m=t.d,y=t.e;return h(Jn,f(xc,g,b,v,m),Ic(y));case 4:d=t.a;var w=t.b;return S([h(Mu,d,w)]);case 5:w=t.a;return S([Pu(w)]);case 6:w=t.a;return S([ju(w)]);case 7:w=t.a;return S([Ou(w)]);default:var A=t.a;return bc(A)}}),h(Bu,Cc,d))));case 3:var _=t.a,g=_.a;o=_.b,i=t.b;return f(Sc,o,i,qu(g),e);case 5:var b=t.a.a,v=(i=t.b,function(t){return h(ec,"_",_c(h(hc,15739,t)))}(b)),m=h(Rc,i,h($u,"animation-name:"+v,e));return h(cu,m,S([uu({c_:b,aB:v})]));case 4:var y=t.a,A=y.a,k=(o=y.b,i=t.b,function(){var t=Qu(e);if(t.b){var r=t.a,n=t.b;return h(Jn,mc(A),h(Rc,o,vc(Fu(l(Du,r,n,x)))))}return x}());return E(h(Rc,i,e),k);default:var T=t.a.a;i=t.b;return h(Rc,E(T,i),e)}})),Ic=function(t){var e=t.a,r=t.b,n=t.c;return h(Rc,n,S([Fu(l(Du,e,r,x))]))},Bc=function(t){if(t.b){var e=t.a,r=t.b;return E(Mc(e),Bc(r))}return x},Oc=r((function(t,e){return h(Bu,(function(e){return h(Jn,Tc(t),Ic(e))}),e)})),Pc=r((function(t,e){var r=Bc(h(Bu,Cc,e));return S([h(Lu,t,r)])})),Mc=function(t){switch(t.$){case 0:var e=t.a;return Ic(e);case 1:var r=t.a,n=t.b;return h(Oc,r,n);case 2:var i=t.a,s=t.b;return h(Pc,i,s);case 3:var a=t.a,o=t.b,u=t.c,c=t.d;e=t.e;return h(Jn,f(xc,a,o,u,c),Ic(e));case 4:i=t.a;var l=t.b;return S([h(Mu,i,l)]);case 5:l=t.a;return S([Pu(l)]);case 6:l=t.a;return S([ju(l)]);case 7:l=t.a;return S([Ou(l)]);default:var d=t.a;return bc(d)}},Dc=function(t){return function(t){var e=t.bJ,r=t.bW,n=t.b2,i=t.c$;return h(Mr,"\n\n",h(Gs,h(Ca,Ha,Ln),S([lu(e),h(Mr,"\n",h(Jn,_u,r)),h(Mr,"\n",h(Jn,gu,n)),h(Mr,"\n\n",h(Jn,Ru,i))])))}(function(t){var e=t.bJ,r=t.bW,n=t.b2,i=t.c$,s=l(Yn,ou,w(rs,x),i),a=s.a,o=s.b;return{bJ:e,c$:h(hu,a,o),bW:r,b2:n}}((r=(e=t).bJ,n=e.bW,i=e.b2,s=e.co,{bJ:r,c$:Bc(h(Bu,Cc,s)),bW:n,b2:i})));var e,r,n,i,s},Fc=function(t){return h(Mr,"\n\n",h(Jn,Dc,t))},Lc=function(t){return ue(be(t))},jc=function(t){return{bJ:Rr,bW:x,b2:x,co:t}},Nc=ae,Uc=function(t){return{$:4,a:t}},zc=Uc,$c=function(t){return zc(l(Lc,"style",x,vc(Nc(Fc(vc(jc(t)))))))},Hc=iu("line-height"),Wc=function(t){return h(nu,"background-color",t.E)},qc=n((function(t,e,r){return{$:0,a:t,b:e,c:r}})),Gc=r((function(t,e){var r=l(Yo,e,x,Rr);return S([Qo(l(Jo,r,x,t))])})),Vc=r((function(t,e){return h(_e,function(t){return"innerHTML"==t||"formAction"==t?"data-"+t:t}(t),ve(e))})),Xc=function(t){var e=function(t){return au(t)?"unstyled":h(ec,"_",_c(h(hc,15739,Fc(vc(jc(vc(h(Gc,t,Vu(x)))))))))}(t),r=h(Vc,"className",ra(e));return l(qc,r,t,e)},Kc=iu("display"),Yc=n((function(t,e,r){return{$:0,a:t,b:e,c:r}})),Jc=Yc,Qc=Jc,Zc=Qc("div"),th={av:0,aE:0,a9:0,E:"fixed"},eh=iu("height"),rh=function(t){return{J:0,aX:0,U:0,C:0,dH:0,a$:0,L:t,ar:"",aL:0,E:Pr(t)}},nh=iu("left"),ih={aa:0,bD:0,r:0,a:0,g:0,di:0,bY:0,bi:0,ak:0,T:0,C:0,c:0,b:0,bm:0,a1:0,dN:0,A:0,a4:0,dW:0,ao:0,Y:0,w:0,e:0,ed:0,E:"none"},sh=iu("position"),ah=et,oh=n((function(t,e,r){return{bw:0,bG:0,af:0,o:0,az:0,ai:0,K:0,aj:0,ak:0,T:0,U:0,C:0,L:r,ap:0,ar:e,aL:t,E:E(ah(r),e)}})),uh=h(oh,0,"px"),ch=r((function(t,e){return t+"("+h(Mr,", ",e)+")"})),hh=i((function(t,e,r,n){return{au:n,aw:r,cU:0,ay:e,aF:t,E:h(ch,"rgba",E(h(Jn,Pr,S([t,e,r])),S([ah(n)])))}})),lh=iu("top"),fh=h(oh,0,"vh"),dh=h(oh,0,"vw"),ph=iu("width"),_h=iu("z-index"),gh=function(t){var e=t?x:S([Kc(ih)]);return h(Zc,S([Xc(E(e,S([sh(th),lh(uh(0)),nh(uh(0)),ph(dh(100)),eh(fh(100)),_h(rh(100)),Wc(f(hh,0,0,0,.5))])))]),x)},bh=iu("center"),vh={$:26},mh={$:25},yh=h(nu,"display","flex"),wh=h(oh,0,"em"),Ah=iu("flex-end"),kh=function(t){return{$:6,a:t}},Eh=r((function(t,e){return ru(t+":"+e)})),xh=n((function(t,e,r){t:for(;;)switch(r.$){case 0:var n=r.a,i=h(Zs,"",Vs(h(Dr,":",n)));return h(Eh,e,i);case 1:r.a;return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-inapplicable-Style-for-selector");case 2:r.a;return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-inapplicable-Style-for-combinator");case 3:r.a;return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-inapplicable-Style-for-pseudo-element setter");case 4:return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-inapplicable-Style-for-media-query");case 5:return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-inapplicable-Style-for-keyframes");default:if(r.a.b){if(r.a.b.b){var s=r.a,a=(s.a,s.b);t=t,e=e,r=kh(a);continue t}t=t,e=e,r=r.a.a;continue t}return h(Eh,e,"elm-css-error-cannot-apply-"+t+"-with-empty-Style")}})),Th=l(oh,0,"",0),Ch=function(t){return l(xh,"justifyContent","justify-content",t(Th))},Sh=iu("padding-top"),Rh=r((function(t,e){return l(qc,h(Vc,t,e),x,"")})),Ih=r((function(t,e){return h(Rh,t,ra(e))})),Bh=Ih("className"),Oh=Bh("panel"),Ph=Qc("button"),Mh=pe,Dh=r((function(t,e){return l(qc,h(Mh,t,e),x,"")})),Fh=r((function(t,e){return h(Dh,t,{$:3,a:e})})),Lh=Z,jh=function(t){return t.toLowerCase()},Nh=r((function(t,e){return{$:1,a:t,b:e}})),Uh=r((function(t,e){if(e.b){if(e.b.b){var r=e.a,n=e.b;return h(vr,r,h(Uh,t,n))}var i=e.a;return S([h(zh,t,i)])}return e})),zh=r((function(t,e){switch(e.$){case 0:var r=e.a;return ru(t(r));case 1:var n=e.a,i=e.b;return h(Nh,n,h(Uh,t,i));case 2:case 3:case 4:case 5:return e;default:var s=e.a;return kh(h(Uu,zh(t),s))}})),$h=zh((function(t){return h(Lh," !important",jh(t))?t:t+" !important"})),Hh={g:0,E:"inline-block"},Wh=function(t){return Nh({$:2,a:t})},qh=Qc("span"),Gh=function(t){return Uc(Nc(t))},Vh=n((function(t,e,r){return h(qh,S([Xc(S([Kc(Hh),h(Wh,"not(:last-child)",S([h(nu,"margin-right","var(--cw)")]))])),h(Fh,"click",xn({dt:e,dO:!0,d2:!0}))]),S([h(Ph,h(vr,Xc(S([$h(h(nu,"margin-right","var(--cw)"))])),t),S([Gh(r)]))]))})),Xh=r((function(t,e){return h(Dh,t,{$:0,a:e})})),Kh=function(t){return h(Xh,"click",xn(t))},Yh=i((function(t,e,r,n){return t?h(Ph,h(vr,Kh(r),e),S([Gh(n)])):l(Vh,e,r,n)})),Jh=iu("space-between"),Qh=r((function(t,e){var r=(t.b.$,t.b.a);return h(Zc,S([Oh,Xc(S([ph(dh(100)),h(nu,"max-width","calc(80*var(--cw))")]))]),S([h(Zc,x,S([Gh(r)])),function(r){if(1===t.b.$){var n=t.b.b;return h(Zc,S([Xc(E(S([yh,Ch(Ah)]),r))]),S([f(Yh,e,S([Xc(S([h(nu,"width","calc(8*var(--cw))")]))]),vh,n)]))}var i=t.b.b,s=i.a,a=i.b,o="calc("+Pr(4+h(pn,Pn(s),Pn(a)))+"*var(--cw))";return h(Zc,S([Xc(E(S([yh,Ch(Jh)]),r))]),S([f(Yh,e,S([Xc(S([h(nu,"width",o)]))]),mh,a),f(Yh,e,S([Xc(S([h(nu,"width",o)]))]),vh,s)]))}(S([Sh(wh(2))]))]))})),Zh={r:0,al:0,E:"hidden",aN:0},tl=h(oh,0,"%"),el=h(Ca,iu("transform"),(function(t){return au(t)?{E:"none"}:{E:h(Mr," ",h(Jn,(function(t){return t.E}),t))}})),rl=function(t){return el(S([t]))},nl=r((function(t,e){return{aO:t,aU:Rr,bM:e,ba:Rr}})),il=nl(89),sl=function(t){switch(t){case 0:return"background";case 1:return"background-color";case 2:return"background-position";case 3:return"background-size";case 4:return"border";case 5:return"border-bottom";case 6:return"border-bottom-color";case 7:return"border-bottom-left-radius";case 8:return"border-bottom-right-radius";case 9:return"border-bottom-width";case 10:return"border-color";case 11:return"border-left";case 12:return"border-left-color";case 13:return"border-left-width";case 14:return"border-radius";case 15:return"border-right";case 16:return"border-right-color";case 17:return"border-right-width";case 18:return"border-top";case 19:return"border-top-color";case 20:return"border-top-left-radius";case 21:return"border-top-right-radius";case 22:return"border-top-width";case 23:return"border-width";case 24:return"bottom";case 25:return"box-shadow";case 26:return"caret-color";case 27:return"clip";case 28:return"clip-path";case 29:return"color";case 30:return"column-count";case 31:return"column-gap";case 32:return"column-rule";case 33:return"column-rule-color";case 34:return"column-rule-width";case 35:return"column-width";case 36:return"columns";case 37:return"filter";case 38:return"flex";case 39:return"flex-basis";case 40:return"flex-grow";case 41:return"flex-shrink";case 42:return"font";case 43:return"font-size";case 44:return"font-size-adjust";case 45:return"font-stretch";case 46:return"font-variation-settings";case 47:return"font-weight";case 48:return"grid-column-gap";case 49:return"grid-gap";case 50:return"grid-row-gap";case 51:return"height";case 52:return"left";case 53:return"letter-spacing";case 54:return"line-height";case 55:return"margin";case 56:return"margin-bottom";case 57:return"margin-left";case 58:return"margin-right";case 59:return"margin-top";case 60:return"mask";case 61:return"mask-position";case 62:return"mask-size";case 63:return"max-height";case 64:return"max-width";case 65:return"min-height";case 66:return"min-width";case 67:return"object-position";case 68:return"offset";case 69:return"offset-anchor";case 70:return"offset-distance";case 71:return"offset-path";case 72:return"offset-rotate";case 73:return"opacity";case 74:return"order";case 75:return"outline";case 76:return"outline-color";case 77:return"outline-offset";case 78:return"outline-width";case 79:return"padding";case 80:return"padding-bottom";case 81:return"padding-left";case 82:return"padding-right";case 83:return"padding-top";case 84:return"right";case 85:return"tab-size";case 86:return"text-indent";case 87:return"text-shadow";case 88:return"top";case 89:return"transform";case 90:return"transform-origin";case 91:return"vertical-align";case 92:return"visibility";case 93:return"width";case 94:return"word-spacing";default:return"z-index"}},al=function(t){return ah(t)+"ms"},ol=function(t){switch(t.$){case 0:return"ease";case 1:return"linear";case 2:return"ease-in";case 3:return"ease-out";case 4:return"ease-in-out";case 5:return"step-start";case 6:return"step-end";default:var e=t.a,r=t.b,n=t.c,i=t.d;return"cubic-bezier("+ah(e)+" , "+ah(r)+" , "+ah(n)+" , "+ah(i)+")"}},ul=function(t){var e=l(Mn,0,-1,l(Lr,r((function(t,e){var r=t.aO,n=t.bM,i=t.aU,s=t.ba;return e+(h(Mr," ",S([sl(r),al(n),h(Zs,"",h(Xs,al,i)),h(Zs,"",h(Xs,ol,s))]))+",")})),"",t));return h(nu,"transition",e)},cl=function(t){var e=t.E;return{e:0,E:h(ch,"translateY",S([e]))}},hl=iu("visibility"),ll=nl(92),fl={al:0,A:0,E:"visible",aN:0},dl=r((function(t,e){var r=!t.a.$;return S([gh(r),h(Zc,S([Xc(E(S([sh(th),lh(uh(0)),nh(uh(0)),ph(dh(100)),_h(rh(150)),yh,Ch(bh),ul(S([il(300),ll(300)]))]),S(r?[rl(cl(tl(0))),hl(fl)]:[rl(cl(tl(-100))),hl(Zh)])))]),S([h(Qh,t,e)]))])})),pl=function(t){return"var(--"+function(){switch(t){case 0:return"black";case 1:return"blue";case 2:return"light-blue";case 3:return"green";case 4:return"light-green";case 5:return"cyan";case 6:return"light-cyan";case 9:return"magenta";case 10:return"light-magenta";case 7:return"red";case 8:return"light-red";case 11:return"dark-gray";case 12:return"light-gray";case 13:return"brown";case 14:return"yellow";default:return"white"}}()+")"},_l=function(t){return h(nu,"background-color",pl(t))},gl=function(t){return h(nu,"color",pl(t))},bl=function(t){return{$:2,a:t}},vl=s((function(t,e,r,n,i){return{cZ:r,bZ:e,b5:t,a3:n,a8:i}})),ml=function(t){return h(Mr,"",t)},yl=W,wl=function(t){return t<0?-t:t},Al=n((function(t,e,r){return t<=0?r:l(Al,t>>1,E(e,e),1&t?E(r,e):r)})),kl=r((function(t,e){return l(Al,t,e,"")})),El=r((function(t,e){var r=Pn(e),n=m(r,t)<0?wl(t-r):0;return E(e,h(kl,n,"0"))})),xl=r((function(t,e){return t<1?e:l(Mn,0,-t,e)})),Tl=r((function(t,e){return t<1?"":l(Mn,-t,Pn(e),e)})),Cl=function(t){return"0"!==h(Tl,1,t)?t:Cl(h(xl,1,t))},Sl=r((function(t,e){var r=t.cZ;switch(r.$){case 1:return Cl(e);case 2:return e;default:var n=r.a;return h(El,n,e)}})),Rl=G,Il=r((function(t,e){var r=h($a,(function(t){return"0"!==t&&"."!==t}),l(Rl,vr,x,e));return E(t&&r?"-":"",e)})),Bl=function(t){return t<0||1114111<t?"�":t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(Math.floor(t/1024)+55296,t%1024+56320))},Ol=function(t){var e=t.a,r=t.b;if("9"===e){var n=Yr(r);if(1===n.$)return"01";var i=n.a;return h(ec,"0",Ol(i))}var s=Hr(e);return s>=48&&s<57?h(ec,Bl(s+1),r):"0"},Pl=function(t){return t===1/0||t===-1/0},Ml=z,Dl=function(t){return h(ec,t,"")},Fl=n((function(t,e,r){return E(r,h(kl,t-Pn(r),Dl(e)))})),Ll=function(t){for(var e=t.length,r=new Array(e),n=0;n<e;){var i=t.charCodeAt(n);55296<=i&&i<=56319?(r[e-n]=t[n+1],r[e-++n]=t[n-1],n++):(r[e-n]=t[n],n++)}return r.join("")},jl=function(t){var e=h(Dr,".",t);return e.b?e.b.b?w(e.a,e.b.a):w(e.a,"0"):w("0","0")},Nl=r((function(t,e){var r=e.a,n=e.b;return w(t(r),n)})),Ul=n((function(t,e,r){if(Pl(r)||Ml(r))return ah(r);var n=r<0,i=jl(function(t){var e=h(Dr,"e",ah(wl(t)));if(e.b){if(e.b.b){var r=e.a,n=e.b.a,i=h(Zs,0,Nn(h(Wn,"+",n)?h(Dn,1,n):n)),s=jl(r),a=E(s.a,s.b),o=i<0?h(Zs,"0",h(Xs,(function(t){return t.a+"."+t.b}),h(Xs,Nl(Dl),Yr(E(h(kl,wl(i),"0"),a))))):l(Fl,i+1,"0",a);return E(t<0?"-":"",o)}return E(t<0?"-":"",r=e.a)}return""}(wl(r))),s=i.a,a=i.b,o=Pn(s)+e,u=E(h(kl,1-o,"0"),l(Fl,o,"0",E(s,a))),c=Pn(u),f=h(pn,1,o),d=h(t,n,l(Mn,f,c,u)),p=l(Mn,0,f,u),_=d?Ll(h(Zs,"1",h(Xs,Ol,Yr(Ll(p))))):p,g=Pn(_),b="0"===_?_:e<=0?E(_,h(kl,wl(e),"0")):m(e,Pn(a))<0?l(Mn,0,g-e,_)+"."+l(Mn,g-e,g,_):E(s+".",l(Fl,e,"0",a));return h(Il,n,b)})),zl=Ul(r((function(t,e){var r=Yr(e);if(1===r.$)return!1;if("5"===r.a.a)return""!==r.a.b||!t;var n=r.a.a;return function(e){return e>53&&t||e>=53&&!t}(Hr(n))}))),$l=r((function(t,e){var r=function(){var e=t.cZ;switch(e.$){case 1:var r=e.a;return zl(r);case 0:return ah;default:var n=e.a;return zl(n)}}(),n=h(Dr,".",r(e)),i=function(){var t=yc(n);if(t.$)return"";var e=t.a;return h(Zs,"",Vs(e))}();return w(h(Zs,"",Vs(n)),i)})),Hl=r((function(t,e){var r,n=h($l,t,e),i=function(t){var e=function(t){return Pn(t)>3?h(vr,h(Tl,3,t),e(h(xl,3,t))):S([t])};return Kr(e(t))}(h(yl,Vr,n.a)),s=h(Sl,t,n.b),a=d(vl,e,i,s,"","");switch(h(Ir,(function(t){return"0"===t}),ml(h(cu,(r=a).bZ,vc(r.cZ))))?1:r.b5<0?2:0){case 2:return A(a,{a3:t.a_,a8:t.bk});case 0:return A(a,{a3:t.b9,a8:t.ca});default:return A(a,{a3:t.cE,a8:t.cF})}})),Wl=r((function(t,e){return""===e?"":E(t.P,e)})),ql=r((function(t,e){var r=Wl(t),n=h(Mr,t.Z,e.bZ),i=r(e.cZ);return ml(S([e.a3,n,i,e.a8]))})),Gl=r((function(t,e){return h(ql,t,h(Hl,t,e))})),Vl={P:".",cZ:($s=0,{$:0,a:$s}),a_:"−",bk:"",b9:"",ca:"",Z:"",cE:"",cF:""},Xl=A(Vl,{cZ:bl(2),Z:","}),Kl=function(t){var e=function(){var e=t.c7;switch(e.$){case 0:return"stopped";case 4:return"starting";case 1:return"paused";case 2:if(1===e.a.$){e.a;return"running"}var r=e.a.a;return"running: "+h(Gl,A(Xl,{cZ:bl(2)}),r/1e6)+" MHz";default:return"error"}}();return E(function(){switch(t.aW){case 0:return"";case 1:return"Gamepads: 1▕ ";default:return"Gamepads: 2▕ "}}(),e)},Yl={$:6},Jl={aE:0,E:"absolute"},Ql=Qc("br"),Zl=r((function(t,e){return{cJ:0,B:0,E:E(ah(e),t)}})),tf=Zl("deg"),ef=iu("overflow"),rf=function(t){return"calc("+ah(t)+" * var(--cw))"},nf=function(t){var e,r,n,i=t.d_?S([rl((e=tf(-90),r=e.E,{e:0,E:h(ch,"rotate",S([r]))}))]):x;return h(Zc,S([Xc(S([sh(Jl),lh(uh(0)),nh(uh(0)),_l(11),eh(wh(2)),(n=4,h(nu,"width",rf(n))),ef(Zh)])),Kh(Yl)]),S([h(Zc,S([Xc(E(S([gl(15),ul(S([il(300)]))]),i))]),S([Gh("░░░░"),h(Ql,x,x),Gh("░░░░")]))]))},sf=iu("right"),af=function(t){return h(qs,(function(e){return h(Za,h(ms,(function(t){return t.S}),ln(e)),t.aS)}),t.dS)},of=r((function(t,e){return h(Gc,e,h(Gu,t,x))})),uf={bg:0,ax:0,E:"row"},cf=A(uf,{E:"column"}),hf=iu("flex-direction"),lf=Qc("a"),ff=A({by:0,l:0,av:0,bA:0,aa:0,bB:0,ab:0,G:0,r:0,aQ:0,cU:0,a:0,g:0,af:0,bg:0,ax:0,aV:0,Q:0,o:0,ag:0,d:0,J:0,aX:0,b_:0,bi:0,az:0,ai:0,K:0,aj:0,ak:0,T:0,U:0,C:0,aY:0,c:0,b:0,bm:0,dH:0,L:0,a1:0,al:0,A:0,a9:0,ao:0,X:0,ap:0,aq:0,Y:0,w:0,ar:"",aL:0,E:"initial",aN:0,O:0},{E:"inherit"}),df=iu("text-decoration"),pf=i((function(t,e,r,n){var i,s=g(e.cY,r)?gl(15):gl(0),a=g(e.cY,r)?_l(11):Wc(ff);return h(lf,S([(i=ta(r),h(Ih,"href",i)),Xc(E(S([h(nu,"padding","0 var(--cw)"),$h(s),$h(a),$h(df(ih)),Kc(Hh)]),t))]),S([Gh(n)]))})),_f=iu("padding-bottom"),gf=function(t){return l(xh,"textAlign","text-align",t(Th))},bf=function(t){var e,r,n=t.d_?S([hl(fl)]):S([rl((e=tl(-100),r=e.E,{e:0,E:h(ch,"translateX",S([r]))})),hl(Zh)]),i=S([Sh(wh(1)),_f(wh(1)),gf(bh)]);return h(Zc,S([Oh,Xc(E(S([sh(th),nh(uh(0)),lh(wh(2)),ph(dh(70)),_l(12),gl(0),ul(S([il(300),ll(300)])),yh,hf(cf)]),n))]),S([f(pf,i,t,0,"ROMs"),f(pf,i,t,1,"Settings"),f(pf,i,t,2,"Emulation"),f(pf,i,t,3,"Help"),f(pf,i,t,4,"About")]))},vf={ct:0,E:"ellipsis"},mf=iu("flex-shrink"),yf={ax:0,aV:0,E:"nowrap",O:0},wf=n((function(t,e,r){return h(nu,t,h(Mr," ",S([e.E,r.E])))})),Af=wf("padding"),kf=iu("text-overflow"),Ef=iu("white-space"),xf=i((function(t,e,r,n){var i=function(t){return h(Zc,S([Xc(S([Kc(Hh),Ef(yf),h(Af,wh(0),wh(1)),mf(rh(0))]))]),S([Gh(t)]))};return h(Zc,S([Xc(E(S([yh,Ch(bh),ef(Zh)]),n))]),S([i(t),h(Zc,S([Xc(S([Kc(Hh),Ef(yf),ef(Zh),kf(vf)]))]),S([Gh(r)])),i(e)]))})),Tf=Qc("nav"),Cf=r((function(t,e){return 1===e?function(t){var e,r=h(Zs,"6502.ts / Stellerator",h(Xs,(function(t){return"Stellerator: "+t.aB}),af(t)));return S([h(Zc,S([Xc(S([ph(dh(100)),eh(wh(2)),sh(th),lh(uh(0)),nh(uh(0)),_h(rh(20)),gl(12),_l(0)]))]),S([f(xf,"----====≡≡≡≡","≡≡≡≡====----",r,x),h(Tf,S([Xc(S([_l(12),gl(0)]))]),S([f(pf,x,t,0,"ROMs"),f(pf,x,t,1,"Settings"),f(pf,x,t,2,"Emulation"),f(pf,x,t,3,"Help"),f(pf,x,t,4,"About"),h(qh,S([Xc(S([(e=sf,l(xh,"float","float",e(Th))),h(nu,"margin-right","var(--cw)")]))]),S([Gh(Kl(t))]))]))])),$c(S([h(of,"body",S([Sh(wh(2))]))]))])}(t):function(t){var e=h(Zs,"Stellerator",h(Xs,(function(t){return t.aB}),af(t)));return S([h(Zc,S([Xc(S([ph(dh(100)),eh(wh(2)),sh(th),lh(uh(0)),nh(uh(0)),_h(rh(20)),gl(12),_l(0)]))]),S([f(xf,"--==≡≡","≡≡==--",e,S([h(nu,"padding-left","calc(4 * var(--cw))")])),h(Zc,S([Xc(S([_l(12),gl(0),gf(sf)]))]),S([Gh(Kl(t))])),nf(t),bf(t)])),$c(S([h(of,"body",S([Sh(wh(2))]))]))])}(t)})),Sf=zc,Rf=Ih("id"),If=iu("margin-bottom"),Bf={bL:Rr,df:Sr({cN:!1,d5:!1}),dT:!0,d$:!1},Of=ar,Pf=Of(Bf),Mf=function(t){var e=h(Zs,h(Zc,x,S([Gh("loading license...")])),h(Xs,(function(t){return Sf(h(Pf,x,t))}),t.dp)),r=h(Zs,h(Zc,x,S([Gh("loading changelog...")])),h(Xs,(function(t){return Sf(h(Pf,x,t))}),t.cS));return h(Zc,S([Xc(S([h(nu,"padding","0 var(--cw)"),Sh(wh(1))]))]),S([h(Zc,S([Rf("version"),Xc(S([gf(bh),gl(5),If(wh(1))]))]),S([Gh("Version "+t.aM)])),h(Zc,S([Xc(S([gf(bh),If(wh(1))]))]),S([Gh("** CHANGELOG **")])),r,h(Zc,S([Xc(S([_l(5),eh(wh(.5)),If(wh(1.5))]))]),x),h(Zc,S([Xc(S([gf(bh),If(wh(1))]))]),S([Gh("** LICENSE **")])),e]))},Df={$:19},Ff=Wh("active"),Lf=iu("bottom"),jf=h(Ph,S([Xc(S([gf(bh),sh(th),sf(wh(0)),Lf(wh(0)),h(Af,wh(1),wh(.75)),$h(_l(2)),gl(12),_h(rh(10)),Ff(S([$h(_l(1))]))])),Kh(Df)]),S([Gh("─┼─")])),Nf={bc:0,aQ:0,E:"border-box"},Uf=iu("box-sizing"),zf=function(t){return{$:18,a:t}},$f=function(t){return{$:27,a:t}},Hf=n((function(t,e,r){var n=h(Jn,jr,S([t.aS,Xa(t)]));t:for(;;){if(n.b&&n.b.b&&!n.b.b.b){if(n.a){if(n.b.a)break t;n.b;return e("no ROMS match the search")}n.b;return e('start by clicking "Add new" to add a ROM image')}break t}return r})),Wf=iu("cursor"),qf=r((function(t,e){return h(Zs,!1,h(Xs,ln(t.S),e))})),Gf=i((function(t,e,r,n){return h(qf,t,e)?r:n})),Vf=de,Xf=r((function(t,e){var r=t.b,n=t.c;return au(r)?e:l(hs,n,r,e)})),Kf=function(t){return t.a},Yf=function(t){return he(be(t))},Jf=r((function(t,e){return h(ce,t,be(e))})),Qf=function(t){return oe(be(t))},Zf=r((function(t,e){var r=t.a,n=t.b,i=e.a,s=e.b;switch(n.$){case 4:var a=n.a;return w(h(vr,w(r,a),i),s);case 0:var o=n.a,u=n.b,c=n.c,d=l(Lr,Xf,s,u),p=l(Lr,td,w(x,d),c),_=p.a,g=p.b;a=l(Lc,o,h(Jn,Kf,u),Kr(_));return w(h(vr,w(r,a),i),g);case 1:var b=n.a,v=(o=n.b,u=n.c,c=n.d,d=l(Lr,Xf,s,u),l(Lr,td,w(x,d),c));_=v.a,g=v.b,a=f(Qf,b,o,h(Jn,Kf,u),Kr(_));return w(h(vr,w(r,a),i),g);case 2:o=n.a,u=n.b,c=n.c,d=l(Lr,Xf,s,u);var m=l(Lr,Zf,w(x,d),c);_=m.a,g=m.b,a=l(Yf,o,h(Jn,Kf,u),Kr(_));return w(h(vr,w(r,a),i),g);default:b=n.a,o=n.b,u=n.c,c=n.d,d=l(Lr,Xf,s,u);var y=l(Lr,Zf,w(x,d),c);_=y.a,g=y.b,a=f(Jf,b,o,h(Jn,Kf,u),Kr(_));return w(h(vr,w(r,a),i),g)}})),td=r((function(t,e){var r=e.a,n=e.b;switch(t.$){case 4:var i=t.a;return w(h(vr,i,r),n);case 0:var s=t.a,a=t.b,o=t.c,u=l(Lr,Xf,n,a),c=l(Lr,td,w(x,u),o),d=c.a,p=c.b;i=l(Lc,s,h(Jn,Kf,a),Kr(d));return w(h(vr,i,r),p);case 1:var _=t.a,g=(s=t.b,a=t.c,o=t.d,u=l(Lr,Xf,n,a),l(Lr,td,w(x,u),o));d=g.a,p=g.b,i=f(Qf,_,s,h(Jn,Kf,a),Kr(d));return w(h(vr,i,r),p);case 2:s=t.a,a=t.b,o=t.c,u=l(Lr,Xf,n,a);var b=l(Lr,Zf,w(x,u),o);d=b.a,p=b.b,i=l(Yf,s,h(Jn,Kf,a),Kr(d));return w(h(vr,i,r),p);default:_=t.a,s=t.b,a=t.c,o=t.d,u=l(Lr,Xf,n,a);var v=l(Lr,Zf,w(x,u),o);d=v.a,p=v.b,i=f(Jf,_,s,h(Jn,Kf,a),Kr(d));return w(h(vr,i,r),p)}})),ed=r((function(t,e){return d(os,1,t,e,es,es)})),rd=r((function(t,e){for(;;){if(!e.b)return t;var r=e.a,n=r.b,i=r.c,s=e.b;if(Ln(i))t=t,e=s;else t=Sr(w(i,n)),e=s}})),nd=function(t){var e=h(rd,Rr,t);if(1===e.$)return rs;var r=e.a,n=r.a,i=r.b;return h(ed,n,i)},id=function(t){return{$:0,a:t}},sd=function(t){var e=t.a,r=t.b;return h(Gc,r,Vu(S([id(e)])))},ad=function(t){return l(Lc,"style",x,vc(Nc(Fc(vc(jc(h(Jn,sd,yr(t))))))))},od=n((function(t,e,r){var n=h(Jn,Kf,e),i=nd(e),s=l(Lr,td,w(x,i),r),a=s.a,o=s.b,u=ad(o);return l(Lc,t,n,h(vr,u,Kr(a)))})),ud=r((function(t,e){for(;;){if(!e.b)return!1;var r=e.a.a,n=e.b;if(g(t,r))return!0;t=t,e=n}})),cd=r((function(t,e){t:for(;;){if(e.b){var r=e.a.a,n=e.b,i="_"+r;if(h(ud,i,n)){t=i,e=n;continue t}return i}return t}})),hd=r((function(t,e){return w(h(cd,"_",e),ad(t))})),ld=n((function(t,e,r){var n=h(Jn,Kf,e),i=nd(e),s=l(Lr,Zf,w(x,i),r),a=s.a,o=s.b,u=h(hd,o,a);return l(Yf,t,n,h(vr,u,Kr(a)))})),fd=i((function(t,e,r,n){var i=h(Jn,Kf,r),s=nd(r),a=l(Lr,Zf,w(x,s),n),o=a.a,u=a.b,c=h(hd,u,o);return f(Jf,t,e,i,h(vr,c,Kr(o)))})),dd=i((function(t,e,r,n){var i=h(Jn,Kf,r),s=nd(r),a=l(Lr,td,w(x,s),n),o=a.a,u=a.b,c=ad(u);return f(Qf,t,e,i,h(vr,c,Kr(o)))})),pd=function(t){switch(t.$){case 4:return t.a;case 0:var e=t.a,r=t.b,n=t.c;return l(od,e,r,n);case 1:var i=t.a;e=t.b,r=t.c,n=t.d;return f(dd,i,e,r,n);case 2:e=t.a,r=t.b,n=t.c;return l(ld,e,r,n);default:i=t.a,e=t.b,r=t.c,n=t.d;return f(fd,i,e,r,n)}},_d=n((function(t,e,r){return pd(h(t,e,r))})),gd=n((function(t,e,r){return Uc(f(Vf,_d,t,e,r))})),bd=iu("margin-top"),vd=iu("min-height"),md=n((function(t,e,r){return{$:2,a:t,b:e,c:r}})),yd=function(t){return Wh("nth-child("+t+")")},wd={a:0,E:"pointer"},Ad=Ih("type"),kd=function(t){var e=function(t){return h(Zc,S([Rf(t.S),Xc(S([Uf(Nf),h(nu,"padding","2.25em calc(2 * var(--cw))"),vd(wh(5)),gf(bh),h(yd,"odd",S([_l(12)])),h(yd,"even",S([_l(5)])),gl(0),Wf(wd),h(nu,"word-break","break-word")])),Kh(Da(t.S))]),S([Gh(t.aB)]))},n=function(e){var n=r((function(t,e){return l(Vh,S([Ad("button"),Xc(S([h(nu,"width","calc(8 * var(--cw))")]))]),t,e)}));return h(Zc,S([Rf(e.S),Oh,Xc(S([Uf(Nf),vd(wh(4)),gf(bh),_l(11),gl(15),Wf(wd),h(nu,"word-break","break-word")]))]),S([Gh(e.aB),h(Zc,S([Xc(S([yh,gf(nh),bd(wh(1)),If(wh(-.5)),Ch(Jh)]))]),S([h(n,zf(1),"Edit"),h(n,h(Zs,pi,h(Xs,$f,vo(t))),"Run")]))]))},i=S([l(gd,r((function(r,i){return l(md,"div",S([Xc(S([Uf(Nf),ph(dh(100)),bd(wh(3.5))]))]),h(Jn,(function(r){return w(r.S,d(Gf,i=r,t.cX,n,e,i));var i}),h(to,h(ms,(function(t){return t.aB}),qa),h(Va,r,i))))})),t.cO,t.aS)]);return l(Hf,t,(function(t){return S([h(Zc,S([Xc(S([ph(dh(100)),bd(wh(3.5)),h(nu,"padding","3em calc(2 * var(--cw)) 0 calc(2 * var(--cw))"),gf(bh),Uf(Nf)]))]),S([Gh(t)]))])}),i)},Ed={$:38},xd=function(t){return{$:7,a:t}},Td={$:8},Cd=r((function(t,e){return h(Rh,t,mo(e))})),Sd=Cd("disabled"),Rd=iu("flex-grow"),Id=Qc("label"),Bd=function(t){return h(nu,"margin-right",rf(t))},Od=r((function(t,e){return h(Dh,t,function(t){return{$:2,a:t}}(e))})),Pd=r((function(t,e){return l(Yn,Bi,e,t)})),Md=h(Pd,S(["target","value"]),ki),Dd=function(t){return h(Od,"change",h(kn,h(ms,t,(function(t){return w(t,!0)})),Md))},Fd=function(t){return h(Od,"input",h(kn,h(ms,t,(function(t){return w(t,!0)})),Md))},Ld=Ih("placeholder"),jd=Qc("input"),Nd=fe,Ud=r((function(t,e){return pd(t(e))})),zd=r((function(t,e){return Uc(l(Nd,Ud,t,e))})),$d=Ih("value"),Hd=function(t){return zd((function(e){return h(jd,h(vr,Ad("text"),h(vr,$d(e),t)),x)}))},Wd=r((function(t,e){return h(Id,S([Xc(E(S([yh]),t)),Oh]),S([h(Hd,S([Ad("text"),Xc(S([Rd(rh(1)),Bd(1)])),Ld("Filter ROMs..."),Fd(xd),Dd((function(t){return Ed}))]),e.cO),l(Vh,S([Ad("button"),Sd(""===e.cO),Xc(S([If(wh(.5))]))]),Td,"Clear")]))})),qd=function(t){return{$:15,a:t}},Gd=function(t){return l(xh,"alignItems","align-items",t(Th))},Vd=r((function(t,e){return{$:2,a:t,b:e}})),Xd=Vd(2),Kd=iu("flex-start"),Yd=Qc("form"),Jd=tu("label"),Qd=function(t){return w(t,!0)},Zd=function(t){return h(Od,"submit",h(kn,Qd,xn(t)))},tp=r((function(t,e){return h(ge,function(t){return/^(on|formAction$)/i.test(t)?"data-"+t:t}(t),ve(e))})),ep=r((function(t,e){return l(qc,h(tp,t,e),x,"")})),rp=ep,np=function(t){return h(rp,"data-label",t)},ip=r((function(t,e){return{$:17,a:t,b:e}})),sp=function(t){return{$:7,a:t}},ap=function(t){return{$:6,a:t}},op=function(t){return{$:3,a:t}},up=function(t){return{$:5,a:t}},cp=function(t){return{$:0,a:t}},hp=function(t){return{$:9,a:t}},lp=function(t){return{$:4,a:t}},fp=function(t){return{$:2,a:t}},dp=function(t){return{$:1,a:t}},pp=function(t){return{$:8,a:t}},_p=function(t){return{$:21,a:t}},gp={g:0,E:"block"},bp=Cd("checked"),vp=h(Pd,S(["target","checked"]),yi),mp=function(t){return h(Od,"change",h(kn,h(ms,t,(function(t){return w(t,!0)})),vp))},yp=r((function(t,e){return h(jd,S([Ad("checkbox"),mp(t),bp(e)]),x)})),wp=Ih("htmlFor"),Ap=iu("max-width"),kp=Qc("option"),Ep=Qc("select"),xp=Cd("selected"),Tp=i((function(t,e,r,n){var i;return h(qh,S([Bh("select-wrapper"),Xc(t)]),S([h(Ep,E(S([$d(n),(i=!1,h(Ih,"autocomplete",i?"on":"off"))]),e),h(Jn,(function(t){var e=t.a,r=t.b;return h(kp,S([$d(e),xp(g(e,n))]),S([Gh(r)]))}),r))]))})),Cp=n((function(t,e,r){return f(Tp,S([Ap(tl(100))]),S([Xc(S([Ap(tl(100))])),Dd(e)]),t,r)})),Sp=i((function(t,e,r,n){return h(qh,t,h(Jn,(function(t){return h(Id,S([Xc(S([Wf(wd),Ef(yf),h(Wh,"not(:first-of-type)",S([h(nu,"margin-left","calc(2 * var(--cw))")]))]))]),S([Gh(t.b),h(jd,S([Ad("radio"),Xc(S([h(nu,"margin-left","var(--cw)")])),bp(g(n,t.a)),l(Ca,h(Ca,Od("change"),kn((function(t){return w(t,!0)}))),wi((function(e){return e?xn(r(t.a)):Ai("")})),vp)]),x)]))}),e))})),Rp={g:0,E:"inline-flex"},Ip=Ih("max"),Bp=Ih("min"),Op=function(t){return h(ep,"tabIndex",Pr(t))},Pp=s((function(t,e,r,n,i){var s=e.a,a=e.b,o=function(t){return m(t,s)>-1&&m(t,a)<1?Sr(t):Rr},u=h(Xh,"keydown",h(wi,(function(t){switch(t){case"ArrowLeft":return xn(r(o(i-1)));case"ArrowRight":return xn(r(o(i+1)));default:return Ai("")}}),h(Bi,"key",ki)));return h(qh,S([Xc(E(t,S([Kc(Rp)]))),Op(0),u]),S([h(jd,S([Xc(S([Rd(rh(1))])),Ad("range"),Bp(Pr(s)),Ip(Pr(a)),$d(Pr(i)),Fd(h(ms,Nn,h(ms,qs(o),r)))]),x),h(qh,S([Xc(S([Kc(gp),h(nu,"padding-left","calc(2 * var(--cw))"),h(nu,"min-width","calc(4 * var(--cw))"),Rd(rh(0)),mf(rh(0))]))]),S([Gh(n(i))]))]))})),Mp=r((function(t,e){var n,i,s=r((function(t,e){return h(Id,S([Xc(S([Kc(gp),ph(tl(100))]))]),S([Gh(t),h(Ql,x,x),e]))})),a=(n=t.ds,i=n.$||n.a?"calc(40 * var(--cw))":(n.a,"calc(100vw - 10 * var(--cw))"),Pp(S([h(nu,"width",i)]))),o=r((function(t,e){return h(Id,S([wp("nothing")]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),e]))})),u=r((function(t,e){return h(Id,S([Xc(S([Wf(wd)]))]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),e]))})),c=function(t){return h(ms,t,ip(e.S))},d=r((function(t,e){return h(Hd,S([Ad("text"),Ld("Auto"),Xc(S([h(nu,"width","calc(10 * var(--cw))")])),Fd((function(e){return""===e?h(c,t,Rr):h(Zs,pi,h(Xs,h(Ca,c(t),Sr),Nn(e)))}))]),l(Ca,Zs(""),Xs(Pr),e))}));return E(S([h(s,"ROM name:",h(Hd,S([Ad("text"),Xc(S([ph(tl(100))])),Fd(c(cp))]),e.aB)),h(s,"ROM type:",l(Cp,h(Jn,(function(t){return w(t.dn,t.c1)}),t.aR),c(dp),e.bH)),h(o,"TV mode:",f(Sp,x,S([w(0,"PAL"),w(1,"NTSC"),w(2,"SECAM")]),c(fp),e.cx)),h(u,"Emulate paddles:",h(yp,c(op),e.bN)),h(o,"RNG seed:",h(d,lp,e.ck)),h(o,"First visible line:",h(d,up,e.bR)),h(o,"CPU emulation:",f(Sp,x,S([w(Rr,"Default"),w(Sr(1),"Instruction"),w(Sr(0),"Cycle")]),c(ap),e.cW)),h(o,"Audio emulation:",f(Sp,x,S([w(Rr,"Default"),w(Sr(1),"PCM"),w(Sr(0),"Waveform")]),c(sp),e.cL)),h(o,"Volume:",f(a,w(0,100),h(ms,Xs(c(pp)),Zs(pi)),(function(t){return Pr(t)+"%"}),e.eg)),h(u,"Default phosphor:",h(yp,c(h(ms,(function(e){return e?Rr:Sr(t.aG.dM)}),hp)),h(Zs,!0,h(Xs,(function(t){return!1}),e.dM))))]),E(function(){var t=e.dM;if(t.$)return x;var r=t.a;return S([h(o,"Phosphor level:",f(a,w(0,100),h(ms,Xs(c(h(ms,Sr,hp))),Zs(pi)),(function(t){return Pr(t)+"%"}),r))])}(),S([h(Zc,x,S([h(Ph,S([Ad("button"),Kh(_p(e.S)),Xc(S([bd(wh(1)),h(Af,uh(0),wh(1))]))]),S([Gh("Save ROM image")]))]))])))})),Dp=r((function(t,e){var n,i=r((function(t,e){return l(Vh,S([Ad("button"),Xc(S([h(nu,"width","calc(10 * var(--cw))")]))]),t,e)}));return S([h(Yd,S([Xc(S([_f(wh(.5)),yh,Ch(Jh),sh(th),lh(wh(2)),nh(uh(0)),_h(rh(10)),ph(dh(100)),Uf(Nf)])),Zd(pi),Oh]),S([h(i,zf(0),"Back"),h(i,qd(e.S),"Delete")])),(n=h(Mp,t,e),h(Yd,S([Oh,np("Settings:"),Zd(pi),Xc(S([yh,hf(cf),Gd(Kd),Xd(S([Jd(S([h(Wh,"not(:first-of-type)",S([Sh(wh(1))]))]))])),bd(wh(4)),Sh(wh(2))]))]),n))])})),Fp=function(t){var e=w(t.cP,h(qs,(function(e){return h(Za,h(Ca,ln(e),(function(t){return t.S})),t.aS)}),t.cX));if(1!==e.a||e.b.$)return function(t){return h(vr,h(Wd,S([ph(dh(100)),sh(th),lh(wh(2)),nh(uh(0)),Uf(Nf),_h(rh(10))]),t),h(vr,jf,h(vr,$c(S([h(of,"body",S([_f(wh(5))]))])),kd(t))))}(t);var r=e.b.a;return h(Dp,t,r)},Lp=iu("border-style"),jp=function(t){return t?"-":"+"},Np=n((function(t,e,r){var n=function(t){return h(Wn,"calc(",t.E)?h(Dn,4,t.E):t.E},i=h(Mr," ",S([n(t),jp(e),n(r)]));return{bG:0,af:0,o:0,az:0,ai:0,K:0,aj:0,ak:0,T:0,U:0,C:0,ap:0,E:h(ch,"calc",S([i]))}})),Up=iu("overflow-y"),zp={av:0,bD:0,bY:0,al:0,dX:0,E:"scroll"},$p=iu("stretch"),Hp=function(t){var e=l(gd,r((function(e,r){return h(Zc,S([Oh,Xc(S([yh,Rd(rh(1)),Gd($p),Up(Zh)]))]),S([l(md,"div",S([Xc(S([Rd(rh(1)),Up(zp),h(nu,"-webkit-overflow-scrolling","touch")]))]),h(Jn,(function(e){return w(e.S,(i=h(Gf,r=e,t.cX),h(Zc,S([Rf(r.S),Xc(S([h(yd,"odd",S([_l(h(i,11,5))])),h(yd,"even",S([_l(h(i,11,12))])),h(i,gl(15),gl(0)),h(nu,"padding-left","var(--cw)"),Wf(wd),h(nu,"word-break","break-word")])),Kh(Da(r.S)),(n=$f(r.S),h(Xh,"dblclick",xn(n)))]),S([Gh(" * "+r.aB)]))));var r,n,i}),h(to,h(ms,(function(t){return t.aB}),qa),h(Va,e,r))))]))})),t.cO,t.aS);return l(Hf,t,(function(t){return h(Zc,S([Oh,Xc(S([Rd(rh(1)),yh,hf(cf),gf(bh),Ch(bh)]))]),S([Gh(t)]))}),e)},Wp=n((function(t,e,r){return vo(t).$?r:e})),qp=function(t){var e=h(Zc,S([Xc(S([yh]))]),S([h(Hd,S([Ad("text"),Xc(S([Rd(rh(1)),Bd(1)])),Ld("Filter ROMs..."),Fd(xd)]),t.cO),h(Ph,S([Ad("button"),Sd(""===t.cO),Kh(Td)]),S([Gh("Clear")]))])),n=r((function(t,e){return h(Ph,E(S([Ad("button"),Xc(S([h(nu,"width","calc(10 * var(--cw))")]))]),t),e)}));return h(Yd,S([Oh,Zd(pi)]),S([e,h(Zc,x,S([h(n,S([Kh(Df)]),S([Gh("Add new")])),h(n,S([Sd(l(Wp,t,!1,!0)),Kh(h(Zs,pi,h(Xs,qd,t.cX)))]),S([Gh("Delete")])),h(n,S([Sd(l(Wp,t,!1,!0)),Kh(h(Zs,pi,h(Xs,$f,vo(t))))]),S([Gh("Run")]))]))]))},Gp=iu("flex-basis"),Vp={$:12},Xp={$:13},Kp=function(t){return{$:10,a:t}},Yp=function(t){return{$:11,a:t}},Jp=r((function(t,e){t:for(;;){if(e.a){if("d"===e.b)return h(Zs,pi,h(Xs,qd,vo(t)));break t}switch(e.b){case"ArrowUp":return h(Zs,Xp,h(Xs,Yp,t.cX));case"ArrowDown":return h(Zs,Vp,h(Xs,Kp,t.cX));case"Enter":return h(Zs,pi,h(Xs,$f,vo(t)));default:break t}}return pi})),Qp=r((function(t,e){return w(t,e)})),Zp=iu("outline-style"),t_=iu("overflow-x"),e_=r((function(t,e){return h(Zc,S([Oh,np("Settings:"),Xc(E(S([yh,t_(Zh)]),E(l(Wp,t,S([Gd($p)]),S([Gd(bh),Ch(bh)])),e)))]),S([h(Zs,Gh("no ROMs selected"),h(Xs,h(Ca,(function(t){return h(Yd,S([Xc(S([yh,hf(cf),Gd(Kd),Sh(wh(1)),Up(zp),h(nu,"-webkit-overflow-scrolling","touch"),Rd(rh(1)),Xd(S([Jd(S([h(Wh,"not(:first-of-type)",S([Sh(wh(1))]))]))]))])),Zd(pi)]),t)}),Mp(t)),h(qs,(function(e){return h(Za,(function(t){return g(e,t.S)}),Xa(t))}),t.cX)))]))})),r_=r((function(t,e){return 1===e?function(t){return S([h(Zc,S([Xc(S([eh(l(Np,fh(100),1,wh(2))),yh,Gd($p),Sh(wh(1)),Uf(Nf),$h(Lp(ih)),$h(Zp(ih))])),Op(0),(e=Jp(t),h(Od,"keydown",h(kn,(function(t){return 41===t.$?w(t,!1):w(t,!0)}),h(kn,e,l(En,Qp,h(Bi,"ctrlKey",yi),h(Bi,"key",ki))))))]),S([h(Zc,S([Xc(S([Uf(Nf),Rd(rh(1)),Gp(uh(0)),yh,hf(cf)]))]),S([qp(t),Hp(t)])),h(e_,t,S([Uf(Nf),Rd(rh(1)),Gp(uh(0))]))]))]);var e}(t):Fp(t)})),n_=function(t){return{$:0,a:t}},i_=function(t){return{$:37,a:t}},s_=function(t){return{$:35,a:t}},a_=function(t){return{$:36,a:t}},o_=function(t){return{$:32,a:t}},u_={$:30},c_=function(t){var e=r((function(t,e){return h(Id,S([wp("nothing"),Xc(S([Kc(gp)]))]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),e]))})),n=function(){switch(t.c7.$){case 1:case 2:return!0;default:return!1}}(),i=r((function(t,e){return h(Id,S([Xc(S([Wf(wd)]))]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),e]))}));return S([h(e,"Difficulty left:",f(Sp,x,S([w(0,"A/Pro:"),w(1,"B/Amateur:")]),s_,t.cV.c2)),h(e,"Difficulty right:",f(Sp,x,S([w(0,"A/Pro:"),w(1,"B/Amateur:")]),a_,t.cV.c3)),h(e,"TV mode:",f(Sp,x,S([w(0,"Color:"),w(1,"BW:")]),i_,t.cV.cU)),h(i,"Limit framerate:",h(yp,o_,t.dq)),h(Ql,x,x),h(Ql,x,x),h(Ph,S([Kh(Fa),Sd(!n),Xc(S([h(nu,"min-width","calc(15 * var(--cw))")]))]),S([Gh(t.c6?"Resume":"Pause")])),h(Ph,S([Kh(u_),Sd(!n),Xc(S([h(nu,"min-width","calc(15 * var(--cw))")]))]),S([Gh("Hard Reset")]))])},h_=Ih("alt"),l_=Qc("h1"),f_=Qc("img"),d_=Qc("li"),p_=Qc("p"),__=function(t){return h(Ih,"src",t)},g_=function(t){return h(Zs,t.bb,t.aG.d9)},b_=Qc("ul"),v_=function(t){var e=t.aG.$7?"doc/images/2600_touch_lh.jpg":"doc/images/2600_touch.jpg",r=t.aG.$7?"doc/images/2600_touch_alt_lh.jpg":"doc/images/2600_touch_alt.jpg",n=S([h(l_,x,S([Gh("Touch controls")])),h(p_,x,S([h(f_,S([__(e),h_("touch controls"),Xc(S([Kc(gp),ph(tl(100)),Ap(wh(20))]))]),x),h(f_,S([__(r),h_("touch controls, alt mode"),Xc(S([Kc(gp),bd(wh(1)),ph(tl(100)),Ap(wh(20))]))]),x)]))]),i=function(t){return h(d_,x,S([Gh(t)]))},s=S([h(l_,x,S([Gh("Keyboard controls")])),h(p_,x,S([h(b_,x,S([i("LEFT JOYSTICK: wasd / arrows + v / space"),i("RIGHT JOYSTICK: ijkl + b"),i("RESET: shift-enter"),i("SELECT: shift-space"),i("TOGGLE FULLSCREEN: enter"),i("HARD RESET: shift-r"),i("PAUSE: p")]))]))]),a=function(){switch(t.aW){case 0:return x;case 1:return S([h(l_,x,S([Gh("Gamepad controls")])),h(p_,x,S([h(b_,x,S([i("Gamepad 1: left joystick")]))]))]);default:return S([h(l_,x,S([Gh("Gamepad controls")])),h(p_,x,S([h(b_,x,S([i("Gamepad 1: left joystick"),i("Gamepad 2: right joystick")]))]))])}}();return g_(t)?E(n,E(a,s)):E(s,a)},m_=Qc("canvas"),y_=iu("touch-action"),w_=function(t){var e=function(){var e=w(t.c7,t.dZ);t:for(;;)switch(e.a.$){case 2:return hl(fl);case 1:if(e.b)break t;return hl(fl);default:break t}return hl(Zh)}();return h(m_,S([Rf("stellerator-canvas"),Xc(S([ph(tl(100)),eh(tl(100)),sh(Jl),nh(uh(0)),lh(uh(0)),_h(rh(10)),e,y_(ih)]))]),x)},A_=iu("max-height"),k_=r((function(t,e){var r=e.E;return{bQ:t,E:Sr(r)}})),E_=function(t){var e=function(){var e=w(t.c7,t.dZ);t:for(;;)switch(e.a.$){case 2:return hl(Zh);case 1:if(e.b)break t;return hl(Zh);default:break t}return hl(fl)}(),r=g_(t)?S([Gh("emulation paused"),h(Ql,x,x),Gh("tap to resume")]):S([Gh("emulation paused")]),n=function(){var e=t.c7;switch(e.$){case 0:return S([Gh("emulation stopped")]);case 4:return S([Gh("emulation starting")]);case 1:return r;case 3:var n=e.a;return S([Gh("ERROR: "+n)]);default:return x}}(),i=3===t.c7.$?_l(7):_l(3);return h(Zc,S([Xc(S([eh(tl(100)),ph(tl(100)),yh,Ch(bh),Gd(bh),gf(bh),sh(Jl),nh(uh(0)),lh(uh(0)),_h(rh(10)),gl(15),e,i])),Kh(g(t.c7,ba)&&g_(t)?Fa:pi)]),n)},x_={aE:0,E:"relative"},T_=r((function(t,e){return{$:4,a:t,b:e}})),C_=Vd(3),S_=i((function(t,e,r,n){return{dk:e,dr:t,dH:r,d3:n}})),R_=h(dr,{cQ:!1,dy:!1},"(\\[.*?\\])\\((?!/|https?://)(.*?)\\)"),I_=pr(Infinity),B_=r((function(t,e){var r=function(e){var r=e.d3;if(!r.b||r.a.$||!r.b.b||r.b.a.$||r.b.b.b)return"";var n=r.a.a,i=r.b.a.a;return n+"("+t+i+")"},n=h(Xs,(function(t){return l(I_,t,r,e)}),R_);return h(Zs,e,n)})),O_=function(t){var e=t.dg;if(e.$)return Gh("loading...");var r=e.a;return h(Zc,S([Xc(S([h(nu,"padding","0 var(--cw)"),Sh(wh(1)),C_(S([h(of,"img",S([ph(wh(25)),h(nu,"max-width","calc(100vw - 2*var(--cw))")]))]))]))]),S([Sf(h(Pf,x,h(B_,"doc/",r)))]))},P_=function(t){return{$:22,a:t}},M_=function(t){return{$:2,a:t}},D_=function(t){return{$:0,a:t}},F_=function(t){return{$:3,a:t}},L_=function(t){return{$:9,a:t}},j_=function(t){return{$:6,a:t}},N_={$:13},U_=function(t){return{$:5,a:t}},z_=function(t){return{$:7,a:t}},$_=function(t){return{$:8,a:t}},H_=function(t){return{$:4,a:t}},W_=function(t){return{$:11,a:t}},q_=function(t){return{$:12,a:t}},G_=function(t){return{$:10,a:t}},V_=function(t){return{$:1,a:t}},X_={$:16},K_=n((function(t,e,r){return{$:23,a:t,b:e,c:r}})),Y_=N,J_=n((function(t,e,i){var s,a=Pp(S([h(nu,"width","calc(40*var(--cw))"),h(nu,"max-width","calc(100vw - 4*var(--cw))")])),o=t.aG,u=function(t){return h(l_,S([Xc(S([gl(5)]))]),S([Gh(t)]))},c=r((function(t,e){return h(Id,S([wp("nothing"),Xc(S([Kc(gp)]))]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),e]))})),d=n((function(t,e,r){return h(Id,S([Xc(S([Wf(wd),Kc(gp)]))]),S([h(qh,S([Xc(S([Kc(Hh),h(nu,"width","calc(20 * var(--cw))")]))]),S([Gh(t)])),h(yp,e,r)]))}));return S([u("General"),h(p_,x,S([h(c,"CPU emulation:",f(Sp,x,S([w(1,"Instruction"),w(0,"Cycle")]),h(Ca,P_,D_),o.cW))])),u("Audio"),h(p_,x,S([h(c,"Audio emulation:",f(Sp,x,S([w(1,"PCM"),w(0,"Waveform")]),h(Ca,P_,M_),o.cL)),h(c,"Volume:",f(a,w(0,100),h(ms,Xs(h(Ca,P_,V_)),Zs(pi)),(function(t){return Pr(t)+"%"}),o.eg))])),u("Display"),h(p_,x,E(S([h(c,"Gamma correction:",f(a,w(0,50),h(ms,Xs(h(Ca,h(Ca,h(Ca,P_,F_),(function(t){return t/10})),an)),Zs(pi)),(function(t){return ah(t/10)}),Y_(10*o.de))),h(c,"TV Emulation:",f(Sp,x,S([w(0,"Composite"),w(1,"S-Video"),w(2,"None")]),h(Ca,P_,H_),o.ea))]),E(t.aP&&2!==o.ea?S([h(Zc,S([Xc(S([gl(7),h(nu,"width","calc(60*var(--cw))"),h(nu,"max-width","calc(100vw - 4*var(--cw))")]))]),S([Gh("WARNING: Your GPU lacks required features. TV emulation will work, but colors will be slightly wrong.")]))]):x,S([h(c,"Scaling:",f(Sp,x,S([w(0,"QIS"),w(1,"Bilinear"),w(2,"Plain")]),h(Ca,P_,U_),o.dU)),h(c,"Phosphor level:",f(a,w(0,100),h(ms,Xs(h(ms,j_,P_)),Zs(pi)),(function(t){return Pr(t)+"%"}),o.dM)),h(c,"Scanline intensity:",f(a,w(0,100),h(ms,Xs(h(ms,z_,P_)),Zs(pi)),(function(t){return Pr(t)+"%"}),o.dV))])))),u("Controls"),h(p_,x,S([h(c,"Touch controls:",f(Sp,x,S([w(Rr,"Auto"),w(Sr(!0),"On"),w(Sr(!1),"Off")]),h(Ca,P_,$_),o.d9)),l(d,"Left handed mode:",h(Ca,P_,L_),o.$7),h(c,"Touch joystick sensitivity:",f(a,w(0,100),h(ms,Xs(h(Ca,P_,G_)),Zs(pi)),Pr,o.ef))])),u("Ui"),h(p_,x,S([h(c,"Display mode:",f(Sp,x,S([w(Rr,"Auto"),w(Sr(1),"Wide"),w(Sr(0),"Narrow")]),h(Ca,P_,W_),o.eb)),h(c,"Size:",l(Cp,h(Jn,h(Ca,(function(t){return w(t,t+"%")}),Pr),Vo),h(ms,Nn,h(ms,Xs(h(Ca,P_,q_)),Zs(pi))),Pr(o.cy)))])),u("Reset"),h(p_,x,(s=h(nu,"width","calc(25*var(--cw))"),S([f(Yh,e,S([Xc(S([s]))]),P_(N_),"Reset to defaults"),f(Yh,e,S([Xc(S([s])),Sd(!i)]),l(K_,"Do you really want to delete all cartridges?",w("OK","Cancel"),X_),"Delete all cartridges")])))])})),Q_=r((function(t,e){return S([h(Zc,S([Xc(S([h(nu,"padding","1rem var(--cw) 1rem var(--cw)"),ph(dh(100)),Uf(Nf),C_(S([Jd(S([h(Wh,"not(:first-of-type)",S([Sh(wh(1))]))]))]))]))]),l(J_,t,e,jr(t.aS)>0))])})),Z_=function(t){var e,r=function(t){var e=t.aG.eb;if(e.$)return t.ds;var r=e.a;return Sr(r)}(t),n=h(Zs,x,h(Xs,Cf(t),r)),i=function(){var e=w(t.cY,r);if(e.b.$)return x;switch(e.a){case 0:var n=e.b.a;return h(r_,t,n);case 1:n=e.b.a;return h(Q_,t,n);case 2:return function(t){var e,r,n=T_(S([n_(S([(e=uh(900*t.aG.cy/100|0),h(k_,"max-width",e))]))]));return S([h(Zc,S([Xc(S([ph(dh(100)),h(nu,"height","calc(100vh - 3em)"),bd(wh(1)),yh,Uf(Nf),Gd($p),hf(uf),n(S([Kc(gp)]))]))]),S([h(Zc,S([Oh,Xc(S([yh,Gd($p),Rd(rh(1)),n(S([h(nu,"height","calc(70vh - 4em)"),A_(uh(600))]))]))]),S([h(Zc,S([Xc(S([Rd(rh(1)),h(nu,"padding","1em calc(2 * var(--cw))"),_l(0),sh(x_)]))]),S([w_(t),E_(t)]))])),h(Zc,S([Xc(S([Rd((r=0,{U:0,C:0,dH:0,a$:0,L:r,ar:"",aL:0,E:ah(r)})),mf(rh(0)),h(nu,"flex-basis","calc(50 * var(--cw))"),yh,hf(cf),Gd($p)]))]),S([h(Zc,S([Oh,np("Console:")]),c_(t)),h(Zc,S([Oh,np("Help:"),Xc(S([Rd(rh(1)),ef(Zh),yh,Gd($p),hf(cf)]))]),S([h(Zc,S([Xc(S([Up(zp),h(nu,"-webkit-overflow-scrolling","touch"),Rd(rh(1))]))]),v_(t))]))]))]))])}(t);case 3:return function(t){return S([O_(t)])}(t);default:return function(t){return S([Mf(t)])}(t)}}(),s=(e=uh(t.aG.cy/100*18),$c(S([eu(S([su(e),Hc(e)]))])));return h(vr,s,E(n,E(h(Zs,x,h(Xs,dl(t.du),r)),i)))},tg=pd;!function(e){t.Elm?ne(t.Elm,e):t.Elm=e}({Stellerator:{Main:{init:ci({dl:aa,dI:ua,dJ:function(t){if(t.$)return pi;var e=t.a;return oa(function(t){var e=t.cd?"https://":"http://";return l(ha,"#",t.dd,l(ha,"?",t.ce,E(h(ca,t.b8,E(e,t.bV)),t.b6)))}(e))},d4:function(t){return _a(S([Pa,(e=la,Sa(h(Ca,e,(function(t){var e=h(Oi,Gi(ji),t);return e.$?x:e.a})))),ka(da),Ta(fa),Ia(pa)]));var e},ec:Ko,ee:function(t){return{cM:h(Jn,tg,Z_(t)),d8:h(Zs,"Stellerator",h(Xs,(function(t){return"Stellerator: "+t.aB}),af(t)))}}})(Mi)(0)}}})}(this)}).call(F);var L=F.Elm;function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function z(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?U(Object(r),!0).forEach((function(e){N(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var $={addCSS:!0,thumbWidth:15,watch:!0};function H(t,e){return function(){return Array.from(document.querySelectorAll(e)).includes(this)}.call(t,e)}var W=function(t){return null!=t?t.constructor:null},q=function(t,e){return!!(t&&e&&t instanceof e)},G=function(t){return null==t},V=function(t){return W(t)===Object},X=function(t){return W(t)===String},K=function(t){return Array.isArray(t)},Y=function(t){return q(t,NodeList)},J=X,Q=K,Z=Y,tt=function(t){return q(t,Element)},et=function(t){return q(t,Event)},rt=function(t){return G(t)||(X(t)||K(t)||Y(t))&&!t.length||V(t)&&!Object.keys(t).length};function nt(t,e){if(1>e){var r=function(t){var e="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}(e);return parseFloat(t.toFixed(r))}return Math.round(t/e)*e}var it=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),tt(e)?this.element=e:J(e)&&(this.element=document.querySelector(e)),tt(this.element)&&rt(this.element.rangeTouch)&&(this.config=z({},$,{},r),this.init())}return function(t,e,r){e&&j(t.prototype,e),r&&j(t,r)}(t,[{key:"init",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(t){var e=this,r=t?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(t){e.element[r](t,(function(t){return e.set(t)}),!1)}))}},{key:"get",value:function(e){if(!t.enabled||!et(e))return null;var r,n=e.target,i=e.changedTouches[0],s=parseFloat(n.getAttribute("min"))||0,a=parseFloat(n.getAttribute("max"))||100,o=parseFloat(n.getAttribute("step"))||1,u=n.getBoundingClientRect(),c=100/u.width*(this.config.thumbWidth/2)/100;return 0>(r=100/u.width*(i.clientX-u.left))?r=0:100<r&&(r=100),50>r?r-=(100-2*r)*c:50<r&&(r+=2*(r-50)*c),s+nt(r/100*(a-s),o)}},{key:"set",value:function(e){t.enabled&&et(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),function(t,e){if(t&&e){var r=new Event(e,{bubbles:!0});t.dispatchEvent(r)}}(e.target,"touchend"===e.type?"change":"input"))}}],[{key:"setup",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=null;if(rt(e)||J(e)?n=Array.from(document.querySelectorAll(J(e)?e:'input[type="range"]')):tt(e)?n=[e]:Z(e)?n=Array.from(e):Q(e)&&(n=e.filter(tt)),rt(n))return null;var i=z({},$,{},r);if(J(e)&&i.watch){var s=new MutationObserver((function(r){Array.from(r).forEach((function(r){Array.from(r.addedNodes).forEach((function(r){tt(r)&&H(r,e)&&new t(r,i)}))}))}));s.observe(document.body,{childList:!0,subtree:!0})}return n.map((function(e){return new t(e,r)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),t}();const st=new WeakMap;function at(t){st.has(t)||st.set(t,new it(t,{watch:!1,addCSS:!1,thumbWidth:8}))}function ot(t){const e="input[type=range]";t.matches&&t.matches(e)&&at(t),t.querySelectorAll&&t.querySelectorAll(e).forEach(at)}let ut=null;var ct;!function(t){let e;!function(t){t.vanilla_2k="vanilla_2k",t.vanilla_4k="vanilla_4k",t.bankswitch_2k_cv="bankswitch_2k_cv",t.bankswitch_8k_F8="bankswitch_8k_F8",t.bankswitch_8k_E0="bankswitch_8k_E0",t.bankswitch_8k_3F="bankswitch_8k_3F",t.bankswitch_8k_FE="bankswitch_8k_FE",t.bankswitch_8k_UA="bankswitch_8k_UA",t.bankswitch_8k_DPC="bankswitch_8k_DPC",t.bankswitch_8k_econobanking="bankswitch_8k_econobanking",t.bankswitch_8k_pp="bankswitch_8k_pp",t.bankswitch_12k_FA="bankswitch_12k_FA",t.bankswitch_16k_F6="bankswitch_16k_F6",t.bankswitch_16k_E7="bankswitch_16k_E7",t.bankswitch_FA2="bankswitch_FA2",t.bankswitch_32k_F4="bankswitch_32k_F4",t.bankswitch_64k_F0="bankswitch_64k_F0",t.bankswitch_64k_EF="bankswitch_64k_EF",t.bankswitch_3E="bankswitch_3E",t.bankswitch_supercharger="bankswitch_supercharger",t.bankswitch_dpc_plus="bankswitch_dpc_plus",t.bankswitch_cdf="bankswitch_cdf",t.unknown="unknown"}(e=t.CartridgeType||(t.CartridgeType={})),t.getAllTypes=function(){return[e.vanilla_2k,e.vanilla_4k,e.bankswitch_2k_cv,e.bankswitch_8k_F8,e.bankswitch_8k_E0,e.bankswitch_8k_3F,e.bankswitch_8k_FE,e.bankswitch_8k_UA,e.bankswitch_8k_econobanking,e.bankswitch_8k_pp,e.bankswitch_12k_FA,e.bankswitch_8k_DPC,e.bankswitch_16k_F6,e.bankswitch_16k_E7,e.bankswitch_FA2,e.bankswitch_32k_F4,e.bankswitch_3E,e.bankswitch_64k_F0,e.bankswitch_64k_EF,e.bankswitch_supercharger,e.bankswitch_dpc_plus,e.bankswitch_cdf,e.unknown]},t.describeCartridgeType=function(t){switch(t){case e.vanilla_2k:return"plain 2k";case e.vanilla_4k:return"plain 4k";case e.bankswitch_2k_cv:return"2k CommaVideo scheme";case e.bankswitch_8k_F8:return"bankswitched 8k, F8 (Atari) scheme";case e.bankswitch_8k_E0:return"bankswitched 8k, E0 (Parker Bros.) scheme";case e.bankswitch_8k_3F:return"bankswitched 8k, 3F (Tigervision) scheme";case e.bankswitch_8k_FE:return"bankswitched 8k, FE (Activision) scheme";case e.bankswitch_8k_UA:return"bankswitched 8k, UA (Pleiades) scheme";case e.bankswitch_8k_pp:return"bankswitched 8k, Pink Panther scheme";case e.bankswitch_12k_FA:return"bankswitched 12k, FA (CBS) scheme";case e.bankswitch_8k_DPC:return"bankswitched 8k + DPC";case e.bankswitch_8k_econobanking:return"bankswitched 8k, econobanking scheme";case e.bankswitch_16k_F6:return"bankswitched 16k, F6 (Atari) scheme";case e.bankswitch_16k_E7:return"bankswitched 16k, E7 (M-Network) scheme";case e.bankswitch_FA2:return"bankswitched 28k/29k, FA2 (modified CBS) scheme";case e.bankswitch_32k_F4:return"bankswitched 32k, F4 (Atari) scheme";case e.bankswitch_3E:return"bankswitched 3E (Tigervision + RAM) scheme";case e.bankswitch_64k_F0:return"bankswitched 64k, F0 (Megaboy) scheme";case e.bankswitch_64k_EF:return"bankswitched 64k, EFSC (Homestar Runner) scheme";case e.bankswitch_supercharger:return"bankswitched supercharger";case e.bankswitch_dpc_plus:return"bankswitched DPC+";case e.bankswitch_cdf:return"bankswitched CDF";case e.unknown:return"unknown"}}}(ct||(ct={}));var ht=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct"}));P(ht);ht.NAMED_TAG,ht.NAME_TAG,ht.UNMANAGED_TAG,ht.OPTIONAL_TAG,ht.INJECT_TAG,ht.MULTI_INJECT_TAG,ht.TAGGED,ht.TAGGED_PROP,ht.PARAM_TYPES,ht.DESIGN_PARAM_TYPES,ht.POST_CONSTRUCT;var lt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}}));P(lt);lt.BindingScopeEnum,lt.BindingTypeEnum,lt.TargetTypeEnum;var ft=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=0;e.id=function(){return r++}}));P(ft);ft.id;var dt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.id=ft.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=lt.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=r}));P(dt);dt.Binding;var pt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"}));P(pt);pt.DUPLICATED_INJECTABLE_DECORATOR,pt.DUPLICATED_METADATA,pt.NULL_ARGUMENT,pt.KEY_NOT_FOUND,pt.AMBIGUOUS_MATCH,pt.CANNOT_UNBIND,pt.NOT_REGISTERED,pt.MISSING_INJECTABLE_ANNOTATION,pt.MISSING_INJECT_ANNOTATION,pt.UNDEFINED_INJECT_ANNOTATION,pt.CIRCULAR_DEPENDENCY,pt.NOT_IMPLEMENTED,pt.INVALID_BINDING_TYPE,pt.NO_MORE_SNAPSHOTS_AVAILABLE,pt.INVALID_MIDDLEWARE_RETURN,pt.INVALID_FUNCTION_BINDING,pt.INVALID_TO_SELF_VALUE,pt.INVALID_DECORATOR_OPERATION,pt.ARGUMENTS_LENGTH_MISMATCH,pt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT,pt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE,pt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE,pt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK,pt.MULTIPLE_POST_CONSTRUCT_METHODS,pt.POST_CONSTRUCT_ERROR,pt.CIRCULAR_DEPENDENCY_IN_FACTORY,pt.STACK_OVERFLOW;var _t=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(ht.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(ht.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(ht.TAGGED_PROP,t)||[]},t}();e.MetadataReader=r}));P(_t);_t.MetadataReader;var gt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}}));P(gt);gt.BindingCount;var bt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===pt.STACK_OVERFLOW}}));P(bt);bt.isStackOverflowExeption;var vt=M((function(t,e){function r(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function n(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||n(t.parentRequest,e))}function i(t){if(t.name)return t.name;var e=t.toString(),r=e.match(/^function\s*([^\s(]+)/);return r?r[1]:"Anonymous function: "+e}Object.defineProperty(e,"__esModule",{value:!0}),e.getServiceIdentifierAsString=r,e.listRegisteredBindingsForServiceIdentifier=function(t,e,r){var n="",s=r(t,e);return 0!==s.length&&(n="\nRegistered bindings:",s.forEach((function(t){var e="Object";null!==t.implementationType&&(e=i(t.implementationType)),n=n+"\n "+e,t.constraint.metaData&&(n=n+" - "+t.constraint.metaData)}))),n},e.circularDependencyToException=function t(e){e.childRequests.forEach((function(e){if(n(e,e.serviceIdentifier)){var i=function(t){return function t(e,n){void 0===n&&(n=[]);var i=r(e.serviceIdentifier);return n.push(i),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(e);throw new Error(pt.CIRCULAR_DEPENDENCY+" "+i)}t(e)}))},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var r="",n=e.getNamedTag(),i=e.getCustomTags();return null!==n&&(r+=n.toString()+"\n"),null!==i&&i.forEach((function(t){r+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+r}return" "+t},e.getFunctionName=i}));P(vt);vt.getServiceIdentifierAsString,vt.listRegisteredBindingsForServiceIdentifier,vt.circularDependencyToException,vt.listMetadataForTarget,vt.getFunctionName;var mt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.id=ft.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=r}));P(mt);mt.Context;var yt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===ht.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=r}));P(yt);yt.Metadata;var wt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e){this.parentContext=t,this.rootRequest=e};e.Plan=r}));P(wt);wt.Plan;var At=M((function(t,e){function r(t,e,r,n,i){var s={},a="number"==typeof i,o=void 0!==i&&a?i.toString():r;if(a&&void 0!==r)throw new Error(pt.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(s=Reflect.getMetadata(t,e));var u=s[o];if(Array.isArray(u))for(var c=0,h=u;c<h.length;c++){var l=h[c];if(l.key===n.key)throw new Error(pt.DUPLICATED_METADATA+" "+l.key.toString())}else u=[];u.push(n),s[o]=u,Reflect.defineMetadata(t,s,e)}function n(t,e){Reflect.decorate(t,e)}function i(t,e){return function(r,n){e(r,n,t)}}Object.defineProperty(e,"__esModule",{value:!0}),e.tagParameter=function(t,e,n,i){r(ht.TAGGED,t,e,i,n)},e.tagProperty=function(t,e,n){r(ht.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,r){"number"==typeof r?n([i(r,t)],e):"string"==typeof r?Reflect.decorate([t],e,r):n([t],e)}}));P(At);At.tagParameter,At.tagProperty,At.decorate;var kt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=r,e.inject=function(t){return function(e,r,n){if(void 0===t)throw new Error(pt.UNDEFINED_INJECT_ANNOTATION(e.name));var i=new yt.Metadata(ht.INJECT_TAG,t);"number"==typeof n?At.tagParameter(e,r,n,i):At.tagProperty(e,r,i)}}}));P(kt);kt.LazyServiceIdentifer,kt.inject;var Et=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,r=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},r)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=r}));P(Et);Et.QueryableString;var xt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,r,n){this.id=ft.id(),this.type=t,this.serviceIdentifier=r,this.name=new Et.QueryableString(e||""),this.metadata=new Array;var i=null;"string"==typeof n?i=new yt.Metadata(ht.NAMED_TAG,n):n instanceof yt.Metadata&&(i=n),null!==i&&this.metadata.push(i)}return t.prototype.hasTag=function(t){for(var e=0,r=this.metadata;e<r.length;e++){if(r[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(ht.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(ht.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(ht.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return t.key!==ht.INJECT_TAG&&t.key!==ht.MULTI_INJECT_TAG&&t.key!==ht.NAME_TAG&&t.key!==ht.UNMANAGED_TAG&&t.key!==ht.NAMED_TAG}))},t.prototype.isOptional=function(){return this.matchesTag(ht.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===ht.NAMED_TAG}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return t.key!==ht.INJECT_TAG&&t.key!==ht.MULTI_INJECT_TAG&&t.key!==ht.NAME_TAG&&t.key!==ht.UNMANAGED_TAG&&t.key!==ht.NAMED_TAG})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(ht.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(r){for(var n=0,i=e.metadata;n<i.length;n++){var s=i[n];if(s.key===t&&s.value===r)return!0}return!1}},t}();e.Target=r}));P(xt);xt.Target;var Tt=M((function(t,e){function r(t,e,r,s){var a=t.getConstructorMetadata(r),o=a.compilerGeneratedMetadata;if(void 0===o){var u=pt.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(u)}var c=a.userGeneratedMetadata,h=Object.keys(c),l=function(t,e,r,i,s){for(var a=[],o=0;o<s;o++){var u=n(o,t,e,r,i);null!==u&&a.push(u)}return a}(s,e,o,c,0===r.length&&h.length>0?h.length:r.length),f=i(t,r);return l.concat(f)}function n(t,e,r,n,i){var a=i[t.toString()]||[],o=s(a),u=!0!==o.unmanaged,c=n[t],h=o.inject||o.multiInject;if((c=h||c)instanceof kt.LazyServiceIdentifer&&(c=c.unwrap()),u){if(!e&&(c===Object||c===Function||void 0===c)){var l=pt.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+r+".";throw new Error(l)}var f=new xt.Target(lt.TargetTypeEnum.ConstructorArgument,o.targetName,c);return f.metadata=a,f}return null}function i(t,e){for(var r=t.getPropertiesMetadata(e),n=[],a=0,o=Object.keys(r);a<o.length;a++){var u=o[a],c=r[u],h=s(r[u]),l=h.targetName||u,f=h.inject||h.multiInject,d=new xt.Target(lt.TargetTypeEnum.ClassProperty,l,f);d.metadata=c,n.push(d)}var p=Object.getPrototypeOf(e.prototype).constructor;if(p!==Object){var _=i(t,p);n=n.concat(_)}return n}function s(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[ht.INJECT_TAG],multiInject:e[ht.MULTI_INJECT_TAG],targetName:e[ht.NAME_TAG],unmanaged:e[ht.UNMANAGED_TAG]}}Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=vt.getFunctionName,e.getDependencies=function(t,e){return r(t,vt.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var s=r(e,vt.getFunctionName(i),i,!0),a=s.map((function(t){return t.metadata.filter((function(t){return t.key===ht.UNMANAGED_TAG}))})),o=[].concat.apply([],a).length,u=s.length-o;return u>0?u:t(e,i)}return 0}}));P(Tt);Tt.getFunctionName,Tt.getDependencies,Tt.getBaseClassDependencyCount;var Ct=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,r,n,i){this.id=ft.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=r,this.target=i,this.childRequests=[],this.bindings=Array.isArray(n)?n:[n],this.requestScope=null===r?new Map:null}return t.prototype.addChildRequest=function(e,r,n){var i=new t(e,this.parentContext,this,r,n);return this.childRequests.push(i),i},t}();e.Request=r}));P(Ct);Ct.Request;var St=M((function(t,e){function r(t){return t._bindingDictionary}function n(t,e,r,n,i,s){var a=t?ht.MULTI_INJECT_TAG:ht.INJECT_TAG,o=new yt.Metadata(a,r),u=new xt.Target(e,n,r,o);if(void 0!==i){var c=new yt.Metadata(i,s);u.metadata.push(c)}return u}function i(t,e,r,n,i){var s=a(r.container,i.serviceIdentifier),o=[];return s.length===gt.BindingCount.NoBindingsAvailable&&r.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&t.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(i.serviceIdentifier).toSelf(),s=a(r.container,i.serviceIdentifier)),o=e?s:s.filter((function(t){var e=new Ct.Request(t.serviceIdentifier,r,n,t,i);return t.constraint(e)})),function(t,e,r,n){switch(e.length){case gt.BindingCount.NoBindingsAvailable:if(r.isOptional())return e;var i=vt.getServiceIdentifierAsString(t),s=pt.NOT_REGISTERED;throw s+=vt.listMetadataForTarget(i,r),s+=vt.listRegisteredBindingsForServiceIdentifier(n,i,a),new Error(s);case gt.BindingCount.OnlyOneBindingAvailable:if(!r.isArray())return e;case gt.BindingCount.MultipleBindingsAvailable:default:if(r.isArray())return e;i=vt.getServiceIdentifierAsString(t),s=pt.AMBIGUOUS_MATCH+" "+i;throw s+=vt.listRegisteredBindingsForServiceIdentifier(n,i,a),new Error(s)}}(i.serviceIdentifier,o,i,r.container),o}function s(t,e,r,n,a,o){var u,c;if(null===a){u=i(t,e,n,null,o),c=new Ct.Request(r,n,null,u,o);var h=new wt.Plan(n,c);n.addPlan(h)}else u=i(t,e,n,a,o),c=a.addChildRequest(o.serviceIdentifier,u,o);u.forEach((function(e){var r=null;if(o.isArray())r=c.addChildRequest(e.serviceIdentifier,e,o);else{if(e.cache)return;r=c}if(e.type===lt.BindingTypeEnum.Instance&&null!==e.implementationType){var i=Tt.getDependencies(t,e.implementationType);if(!n.container.options.skipBaseClassChecks){var a=Tt.getBaseClassDependencyCount(t,e.implementationType);if(i.length<a){var u=pt.ARGUMENTS_LENGTH_MISMATCH(Tt.getFunctionName(e.implementationType));throw new Error(u)}}i.forEach((function(e){s(t,!1,e.serviceIdentifier,n,r,e)}))}}))}function a(t,e){var n=[],i=r(t);return i.hasKey(e)?n=i.get(e):null!==t.parent&&(n=a(t.parent,e)),n}Object.defineProperty(e,"__esModule",{value:!0}),e.getBindingDictionary=r,e.plan=function(t,e,r,i,a,o,u,c){void 0===c&&(c=!1);var h=new mt.Context(e),l=n(r,i,a,"",o,u);try{return s(t,c,a,h,null,l),h}catch(t){throw bt.isStackOverflowExeption(t)&&h.plan&&vt.circularDependencyToException(h.plan.rootRequest),t}},e.createMockRequest=function(t,e,r,n){var i=new xt.Target(lt.TargetTypeEnum.Variable,"",e,new yt.Metadata(r,n)),s=new mt.Context(t);return new Ct.Request(e,s,null,[],i)}}));P(St);St.getBindingDictionary,St.plan,St.createMockRequest;var Rt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.resolveInstance=function(t,e,r){var n,i,s=null;if(e.length>0){var a=e.filter((function(t){return null!==t.target&&t.target.type===lt.TargetTypeEnum.ConstructorArgument})).map(r);i=a,s=function(t,e,r){var n=e.filter((function(t){return null!==t.target&&t.target.type===lt.TargetTypeEnum.ClassProperty})),i=n.map(r);return n.forEach((function(e,r){var n;n=e.target.name.value();var s=i[r];t[n]=s})),t}(s=new((n=t).bind.apply(n,[void 0].concat(i))),e,r)}else s=new t;return function(t,e){if(Reflect.hasMetadata(ht.POST_CONSTRUCT,t)){var r=Reflect.getMetadata(ht.POST_CONSTRUCT,t);try{e[r.value]()}catch(e){throw new Error(pt.POST_CONSTRUCT_ERROR(t.name,e.message))}}}(t,s),s}}));P(Rt);Rt.resolveInstance;var It=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,r){try{return r()}catch(r){throw bt.isStackOverflowExeption(r)?new Error(pt.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):r}},n=function(t){return function(e){e.parentContext.setCurrentRequest(e);var i=e.bindings,s=e.childRequests,a=e.target&&e.target.isArray(),o=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(a&&o)return s.map((function(e){return n(t)(e)}));var u=null;if(!e.target.isOptional()||0!==i.length){var c=i[0],h=c.scope===lt.BindingScopeEnum.Singleton,l=c.scope===lt.BindingScopeEnum.Request;if(h&&c.activated)return c.cache;if(l&&null!==t&&t.has(c.id))return t.get(c.id);if(c.type===lt.BindingTypeEnum.ConstantValue)u=c.cache;else if(c.type===lt.BindingTypeEnum.Function)u=c.cache;else if(c.type===lt.BindingTypeEnum.Constructor)u=c.implementationType;else if(c.type===lt.BindingTypeEnum.DynamicValue&&null!==c.dynamicValue)u=r("toDynamicValue",c.serviceIdentifier,(function(){return c.dynamicValue(e.parentContext)}));else if(c.type===lt.BindingTypeEnum.Factory&&null!==c.factory)u=r("toFactory",c.serviceIdentifier,(function(){return c.factory(e.parentContext)}));else if(c.type===lt.BindingTypeEnum.Provider&&null!==c.provider)u=r("toProvider",c.serviceIdentifier,(function(){return c.provider(e.parentContext)}));else{if(c.type!==lt.BindingTypeEnum.Instance||null===c.implementationType){var f=vt.getServiceIdentifierAsString(e.serviceIdentifier);throw new Error(pt.INVALID_BINDING_TYPE+" "+f)}u=Rt.resolveInstance(c.implementationType,s,n(t))}return"function"==typeof c.onActivation&&(u=c.onActivation(e.parentContext,u)),h&&(c.cache=u,c.activated=!0),l&&null!==t&&!t.has(c.id)&&t.set(c.id,u),u}}};e.resolve=function(t){return n(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}}));P(It);It.resolve;var Bt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||r(n,e))};e.traverseAncerstors=r;var n=function(t){return function(e){var r=function(r){return null!==r&&null!==r.target&&r.target.matchesTag(t)(e)};return r.metaData=new yt.Metadata(t,e),r}};e.taggedConstraint=n;var i=n(ht.NAMED_TAG);e.namedConstraint=i;e.typeConstraint=function(t){return function(e){var r=null;if(null!==e){if(r=e.bindings[0],"string"==typeof t)return r.serviceIdentifier===t;var n=e.bindings[0].implementationType;return t===n}return!1}}}));P(Bt);Bt.traverseAncerstors,Bt.taggedConstraint,Bt.namedConstraint,Bt.typeConstraint;var Ot=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new Pt.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=Bt.namedConstraint(t),new Pt.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=Bt.taggedConstraint(t)(e),new Pt.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return Bt.typeConstraint(t)(e.parentRequest)},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return Bt.namedConstraint(t)(e.parentRequest)},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(r){return Bt.taggedConstraint(t)(e)(r.parentRequest)},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return Bt.traverseAncerstors(e,Bt.typeConstraint(t))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!Bt.traverseAncerstors(e,Bt.typeConstraint(t))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return Bt.traverseAncerstors(e,Bt.namedConstraint(t))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!Bt.traverseAncerstors(e,Bt.namedConstraint(t))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(r){return Bt.traverseAncerstors(r,Bt.taggedConstraint(t)(e))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(r){return!Bt.traverseAncerstors(r,Bt.taggedConstraint(t)(e))},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return Bt.traverseAncerstors(e,t)},new Pt.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!Bt.traverseAncerstors(e,t)},new Pt.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=r}));P(Ot);Ot.BindingWhenSyntax;var Pt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new Ot.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=r}));P(Pt);Pt.BindingOnSyntax;var Mt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new Ot.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Pt.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=r}));P(Mt);Mt.BindingWhenOnSyntax;var Dt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=lt.BindingScopeEnum.Request,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=lt.BindingScopeEnum.Singleton,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=lt.BindingScopeEnum.Transient,new Mt.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=r}));P(Dt);Dt.BindingInSyntax;var Ft=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new Ot.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Pt.BindingOnSyntax(this._binding),this._bindingInSyntax=new Dt.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=r}));P(Ft);Ft.BindingInWhenOnSyntax;var Lt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=lt.BindingTypeEnum.Instance,this._binding.implementationType=t,new Ft.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+pt.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=lt.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=lt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Ft.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=lt.BindingTypeEnum.Constructor,this._binding.implementationType=t,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=lt.BindingTypeEnum.Factory,this._binding.factory=t,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(pt.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=lt.BindingTypeEnum.Function,e},t.prototype.toAutoFactory=function(t){return this._binding.type=lt.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=lt.BindingTypeEnum.Provider,this._binding.provider=t,new Mt.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}();e.BindingToSyntax=r}));P(Lt);Lt.BindingToSyntax;var jt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.of=function(e,r){var n=new t;return n.bindings=e,n.middleware=r,n},t}();e.ContainerSnapshot=r}));P(jt);jt.ContainerSnapshot;var Nt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(pt.NULL_ARGUMENT);if(null==e)throw new Error(pt.NULL_ARGUMENT);var r=this._map.get(t);void 0!==r?(r.push(e),this._map.set(t,r)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(pt.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(pt.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(pt.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(pt.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(r,n){var i=r.filter((function(e){return!t(e)}));i.length>0?e._map.set(n,i):e._map.delete(n)}))},t.prototype.hasKey=function(t){if(null==t)throw new Error(pt.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,r){t.forEach((function(t){return e.add(r,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,r){t(r,e)}))},t}();e.Lookup=r}));P(Nt);Nt.Lookup;var Ut=M((function(t,e){var r=O&&O.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function a(t){try{u(n.next(t))}catch(t){s(t)}}function o(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(a,o)}u((n=n.apply(t,e||[])).next())}))},n=O&&O.__generator||function(t,e){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=n[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){var e=t||{};if("object"!=typeof e)throw new Error(""+pt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=lt.BindingScopeEnum.Transient;else if(e.defaultScope!==lt.BindingScopeEnum.Singleton&&e.defaultScope!==lt.BindingScopeEnum.Transient&&e.defaultScope!==lt.BindingScopeEnum.Request)throw new Error(""+pt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error(""+pt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error(""+pt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=ft.id(),this._bindingDictionary=new Nt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new _t.MetadataReader}return t.merge=function(e,r){var n=new t,i=St.getBindingDictionary(n),s=St.getBindingDictionary(e),a=St.getBindingDictionary(r);function o(t,e){t.traverse((function(t,r){r.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return o(s,i),o(a,i),n},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._getContainerModuleHelpersFactory(),n=0,i=t;n<i.length;n++){var s=i[n],a=r(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e,r,i,s,a;return n(this,(function(n){switch(n.label){case 0:e=this._getContainerModuleHelpersFactory(),r=0,i=t,n.label=1;case 1:return r<i.length?(s=i[r],a=e(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:n.sent(),n.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var r=n(e.id);t._bindingDictionary.removeByCondition(r)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||lt.BindingScopeEnum.Transient,r=new dt.Binding(t,e);return this._bindingDictionary.add(t,r),new Lt.BindingToSyntax(r)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(pt.CANNOT_UNBIND+" "+vt.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new Nt.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,ht.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,r){var n=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),s=St.createMockRequest(this,t,e,r);n=i.some((function(t){return t.constraint(s)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(t,e,r)),n},t.prototype.snapshot=function(){this._snapshots.push(jt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(pt.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var r=new t(e||this.options);return r.parent=this,r},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),r)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,lt.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,r){return this._get(!1,!1,lt.TargetTypeEnum.Variable,t,e,r)},t.prototype.getNamed=function(t,e){return this.getTagged(t,ht.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,lt.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,r){return this._get(!1,!0,lt.TargetTypeEnum.Variable,t,e,r)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,ht.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},r=function(r){return function(n){var i=t.rebind.bind(t)(n);return e(i,r),i}};return function(n){return{bindFunction:(i=n,function(r){var n=t.bind.bind(t)(r);return e(n,i),n}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:r(n),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,r,n,i,s){var a=null,o={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:n,targetType:r,value:s};if(this._middleware){if(null==(a=this._middleware(o)))throw new Error(pt.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(o);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var r=St.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return r=e.contextInterceptor(r),It.resolve(r)}},t}();e.Container=i}));P(Ut);Ut.Container;var zt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){this.id=ft.id(),this.registry=t};e.ContainerModule=r;var n=function(t){this.id=ft.id(),this.registry=t};e.AsyncContainerModule=n}));P(zt);zt.ContainerModule,zt.AsyncContainerModule;var $t=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(ht.PARAM_TYPES,t))throw new Error(pt.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(ht.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(ht.PARAM_TYPES,e,t),t}}}));P($t);$t.injectable;var Ht=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.tagged=function(t,e){return function(r,n,i){var s=new yt.Metadata(t,e);"number"==typeof i?At.tagParameter(r,n,i,s):At.tagProperty(r,n,s)}}}));P(Ht);Ht.tagged;var Wt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.named=function(t){return function(e,r,n){var i=new yt.Metadata(ht.NAMED_TAG,t);"number"==typeof n?At.tagParameter(e,r,n,i):At.tagProperty(e,r,i)}}}));P(Wt);Wt.named;var qt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.optional=function(){return function(t,e,r){var n=new yt.Metadata(ht.OPTIONAL_TAG,!0);"number"==typeof r?At.tagParameter(t,e,r,n):At.tagProperty(t,e,n)}}}));P(qt);qt.optional;var Gt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.unmanaged=function(){return function(t,e,r){var n=new yt.Metadata(ht.UNMANAGED_TAG,!0);At.tagParameter(t,e,r,n)}}}));P(Gt);Gt.unmanaged;var Vt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiInject=function(t){return function(e,r,n){var i=new yt.Metadata(ht.MULTI_INJECT_TAG,t);"number"==typeof n?At.tagParameter(e,r,n,i):At.tagProperty(e,r,i)}}}));P(Vt);Vt.multiInject;var Xt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.targetName=function(t){return function(e,r,n){var i=new yt.Metadata(ht.NAME_TAG,t);At.tagParameter(e,r,n,i)}}}));P(Xt);Xt.targetName;var Kt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.postConstruct=function(){return function(t,e,r){var n=new yt.Metadata(ht.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(ht.POST_CONSTRUCT,t.constructor))throw new Error(pt.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(ht.POST_CONSTRUCT,n,t.constructor)}}}));P(Kt);Kt.postConstruct;var Yt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=function(t){return function(e){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.forEach((function(r){return t.bind(r).toService(e)}))}}}}));P(Yt);Yt.multiBindToService;var Jt=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.METADATA_KEY=ht,e.Container=Ut.Container,e.BindingScopeEnum=lt.BindingScopeEnum,e.BindingTypeEnum=lt.BindingTypeEnum,e.TargetTypeEnum=lt.TargetTypeEnum,e.AsyncContainerModule=zt.AsyncContainerModule,e.ContainerModule=zt.ContainerModule,e.injectable=$t.injectable,e.tagged=Ht.tagged,e.named=Wt.named,e.inject=kt.inject,e.LazyServiceIdentifer=kt.LazyServiceIdentifer,e.optional=qt.optional,e.unmanaged=Gt.unmanaged,e.multiInject=Vt.multiInject,e.targetName=Xt.targetName,e.postConstruct=Kt.postConstruct,e.MetadataReader=_t.MetadataReader,e.id=ft.id,e.decorate=At.decorate,e.traverseAncerstors=Bt.traverseAncerstors,e.taggedConstraint=Bt.taggedConstraint,e.namedConstraint=Bt.namedConstraint,e.typeConstraint=Bt.typeConstraint,e.getServiceIdentifierAsString=vt.getServiceIdentifierAsString,e.multiBindToService=Yt.multiBindToService}));P(Jt);Jt.METADATA_KEY;var Qt=Jt.Container,Zt=(Jt.BindingScopeEnum,Jt.BindingTypeEnum,Jt.TargetTypeEnum,Jt.AsyncContainerModule,Jt.ContainerModule,Jt.injectable),te=(Jt.tagged,Jt.named,Jt.inject);Jt.LazyServiceIdentifer,Jt.optional,Jt.unmanaged,Jt.multiInject,Jt.targetName,Jt.postConstruct,Jt.MetadataReader,Jt.id,Jt.decorate,Jt.traverseAncerstors,Jt.taggedConstraint,Jt.namedConstraint,Jt.typeConstraint,Jt.getServiceIdentifierAsString,Jt.multiBindToService;let ee=class{constructor(){this._watchMedia=t=>{this._queries.forEach(t=>{t.removeEventListener?t.removeEventListener("change",this._updateQueries):t.removeListener(this._updateQueries)}),this._queries=t.map(t=>matchMedia(t)),this._queries.forEach(t=>{t.removeEventListener?t.addEventListener("change",this._updateQueries):t.addListener(this._updateQueries)}),this._updateQueries()},this._updateQueries=()=>this._ports.onMediaUpdate_.send(this._queries.map(t=>t.matches)),this._queries=[]}init(t){this._ports=t,t.watchMedia_.subscribe(this._watchMedia)}};ee=t([Zt()],ee);var re=ee;let ne=class{constructor(){this._scrollIntoView=([t,e])=>{const r=document.getElementById(e);r?r.scrollIntoView({block:t}):new ie(t,e).start()}}init(t){t.scrollIntoView_.subscribe(this._scrollIntoView)}};ne=t([Zt()],ne);class ie{constructor(t,e,r=500){this._position=t,this._id=e,this._timeout=r,this._onMutation=t=>{if(!t.some(t=>t.addedNodes))return;const e=document.getElementById(this._id);e&&(this._observer.disconnect(),clearTimeout(this._timeoutHandle),e.scrollIntoView({block:this._position}))},this._observer=new MutationObserver(this._onMutation),this._timeoutHandle=null}start(){setTimeout(()=>this._observer.disconnect(),this._timeout),this._observer.observe(document.body,{attributes:!1,characterData:!1,childList:!0,subtree:!0})}}var se=ne,ae=[],oe=[],ue="undefined"!=typeof Uint8Array?Uint8Array:Array,ce=!1;function he(){ce=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)ae[e]=t[e],oe[t.charCodeAt(e)]=e;oe["-".charCodeAt(0)]=62,oe["_".charCodeAt(0)]=63}function le(t,e,r){for(var n,i,s=[],a=e;a<r;a+=3)n=(t[a]<<16)+(t[a+1]<<8)+t[a+2],s.push(ae[(i=n)>>18&63]+ae[i>>12&63]+ae[i>>6&63]+ae[63&i]);return s.join("")}function fe(t){var e;ce||he();for(var r=t.length,n=r%3,i="",s=[],a=16383,o=0,u=r-n;o<u;o+=a)s.push(le(t,o,o+a>u?u:o+a));return 1===n?(e=t[r-1],i+=ae[e>>2],i+=ae[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=ae[e>>10],i+=ae[e>>4&63],i+=ae[e<<2&63],i+="="),s.push(i),s.join("")}function de(t,e,r,n,i){var s,a,o=8*i-n-1,u=(1<<o)-1,c=u>>1,h=-7,l=r?i-1:0,f=r?-1:1,d=t[e+l];for(l+=f,s=d&(1<<-h)-1,d>>=-h,h+=o;h>0;s=256*s+t[e+l],l+=f,h-=8);for(a=s&(1<<-h)-1,s>>=-h,h+=n;h>0;a=256*a+t[e+l],l+=f,h-=8);if(0===s)s=1-c;else{if(s===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),s-=c}return(d?-1:1)*a*Math.pow(2,s-n)}function pe(t,e,r,n,i,s){var a,o,u,c=8*s-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(a++,u/=2),a+l>=h?(o=0,a=h):a+l>=1?(o=(e*u-1)*Math.pow(2,i),a+=l):(o=e*Math.pow(2,l-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&o,d+=p,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;t[r+d]=255&a,d+=p,a/=256,c-=8);t[r+d-p]|=128*_}var _e={}.toString,ge=Array.isArray||function(t){return"[object Array]"==_e.call(t)};function be(){return me.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ve(t,e){if(be()<e)throw new RangeError("Invalid typed array length");return me.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=me.prototype:(null===t&&(t=new me(e)),t.length=e),t}function me(t,e,r){if(!(me.TYPED_ARRAY_SUPPORT||this instanceof me))return new me(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Ae(this,t)}return ye(this,t,e,r)}function ye(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);me.TYPED_ARRAY_SUPPORT?(t=e).__proto__=me.prototype:t=ke(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!me.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Te(e,r),i=(t=ve(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(xe(e)){var r=0|Ee(e.length);return 0===(t=ve(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?ve(t,0):ke(t,e);if("Buffer"===e.type&&ge(e.data))return ke(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function we(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Ae(t,e){if(we(e),t=ve(t,e<0?0:0|Ee(e)),!me.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function ke(t,e){var r=e.length<0?0:0|Ee(e.length);t=ve(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function Ee(t){if(t>=be())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+be().toString(16)+" bytes");return 0|t}function xe(t){return!(null==t||!t._isBuffer)}function Te(t,e){if(xe(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Ze(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return tr(t).length;default:if(n)return Ze(t).length;e=(""+e).toLowerCase(),n=!0}}function Ce(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return $e(this,e,r);case"utf8":case"utf-8":return je(this,e,r);case"ascii":return Ue(this,e,r);case"latin1":case"binary":return ze(this,e,r);case"base64":return Le(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return He(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function Se(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Re(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=me.from(e,n)),xe(e))return 0===e.length?-1:Ie(t,e,r,n,i);if("number"==typeof e)return e&=255,me.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Ie(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Ie(t,e,r,n,i){var s,a=1,o=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,o/=2,u/=2,r/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var h=-1;for(s=r;s<o;s++)if(c(t,s)===c(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*a}else-1!==h&&(s-=s-h),h=-1}else for(r+u>o&&(r=o-u),s=r;s>=0;s--){for(var l=!0,f=0;f<u;f++)if(c(t,s+f)!==c(e,f)){l=!1;break}if(l)return s}return-1}function Be(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o=parseInt(e.substr(2*a,2),16);if(isNaN(o))return a;t[r+a]=o}return a}function Oe(t,e,r,n){return er(Ze(e,t.length-r),t,r,n)}function Pe(t,e,r,n){return er(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function Me(t,e,r,n){return Pe(t,e,r,n)}function De(t,e,r,n){return er(tr(e),t,r,n)}function Fe(t,e,r,n){return er(function(t,e){for(var r,n,i,s=[],a=0;a<t.length&&!((e-=2)<0);++a)n=(r=t.charCodeAt(a))>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function Le(t,e,r){return 0===e&&r===t.length?fe(t):fe(t.slice(e,r))}function je(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,a,o,u,c=t[i],h=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=r)switch(l){case 1:c<128&&(h=c);break;case 2:128==(192&(s=t[i+1]))&&(u=(31&c)<<6|63&s)>127&&(h=u);break;case 3:s=t[i+1],a=t[i+2],128==(192&s)&&128==(192&a)&&(u=(15&c)<<12|(63&s)<<6|63&a)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=t[i+1],a=t[i+2],o=t[i+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&(u=(15&c)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&u<1114112&&(h=u)}null===h?(h=65533,l=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=l}return function(t){var e=t.length;if(e<=Ne)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Ne));return r}(n)}me.TYPED_ARRAY_SUPPORT=void 0===s.TYPED_ARRAY_SUPPORT||s.TYPED_ARRAY_SUPPORT,me.poolSize=8192,me._augment=function(t){return t.__proto__=me.prototype,t},me.from=function(t,e,r){return ye(null,t,e,r)},me.TYPED_ARRAY_SUPPORT&&(me.prototype.__proto__=Uint8Array.prototype,me.__proto__=Uint8Array),me.alloc=function(t,e,r){return function(t,e,r,n){return we(e),e<=0?ve(t,e):void 0!==r?"string"==typeof n?ve(t,e).fill(r,n):ve(t,e).fill(r):ve(t,e)}(null,t,e,r)},me.allocUnsafe=function(t){return Ae(null,t)},me.allocUnsafeSlow=function(t){return Ae(null,t)},me.isBuffer=rr,me.compare=function(t,e){if(!xe(t)||!xe(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},me.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},me.concat=function(t,e){if(!ge(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return me.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=me.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!xe(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},me.byteLength=Te,me.prototype._isBuffer=!0,me.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Se(this,e,e+1);return this},me.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Se(this,e,e+3),Se(this,e+1,e+2);return this},me.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Se(this,e,e+7),Se(this,e+1,e+6),Se(this,e+2,e+5),Se(this,e+3,e+4);return this},me.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?je(this,0,t):Ce.apply(this,arguments)},me.prototype.equals=function(t){if(!xe(t))throw new TypeError("Argument must be a Buffer");return this===t||0===me.compare(this,t)},me.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},me.prototype.compare=function(t,e,r,n,i){if(!xe(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),o=Math.min(s,a),u=this.slice(n,i),c=t.slice(e,r),h=0;h<o;++h)if(u[h]!==c[h]){s=u[h],a=c[h];break}return s<a?-1:a<s?1:0},me.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},me.prototype.indexOf=function(t,e,r){return Re(this,t,e,r,!0)},me.prototype.lastIndexOf=function(t,e,r){return Re(this,t,e,r,!1)},me.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return Be(this,t,e,r);case"utf8":case"utf-8":return Oe(this,t,e,r);case"ascii":return Pe(this,t,e,r);case"latin1":case"binary":return Me(this,t,e,r);case"base64":return De(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},me.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ne=4096;function Ue(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function ze(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function $e(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=Qe(t[s]);return i}function He(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function We(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function qe(t,e,r,n,i,s){if(!xe(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Ge(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-r,2);i<s;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Ve(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-r,4);i<s;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Xe(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Ke(t,e,r,n,i){return i||Xe(t,0,r,4),pe(t,e,r,n,23,4),r+4}function Ye(t,e,r,n,i){return i||Xe(t,0,r,8),pe(t,e,r,n,52,8),r+8}me.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),me.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=me.prototype;else{var i=e-t;r=new me(i,void 0);for(var s=0;s<i;++s)r[s]=this[s+t]}return r},me.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||We(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},me.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||We(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},me.prototype.readUInt8=function(t,e){return e||We(t,1,this.length),this[t]},me.prototype.readUInt16LE=function(t,e){return e||We(t,2,this.length),this[t]|this[t+1]<<8},me.prototype.readUInt16BE=function(t,e){return e||We(t,2,this.length),this[t]<<8|this[t+1]},me.prototype.readUInt32LE=function(t,e){return e||We(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},me.prototype.readUInt32BE=function(t,e){return e||We(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},me.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||We(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},me.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||We(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},me.prototype.readInt8=function(t,e){return e||We(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},me.prototype.readInt16LE=function(t,e){e||We(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},me.prototype.readInt16BE=function(t,e){e||We(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},me.prototype.readInt32LE=function(t,e){return e||We(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},me.prototype.readInt32BE=function(t,e){return e||We(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},me.prototype.readFloatLE=function(t,e){return e||We(t,4,this.length),de(this,t,!0,23,4)},me.prototype.readFloatBE=function(t,e){return e||We(t,4,this.length),de(this,t,!1,23,4)},me.prototype.readDoubleLE=function(t,e){return e||We(t,8,this.length),de(this,t,!0,52,8)},me.prototype.readDoubleBE=function(t,e){return e||We(t,8,this.length),de(this,t,!1,52,8)},me.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||qe(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},me.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||qe(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},me.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,1,255,0),me.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},me.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,2,65535,0),me.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Ge(this,t,e,!0),e+2},me.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,2,65535,0),me.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Ge(this,t,e,!1),e+2},me.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,4,4294967295,0),me.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ve(this,t,e,!0),e+4},me.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,4,4294967295,0),me.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ve(this,t,e,!1),e+4},me.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);qe(this,t,e,r,i-1,-i)}var s=0,a=1,o=0;for(this[e]=255&t;++s<r&&(a*=256);)t<0&&0===o&&0!==this[e+s-1]&&(o=1),this[e+s]=(t/a>>0)-o&255;return e+r},me.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);qe(this,t,e,r,i-1,-i)}var s=r-1,a=1,o=0;for(this[e+s]=255&t;--s>=0&&(a*=256);)t<0&&0===o&&0!==this[e+s+1]&&(o=1),this[e+s]=(t/a>>0)-o&255;return e+r},me.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,1,127,-128),me.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},me.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,2,32767,-32768),me.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Ge(this,t,e,!0),e+2},me.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,2,32767,-32768),me.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Ge(this,t,e,!1),e+2},me.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,4,2147483647,-2147483648),me.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ve(this,t,e,!0),e+4},me.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||qe(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),me.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ve(this,t,e,!1),e+4},me.prototype.writeFloatLE=function(t,e,r){return Ke(this,t,e,!0,r)},me.prototype.writeFloatBE=function(t,e,r){return Ke(this,t,e,!1,r)},me.prototype.writeDoubleLE=function(t,e,r){return Ye(this,t,e,!0,r)},me.prototype.writeDoubleBE=function(t,e,r){return Ye(this,t,e,!1,r)},me.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,s=n-r;if(this===t&&r<e&&e<n)for(i=s-1;i>=0;--i)t[i+e]=this[i+r];else if(s<1e3||!me.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},me.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!me.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=xe(t)?t:Ze(new me(t,n).toString()),o=a.length;for(s=0;s<r-e;++s)this[s+e]=a[s%o]}return this};var Je=/[^+\/0-9A-Za-z-_]/g;function Qe(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ze(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function tr(t){return function(t){var e,r,n,i,s,a;ce||he();var o=t.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[o-2]?2:"="===t[o-1]?1:0,a=new ue(3*o/4-s),n=s>0?o-4:o;var u=0;for(e=0,r=0;e<n;e+=4,r+=3)i=oe[t.charCodeAt(e)]<<18|oe[t.charCodeAt(e+1)]<<12|oe[t.charCodeAt(e+2)]<<6|oe[t.charCodeAt(e+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===s?(i=oe[t.charCodeAt(e)]<<2|oe[t.charCodeAt(e+1)]>>4,a[u++]=255&i):1===s&&(i=oe[t.charCodeAt(e)]<<10|oe[t.charCodeAt(e+1)]<<4|oe[t.charCodeAt(e+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Je,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function er(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function rr(t){return null!=t&&(!!t._isBuffer||nr(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&nr(t.slice(0,0))}(t))}function nr(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function ir(){}function sr(){sr.init.call(this)}function ar(t){return void 0===t._maxListeners?sr.defaultMaxListeners:t._maxListeners}function or(t,e,r){if(e)t.call(r);else for(var n=t.length,i=_r(t,n),s=0;s<n;++s)i[s].call(r)}function ur(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,s=_r(t,i),a=0;a<i;++a)s[a].call(r,n)}function cr(t,e,r,n,i){if(e)t.call(r,n,i);else for(var s=t.length,a=_r(t,s),o=0;o<s;++o)a[o].call(r,n,i)}function hr(t,e,r,n,i,s){if(e)t.call(r,n,i,s);else for(var a=t.length,o=_r(t,a),u=0;u<a;++u)o[u].call(r,n,i,s)}function lr(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,s=_r(t,i),a=0;a<i;++a)s[a].apply(r,n)}function fr(t,e,r,n){var i,s,a,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]):(s=t._events=new ir,t._eventsCount=0),a){if("function"==typeof a?a=s[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(i=ar(t))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,o=u,"function"==typeof console.warn?console.warn(o):console.log(o)}}else a=s[e]=r,++t._eventsCount;return t}function dr(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}function pr(t){var e=this._events;if(e){var r=e[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function _r(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}ir.prototype=Object.create(null),sr.EventEmitter=sr,sr.usingDomains=!1,sr.prototype.domain=void 0,sr.prototype._events=void 0,sr.prototype._maxListeners=void 0,sr.defaultMaxListeners=10,sr.init=function(){this.domain=null,sr.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new ir,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},sr.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},sr.prototype.getMaxListeners=function(){return ar(this)},sr.prototype.emit=function(t){var e,r,n,i,s,a,o,u="error"===t;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(o=this.domain,u){if(e=arguments[1],!o){if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=o,e.domainThrown=!1,o.emit("error",e),!1}if(!(r=a[t]))return!1;var h="function"==typeof r;switch(n=arguments.length){case 1:or(r,h,this);break;case 2:ur(r,h,this,arguments[1]);break;case 3:cr(r,h,this,arguments[1],arguments[2]);break;case 4:hr(r,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),s=1;s<n;s++)i[s-1]=arguments[s];lr(r,h,this,i)}return!0},sr.prototype.addListener=function(t,e){return fr(this,t,e,!1)},sr.prototype.on=sr.prototype.addListener,sr.prototype.prependListener=function(t,e){return fr(this,t,e,!0)},sr.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,dr(this,t,e)),this},sr.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,dr(this,t,e)),this},sr.prototype.removeListener=function(t,e){var r,n,i,s,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new ir:(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,s=r.length;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){a=r[s].listener,i=s;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new ir,this;delete n[t]}else!function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i);n.removeListener&&this.emit("removeListener",t,a||e)}return this},sr.prototype.removeAllListeners=function(t){var e,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new ir,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new ir:delete r[t]),this;if(0===arguments.length){for(var n,i=Object.keys(r),s=0;s<i.length;++s)"removeListener"!==(n=i[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new ir,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},sr.prototype.listeners=function(t){var e,r=this._events;return r&&(e=r[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(e):[]},sr.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):pr.call(t,e)},sr.prototype.listenerCount=pr,sr.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var gr="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t},br=/%[sdj%]/g;function vr(t){if(!Ir(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(Ar(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,i=n.length,s=String(t).replace(br,(function(t){if("%%"===t)return"%";if(r>=i)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}})),a=n[r];r<i;a=n[++r])Rr(a)||!Pr(a)?s+=" "+a:s+=" "+Ar(a);return s}function mr(t,e){if(Br(s.process))return function(){return mr(t,e).apply(this,arguments)};if(!0===B.noDeprecation)return t;var r=!1;return function(){if(!r){if(B.throwDeprecation)throw new Error(e);B.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}}var yr,wr={};function Ar(t,e){var r={seen:[],stylize:Er};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Sr(e)?r.showHidden=e:e&&jr(r,e),Br(r.showHidden)&&(r.showHidden=!1),Br(r.depth)&&(r.depth=2),Br(r.colors)&&(r.colors=!1),Br(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=kr),xr(r,t,r.depth)}function kr(t,e){var r=Ar.styles[e];return r?"["+Ar.colors[r][0]+"m"+t+"["+Ar.colors[r][1]+"m":t}function Er(t,e){return t}function xr(t,e,r){if(t.customInspect&&e&&Fr(e.inspect)&&e.inspect!==Ar&&(!e.constructor||e.constructor.prototype!==e)){var n=e.inspect(r,t);return Ir(n)||(n=xr(t,n,r)),n}var i=function(t,e){if(Br(e))return t.stylize("undefined","undefined");if(Ir(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(n=e,"number"==typeof n)return t.stylize(""+e,"number");var n;if(Sr(e))return t.stylize(""+e,"boolean");if(Rr(e))return t.stylize("null","null")}(t,e);if(i)return i;var s=Object.keys(e),a=function(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),Dr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Tr(e);if(0===s.length){if(Fr(e)){var o=e.name?": "+e.name:"";return t.stylize("[Function"+o+"]","special")}if(Or(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Mr(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Dr(e))return Tr(e)}var u,c,h="",l=!1,f=["{","}"];(u=e,Array.isArray(u)&&(l=!0,f=["[","]"]),Fr(e))&&(h=" [Function"+(e.name?": "+e.name:"")+"]");return Or(e)&&(h=" "+RegExp.prototype.toString.call(e)),Mr(e)&&(h=" "+Date.prototype.toUTCString.call(e)),Dr(e)&&(h=" "+Tr(e)),0!==s.length||l&&0!=e.length?r<0?Or(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=l?function(t,e,r,n,i){for(var s=[],a=0,o=e.length;a<o;++a)Nr(e,String(a))?s.push(Cr(t,e,r,n,String(a),!0)):s.push("");return i.forEach((function(i){i.match(/^\d+$/)||s.push(Cr(t,e,r,n,i,!0))})),s}(t,e,r,a,s):s.map((function(n){return Cr(t,e,r,a,n,l)})),t.seen.pop(),function(t,e,r){if(t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(c,h,f)):f[0]+h+f[1]}function Tr(t){return"["+Error.prototype.toString.call(t)+"]"}function Cr(t,e,r,n,i,s){var a,o,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(o=t.stylize("[Setter]","special")),Nr(n,i)||(a="["+i+"]"),o||(t.seen.indexOf(u.value)<0?(o=Rr(r)?xr(t,u.value,null):xr(t,u.value,r-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+o.split("\n").map((function(t){return"   "+t})).join("\n")):o=t.stylize("[Circular]","special")),Br(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+o}function Sr(t){return"boolean"==typeof t}function Rr(t){return null===t}function Ir(t){return"string"==typeof t}function Br(t){return void 0===t}function Or(t){return Pr(t)&&"[object RegExp]"===Lr(t)}function Pr(t){return"object"==typeof t&&null!==t}function Mr(t){return Pr(t)&&"[object Date]"===Lr(t)}function Dr(t){return Pr(t)&&("[object Error]"===Lr(t)||t instanceof Error)}function Fr(t){return"function"==typeof t}function Lr(t){return Object.prototype.toString.call(t)}function jr(t,e){if(!e||!Pr(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}function Nr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ur(){this.head=null,this.tail=null,this.length=0}Ar.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Ar.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Ur.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},Ur.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},Ur.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},Ur.prototype.clear=function(){this.head=this.tail=null,this.length=0},Ur.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r},Ur.prototype.concat=function(t){if(0===this.length)return me.alloc(0);if(1===this.length)return this.head.data;for(var e=me.allocUnsafe(t>>>0),r=this.head,n=0;r;)r.data.copy(e,n),n+=r.data.length,r=r.next;return e};var zr=me.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $r(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!zr(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Wr;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=qr;break;default:return void(this.write=Hr)}this.charBuffer=new me(6),this.charReceived=0,this.charLength=0}function Hr(t){return t.toString(this.encoding)}function Wr(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function qr(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}$r.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(t=t.slice(r,t.length),!((i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var n=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,n),n-=this.charReceived);var i;n=(e+=t.toString(this.encoding,0,n)).length-1;if((i=e.charCodeAt(n))>=55296&&i<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),t.copy(this.charBuffer,0,0,s),e.substring(0,n)}return e},$r.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(e<=2&&r>>4==14){this.charLength=3;break}if(e<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=e},$r.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e},Xr.ReadableState=Vr;var Gr=function(t){if(Br(yr)&&(yr=B.env.NODE_DEBUG||""),t=t.toUpperCase(),!wr[t])if(new RegExp("\\b"+t+"\\b","i").test(yr)){wr[t]=function(){var e=vr.apply(null,arguments);console.error("%s %d: %s",t,0,e)}}else wr[t]=function(){};return wr[t]}("stream");function Vr(t,e){t=t||{},this.objectMode=!!t.objectMode,e instanceof kn&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new Ur,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new $r(t.encoding),this.encoding=t.encoding)}function Xr(t){if(!(this instanceof Xr))return new Xr(t);this._readableState=new Vr(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),sr.call(this)}function Kr(t,e,r,n,i){var s=function(t,e){var r=null;rr(e)||"string"==typeof e||null==e||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(e,r);if(s)t.emit("error",s);else if(null===r)e.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,Qr(t)}(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var o=new Error("stream.unshift() after end event");t.emit("error",o)}else{var u;!e.decoder||i||n||(r=e.decoder.write(r),u=!e.objectMode&&0===r.length),i||(e.reading=!1),u||(e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Qr(t))),function(t,e){e.readingMore||(e.readingMore=!0,b(tn,t,e))}(t,e)}else i||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}gr(Xr,sr),Xr.prototype.push=function(t,e){var r=this._readableState;return r.objectMode||"string"!=typeof t||(e=e||r.defaultEncoding)!==r.encoding&&(t=me.from(t,e),e=""),Kr(this,r,t,e,!1)},Xr.prototype.unshift=function(t){return Kr(this,this._readableState,t,"",!0)},Xr.prototype.isPaused=function(){return!1===this._readableState.flowing},Xr.prototype.setEncoding=function(t){return this._readableState.decoder=new $r(t),this._readableState.encoding=t,this};var Yr=8388608;function Jr(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=Yr?t=Yr:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function Qr(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Gr("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?b(Zr,t):Zr(t))}function Zr(t){Gr("emit readable"),t.emit("readable"),nn(t)}function tn(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Gr("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function en(t){Gr("readable nexttick read 0"),t.read(0)}function rn(t,e){e.reading||(Gr("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),nn(t),e.flowing&&!e.reading&&t.read(0)}function nn(t){var e=t._readableState;for(Gr("flow",e.flowing);e.flowing&&null!==t.read(););}function sn(t,e){return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):r=function(t,e,r){var n;t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():r?function(t,e){var r=e.head,n=1,i=r.data;t-=i.length;for(;r=r.next;){var s=r.data,a=t>s.length?s.length:t;if(a===s.length?i+=s:i+=s.slice(0,t),0===(t-=a)){a===s.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=s.slice(a));break}++n}return e.length-=n,i}(t,e):function(t,e){var r=me.allocUnsafe(t),n=e.head,i=1;n.data.copy(r),t-=n.data.length;for(;n=n.next;){var s=n.data,a=t>s.length?s.length:t;if(s.copy(r,r.length-t,0,a),0===(t-=a)){a===s.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(a));break}++i}return e.length-=i,r}(t,e);return n}(t,e.buffer,e.decoder),r);var r}function an(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,b(on,e,t))}function on(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function un(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function cn(){}function hn(t,e,r){this.chunk=t,this.encoding=e,this.callback=r,this.next=null}function ln(t,e){Object.defineProperty(this,"buffer",{get:mr((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),t=t||{},this.objectMode=!!t.objectMode,e instanceof kn&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===t.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),e)!function(t,e,r,n,i){--e.pendingcb,r?b(i,n):i(n);t._writableState.errorEmitted=!0,t.emit("error",n)}(t,r,n,e,i);else{var s=gn(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||_n(t,r),n?b(pn,t,r,s,i):pn(t,r,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new mn(this)}function fn(t){if(!(this instanceof fn||this instanceof kn))return new fn(t);this._writableState=new ln(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),sr.call(this)}function dn(t,e,r,n,i,s,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function pn(t,e,r,n){r||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),vn(t,e)}function _n(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;dn(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new mn(e)}else{for(;r;){var o=r.chunk,u=r.encoding,c=r.callback;if(dn(t,e,!1,e.objectMode?1:o.length,o,u,c),r=r.next,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=r,e.bufferProcessing=!1}function gn(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function bn(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function vn(t,e){var r=gn(e);return r&&(0===e.pendingcb?(bn(t,e),e.finished=!0,t.emit("finish")):bn(t,e)),r}function mn(t){var e=this;this.next=null,this.entry=null,this.finish=function(r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}Xr.prototype.read=function(t){Gr("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Gr("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?an(this):Qr(this),null;if(0===(t=Jr(t,e))&&e.ended)return 0===e.length&&an(this),null;var n,i=e.needReadable;return Gr("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&Gr("length less than watermark",i=!0),e.ended||e.reading?Gr("reading or ended",i=!1):i&&(Gr("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Jr(r,e))),null===(n=t>0?sn(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&an(this)),null!==n&&this.emit("data",n),n},Xr.prototype._read=function(t){this.emit("error",new Error("not implemented"))},Xr.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1,Gr("pipe count=%d opts=%j",n.pipesCount,e);var i=!e||!1!==e.end?a:c;function s(t){Gr("onunpipe"),t===r&&c()}function a(){Gr("onend"),t.end()}n.endEmitted?b(i):r.once("end",i),t.on("unpipe",s);var o=function(t){return function(){var e=t._readableState;Gr("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&t.listeners("data").length&&(e.flowing=!0,nn(t))}}(r);t.on("drain",o);var u=!1;function c(){Gr("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",o),t.removeListener("error",f),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",c),r.removeListener("data",l),u=!0,!n.awaitDrain||t._writableState&&!t._writableState.needDrain||o()}var h=!1;function l(e){Gr("ondata"),h=!1,!1!==t.write(e)||h||((1===n.pipesCount&&n.pipes===t||n.pipesCount>1&&-1!==un(n.pipes,t))&&!u&&(Gr("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,h=!0),r.pause())}function f(e){var r;Gr("onerror",e),_(),t.removeListener("error",f),0===(r="error",t.listeners(r).length)&&t.emit("error",e)}function d(){t.removeListener("finish",p),_()}function p(){Gr("onfinish"),t.removeListener("close",d),_()}function _(){Gr("unpipe"),r.unpipe(t)}return r.on("data",l),function(t,e,r){if("function"==typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r)}(t,"error",f),t.once("close",d),t.once("finish",p),t.emit("pipe",r),n.flowing||(Gr("pipe resume"),r.resume()),t},Xr.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this)),this;if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var s=un(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this)),this},Xr.prototype.on=function(t,e){var r=sr.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&Qr(this):b(en,this))}return r},Xr.prototype.addListener=Xr.prototype.on,Xr.prototype.resume=function(){var t=this._readableState;return t.flowing||(Gr("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,b(rn,t,e))}(this,t)),this},Xr.prototype.pause=function(){return Gr("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Gr("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Xr.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;for(var i in t.on("end",(function(){if(Gr("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)})),t.on("data",(function(i){(Gr("wrapped data"),e.decoder&&(i=e.decoder.write(i)),e.objectMode&&null==i)||(e.objectMode||i&&i.length)&&(n.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));return function(t,e){for(var r=0,n=t.length;r<n;r++)e(t[r],r)}(["error","close","destroy","pause","resume"],(function(e){t.on(e,n.emit.bind(n,e))})),n._read=function(e){Gr("wrapped _read",e),r&&(r=!1,t.resume())},n},Xr._fromList=sn,fn.WritableState=ln,gr(fn,sr),ln.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},fn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},fn.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return"function"==typeof e&&(r=e,e=null),me.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),"function"!=typeof r&&(r=cn),n.ended?function(t,e){var r=new Error("write after end");t.emit("error",r),b(e,r)}(this,r):function(t,e,r,n){var i=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):me.isBuffer(r)||"string"==typeof r||void 0===r||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),b(n,s),i=!1),i}(this,n,t,r)&&(n.pendingcb++,i=function(t,e,r,n,i){r=function(t,e,r){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=me.from(e,r));return e}(e,r,n),me.isBuffer(r)&&(n="buffer");var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;a||(e.needDrain=!0);if(e.writing||e.corked){var o=e.lastBufferedRequest;e.lastBufferedRequest=new hn(r,n,i),o?o.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else dn(t,e,!1,s,r,n,i);return a}(this,n,t,e,r)),i},fn.prototype.cork=function(){this._writableState.corked++},fn.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||_n(this,t))},fn.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},fn.prototype._write=function(t,e,r){r(new Error("not implemented"))},fn.prototype._writev=null,fn.prototype.end=function(t,e,r){var n=this._writableState;"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(t,e,r){e.ending=!0,vn(t,e),r&&(e.finished?b(r):t.once("finish",r));e.ended=!0,t.writable=!1}(this,n,r)},gr(kn,Xr);for(var yn=Object.keys(fn.prototype),wn=0;wn<yn.length;wn++){var An=yn[wn];kn.prototype[An]||(kn.prototype[An]=fn.prototype[An])}function kn(t){if(!(this instanceof kn))return new kn(t);Xr.call(this,t),fn.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",En)}function En(){this.allowHalfOpen||this._writableState.ended||b(xn,this)}function xn(t){t.end()}function Tn(t){this.afterTransform=function(e,r){return function(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&t.push(r);i(e);var s=t._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&t._read(s.highWaterMark)}(t,e,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Cn(t){if(!(this instanceof Cn))return new Cn(t);kn.call(this,t),this._transformState=new Tn(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(t){Sn(e,t)})):Sn(e)}))}function Sn(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function Rn(t){if(!(this instanceof Rn))return new Rn(t);Cn.call(this,t)}function In(){sr.call(this)}gr(Cn,kn),Cn.prototype.push=function(t,e){return this._transformState.needTransform=!1,kn.prototype.push.call(this,t,e)},Cn.prototype._transform=function(t,e,r){throw new Error("Not implemented")},Cn.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Cn.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},gr(Rn,Cn),Rn.prototype._transform=function(t,e,r){r(null,t)},gr(In,sr),In.Readable=Xr,In.Writable=fn,In.Duplex=kn,In.Transform=Cn,In.PassThrough=Rn,In.Stream=In,In.prototype.pipe=function(t,e){var r=this;function n(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),t.on("drain",i),t._isStdio||e&&!1===e.end||(r.on("end",a),r.on("close",o));var s=!1;function a(){s||(s=!0,t.end())}function o(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(c(),0===sr.listenerCount(this,"error"))throw t}function c(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",o),r.removeListener("error",u),t.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),t.removeListener("close",c)}return r.on("error",u),t.on("error",u),r.on("end",c),r.on("close",c),t.on("close",c),t.emit("pipe",r),t};var Bn,On,Pn=M((function(t,e){if(e.base64=!0,e.array=!0,e.string=!0,e.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,e.nodebuffer=!0,e.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)e.blob=!1;else{var r=new ArrayBuffer(0);try{e.blob=0===new Blob([r],{type:"application/zip"}).size}catch(t){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),e.blob=0===n.getBlob("application/zip").size}catch(t){e.blob=!1}}}try{e.nodestream=!!In.Readable}catch(t){e.nodestream=!1}})),Mn=(Pn.base64,Pn.array,Pn.string,Pn.arraybuffer,Pn.nodebuffer,Pn.uint8array,Pn.blob,Pn.nodestream,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Dn=function(t){for(var e,r,n,i,s,a,o,u=[],c=0,h=t.length,l=h,f="string"!==hi.getTypeOf(t);c<t.length;)l=h-c,f?(e=t[c++],r=c<h?t[c++]:0,n=c<h?t[c++]:0):(e=t.charCodeAt(c++),r=c<h?t.charCodeAt(c++):0,n=c<h?t.charCodeAt(c++):0),i=e>>2,s=(3&e)<<4|r>>4,a=l>1?(15&r)<<2|n>>6:64,o=l>2?63&n:64,u.push(Mn.charAt(i)+Mn.charAt(s)+Mn.charAt(a)+Mn.charAt(o));return u.join("")},Fn=function(t){var e,r,n,i,s,a,o=0,u=0,c="data:";if(t.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var h,l=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===Mn.charAt(64)&&l--,t.charAt(t.length-2)===Mn.charAt(64)&&l--,l%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=Pn.uint8array?new Uint8Array(0|l):new Array(0|l);o<t.length;)e=Mn.indexOf(t.charAt(o++))<<2|(i=Mn.indexOf(t.charAt(o++)))>>4,r=(15&i)<<4|(s=Mn.indexOf(t.charAt(o++)))>>2,n=(3&s)<<6|(a=Mn.indexOf(t.charAt(o++))),h[u++]=e,64!==s&&(h[u++]=r),64!==a&&(h[u++]=n);return h},Ln=!0,jn=function(t,e){if(me.from&&me.from!==Uint8Array.from)return me.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new me(t,e)},Nn=function(t){if(me.alloc)return me.alloc(t);var e=new me(t);return e.fill(0),e},Un=function(t){return rr(t)},zn=function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume},$n="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)},Hn=O.MutationObserver||O.WebKitMutationObserver;if(Hn){var Wn=0,qn=new Hn(Kn),Gn=O.document.createTextNode("");qn.observe(Gn,{characterData:!0}),Bn=function(){Gn.data=Wn=++Wn%2}}else if(O.setImmediate||void 0===O.MessageChannel)Bn="document"in O&&"onreadystatechange"in O.document.createElement("script")?function(){var t=O.document.createElement("script");t.onreadystatechange=function(){Kn(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},O.document.documentElement.appendChild(t)}:function(){setTimeout(Kn,0)};else{var Vn=new O.MessageChannel;Vn.port1.onmessage=Kn,Bn=function(){Vn.port2.postMessage(0)}}var Xn=[];function Kn(){var t,e;On=!0;for(var r=Xn.length;r;){for(e=Xn,Xn=[],t=-1;++t<r;)e[t]();r=Xn.length}On=!1}var Yn=function(t){1!==Xn.push(t)||On||Bn()};function Jn(){}var Qn={},Zn=["REJECTED"],ti=["FULFILLED"],ei=["PENDING"],ri=ni;function ni(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=ei,this.queue=[],this.outcome=void 0,t!==Jn&&oi(this,t)}function ii(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function si(t,e,r){Yn((function(){var n;try{n=e(r)}catch(e){return Qn.reject(t,e)}n===t?Qn.reject(t,new TypeError("Cannot resolve promise with itself")):Qn.resolve(t,n)}))}function ai(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function oi(t,e){var r=!1;function n(e){r||(r=!0,Qn.reject(t,e))}function i(e){r||(r=!0,Qn.resolve(t,e))}var s=ui((function(){e(i,n)}));"error"===s.status&&n(s.value)}function ui(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}ni.prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){throw r}))}))},ni.prototype.catch=function(t){return this.then(null,t)},ni.prototype.then=function(t,e){if("function"!=typeof t&&this.state===ti||"function"!=typeof e&&this.state===Zn)return this;var r=new this.constructor(Jn);this.state!==ei?si(r,this.state===ti?t:e,this.outcome):this.queue.push(new ii(r,t,e));return r},ii.prototype.callFulfilled=function(t){Qn.resolve(this.promise,t)},ii.prototype.otherCallFulfilled=function(t){si(this.promise,this.onFulfilled,t)},ii.prototype.callRejected=function(t){Qn.reject(this.promise,t)},ii.prototype.otherCallRejected=function(t){si(this.promise,this.onRejected,t)},Qn.resolve=function(t,e){var r=ui(ai,e);if("error"===r.status)return Qn.reject(t,r.value);var n=r.value;if(n)oi(t,n);else{t.state=ti,t.outcome=e;for(var i=-1,s=t.queue.length;++i<s;)t.queue[i].callFulfilled(e)}return t},Qn.reject=function(t,e){t.state=Zn,t.outcome=e;for(var r=-1,n=t.queue.length;++r<n;)t.queue[r].callRejected(e);return t},ni.resolve=function(t){if(t instanceof this)return t;return Qn.resolve(new this(Jn),t)},ni.reject=function(t){var e=new this(Jn);return Qn.reject(e,t)},ni.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);var i=new Array(r),s=0,a=-1,o=new this(Jn);for(;++a<r;)u(t[a],a);return o;function u(t,a){e.resolve(t).then((function(t){i[a]=t,++s!==r||n||(n=!0,Qn.resolve(o,i))}),(function(t){n||(n=!0,Qn.reject(o,t))}))}},ni.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);var i=-1,s=new this(Jn);for(;++i<r;)a=t[i],e.resolve(a).then((function(t){n||(n=!0,Qn.resolve(s,t))}),(function(t){n||(n=!0,Qn.reject(s,t))}));var a;return s};var ci={Promise:"undefined"!=typeof Promise?Promise:ri},hi=M((function(t,e){function r(t){return t}function n(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}e.newBlob=function(t,r){e.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var i={stringifyByChunk:function(t,e,r){var n=[],i=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;i<s;)"array"===e||"nodebuffer"===e?n.push(String.fromCharCode.apply(null,t.slice(i,Math.min(i+r,s)))):n.push(String.fromCharCode.apply(null,t.subarray(i,Math.min(i+r,s)))),i+=r;return n.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return Pn.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return Pn.nodebuffer&&1===String.fromCharCode.apply(null,Nn(1)).length}catch(t){return!1}}()}};function s(t){var r=65536,n=e.getTypeOf(t),s=!0;if("uint8array"===n?s=i.applyCanBeUsed.uint8array:"nodebuffer"===n&&(s=i.applyCanBeUsed.nodebuffer),s)for(;r>1;)try{return i.stringifyByChunk(t,n,r)}catch(t){r=Math.floor(r/2)}return i.stringifyByChar(t)}function a(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}e.applyFromCharCode=s;var o={};o.string={string:r,array:function(t){return n(t,new Array(t.length))},arraybuffer:function(t){return o.string.uint8array(t).buffer},uint8array:function(t){return n(t,new Uint8Array(t.length))},nodebuffer:function(t){return n(t,Nn(t.length))}},o.array={string:s,array:r,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return jn(t)}},o.arraybuffer={string:function(t){return s(new Uint8Array(t))},array:function(t){return a(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:r,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return jn(new Uint8Array(t))}},o.uint8array={string:s,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:r,nodebuffer:function(t){return jn(t)}},o.nodebuffer={string:s,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return o.nodebuffer.uint8array(t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:r},e.transformTo=function(t,r){if(r||(r=""),!t)return r;e.checkSupport(t);var n=e.getTypeOf(r);return o[n][t](r)},e.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":Pn.nodebuffer&&Un(t)?"nodebuffer":Pn.uint8array&&t instanceof Uint8Array?"uint8array":Pn.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(t){if(!Pn[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(t){var e,r,n="";for(r=0;r<(t||"").length;r++)n+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return n},e.delay=function(t,e,r){$n((function(){t.apply(r||null,e||[])}))},e.inherits=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r},e.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r},e.prepareContent=function(t,r,i,s,a){return ci.Promise.resolve(r).then((function(t){return Pn.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new ci.Promise((function(e,r){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=function(t){r(t.target.error)},n.readAsArrayBuffer(t)})):t})).then((function(r){var o,u=e.getTypeOf(r);return u?("arraybuffer"===u?r=e.transformTo("uint8array",r):"string"===u&&(a?r=Fn(r):i&&!0!==s&&(r=n(o=r,Pn.uint8array?new Uint8Array(o.length):new Array(o.length)))),r):ci.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}}));hi.newBlob,hi.applyFromCharCode,hi.transformTo,hi.getTypeOf,hi.checkSupport,hi.MAX_VALUE_16BITS,hi.MAX_VALUE_32BITS,hi.pretty,hi.delay,hi.inherits,hi.extend,hi.prepareContent;function li(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}li.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}};var fi=li,di=M((function(t,e){for(var r=new Array(256),n=0;n<256;n++)r[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;r[254]=r[254]=1;function i(){fi.call(this,"utf-8 decode"),this.leftOver=null}function s(){fi.call(this,"utf-8 encode")}e.utf8encode=function(t){return Pn.nodebuffer?jn(t,"utf-8"):function(t){var e,r,n,i,s,a=t.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=Pn.uint8array?new Uint8Array(o):new Array(o),s=0,i=0;s<o;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e}(t)},e.utf8decode=function(t){return Pn.nodebuffer?hi.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,n,i,s,a=t.length,o=new Array(2*a);for(n=0,e=0;e<a;)if((i=t[e++])<128)o[n++]=i;else if((s=r[i])>4)o[n++]=65533,e+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&e<a;)i=i<<6|63&t[e++],s--;s>1?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return o.length!==n&&(o.subarray?o=o.subarray(0,n):o.length=n),hi.applyFromCharCode(o)}(t=hi.transformTo(Pn.uint8array?"uint8array":"array",t))},hi.inherits(i,fi),i.prototype.processChunk=function(t){var n=hi.transformTo(Pn.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(Pn.uint8array){var i=n;(n=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),n.set(i,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var s=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+r[t[n]]>e?n:e}(n),a=n;s!==n.length&&(Pn.uint8array?(a=n.subarray(0,s),this.leftOver=n.subarray(s,n.length)):(a=n.slice(0,s),this.leftOver=n.slice(s,n.length))),this.push({data:e.utf8decode(a),meta:t.meta})},i.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=i,hi.inherits(s,fi),s.prototype.processChunk=function(t){this.push({data:e.utf8encode(t.data),meta:t.meta})},e.Utf8EncodeWorker=s}));di.utf8encode,di.utf8decode,di.Utf8DecodeWorker,di.Utf8EncodeWorker;function pi(t){fi.call(this,"ConvertWorker to "+t),this.destType=t}hi.inherits(pi,fi),pi.prototype.processChunk=function(t){this.push({data:hi.transformTo(this.destType,t.data),meta:t.meta})};var _i=pi,gi=In.Readable;function bi(t,e,r){gi.call(this,e),this._helper=t;var n=this;t.on("data",(function(t,e){n.push(t)||n._helper.pause(),r&&r(e)})).on("error",(function(t){n.emit("error",t)})).on("end",(function(){n.push(null)}))}hi.inherits(bi,gi),bi.prototype._read=function(){this._helper.resume()};var vi=bi,mi=null;if(Pn.nodestream)try{mi=vi}catch(t){}function yi(t,e){return new ci.Promise((function(r,n){var i=[],s=t._internalType,a=t._outputType,o=t._mimeType;t.on("data",(function(t,r){i.push(t),e&&e(r)})).on("error",(function(t){i=[],n(t)})).on("end",(function(){try{var t=function(t,e,r){switch(t){case"blob":return hi.newBlob(hi.transformTo("arraybuffer",e),r);case"base64":return Dn(e);default:return hi.transformTo(t,e)}}(a,function(t,e){var r,n=0,i=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(i=new Uint8Array(s),r=0;r<e.length;r++)i.set(e[r],n),n+=e[r].length;return i;case"nodebuffer":return me.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(s,i),o);r(t)}catch(t){n(t)}i=[]})).resume()}))}function wi(t,e,r){var n=e;switch(e){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=e,this._mimeType=r,hi.checkSupport(n),this._worker=t.pipe(new _i(n)),t.lock()}catch(t){this._worker=new fi("error"),this._worker.error(t)}}wi.prototype={accumulate:function(t){return yi(this,t)},on:function(t,e){var r=this;return"data"===t?this._worker.on(t,(function(t){e.call(r,t.data,t.meta)})):this._worker.on(t,(function(){hi.delay(e,arguments,r)})),this},resume:function(){return hi.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(hi.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new mi(this,{objectMode:"nodebuffer"!==this._outputType},t)}};var Ai=wi,ki={base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null};function Ei(t){fi.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=hi.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}hi.inherits(Ei,fi),Ei.prototype.cleanUp=function(){fi.prototype.cleanUp.call(this),this.data=null},Ei.prototype.resume=function(){return!!fi.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,hi.delay(this._tickAndRepeat,[],this)),!0)},Ei.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(hi.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},Ei.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})};var xi=Ei;function Ti(t){fi.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}hi.inherits(Ti,fi),Ti.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}fi.prototype.processChunk.call(this,t)};var Ci=Ti;var Si=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();var Ri=function(t,e){return void 0!==t&&t.length?"string"!==hi.getTypeOf(t)?function(t,e,r,n){var i=Si,s=n+r;t^=-1;for(var a=n;a<s;a++)t=t>>>8^i[255&(t^e[a])];return-1^t}(0|e,t,t.length,0):function(t,e,r,n){var i=Si,s=n+r;t^=-1;for(var a=n;a<s;a++)t=t>>>8^i[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length,0):0};function Ii(){fi.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}hi.inherits(Ii,fi),Ii.prototype.processChunk=function(t){this.streamInfo.crc32=Ri(t.data,this.streamInfo.crc32||0),this.push(t)};var Bi=Ii;function Oi(t,e,r,n,i){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=n,this.compressedContent=i}Oi.prototype={getContentWorker:function(){var t=new xi(ci.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Ci("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new xi(ci.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},Oi.createWorkerFrom=function(t,e,r){return t.pipe(new Bi).pipe(new Ci("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new Ci("compressedSize")).withStreamInfo("compression",e)};var Pi=Oi,Mi=function(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};Mi.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");var n="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),e=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(e=e.pipe(new di.Utf8EncodeWorker)),!i&&n&&(e=e.pipe(new di.Utf8DecodeWorker))}catch(t){(e=new fi("error")).error(t)}return new Ai(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof Pi&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new di.Utf8EncodeWorker)),Pi.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof Pi?this._data.getContentWorker():this._data instanceof fi?this._data:new xi(this._data)}};for(var Di=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],Fi=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Li=0;Li<Di.length;Li++)Mi.prototype[Di[Li]]=Fi;var ji=Mi,Ni=M((function(t,e){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(t[i]=r[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+n),i);else for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){var e,r,n,i,s,a;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(a=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)s=t[e],a.set(s,i),i+=s.length;return a}},s={arraySet:function(t,e,r,n,i){for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(r)}));Ni.assign,Ni.shrinkBuf,Ni.setTyped,Ni.Buf8,Ni.Buf16,Ni.Buf32;function Ui(t){for(var e=t.length;--e>=0;)t[e]=0}var zi=256,$i=286,Hi=30,Wi=15,qi=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Gi=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Vi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Xi=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ki=new Array(576);Ui(Ki);var Yi=new Array(60);Ui(Yi);var Ji=new Array(512);Ui(Ji);var Qi=new Array(256);Ui(Qi);var Zi=new Array(29);Ui(Zi);var ts,es,rs,ns=new Array(Hi);function is(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function ss(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function as(t){return t<256?Ji[t]:Ji[256+(t>>>7)]}function os(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function us(t,e,r){t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,os(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function cs(t,e,r){us(t,r[2*e],r[2*e+1])}function hs(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function ls(t,e,r){var n,i,s=new Array(16),a=0;for(n=1;n<=Wi;n++)s[n]=a=a+r[n-1]<<1;for(i=0;i<=e;i++){var o=t[2*i+1];0!==o&&(t[2*i]=hs(s[o]++,o))}}function fs(t){var e;for(e=0;e<$i;e++)t.dyn_ltree[2*e]=0;for(e=0;e<Hi;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function ds(t){t.bi_valid>8?os(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function ps(t,e,r,n){var i=2*e,s=2*r;return t[i]<t[s]||t[i]===t[s]&&n[e]<=n[r]}function _s(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&ps(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!ps(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function gs(t,e,r){var n,i,s,a,o=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],i=t.pending_buf[t.l_buf+o],o++,0===n?cs(t,i,e):(cs(t,(s=Qi[i])+zi+1,e),0!==(a=qi[s])&&us(t,i-=Zi[s],a),cs(t,s=as(--n),r),0!==(a=Gi[s])&&us(t,n-=ns[s],a))}while(o<t.last_lit);cs(t,256,e)}function bs(t,e){var r,n,i,s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,u=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<u;r++)0!==s[2*r]?(t.heap[++t.heap_len]=c=r,t.depth[r]=0):s[2*r+1]=0;for(;t.heap_len<2;)s[2*(i=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=a[2*i+1]);for(e.max_code=c,r=t.heap_len>>1;r>=1;r--)_s(t,s,r);i=u;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_s(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,s[2*i]=s[2*r]+s[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,s[2*r+1]=s[2*n+1]=i,t.heap[1]=i++,_s(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,s,a,o,u=e.dyn_tree,c=e.max_code,h=e.stat_desc.static_tree,l=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,p=e.stat_desc.max_length,_=0;for(s=0;s<=Wi;s++)t.bl_count[s]=0;for(u[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<573;r++)(s=u[2*u[2*(n=t.heap[r])+1]+1]+1)>p&&(s=p,_++),u[2*n+1]=s,n>c||(t.bl_count[s]++,a=0,n>=d&&(a=f[n-d]),o=u[2*n],t.opt_len+=o*(s+a),l&&(t.static_len+=o*(h[2*n+1]+a)));if(0!==_){do{for(s=p-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[p]--,_-=2}while(_>0);for(s=p;0!==s;s--)for(n=t.bl_count[s];0!==n;)(i=t.heap[--r])>c||(u[2*i+1]!==s&&(t.opt_len+=(s-u[2*i+1])*u[2*i],u[2*i+1]=s),n--)}}(t,e),ls(s,c,t.bl_count)}function vs(t,e,r){var n,i,s=-1,a=e[1],o=0,u=7,c=4;for(0===a&&(u=138,c=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=e[2*(n+1)+1],++o<u&&i===a||(o<c?t.bl_tree[2*i]+=o:0!==i?(i!==s&&t.bl_tree[2*i]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4))}function ms(t,e,r){var n,i,s=-1,a=e[1],o=0,u=7,c=4;for(0===a&&(u=138,c=3),n=0;n<=r;n++)if(i=a,a=e[2*(n+1)+1],!(++o<u&&i===a)){if(o<c)do{cs(t,i,t.bl_tree)}while(0!=--o);else 0!==i?(i!==s&&(cs(t,i,t.bl_tree),o--),cs(t,16,t.bl_tree),us(t,o-3,2)):o<=10?(cs(t,17,t.bl_tree),us(t,o-3,3)):(cs(t,18,t.bl_tree),us(t,o-11,7));o=0,s=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4)}}Ui(ns);var ys=!1;function ws(t,e,r,n){us(t,0+(n?1:0),3),function(t,e,r,n){ds(t),n&&(os(t,r),os(t,~r)),Ni.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}var As={_tr_init:function(t){ys||(!function(){var t,e,r,n,i,s=new Array(16);for(r=0,n=0;n<28;n++)for(Zi[n]=r,t=0;t<1<<qi[n];t++)Qi[r++]=n;for(Qi[r-1]=n,i=0,n=0;n<16;n++)for(ns[n]=i,t=0;t<1<<Gi[n];t++)Ji[i++]=n;for(i>>=7;n<Hi;n++)for(ns[n]=i<<7,t=0;t<1<<Gi[n]-7;t++)Ji[256+i++]=n;for(e=0;e<=Wi;e++)s[e]=0;for(t=0;t<=143;)Ki[2*t+1]=8,t++,s[8]++;for(;t<=255;)Ki[2*t+1]=9,t++,s[9]++;for(;t<=279;)Ki[2*t+1]=7,t++,s[7]++;for(;t<=287;)Ki[2*t+1]=8,t++,s[8]++;for(ls(Ki,287,s),t=0;t<Hi;t++)Yi[2*t+1]=5,Yi[2*t]=hs(t,5);ts=new is(Ki,qi,257,$i,Wi),es=new is(Yi,Gi,0,Hi,Wi),rs=new is(new Array(0),Vi,0,19,7)}(),ys=!0),t.l_desc=new ss(t.dyn_ltree,ts),t.d_desc=new ss(t.dyn_dtree,es),t.bl_desc=new ss(t.bl_tree,rs),t.bi_buf=0,t.bi_valid=0,fs(t)},_tr_stored_block:ws,_tr_flush_block:function(t,e,r,n){var i,s,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<zi;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),bs(t,t.l_desc),bs(t,t.d_desc),a=function(t){var e;for(vs(t,t.dyn_ltree,t.l_desc.max_code),vs(t,t.dyn_dtree,t.d_desc.max_code),bs(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Xi[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==e?ws(t,e,r,n):4===t.strategy||s===i?(us(t,2+(n?1:0),3),gs(t,Ki,Yi)):(us(t,4+(n?1:0),3),function(t,e,r,n){var i;for(us(t,e-257,5),us(t,r-1,5),us(t,n-4,4),i=0;i<n;i++)us(t,t.bl_tree[2*Xi[i]+1],3);ms(t,t.dyn_ltree,e-1),ms(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),gs(t,t.dyn_ltree,t.dyn_dtree)),fs(t),n&&ds(t)},_tr_tally:function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(Qi[r]+zi+1)]++,t.dyn_dtree[2*as(e)]++),t.last_lit===t.lit_bufsize-1},_tr_align:function(t){us(t,2,3),cs(t,256,Ki),function(t){16===t.bi_valid?(os(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}};var ks=function(t,e,r,n){for(var i=65535&t|0,s=t>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{s=s+(i=i+e[n++]|0)|0}while(--a);i%=65521,s%=65521}return i|s<<16|0};var Es=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();var xs,Ts=function(t,e,r,n){var i=Es,s=n+r;t^=-1;for(var a=n;a<s;a++)t=t>>>8^i[255&(t^e[a])];return-1^t},Cs={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ss=-2,Rs=258,Is=262,Bs=103,Os=113,Ps=666;function Ms(t,e){return t.msg=Cs[e],e}function Ds(t){return(t<<1)-(t>4?9:0)}function Fs(t){for(var e=t.length;--e>=0;)t[e]=0}function Ls(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(Ni.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function js(t,e){As._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Ls(t.strm)}function Ns(t,e){t.pending_buf[t.pending++]=e}function Us(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function zs(t,e){var r,n,i=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,u=t.strstart>t.w_size-Is?t.strstart-(t.w_size-Is):0,c=t.window,h=t.w_mask,l=t.prev,f=t.strstart+Rs,d=c[s+a-1],p=c[s+a];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(c[(r=e)+a]===p&&c[r+a-1]===d&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<f);if(n=Rs-(f-s),s=f-Rs,n>a){if(t.match_start=e,a=n,n>=o)break;d=c[s+a-1],p=c[s+a]}}}while((e=l[e&h])>u&&0!=--i);return a<=t.lookahead?a:t.lookahead}function $s(t){var e,r,n,i,s,a,o,u,c,h,l=t.w_size;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=l+(l-Is)){Ni.arraySet(t.window,t.window,l,l,0),t.match_start-=l,t.strstart-=l,t.block_start-=l,e=r=t.hash_size;do{n=t.head[--e],t.head[e]=n>=l?n-l:0}while(--r);e=r=l;do{n=t.prev[--e],t.prev[e]=n>=l?n-l:0}while(--r);i+=l}if(0===t.strm.avail_in)break;if(a=t.strm,o=t.window,u=t.strstart+t.lookahead,c=i,h=void 0,(h=a.avail_in)>c&&(h=c),r=0===h?0:(a.avail_in-=h,Ni.arraySet(o,a.input,a.next_in,h,u),1===a.state.wrap?a.adler=ks(a.adler,o,h,u):2===a.state.wrap&&(a.adler=Ts(a.adler,o,h,u)),a.next_in+=h,a.total_in+=h,h),t.lookahead+=r,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+3-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Is&&0!==t.strm.avail_in)}function Hs(t,e){for(var r,n;;){if(t.lookahead<Is){if($s(t),t.lookahead<Is&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-Is&&(t.match_length=zs(t,r)),t.match_length>=3)if(n=As._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=As._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(js(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(js(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(js(t,!1),0===t.strm.avail_out)?1:2}function Ws(t,e){for(var r,n,i;;){if(t.lookahead<Is){if($s(t),t.lookahead<Is&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Is&&(t.match_length=zs(t,r),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=As._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(js(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=As._tr_tally(t,0,t.window[t.strstart-1]))&&js(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=As._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(js(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(js(t,!1),0===t.strm.avail_out)?1:2}function qs(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function Gs(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ni.Buf16(1146),this.dyn_dtree=new Ni.Buf16(122),this.bl_tree=new Ni.Buf16(78),Fs(this.dyn_ltree),Fs(this.dyn_dtree),Fs(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ni.Buf16(16),this.heap=new Ni.Buf16(573),Fs(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ni.Buf16(573),Fs(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Vs(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:Os,t.adler=2===e.wrap?0:1,e.last_flush=0,As._tr_init(e),0):Ms(t,Ss)}function Xs(t){var e,r=Vs(t);return 0===r&&((e=t.state).window_size=2*e.w_size,Fs(e.head),e.max_lazy_match=xs[e.level].max_lazy,e.good_match=xs[e.level].good_length,e.nice_match=xs[e.level].nice_length,e.max_chain_length=xs[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),r}function Ks(t,e,r,n,i,s){if(!t)return Ss;var a=1;if(-1===e&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>9||8!==r||n<8||n>15||e<0||e>9||s<0||s>4)return Ms(t,Ss);8===n&&(n=9);var o=new Gs;return t.state=o,o.strm=t,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Ni.Buf8(2*o.w_size),o.head=new Ni.Buf16(o.hash_size),o.prev=new Ni.Buf16(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Ni.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=e,o.strategy=s,o.method=r,Xs(t)}xs=[new qs(0,0,0,0,(function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if($s(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,js(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-Is&&(js(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(js(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(js(t,!1),t.strm.avail_out),1)})),new qs(4,4,8,4,Hs),new qs(4,5,16,8,Hs),new qs(4,6,32,32,Hs),new qs(4,4,16,16,Ws),new qs(8,16,32,32,Ws),new qs(8,16,128,128,Ws),new qs(8,32,128,256,Ws),new qs(32,128,258,1024,Ws),new qs(32,258,258,4096,Ws)];var Ys={deflateInit:function(t,e){return Ks(t,e,8,15,8,0)},deflateInit2:Ks,deflateReset:Xs,deflateResetKeep:Vs,deflateSetHeader:function(t,e){return t&&t.state?2!==t.state.wrap?Ss:(t.state.gzhead=e,0):Ss},deflate:function(t,e){var r,n,i,s;if(!t||!t.state||e>5||e<0)return t?Ms(t,Ss):Ss;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||n.status===Ps&&4!==e)return Ms(t,0===t.avail_out?-5:Ss);if(n.strm=t,r=n.last_flush,n.last_flush=e,42===n.status)if(2===n.wrap)t.adler=0,Ns(n,31),Ns(n,139),Ns(n,8),n.gzhead?(Ns(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ns(n,255&n.gzhead.time),Ns(n,n.gzhead.time>>8&255),Ns(n,n.gzhead.time>>16&255),Ns(n,n.gzhead.time>>24&255),Ns(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),Ns(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Ns(n,255&n.gzhead.extra.length),Ns(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Ts(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(Ns(n,0),Ns(n,0),Ns(n,0),Ns(n,0),Ns(n,0),Ns(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),Ns(n,3),n.status=Os);else{var a=8+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=Os,Us(n,a),0!==n.strstart&&(Us(n,t.adler>>>16),Us(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),Ls(t),i=n.pending,n.pending!==n.pending_buf_size));)Ns(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),Ls(t),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Ns(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),Ls(t),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Ns(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(t.adler=Ts(t.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.status=Bs)}else n.status=Bs;if(n.status===Bs&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Ls(t),n.pending+2<=n.pending_buf_size&&(Ns(n,255&t.adler),Ns(n,t.adler>>8&255),t.adler=0,n.status=Os)):n.status=Os),0!==n.pending){if(Ls(t),0===t.avail_out)return n.last_flush=-1,0}else if(0===t.avail_in&&Ds(e)<=Ds(r)&&4!==e)return Ms(t,-5);if(n.status===Ps&&0!==t.avail_in)return Ms(t,-5);if(0!==t.avail_in||0!==n.lookahead||0!==e&&n.status!==Ps){var o=2===n.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&($s(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,r=As._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(js(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(js(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(js(t,!1),0===t.strm.avail_out)?1:2}(n,e):3===n.strategy?function(t,e){for(var r,n,i,s,a=t.window;;){if(t.lookahead<=Rs){if($s(t),t.lookahead<=Rs&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=a[i=t.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){s=t.strstart+Rs;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<s);t.match_length=Rs-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=As._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=As._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(js(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(js(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(js(t,!1),0===t.strm.avail_out)?1:2}(n,e):xs[n.level].func(n,e);if(3!==o&&4!==o||(n.status=Ps),1===o||3===o)return 0===t.avail_out&&(n.last_flush=-1),0;if(2===o&&(1===e?As._tr_align(n):5!==e&&(As._tr_stored_block(n,0,0,!1),3===e&&(Fs(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Ls(t),0===t.avail_out))return n.last_flush=-1,0}return 4!==e?0:n.wrap<=0?1:(2===n.wrap?(Ns(n,255&t.adler),Ns(n,t.adler>>8&255),Ns(n,t.adler>>16&255),Ns(n,t.adler>>24&255),Ns(n,255&t.total_in),Ns(n,t.total_in>>8&255),Ns(n,t.total_in>>16&255),Ns(n,t.total_in>>24&255)):(Us(n,t.adler>>>16),Us(n,65535&t.adler)),Ls(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},deflateEnd:function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==Bs&&e!==Os&&e!==Ps?Ms(t,Ss):(t.state=null,e===Os?Ms(t,-3):0):Ss},deflateSetDictionary:function(t,e){var r,n,i,s,a,o,u,c,h=e.length;if(!t||!t.state)return Ss;if(2===(s=(r=t.state).wrap)||1===s&&42!==r.status||r.lookahead)return Ss;for(1===s&&(t.adler=ks(t.adler,e,h,0)),r.wrap=0,h>=r.w_size&&(0===s&&(Fs(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new Ni.Buf8(r.w_size),Ni.arraySet(c,e,h-r.w_size,r.w_size,0),e=c,h=r.w_size),a=t.avail_in,o=t.next_in,u=t.input,t.avail_in=h,t.next_in=0,t.input=e,$s(r);r.lookahead>=3;){n=r.strstart,i=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=2,$s(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=o,t.input=u,t.avail_in=a,r.wrap=s,0},deflateInfo:"pako deflate (from Nodeca project)"},Js=!0,Qs=!0;try{String.fromCharCode.apply(null,[0])}catch(t){Js=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Qs=!1}for(var Zs=new Ni.Buf8(256),ta=0;ta<256;ta++)Zs[ta]=ta>=252?6:ta>=248?5:ta>=240?4:ta>=224?3:ta>=192?2:1;Zs[254]=Zs[254]=1;function ea(t,e){if(e<65534&&(t.subarray&&Qs||!t.subarray&&Js))return String.fromCharCode.apply(null,Ni.shrinkBuf(t,e));for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r}var ra=function(t){var e,r,n,i,s,a=t.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Ni.Buf8(o),s=0,i=0;s<o;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e},na=function(t){return ea(t,t.length)},ia=function(t){for(var e=new Ni.Buf8(t.length),r=0,n=e.length;r<n;r++)e[r]=t.charCodeAt(r);return e},sa=function(t,e){var r,n,i,s,a=e||t.length,o=new Array(2*a);for(n=0,r=0;r<a;)if((i=t[r++])<128)o[n++]=i;else if((s=Zs[i])>4)o[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&r<a;)i=i<<6|63&t[r++],s--;s>1?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return ea(o,n)},aa=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+Zs[t[r]]>e?r:e};var oa=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},ua=Object.prototype.toString;function ca(t){if(!(this instanceof ca))return new ca(t);this.options=Ni.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oa,this.strm.avail_out=0;var r=Ys.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==r)throw new Error(Cs[r]);if(e.header&&Ys.deflateSetHeader(this.strm,e.header),e.dictionary){var n;if(n="string"==typeof e.dictionary?ra(e.dictionary):"[object ArrayBuffer]"===ua.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(r=Ys.deflateSetDictionary(this.strm,n)))throw new Error(Cs[r]);this._dict_set=!0}}function ha(t,e){var r=new ca(e);if(r.push(t,!0),r.err)throw r.msg||Cs[r.err];return r.result}ca.prototype.push=function(t,e){var r,n,i=this.strm,s=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:!0===e?4:0,"string"==typeof t?i.input=ra(t):"[object ArrayBuffer]"===ua.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new Ni.Buf8(s),i.next_out=0,i.avail_out=s),1!==(r=Ys.deflate(i,n))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(na(Ni.shrinkBuf(i.output,i.next_out))):this.onData(Ni.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=Ys.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==n||(this.onEnd(0),i.avail_out=0,!0)},ca.prototype.onData=function(t){this.chunks.push(t)},ca.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ni.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var la={Deflate:ca,deflate:ha,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ha(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ha(t,e)}},fa=function(t,e){var r,n,i,s,a,o,u,c,h,l,f,d,p,_,g,b,v,m,y,w,A,k,E,x,T;r=t.state,n=t.next_in,x=t.input,i=n+(t.avail_in-5),s=t.next_out,T=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),u=r.dmax,c=r.wsize,h=r.whave,l=r.wnext,f=r.window,d=r.hold,p=r.bits,_=r.lencode,g=r.distcode,b=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;t:do{p<15&&(d+=x[n++]<<p,p+=8,d+=x[n++]<<p,p+=8),m=_[d&b];e:for(;;){if(d>>>=y=m>>>24,p-=y,0===(y=m>>>16&255))T[s++]=65535&m;else{if(!(16&y)){if(0==(64&y)){m=_[(65535&m)+(d&(1<<y)-1)];continue e}if(32&y){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}w=65535&m,(y&=15)&&(p<y&&(d+=x[n++]<<p,p+=8),w+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=x[n++]<<p,p+=8,d+=x[n++]<<p,p+=8),m=g[d&v];r:for(;;){if(d>>>=y=m>>>24,p-=y,!(16&(y=m>>>16&255))){if(0==(64&y)){m=g[(65535&m)+(d&(1<<y)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(A=65535&m,p<(y&=15)&&(d+=x[n++]<<p,(p+=8)<y&&(d+=x[n++]<<p,p+=8)),(A+=d&(1<<y)-1)>u){t.msg="invalid distance too far back",r.mode=30;break t}if(d>>>=y,p-=y,A>(y=s-a)){if((y=A-y)>h&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(k=0,E=f,0===l){if(k+=c-y,y<w){w-=y;do{T[s++]=f[k++]}while(--y);k=s-A,E=T}}else if(l<y){if(k+=c+l-y,(y-=l)<w){w-=y;do{T[s++]=f[k++]}while(--y);if(k=0,l<w){w-=y=l;do{T[s++]=f[k++]}while(--y);k=s-A,E=T}}}else if(k+=l-y,y<w){w-=y;do{T[s++]=f[k++]}while(--y);k=s-A,E=T}for(;w>2;)T[s++]=E[k++],T[s++]=E[k++],T[s++]=E[k++],w-=3;w&&(T[s++]=E[k++],w>1&&(T[s++]=E[k++]))}else{k=s-A;do{T[s++]=T[k++],T[s++]=T[k++],T[s++]=T[k++],w-=3}while(w>2);w&&(T[s++]=T[k++],w>1&&(T[s++]=T[k++]))}break}}break}}while(n<i&&s<o);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=s<o?o-s+257:257-(s-o),r.hold=d,r.bits=p},da=15,pa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ga=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ba=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],va=function(t,e,r,n,i,s,a,o){var u,c,h,l,f,d,p,_,g,b=o.bits,v=0,m=0,y=0,w=0,A=0,k=0,E=0,x=0,T=0,C=0,S=null,R=0,I=new Ni.Buf16(16),B=new Ni.Buf16(16),O=null,P=0;for(v=0;v<=da;v++)I[v]=0;for(m=0;m<n;m++)I[e[r+m]]++;for(A=b,w=da;w>=1&&0===I[w];w--);if(A>w&&(A=w),0===w)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(y=1;y<w&&0===I[y];y++);for(A<y&&(A=y),x=1,v=1;v<=da;v++)if(x<<=1,(x-=I[v])<0)return-1;if(x>0&&(0===t||1!==w))return-1;for(B[1]=0,v=1;v<da;v++)B[v+1]=B[v]+I[v];for(m=0;m<n;m++)0!==e[r+m]&&(a[B[e[r+m]]++]=m);if(0===t?(S=O=a,d=19):1===t?(S=pa,R-=257,O=_a,P-=257,d=256):(S=ga,O=ba,d=-1),C=0,m=0,v=y,f=s,k=A,E=0,h=-1,l=(T=1<<A)-1,1===t&&T>852||2===t&&T>592)return 1;for(;;){p=v-E,a[m]<d?(_=0,g=a[m]):a[m]>d?(_=O[P+a[m]],g=S[R+a[m]]):(_=96,g=0),u=1<<v-E,y=c=1<<k;do{i[f+(C>>E)+(c-=u)]=p<<24|_<<16|g|0}while(0!==c);for(u=1<<v-1;C&u;)u>>=1;if(0!==u?(C&=u-1,C+=u):C=0,m++,0==--I[v]){if(v===w)break;v=e[r+a[m]]}if(v>A&&(C&l)!==h){for(0===E&&(E=A),f+=y,x=1<<(k=v-E);k+E<w&&!((x-=I[k+E])<=0);)k++,x<<=1;if(T+=1<<k,1===t&&T>852||2===t&&T>592)return 1;i[h=C&l]=A<<24|k<<16|f-s|0}}return 0!==C&&(i[f+C]=v-E<<24|64<<16|0),o.bits=A,0},ma=-2,ya=12,wa=30;function Aa(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function ka(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ni.Buf16(320),this.work=new Ni.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ea(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Ni.Buf32(852),e.distcode=e.distdyn=new Ni.Buf32(592),e.sane=1,e.back=-1,0):ma}function xa(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,Ea(t)):ma}function Ta(t,e){var r,n;return t&&t.state?(n=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ma:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,xa(t))):ma}function Ca(t,e){var r,n;return t?(n=new ka,t.state=n,n.window=null,0!==(r=Ta(t,e))&&(t.state=null),r):ma}var Sa,Ra,Ia=!0;function Ba(t){if(Ia){var e;for(Sa=new Ni.Buf32(512),Ra=new Ni.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(va(1,t.lens,0,288,Sa,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;va(2,t.lens,0,32,Ra,0,t.work,{bits:5}),Ia=!1}t.lencode=Sa,t.lenbits=9,t.distcode=Ra,t.distbits=5}function Oa(t,e,r,n){var i,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Ni.Buf8(s.wsize)),n>=s.wsize?(Ni.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((i=s.wsize-s.wnext)>n&&(i=n),Ni.arraySet(s.window,e,r-n,i,s.wnext),(n-=i)?(Ni.arraySet(s.window,e,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}var Pa={inflateReset:xa,inflateReset2:Ta,inflateResetKeep:Ea,inflateInit:function(t){return Ca(t,15)},inflateInit2:Ca,inflate:function(t,e){var r,n,i,s,a,o,u,c,h,l,f,d,p,_,g,b,v,m,y,w,A,k,E,x,T=0,C=new Ni.Buf8(4),S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return ma;(r=t.state).mode===ya&&(r.mode=13),a=t.next_out,i=t.output,u=t.avail_out,s=t.next_in,n=t.input,o=t.avail_in,c=r.hold,h=r.bits,l=o,f=u,k=0;t:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;h<16;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(2&r.wrap&&35615===c){r.check=0,C[0]=255&c,C[1]=c>>>8&255,r.check=Ts(r.check,C,2,0),c=0,h=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",r.mode=wa;break}if(8!=(15&c)){t.msg="unknown compression method",r.mode=wa;break}if(h-=4,A=8+(15&(c>>>=4)),0===r.wbits)r.wbits=A;else if(A>r.wbits){t.msg="invalid window size",r.mode=wa;break}r.dmax=1<<A,t.adler=r.check=1,r.mode=512&c?10:ya,c=0,h=0;break;case 2:for(;h<16;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(r.flags=c,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=wa;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=wa;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Ts(r.check,C,2,0)),c=0,h=0,r.mode=3;case 3:for(;h<32;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.head&&(r.head.time=c),512&r.flags&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,r.check=Ts(r.check,C,4,0)),c=0,h=0,r.mode=4;case 4:for(;h<16;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Ts(r.check,C,2,0)),c=0,h=0,r.mode=5;case 5:if(1024&r.flags){for(;h<16;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(C[0]=255&c,C[1]=c>>>8&255,r.check=Ts(r.check,C,2,0)),c=0,h=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((d=r.length)>o&&(d=o),d&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),Ni.arraySet(r.head.extra,n,s,d,A)),512&r.flags&&(r.check=Ts(r.check,n,d,s)),o-=d,s+=d,r.length-=d),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break t;d=0;do{A=n[s+d++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A))}while(A&&d<o);if(512&r.flags&&(r.check=Ts(r.check,n,d,s)),o-=d,s+=d,A)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break t;d=0;do{A=n[s+d++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A))}while(A&&d<o);if(512&r.flags&&(r.check=Ts(r.check,n,d,s)),o-=d,s+=d,A)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;h<16;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(c!==(65535&r.check)){t.msg="header crc mismatch",r.mode=wa;break}c=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ya;break;case 10:for(;h<32;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}t.adler=r.check=Aa(c),c=0,h=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=h,2;t.adler=r.check=1,r.mode=ya;case ya:if(5===e||6===e)break t;case 13:if(r.last){c>>>=7&h,h-=7&h,r.mode=27;break}for(;h<3;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}switch(r.last=1&c,h-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(Ba(r),r.mode=20,6===e){c>>>=2,h-=2;break t}break;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=wa}c>>>=2,h-=2;break;case 14:for(c>>>=7&h,h-=7&h;h<32;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",r.mode=wa;break}if(r.length=65535&c,c=0,h=0,r.mode=15,6===e)break t;case 15:r.mode=16;case 16:if(d=r.length){if(d>o&&(d=o),d>u&&(d=u),0===d)break t;Ni.arraySet(i,n,s,d,a),o-=d,s+=d,u-=d,a+=d,r.length-=d;break}r.mode=ya;break;case 17:for(;h<14;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(r.nlen=257+(31&c),c>>>=5,h-=5,r.ndist=1+(31&c),c>>>=5,h-=5,r.ncode=4+(15&c),c>>>=4,h-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=wa;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;h<3;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.lens[S[r.have++]]=7&c,c>>>=3,h-=3}for(;r.have<19;)r.lens[S[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},k=va(0,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid code lengths set",r.mode=wa;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;b=(T=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,v=65535&T,!((g=T>>>24)<=h);){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(v<16)c>>>=g,h-=g,r.lens[r.have++]=v;else{if(16===v){for(x=g+2;h<x;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(c>>>=g,h-=g,0===r.have){t.msg="invalid bit length repeat",r.mode=wa;break}A=r.lens[r.have-1],d=3+(3&c),c>>>=2,h-=2}else if(17===v){for(x=g+3;h<x;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}h-=g,A=0,d=3+(7&(c>>>=g)),c>>>=3,h-=3}else{for(x=g+7;h<x;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}h-=g,A=0,d=11+(127&(c>>>=g)),c>>>=7,h-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=wa;break}for(;d--;)r.lens[r.have++]=A}}if(r.mode===wa)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=wa;break}if(r.lenbits=9,E={bits:r.lenbits},k=va(1,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,k){t.msg="invalid literal/lengths set",r.mode=wa;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},k=va(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,k){t.msg="invalid distances set",r.mode=wa;break}if(r.mode=20,6===e)break t;case 20:r.mode=21;case 21:if(o>=6&&u>=258){t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=h,fa(t,f),a=t.next_out,i=t.output,u=t.avail_out,s=t.next_in,n=t.input,o=t.avail_in,c=r.hold,h=r.bits,r.mode===ya&&(r.back=-1);break}for(r.back=0;b=(T=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,v=65535&T,!((g=T>>>24)<=h);){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(b&&0==(240&b)){for(m=g,y=b,w=v;b=(T=r.lencode[w+((c&(1<<m+y)-1)>>m)])>>>16&255,v=65535&T,!(m+(g=T>>>24)<=h);){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}c>>>=m,h-=m,r.back+=m}if(c>>>=g,h-=g,r.back+=g,r.length=v,0===b){r.mode=26;break}if(32&b){r.back=-1,r.mode=ya;break}if(64&b){t.msg="invalid literal/length code",r.mode=wa;break}r.extra=15&b,r.mode=22;case 22:if(r.extra){for(x=r.extra;h<x;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;b=(T=r.distcode[c&(1<<r.distbits)-1])>>>16&255,v=65535&T,!((g=T>>>24)<=h);){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(0==(240&b)){for(m=g,y=b,w=v;b=(T=r.distcode[w+((c&(1<<m+y)-1)>>m)])>>>16&255,v=65535&T,!(m+(g=T>>>24)<=h);){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}c>>>=m,h-=m,r.back+=m}if(c>>>=g,h-=g,r.back+=g,64&b){t.msg="invalid distance code",r.mode=wa;break}r.offset=v,r.extra=15&b,r.mode=24;case 24:if(r.extra){for(x=r.extra;h<x;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=wa;break}r.mode=25;case 25:if(0===u)break t;if(d=f-u,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=wa;break}d>r.wnext?(d-=r.wnext,p=r.wsize-d):p=r.wnext-d,d>r.length&&(d=r.length),_=r.window}else _=i,p=a-r.offset,d=r.length;d>u&&(d=u),u-=d,r.length-=d;do{i[a++]=_[p++]}while(--d);0===r.length&&(r.mode=21);break;case 26:if(0===u)break t;i[a++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;h<32;){if(0===o)break t;o--,c|=n[s++]<<h,h+=8}if(f-=u,t.total_out+=f,r.total+=f,f&&(t.adler=r.check=r.flags?Ts(r.check,i,f,a-f):ks(r.check,i,f,a-f)),f=u,(r.flags?c:Aa(c))!==r.check){t.msg="incorrect data check",r.mode=wa;break}c=0,h=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;h<32;){if(0===o)break t;o--,c+=n[s++]<<h,h+=8}if(c!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=wa;break}c=0,h=0}r.mode=29;case 29:k=1;break t;case wa:k=-3;break t;case 31:return-4;case 32:default:return ma}return t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=h,(r.wsize||f!==t.avail_out&&r.mode<wa&&(r.mode<27||4!==e))&&Oa(t,t.output,t.next_out,f-t.avail_out),l-=t.avail_in,f-=t.avail_out,t.total_in+=l,t.total_out+=f,r.total+=f,r.wrap&&f&&(t.adler=r.check=r.flags?Ts(r.check,i,f,t.next_out-f):ks(r.check,i,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ya?128:0)+(20===r.mode||15===r.mode?256:0),(0===l&&0===f||4===e)&&0===k&&(k=-5),k},inflateEnd:function(t){if(!t||!t.state)return ma;var e=t.state;return e.window&&(e.window=null),t.state=null,0},inflateGetHeader:function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?ma:(r.head=e,e.done=!1,0):ma},inflateSetDictionary:function(t,e){var r,n=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?ma:11===r.mode&&ks(1,e,n,0)!==r.check?-3:Oa(t,e,n,n)?(r.mode=31,-4):(r.havedict=1,0):ma},inflateInfo:"pako inflate (from Nodeca project)"},Ma={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Da=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Fa=Object.prototype.toString;function La(t){if(!(this instanceof La))return new La(t);this.options=Ni.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oa,this.strm.avail_out=0;var r=Pa.inflateInit2(this.strm,e.windowBits);if(r!==Ma.Z_OK)throw new Error(Cs[r]);if(this.header=new Da,Pa.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=ra(e.dictionary):"[object ArrayBuffer]"===Fa.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Pa.inflateSetDictionary(this.strm,e.dictionary))!==Ma.Z_OK))throw new Error(Cs[r])}function ja(t,e){var r=new La(e);if(r.push(t,!0),r.err)throw r.msg||Cs[r.err];return r.result}La.prototype.push=function(t,e){var r,n,i,s,a,o=this.strm,u=this.options.chunkSize,c=this.options.dictionary,h=!1;if(this.ended)return!1;n=e===~~e?e:!0===e?Ma.Z_FINISH:Ma.Z_NO_FLUSH,"string"==typeof t?o.input=ia(t):"[object ArrayBuffer]"===Fa.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new Ni.Buf8(u),o.next_out=0,o.avail_out=u),(r=Pa.inflate(o,Ma.Z_NO_FLUSH))===Ma.Z_NEED_DICT&&c&&(r=Pa.inflateSetDictionary(this.strm,c)),r===Ma.Z_BUF_ERROR&&!0===h&&(r=Ma.Z_OK,h=!1),r!==Ma.Z_STREAM_END&&r!==Ma.Z_OK)return this.onEnd(r),this.ended=!0,!1;o.next_out&&(0!==o.avail_out&&r!==Ma.Z_STREAM_END&&(0!==o.avail_in||n!==Ma.Z_FINISH&&n!==Ma.Z_SYNC_FLUSH)||("string"===this.options.to?(i=aa(o.output,o.next_out),s=o.next_out-i,a=sa(o.output,i),o.next_out=s,o.avail_out=u-s,s&&Ni.arraySet(o.output,o.output,i,s,0),this.onData(a)):this.onData(Ni.shrinkBuf(o.output,o.next_out)))),0===o.avail_in&&0===o.avail_out&&(h=!0)}while((o.avail_in>0||0===o.avail_out)&&r!==Ma.Z_STREAM_END);return r===Ma.Z_STREAM_END&&(n=Ma.Z_FINISH),n===Ma.Z_FINISH?(r=Pa.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Ma.Z_OK):n!==Ma.Z_SYNC_FLUSH||(this.onEnd(Ma.Z_OK),o.avail_out=0,!0)},La.prototype.onData=function(t){this.chunks.push(t)},La.prototype.onEnd=function(t){t===Ma.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ni.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Na={Inflate:La,inflate:ja,inflateRaw:function(t,e){return(e=e||{}).raw=!0,ja(t,e)},ungzip:ja},Ua={};(0,Ni.assign)(Ua,la,Na,Ma);var za=Ua,$a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array?"uint8array":"array";function Ha(t,e){fi.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}hi.inherits(Ha,fi),Ha.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(hi.transformTo($a,t.data),!1)},Ha.prototype.flush=function(){fi.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},Ha.prototype.cleanUp=function(){fi.prototype.cleanUp.call(this),this._pako=null},Ha.prototype._createPako=function(){this._pako=new za[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}};var Wa={STORE:{magic:"\0\0",compressWorker:function(t){return new fi("STORE compression")},uncompressWorker:function(){return new fi("STORE decompression")}},DEFLATE:{magic:"\b\0",compressWorker:function(t){return new Ha("Deflate",t)},uncompressWorker:function(){return new Ha("Inflate",{})}}},qa="PK",Ga="PK",Va="PK",Xa="PK",Ka="PK",Ya="PK\b",Ja=function(t,e){var r,n="";for(r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n},Qa=function(t,e,r,n,i,s){var a,o,u=t.file,c=t.compression,h=s!==di.utf8encode,l=hi.transformTo("string",s(u.name)),f=hi.transformTo("string",di.utf8encode(u.name)),d=u.comment,p=hi.transformTo("string",s(d)),_=hi.transformTo("string",di.utf8encode(d)),g=f.length!==u.name.length,b=_.length!==d.length,v="",m="",y="",w=u.dir,A=u.date,k={crc32:0,compressedSize:0,uncompressedSize:0};e&&!r||(k.crc32=t.crc32,k.compressedSize=t.compressedSize,k.uncompressedSize=t.uncompressedSize);var E=0;e&&(E|=8),h||!g&&!b||(E|=2048);var x=0,T=0;w&&(x|=16),"UNIX"===i?(T=798,x|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(u.unixPermissions,w)):(T=20,x|=function(t,e){return 63&(t||0)}(u.dosPermissions)),a=A.getUTCHours(),a<<=6,a|=A.getUTCMinutes(),a<<=5,a|=A.getUTCSeconds()/2,o=A.getUTCFullYear()-1980,o<<=4,o|=A.getUTCMonth()+1,o<<=5,o|=A.getUTCDate(),g&&(m=Ja(1,1)+Ja(Ri(l),4)+f,v+="up"+Ja(m.length,2)+m),b&&(y=Ja(1,1)+Ja(Ri(p),4)+_,v+="uc"+Ja(y.length,2)+y);var C="";return C+="\n\0",C+=Ja(E,2),C+=c.magic,C+=Ja(a,2),C+=Ja(o,2),C+=Ja(k.crc32,4),C+=Ja(k.compressedSize,4),C+=Ja(k.uncompressedSize,4),C+=Ja(l.length,2),C+=Ja(v.length,2),{fileRecord:qa+C+l+v,dirRecord:Ga+Ja(T,2)+C+Ja(p.length,2)+"\0\0\0\0"+Ja(x,4)+Ja(n,4)+l+v+p}},Za=function(t){return Ya+Ja(t.crc32,4)+Ja(t.compressedSize,4)+Ja(t.uncompressedSize,4)};function to(t,e,r,n){fi.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}hi.inherits(to,fi),to.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,fi.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-n-1))/r:100}}))},to.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=Qa(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},to.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=Qa(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:Za(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},to.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,n=function(t,e,r,n,i){var s=hi.transformTo("string",i(n));return Va+"\0\0\0\0"+Ja(t,2)+Ja(t,2)+Ja(e,4)+Ja(r,4)+Ja(s.length,2)+s}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},to.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},to.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},to.prototype.resume=function(){return!!fi.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},to.prototype.error=function(t){var e=this._sources;if(!fi.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch(t){}return!0},to.prototype.lock=function(){fi.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()};var eo=to,ro=function(t,e,r){var n=new eo(e.streamFiles,r,e.platform,e.encodeFileName),i=0;try{t.forEach((function(t,r){i++;var s=function(t,e){var r=t||e,n=Wa[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,e.compression),a=r.options.compressionOptions||e.compressionOptions||{},o=r.dir,u=r.date;r._compressWorker(s,a).withStreamInfo("file",{name:t,dir:o,date:u,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(n)})),n.entriesCount=i}catch(t){n.error(t)}return n};function no(t,e){fi.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}hi.inherits(no,fi),no.prototype._bindStream=function(t){var e=this;this._stream=t,t.pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},no.prototype.pause=function(){return!!fi.prototype.pause.call(this)&&(this._stream.pause(),!0)},no.prototype.resume=function(){return!!fi.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};var io=no,so=function(t,e,r){var n,i=hi.getTypeOf(e),s=hi.extend(r||{},ki);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=oo(t)),s.createFolders&&(n=ao(t))&&uo.call(this,n,!0);var a="string"===i&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!a),(e instanceof Pi&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",i="string");var o=null;o=e instanceof Pi||e instanceof fi?e:Ln&&zn(e)?new io(t,e):hi.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var u=new ji(t,o,s);this.files[t]=u},ao=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},oo=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},uo=function(t,e){return e=void 0!==e?e:ki.createFolders,t=oo(t),this.files[t]||so.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function co(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var ho={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,n;for(e in this.files)this.files.hasOwnProperty(e)&&(n=this.files[e],(r=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(r,n))},filter:function(t){var e=[];return this.forEach((function(r,n){t(r,n)&&e.push(n)})),e},file:function(t,e,r){if(1===arguments.length){if(co(t)){var n=t;return this.filter((function(t,e){return!e.dir&&n.test(t)}))}var i=this.files[this.root+t];return i&&!i.dir?i:null}return t=this.root+t,so.call(this,t,e,r),this},folder:function(t){if(!t)return this;if(co(t))return this.filter((function(e,r){return r.dir&&t.test(e)}));var e=this.root+t,r=uo.call(this,e),n=this.clone();return n.root=r.name,n},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter((function(e,r){return r.name.slice(0,t.length)===t})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if((r=hi.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:di.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");hi.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";e=ro(this,r,n)}catch(t){(e=new fi("error")).error(t)}return new Ai(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};function lo(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}lo.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return hi.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}};var fo=lo;function po(t){fo.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}hi.inherits(po,fo),po.prototype.byteAt=function(t){return this.data[this.zero+t]},po.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s-this.zero;return-1},po.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&n===s[2]&&i===s[3]},po.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var _o=po;function go(t){fo.call(this,t)}hi.inherits(go,fo),go.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},go.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},go.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},go.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var bo=go;function vo(t){_o.call(this,t)}hi.inherits(vo,_o),vo.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var mo=vo;function yo(t){mo.call(this,t)}hi.inherits(yo,mo),yo.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var wo=yo,Ao=function(t){var e=hi.getTypeOf(t);return hi.checkSupport(e),"string"!==e||Pn.uint8array?"nodebuffer"===e?new wo(t):Pn.uint8array?new mo(hi.transformTo("uint8array",t)):new _o(hi.transformTo("array",t)):new bo(t)};function ko(t,e){this.options=t,this.loadOptions=e}ko.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in Wa)if(Wa.hasOwnProperty(e)&&Wa[e].magic===t)return Wa[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+hi.pretty(this.compressionMethod)+" unknown (inner file : "+hi.transformTo("string",this.fileName)+")");this.decompressed=new Pi(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=Ao(this.extraFields[1].value);this.uncompressedSize===hi.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===hi.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===hi.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===hi.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,n,i=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<i;)e=t.readInt(2),r=t.readInt(2),n=t.readData(r),this.extraFields[e]={id:e,length:r,value:n};t.setIndex(i)},handleUTF8:function(){var t=Pn.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=di.utf8decode(this.fileName),this.fileCommentStr=di.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=hi.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=hi.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=Ao(t.value);return 1!==e.readInt(1)||Ri(this.fileName)!==e.readInt(4)?null:di.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=Ao(t.value);return 1!==e.readInt(1)||Ri(this.fileComment)!==e.readInt(4)?null:di.utf8decode(e.readData(t.length-5))}return null}};var Eo=ko;function xo(t){this.files=[],this.loadOptions=t}xo.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+hi.pretty(e)+", expected "+hi.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var n=this.reader.readString(4)===e;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=Pn.uint8array?"uint8array":"array",r=hi.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,n=this.zip64EndOfCentralSize-44;0<n;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(qa),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Ga);)(t=new Eo({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(Va);if(t<0)throw!this.isSignature(0,qa)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature(Va),this.readBlockEndOfCentral(),this.diskNumber===hi.MAX_VALUE_16BITS||this.diskWithCentralDirStart===hi.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===hi.MAX_VALUE_16BITS||this.centralDirRecords===hi.MAX_VALUE_16BITS||this.centralDirSize===hi.MAX_VALUE_32BITS||this.centralDirOffset===hi.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(Xa))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(Xa),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Ka)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Ka),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Ka),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=e-r;if(n>0)this.isSignature(e,Ga)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){this.reader=Ao(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var To=xo;function Co(t){return new ci.Promise((function(e,r){var n=t.decompressed.getContentWorker().pipe(new Bi);n.on("error",(function(t){r(t)})).on("end",(function(){n.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}function So(){if(!(this instanceof So))return new So;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new So;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}So.prototype=ho,So.prototype.loadAsync=function(t,e){var r=this;return e=hi.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:di.utf8decode}),Ln&&zn(t)?ci.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):hi.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var r=new To(e);return r.load(t),r})).then((function(t){var r=[ci.Promise.resolve(t)],n=t.files;if(e.checkCRC32)for(var i=0;i<n.length;i++)r.push(Co(n[i]));return ci.Promise.all(r)})).then((function(t){for(var n=t.shift(),i=n.files,s=0;s<i.length;s++){var a=i[s];r.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders})}return n.zipComment.length&&(r.comment=n.zipComment),r}))},So.support=Pn,So.defaults=ki,So.version="3.5.0",So.loadAsync=function(t,e){return(new So).loadAsync(t,e)},So.external=ci;var Ro=So,Io=M((function(t){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var r=[],n=0;n<t.length;n+=3)for(var i=t[n]<<16|t[n+1]<<8|t[n+2],s=0;s<4;s++)8*n+6*s<=8*t.length?r.push(e.charAt(i>>>6*(3-s)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,i=0;n<t.length;i=++n%4)0!=i&&r.push((e.indexOf(t.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(n))>>>6-2*i);return r}};t.exports=r}()})),Bo={utf8:{stringToBytes:function(t){return Bo.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(Bo.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}},Oo=Bo,Po=function(t){return null!=t&&(Mo(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Mo(t.slice(0,0))}(t)||!!t._isBuffer)};function Mo(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Do=M((function(t){!function(){var e=Io,r=Oo.utf8,n=Po,i=Oo.bin,s=function(t,a){t.constructor==String?t=a&&"binary"===a.encoding?i.stringToBytes(t):r.stringToBytes(t):n(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var o=e.bytesToWords(t),u=8*t.length,c=1732584193,h=-271733879,l=-1732584194,f=271733878,d=0;d<o.length;d++)o[d]=16711935&(o[d]<<8|o[d]>>>24)|4278255360&(o[d]<<24|o[d]>>>8);o[u>>>5]|=128<<u%32,o[14+(u+64>>>9<<4)]=u;var p=s._ff,_=s._gg,g=s._hh,b=s._ii;for(d=0;d<o.length;d+=16){var v=c,m=h,y=l,w=f;c=p(c,h,l,f,o[d+0],7,-680876936),f=p(f,c,h,l,o[d+1],12,-389564586),l=p(l,f,c,h,o[d+2],17,606105819),h=p(h,l,f,c,o[d+3],22,-1044525330),c=p(c,h,l,f,o[d+4],7,-176418897),f=p(f,c,h,l,o[d+5],12,1200080426),l=p(l,f,c,h,o[d+6],17,-1473231341),h=p(h,l,f,c,o[d+7],22,-45705983),c=p(c,h,l,f,o[d+8],7,1770035416),f=p(f,c,h,l,o[d+9],12,-1958414417),l=p(l,f,c,h,o[d+10],17,-42063),h=p(h,l,f,c,o[d+11],22,-1990404162),c=p(c,h,l,f,o[d+12],7,1804603682),f=p(f,c,h,l,o[d+13],12,-40341101),l=p(l,f,c,h,o[d+14],17,-1502002290),c=_(c,h=p(h,l,f,c,o[d+15],22,1236535329),l,f,o[d+1],5,-165796510),f=_(f,c,h,l,o[d+6],9,-1069501632),l=_(l,f,c,h,o[d+11],14,643717713),h=_(h,l,f,c,o[d+0],20,-373897302),c=_(c,h,l,f,o[d+5],5,-701558691),f=_(f,c,h,l,o[d+10],9,38016083),l=_(l,f,c,h,o[d+15],14,-660478335),h=_(h,l,f,c,o[d+4],20,-405537848),c=_(c,h,l,f,o[d+9],5,568446438),f=_(f,c,h,l,o[d+14],9,-1019803690),l=_(l,f,c,h,o[d+3],14,-187363961),h=_(h,l,f,c,o[d+8],20,1163531501),c=_(c,h,l,f,o[d+13],5,-1444681467),f=_(f,c,h,l,o[d+2],9,-51403784),l=_(l,f,c,h,o[d+7],14,1735328473),c=g(c,h=_(h,l,f,c,o[d+12],20,-1926607734),l,f,o[d+5],4,-378558),f=g(f,c,h,l,o[d+8],11,-2022574463),l=g(l,f,c,h,o[d+11],16,1839030562),h=g(h,l,f,c,o[d+14],23,-35309556),c=g(c,h,l,f,o[d+1],4,-1530992060),f=g(f,c,h,l,o[d+4],11,1272893353),l=g(l,f,c,h,o[d+7],16,-155497632),h=g(h,l,f,c,o[d+10],23,-1094730640),c=g(c,h,l,f,o[d+13],4,681279174),f=g(f,c,h,l,o[d+0],11,-358537222),l=g(l,f,c,h,o[d+3],16,-722521979),h=g(h,l,f,c,o[d+6],23,76029189),c=g(c,h,l,f,o[d+9],4,-640364487),f=g(f,c,h,l,o[d+12],11,-421815835),l=g(l,f,c,h,o[d+15],16,530742520),c=b(c,h=g(h,l,f,c,o[d+2],23,-995338651),l,f,o[d+0],6,-198630844),f=b(f,c,h,l,o[d+7],10,1126891415),l=b(l,f,c,h,o[d+14],15,-1416354905),h=b(h,l,f,c,o[d+5],21,-57434055),c=b(c,h,l,f,o[d+12],6,1700485571),f=b(f,c,h,l,o[d+3],10,-1894986606),l=b(l,f,c,h,o[d+10],15,-1051523),h=b(h,l,f,c,o[d+1],21,-2054922799),c=b(c,h,l,f,o[d+8],6,1873313359),f=b(f,c,h,l,o[d+15],10,-30611744),l=b(l,f,c,h,o[d+6],15,-1560198380),h=b(h,l,f,c,o[d+13],21,1309151649),c=b(c,h,l,f,o[d+4],6,-145523070),f=b(f,c,h,l,o[d+11],10,-1120210379),l=b(l,f,c,h,o[d+2],15,718787259),h=b(h,l,f,c,o[d+9],21,-343485551),c=c+v>>>0,h=h+m>>>0,l=l+y>>>0,f=f+w>>>0}return e.endian([c,h,l,f])};s._ff=function(t,e,r,n,i,s,a){var o=t+(e&r|~e&n)+(i>>>0)+a;return(o<<s|o>>>32-s)+e},s._gg=function(t,e,r,n,i,s,a){var o=t+(e&n|r&~n)+(i>>>0)+a;return(o<<s|o>>>32-s)+e},s._hh=function(t,e,r,n,i,s,a){var o=t+(e^r^n)+(i>>>0)+a;return(o<<s|o>>>32-s)+e},s._ii=function(t,e,r,n,i,s,a){var o=t+(r^(e|~n))+(i>>>0)+a;return(o<<s|o>>>32-s)+e},s._blocksize=16,s._digestsize=16,t.exports=function(t,r){if(null==t)throw new Error("Illegal argument "+t);var n=e.wordsToBytes(s(t,r));return r&&r.asBytes?n:r&&r.asString?i.bytesToString(n):e.bytesToHex(n)}}()}));var Fo=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=[];function n(t){return r[t]||(r[t]=function(t){for(var e="return function dispatcher"+t+"(payload) {\n",r=[],n=[],i=0;i<t;i++)r.push("cb"+i),n.push("ctx"+i),e+="    cb"+i+"(payload, ctx"+i+");\n";return e+="};",new(Function.bind.apply(Function,[void 0].concat(r.concat(n),[e])))}(t)),r[t]}r[0]=function(){return function(){}},r[1]=function(t,e){return void 0===e?t:function(r){t(r,e)}};var i=function(){function t(){this.hasHandlers=!1,this._handlers=[],this._contexts=[],this._createDispatcher()}return t.prototype.addHandler=function(t,e){return this.isHandlerAttached(t,e)||(this._handlers.push(t),this._contexts.push(e),this._createDispatcher(),this._updateHasHandlers()),this},t.prototype.removeHandler=function(t,e){var r=this._getHandlerIndex(t,e);return void 0!==r&&(this._handlers.splice(r,1),this._contexts.splice(r,1),this._createDispatcher(),this._updateHasHandlers()),this},t.prototype.isHandlerAttached=function(t,e){return void 0!==this._getHandlerIndex(t,e)},t.prototype._updateHasHandlers=function(){this.hasHandlers=!!this._handlers.length},t.prototype._getHandlerIndex=function(t,e){var r,n=this._handlers.length;for(r=0;r<n&&(this._handlers[r]!==t||this._contexts[r]!==e);r++);return r<n?r:void 0},t.prototype._createDispatcher=function(){this.dispatch=n(this._handlers.length).apply(this,this._handlers.concat(this._contexts))},t}();e.default=i}));P(Fo);var Lo=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Event=Fo.default}));P(Lo);var jo,No=Lo.Event;!function(t){t.TrapPayload=class{constructor(t,e,r){this.reason=t,this.cartridge=e,this.message=r}}}(jo||(jo={}));class Uo{constructor(){this.trap=new No}init(){return n(this,void 0,void 0,(function*(){}))}reset(){}read(t){return 0}peek(t){return this.read(t)}write(t,e){}getType(){return ct.CartridgeType.unknown}setCpu(t){return this}setBus(t){return this}setRng(t){return this}setCpuTimeProvider(t){return this}notifyCpuCycleComplete(){}randomize(t){}triggerTrap(t,e){if(!this.trap.hasHandlers)throw new Error(e);this.trap.dispatch(new jo.TrapPayload(t,this,e))}}function zo(t,e){const r=[],n=e.map(t=>0);for(let i=0;i<t.length;i++){for(let s=0;s<r.length;s++){const a=r[s],o=e[a.signature];t[i]===o[a.nextIndex]?++a.nextIndex===o.length&&(n[a.signature]++,r.splice(s,1),s--):(r.splice(s,1),s--)}for(let s=0;s<e.length;s++){const a=e[s];a.length>0&&t[i]===a[0]&&(1===a.length?n[s]++:r.push({signature:s,nextIndex:1}))}}return n}class $o extends Uo{constructor(t,e=!0){if(super(),this._supportSC=e,this._bank=null,this._bank0=new Uint8Array(4096),this._bank1=new Uint8Array(4096),this._hasSC=!1,this._saraRAM=new Uint8Array(128),this._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(let e=0;e<4096;e++)this._bank0[e]=t[e],this._bank1[e]=t[4096+e];this.reset()}static matchesBuffer(t){return zo(t,[[141,249,31]])[0]>=2}reset(){this._bank=this._bank1,this._hasSC=!1}read(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)}peek(t){return t&=4095,this._hasSC&&t>=128&&t<256?this._saraRAM[t-128]:this._bank[t]}write(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)}getType(){return ct.CartridgeType.bankswitch_8k_F8}randomize(t){for(let e=0;e<this._saraRAM.length;e++)this._saraRAM[e]=t.int(255)}setBus(t){return this._bus=t,this}_access(t,e){if(t<128&&this._hasSC)this._saraRAM[t]=255&e;else switch(t){case 4088:this._bank=this._bank0;break;case 4089:this._bank=this._bank1}}}class Ho extends Uo{constructor(t){if(super(),this._banks=new Array(8),this._activeBanks=new Array(4),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(let t=0;t<8;t++)this._banks[t]=new Uint8Array(1024);for(let e=0;e<1024;e++)for(let r=0;r<8;r++)this._banks[r][e]=t[1024*r+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[141,224,31],[141,224,95],[141,233,255],[12,224,31],[173,224,31],[173,233,255],[173,237,255],[173,243,191]]);for(let t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}reset(){for(let t=0;t<4;t++)this._activeBanks[t]=this._banks[7]}read(t){return(t&=4095)>=4064&&t<4088&&this._handleBankswitch(t),this._activeBanks[t>>10][1023&t]}peek(t){return t&=4095,this._activeBanks[t>>10][1023&t]}write(t,e){const r=4095&t;return r>=4064&&r<4088&&this._handleBankswitch(r),super.write(t,e)}getType(){return ct.CartridgeType.bankswitch_8k_E0}_handleBankswitch(t){t<4072?this._activeBanks[0]=this._banks[t-4064]:t<4080?this._activeBanks[1]=this._banks[t-4072]:this._activeBanks[2]=this._banks[t-4080]}}class Wo extends Uo{constructor(t){if(super(),this._banks=new Array(4),this._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: invalid length "+t.length);for(let t=0;t<4;t++)this._banks[t]=new Uint8Array(2048);this._bank1=this._banks[3],this._bank0=this._banks[0];for(let e=0;e<2048;e++)for(let r=0;r<4;r++)this._banks[r][e]=t[2048*r+e]}static matchesBuffer(t){return zo(t,[[133,63]])[0]>=2}reset(){this._bank0=this._banks[0]}setBus(t){return this._bus=t,this._bus.event.read.addHandler(Wo._onBusAccess,this),this._bus.event.write.addHandler(Wo._onBusAccess,this),this}read(t){return(t&=4095)<2048?this._bank0[t]:this._bank1[2047&t]}getType(){return ct.CartridgeType.bankswitch_8k_3F}static _onBusAccess(t,e){63===e._bus.getLastAddresBusValue()&&(e._bank0=e._banks[3&e._bus.getLastDataBusValue()])}}class qo extends Uo{constructor(t){if(super(),this._banks=null,this._ramSelect=!1,this._ramBanks=new Array(256),this._bus=null,0!=(2047&t.length))throw new Error(`buffer length ${t.length} is not a multiple of 2k`);const e=t.length>>>11;if(e<2)throw new Error("image must have at least 2k");this._banks=new Array(e);for(let t=0;t<e;t++)this._banks[t]=new Uint8Array(2048);for(let t=0;t<=255;t++)this._ramBanks[t]=new Uint8Array(1024);this._ramBank=this._ramBanks[0],this._bank1=this._banks[e-1],this._bank0=this._banks[0];for(let r=0;r<2048;r++)for(let n=0;n<e;n++)this._banks[n][r]=t[2048*n+r]}static matchesBuffer(t){return zo(t,[[133,62,169,0]])[0]>=1}reset(){this._bank0=this._banks[0]}randomize(t){for(let e=0;e<this._ramBanks.length;e++)for(let r=0;r<1024;r++)this._ramBanks[e][r]=t.int(255)}setBus(t){return this._bus=t,this._bus.event.read.addHandler(qo._onBusAccess,this),this._bus.event.write.addHandler(qo._onBusAccess,this),this}read(t){return t&=4095,this._ramSelect?t<1024?this._ramBank[t]:t<2048?this._ramBank[1023&t]=this._bus.getLastDataBusValue():this._bank1[2047&t]:t<2048?this._bank0[t]:this._bank1[2047&t]}peek(t){return t&=4095,this._ramSelect?t<1024?this._ramBank[t]:t<2048?this._bus.getLastDataBusValue():this._bank1[2047&t]:t<2048?this._bank0[t]:this._bank1[2047&t]}write(t,e){this._ramSelect&&(t&=4095)>=1024&&t<2048&&(this._ramBank[1023&t]=e)}getType(){return ct.CartridgeType.bankswitch_3E}static _onBusAccess(t,e){switch(e._bus.getLastAddresBusValue()){case 63:e._ramSelect=!1,e._bank0=e._banks[e._bus.getLastDataBusValue()%e._banks.length];break;case 62:e._ramSelect=!0,e._ramBank=e._ramBanks[e._bus.getLastDataBusValue()%32]}}}class Go extends Uo{constructor(t){if(super(),this._bank0=new Uint8Array(4096),this._bank1=new Uint8Array(4096),this._lastAccessWasFE=!1,this._lastAddressBusValue=-1,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(let e=0;e<4096;e++)this._bank0[e]=t[e],this._bank1[e]=t[4096+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[32,0,208,198,197],[32,195,248,165,130],[208,251,32,115,254],[32,0,240,132,214]]);for(let t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}reset(){this._bank=this._bank0,this._lastAccessWasFE=!1,this._lastAddressBusValue=-1}read(t){return this._bank[4095&t]}write(t,e){super.write(t,e)}setBus(t){return this._bus=t,this._bus.event.read.addHandler(Go._onBusAccess,this),this._bus.event.write.addHandler(Go._onBusAccess,this),this}getType(){return ct.CartridgeType.bankswitch_8k_FE}static _onBusAccess(t,e){const r=e._lastAddressBusValue;if(e._lastAddressBusValue=8191&e._bus.getLastAddresBusValue(),e._lastAddressBusValue!==r){if(e._lastAccessWasFE){const t=224&e._bus.getLastDataBusValue();e._bank=0===t||(32&e._bus.getLastDataBusValue())>0?e._bank0:e._bank1}e._lastAccessWasFE=510===e._lastAddressBusValue}}}class Vo extends Uo{constructor(t){if(super(),this._bus=null,this._bank=null,this._bank0=new Uint8Array(4096),this._bank1=new Uint8Array(4096),8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(let e=0;e<4096;e++)this._bank0[e]=t[e],this._bank1[e]=t[4096+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[141,64,2],[173,64,2],[189,31,2]]);for(let t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}reset(){this._bank=this._bank0}read(t){return this._bank[4095&t]}setBus(t){return this._bus=t,t.event.read.addHandler(Vo._onBusAccess,this),t.event.write.addHandler(Vo._onBusAccess,this),this}getType(){return ct.CartridgeType.bankswitch_8k_UA}static _onBusAccess(t,e){switch(e._bus.getLastAddresBusValue()){case 544:e._bank=e._bank0;break;case 576:e._bank=e._bank1}}}class Xo extends Uo{constructor(t){if(super(),this._banks=new Array(8),this._ram0=new Uint8Array(1024),this._ram1Banks=new Array(4),this._ram0Enabled=!1,16384!==t.length)throw new Error("buffer is not a 16k cartridge image: wrong length "+t.length);for(let t=0;t<8;t++)this._banks[t]=new Uint8Array(2048);for(let t=0;t<4;t++)this._ram1Banks[t]=new Uint8Array(256);for(let e=0;e<2048;e++)for(let r=0;r<8;r++)this._banks[r][e]=t[2048*r+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[173,226,255],[173,229,255],[173,229,31],[173,231,31],[12,231,31],[141,231,255],[141,231,31]]);for(let t=0;t<e.length;t++)if(e[t]>0)return!0;return!1}reset(){this._bank0=this._banks[0],this._ram1=this._ram1Banks[0],this._ram0Enabled=!1}read(t){return this._handleBankswitch(4095&t),this.peek(t)}peek(t){return(t&=4095)<2048?this._ram0Enabled?t>=1024?this._ram0[t-1024]:0:this._bank0[t]:t<=2559?t>=2304?this._ram1[t-2304]:0:this._banks[7][2047-(4095-t)]}write(t,e){t&=4095,this._handleBankswitch(t),t<1024?this._ram0Enabled?this._ram0[t]=e:super.write(t,e):t<2048?super.write(t,e):t<2303?this._ram1[t-2048]=e:super.write(t,e)}getType(){return ct.CartridgeType.bankswitch_16k_E7}randomize(t){for(let e=0;e<4;e++)for(let r=0;r<this._ram1Banks[e].length;r++)this._ram1Banks[e][r]=t.int(255);for(let e=0;e<this._ram0.length;e++)this._ram0[e]=t.int(255)}_handleBankswitch(t){t<4064||(t<=4070?(this._bank0=this._banks[15&t],this._ram0Enabled=!1):4071===t?this._ram0Enabled=!0:t<=4075&&(this._ram1=this._ram1Banks[t-4072]))}}class Ko extends Uo{constructor(t){if(super(),this._banks=new Array(7),this._ram=new Uint8Array(256),this._savedRam=new Uint8Array(256),this._accessCounter=0,this._accessCounterLimit=0,28672!==t.length&&29696!==t.length)throw new Error("buffer is not a 28k/29k cartridge image: wrong length "+t.length);for(let t=0;t<7;t++)this._banks[t]=new Uint8Array(4096);const e=28672===t.length?0:1024;for(let r=0;r<4096;r++)for(let n=0;n<7;n++)this._banks[n][r]=t[4096*n+r+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[160,193,31,224],[0,128,2,224]]);return e[0]>0||e[1]>0}reset(){this._accessCounter=0,this._accessCounterLimit=0,this._bank=this._banks[0]}getType(){return ct.CartridgeType.bankswitch_FA2}randomize(t){for(let e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)}setBus(t){return this._bus=t,this}read(t){return this.write(4095&t,this._bus.getLastDataBusValue()),this.peek(t)}peek(t){return(t&=4095)>=256&&t<512?this._ram[t-256]:4084===t?this._accessCounter>=this._accessCounterLimit?-65&this._bank[t]:64|this._bank[t]:this._bank[t]}write(t,e){if(t&=4095,this._accessCounter++,!(t<256))return 4084===t?this._handleIo():void(t>=4085&&t<=4091&&(this._bank=this._banks[t-4085]));this._ram[t]=e}_handleIo(){if(!(this._accessCounter<this._accessCounterLimit)){if(1===this._ram[255]){for(let t=0;t<256;t++)this._ram[t]=this._savedRam[t];this._accessCounterLimit=10}else{if(2!==this._ram[255])return;for(let t=0;t<256;t++)this._savedRam[t]=this._ram[t];this._accessCounterLimit=100}this._accessCounter=0,this._ram[255]=0}}}class Yo extends Uo{constructor(t,e=!0){if(super(),this._supportSC=e,this._bus=null,this._banks=new Array(16),this._ram=new Uint8Array(128),this._hasSC=!1,65536!==t.length)throw new Error("buffer is not a 64k cartridge image: wrong length "+t.length);for(let t=0;t<16;t++)this._banks[t]=new Uint8Array(4096);for(let e=0;e<4096;e++)for(let r=0;r<16;r++)this._banks[r][e]=t[4096*r+e];this.reset()}static matchesBuffer(t){const e=e=>{const r=e.split("").map(t=>t.charCodeAt(0));for(let e=0;e<r.length;e++)if(r[e]!==t[65528+e])return!1;return!0};if(65536!==t.length)return!1;if(e("efef")||e("efsc"))return!0;const r=zo(t,[[12,224,255],[173,224,255],[12,224,31],[173,224,31]]);for(let t=0;t<4;t++)if(r[t]>0)return!0;return!1}reset(){this._bank=this._banks[15],this._hasSC=!1}getType(){return ct.CartridgeType.bankswitch_64k_EF}randomize(t){for(let e=0;e<this._ram.length;e++)this._ram[e]=t.int(255)}setBus(t){return this._bus=t,this}read(t){return this._access(4095&t,this._bus.getLastDataBusValue()),this.peek(t)}peek(t){return t&=4095,this._hasSC&&t>=128&&t<256?this._ram[t-128]:this._bank[t]}write(t,e){(t&=4095)<128&&this._supportSC&&(this._hasSC=!0),this._access(t,e)}_access(t,e){t<128&&this._hasSC?this._ram[t]=e:t>=4064&&t<=4079&&(this._bank=this._banks[t-4064])}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Jo=function(t,e){return(Jo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var Qo=function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Zo(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tu(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function eu(t){return this instanceof eu?(this.v=t,this):new eu(t)}var ru=Object.freeze({__proto__:null,__extends:function(t,e){function r(){this.constructor=t}Jo(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return Qo},__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function(t,e,r,n){var i,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(a=(s<3?i(a):s>3?i(e,r,a):i(e,r))||a);return s>3&&a&&Object.defineProperty(e,r,a),a},__param:function(t,e){return function(r,n){e(r,n,t)}},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function a(t){try{u(n.next(t))}catch(t){s(t)}}function o(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))},__generator:function(t,e){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},__createBinding:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])},__values:Zo,__read:tu,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(tu(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n},__await:eu,__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){s.push([t,e,r,n])>1||o(t,e)}))})}function o(t,e){try{(r=i[t](e)).value instanceof eu?Promise.resolve(r.value.v).then(u,c):h(s[0][2],r)}catch(t){h(s[0][3],t)}var r}function u(t){o("next",t)}function c(t){o("throw",t)}function h(t,e){t(e),s.shift(),s.length&&o(s[0][0],s[0][1])}},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:eu(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=Zo(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,i,(e=t[r](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}}),nu="/home/travis/build/6502ts/6502.ts/node_modules/thumbulator.ts/lib/native",iu=Object.freeze({__proto__:null,default:{}});function su(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}var au=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,ou=function(t){return au.exec(t).slice(1)};function uu(){for(var t="",e=!1,r=arguments.length-1;r>=-1&&!e;r--){var n=r>=0?arguments[r]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(t=n+"/"+t,e="/"===n.charAt(0))}return(e?"/":"")+(t=su(bu(t.split("/"),(function(t){return!!t})),!e).join("/"))||"."}function cu(t){var e=hu(t),r="/"===vu(t,-1);return(t=su(bu(t.split("/"),(function(t){return!!t})),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function hu(t){return"/"===t.charAt(0)}function lu(){var t=Array.prototype.slice.call(arguments,0);return cu(bu(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))}function fu(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=uu(t).substr(1),e=uu(e).substr(1);for(var n=r(t.split("/")),i=r(e.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}var u=[];for(o=a;o<n.length;o++)u.push("..");return(u=u.concat(i.slice(a))).join("/")}function du(t){var e=ou(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."}function pu(t,e){var r=ou(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r}function _u(t){return ou(t)[3]}var gu={extname:_u,basename:pu,dirname:du,sep:"/",delimiter:":",relative:fu,join:lu,isAbsolute:hu,normalize:cu,resolve:uu};function bu(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var vu="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)},mu=Object.freeze({__proto__:null,resolve:uu,normalize:cu,isAbsolute:hu,join:lu,relative:fu,sep:"/",delimiter:":",dirname:du,basename:pu,extname:_u,default:gu}),yu=D(iu),wu=D(mu),Au=M((function(t,e){var r,n=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){t=void 0!==(t=t||{})?t:{};var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);var i=function(t,e){throw e},s=!1,a=!1,o=!1,u=!1,c=!1;s="object"==typeof window,a="function"==typeof importScripts,u="object"==typeof B&&"object"==typeof B.versions&&"string"==typeof B.versions.node,o=u&&!s&&!a,c=!s&&!o&&!a;var h,l,f,d,p,_="";function g(e){return t.locateFile?t.locateFile(e,_):_+e}o?(_=nu+"/",h=function(t,e){var r;return(r=It(t))||(d||(d=yu),p||(p=wu),t=p.normalize(t),r=d.readFileSync(t)),e?r:r.toString()},f=function(t){var e=h(t,!0);return e.buffer||(e=new Uint8Array(e)),x(e.buffer),e},B.argv.length>1&&B.argv[1].replace(/\\/g,"/"),B.argv.slice(2),B.on("unhandledRejection",Gt),i=function(t){B.exit(t)},t.inspect=function(){return"[Emscripten Module object]"}):c?("undefined"!=typeof read&&(h=function(t){var e=It(t);return e?Ct(e):read(t)}),f=function(t){var e;return(e=It(t))?e:"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(x("object"==typeof(e=read(t,"binary"))),e)},"undefined"!=typeof scriptArgs&&scriptArgs,"function"==typeof quit&&(i=function(t){quit(t)}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(s||a)&&(a?_=self.location.href:document.currentScript&&(_=document.currentScript.src),r&&(_=r),_=0!==_.indexOf("blob:")?_.substr(0,_.lastIndexOf("/")+1):"",h=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText}catch(e){var r=It(t);if(r)return Ct(r);throw e}},a&&(f=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}catch(e){var r=It(t);if(r)return r;throw e}}),l=function(t,e,r){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){if(200==n.status||0==n.status&&n.response)e(n.response);else{var i=It(t);i?e(i.buffer):r()}},n.onerror=r,n.send(null)});var b=t.print||console.log.bind(console),v=t.printErr||console.warn.bind(console);for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);n=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&(i=t.quit),new Array(0);var m,y=0,w=function(t){y=t},A=function(){return y},k=8;t.wasmBinary&&t.wasmBinary,t.noExitRuntime&&(m=t.noExitRuntime);var E=!1;function x(t,e){t||Gt("Assertion failed: "+e)}function T(e){var r=t["_"+e];return x(r,"Cannot call unknown function "+e+", make sure it is exported"),r}function C(t,e,r,n,i){var s={string:function(t){var e=0;if(null!=t&&0!==t){var r=1+(t.length<<2);L(t,e=Dt(r),r)}return e},array:function(t){var e=Dt(t.length);return j(t,e),e}},a=T(t),o=[],u=0;if(n)for(var c=0;c<n.length;c++){var h=s[r[c]];h?(0===u&&(u=Lt()),o[c]=h(n[c])):o[c]=n[c]}var l=a.apply(null,o);return l=function(t){return"string"===e?D(t):"boolean"===e?Boolean(t):t}(l),0!==u&&Ft(u),l}var S,R,I,O,P="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function M(t,e,r){for(var n=e+r,i=e;t[i]&&!(i>=n);)++i;if(i-e>16&&t.subarray&&P)return P.decode(t.subarray(e,i));for(var s="";e<i;){var a=t[e++];if(128&a){var o=63&t[e++];if(192!=(224&a)){var u=63&t[e++];if((a=224==(240&a)?(15&a)<<12|o<<6|u:(7&a)<<18|o<<12|u<<6|63&t[e++])<65536)s+=String.fromCharCode(a);else{var c=a-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&a)<<6|o)}else s+=String.fromCharCode(a)}return s}function D(t,e){return t?M(I,t,e):""}function F(t,e,r,n){if(!(n>0))return 0;for(var i=r,s=r+n-1,a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),o<=127){if(r>=s)break;e[r++]=o}else if(o<=2047){if(r+1>=s)break;e[r++]=192|o>>6,e[r++]=128|63&o}else if(o<=65535){if(r+2>=s)break;e[r++]=224|o>>12,e[r++]=128|o>>6&63,e[r++]=128|63&o}else{if(r+3>=s)break;e[r++]=240|o>>18,e[r++]=128|o>>12&63,e[r++]=128|o>>6&63,e[r++]=128|63&o}}return e[r]=0,r-i}function L(t,e,r){return F(t,I,e,r)}function j(t,e){R.set(t,e)}function N(e){S=e,t.HEAP8=R=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=O=new Int32Array(e),t.HEAPU8=I=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var U=13920,z=3648,$=t.TOTAL_MEMORY||16777216;function H(e){for(;e.length>0;){var r=e.shift();if("function"!=typeof r){var n=r.func;"number"==typeof n?void 0===r.arg?t.dynCall_v(n):t.dynCall_vi(n,r.arg):n(void 0===r.arg?null:r.arg)}else r()}}$=(S=t.buffer?t.buffer:new ArrayBuffer($)).byteLength,N(S),O[z>>2]=U;var W=[],q=[],G=[],V=[];function X(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)Q(t.preRun.shift());H(W)}function K(){H(q)}function Y(){H(G)}function J(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)Z(t.postRun.shift());H(V)}function Q(t){W.unshift(t)}function Z(t){V.unshift(t)}var tt=0,et=null;function rt(e){tt++,t.monitorRunDependencies&&t.monitorRunDependencies(tt)}function nt(e){if(tt--,t.monitorRunDependencies&&t.monitorRunDependencies(tt),0==tt&&et){var r=et;et=null,r()}}t.preloadedImages={},t.preloadedAudios={};var it=null,st="data:application/octet-stream;base64,";function at(t){return String.prototype.startsWith?t.startsWith(st):0===t.indexOf(st)}var ot=[function(e){return t.trapOnInstructionFetch(e)},function(e){return t.busRead32(e)},function(e,r){t.busWrite32(e,r)},function(e){return t.busRead16(e)},function(e,r){return t.trapOnBx32(e,r)},function(e,r){t.busWrite16(e,r)}];function ut(t,e,r){return ot[t](e,r)}function ct(t,e){return ot[t](e)}it="data:application/octet-stream;base64,AAAAAAAAAAARAAoAERERAAAAAAUAAAAAAAAJAAAAAAsAAAAAAAAAABEADwoREREDCgcAARMJCwsAAAkGCwAACwAGEQAAABEREQAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAARAAoKERERAAoAAAIACQsAAAAJAAsAAAsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAMAAAAAAkMAAAAAAAMAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAA0AAAAEDQAAAAAJDgAAAAAADgAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAPAAAAAA8AAAAACRAAAAAAABAAABAAABIAAAASEhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAABISEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAoAAAAACgAAAAAJCwAAAAAACwAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAwAAAAACQwAAAAAAAwAAAwAADAxMjM0NTY3ODlBQkNERUYFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAQAAAHkNAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAD//////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHRodW1idWxhdG9yAHsgcmV0dXJuIE1vZHVsZS5idXNSZWFkMTYoJDApOyB9AHsgcmV0dXJuIE1vZHVsZS5idXNSZWFkMzIoJDApOyB9AHsgTW9kdWxlLmJ1c1dyaXRlMTYoJDAsICQxKTsgfQB7IE1vZHVsZS5idXNXcml0ZTMyKCQwLCAkMSk7IH0AcGMgaGFzIGxzYml0IHNldCAweCUwOFgKAHsgcmV0dXJuIE1vZHVsZS50cmFwT25JbnN0cnVjdGlvbkZldGNoKCQwKTsgfQAtLS0gMHglMDhYOiAweCUwNFggAGFkYyByJXUsciV1CgBhZGRzIHIldSxyJXUsIzB4JVgKAGFkZHMgciV1LCMweCUwMlgKAGFkZHMgciV1LHIldSxyJXUKAGFkZCByJXUsciV1CgBhZGQgcGMsLi4uIHByb2R1Y2VkIGFuIGFybSBhZGRyZXNzIDB4JTA4WCAweCUwOFgKAGFkZCByJXUsUEMsIzB4JTAyWAoAYWRkIHIldSxTUCwjMHglMDJYCgBhZGQgU1AsIzB4JTAyWAoAYW5kcyByJXUsciV1CgBhc3JzIHIldSxyJXUsIzB4JVgKAGFzcnMgciV1LHIldQoAYmVxIDB4JTA4WAoAYm5lIDB4JTA4WAoAYmNzIDB4JTA4WAoAYmNjIDB4JTA4WAoAYm1pIDB4JTA4WAoAYnBsIDB4JTA4WAoAYnZzIDB4JTA4WAoAYnZjIDB4JTA4WAoAYmhpIDB4JTA4WAoAYmxzIDB4JTA4WAoAYmdlIDB4JTA4WAoAYmx0IDB4JTA4WAoAYmd0IDB4JTA4WAoAYmxlIDB4JTA4WAoAQiAweCUwOFgKAGJpY3MgciV1LHIldQoAYmtwdCAweCUwMlgKAGJsIDB4JTA4WAoAYmx4IHIldQoAY2Fubm90IGJyYW5jaCB0byBhcm0gMHglMDhYIDB4JTA0WAoAYnggciV1CgB7IHJldHVybiBNb2R1bGUudHJhcE9uQngzMigkMCwgJDEpOyB9AGNtbnMgciV1LHIldQoAY21wIHIldSwjMHglMDJYCgBjbXBzIHIldSxyJXUKAGNwcyBUT0RPCgBjcHkgciV1LHIldQoAZW9ycyByJXUsciV1CgBsZG1pYSByJXUhLHsAciV1AH0KAGxkciByJXUsW3IldSwjMHglWF0KAGxkciByJXUsW3IldSxyJXVdCgBsZHIgciV1LFtQQysjMHglWF0KAGxkciByJXUsW1NQKyMweCVYXQoAbGRyYiByJXUsW3IldSwjMHglWF0KAGxkcmIgciV1LFtyJXUsciV1XQoAbGRyaCByJXUsW3IldSwjMHglWF0KAGxkcmggciV1LFtyJXUsciV1XQoAbGRyc2IgciV1LFtyJXUsciV1XQoAbGRyc2ggciV1LFtyJXUsciV1XQoAbHNscyByJXUsciV1LCMweCVYCgBsc2xzIHIldSxyJXUKAGxzcnMgciV1LHIldSwjMHglWAoAbHNycyByJXUsciV1CgBtb3ZzIHIldSwjMHglMDJYCgBtb3ZzIHIldSxyJXUKAG1vdiByJXUsciV1CgBtdWxzIHIldSxyJXUKAG12bnMgciV1LHIldQoAbmVncyByJXUsciV1CgBvcnJzIHIldSxyJXUKAHBvcCB7AHBjAHBvcCB7cmN9IHdpdGggYW4gQVJNIGFkZHJlc3MgcGMgMHglMDhYIHBvcHBlZCAweCUwOFgKAHB1c2ggewBscgBwdXNoIHtscn0gd2l0aCBhbiBBUk0gYWRkcmVzcyBwYyAweCUwOFggcG9wcGVkIDB4JTA4WAoAcmV2IHIldSxyJXUKAHJldjE2IHIldSxyJXUKAHJldnNoIHIldSxyJXUKAHJvcnMgciV1LHIldQoAc2JjIHIldSxyJXUKAHNldGVuZCBub3QgaW1wbGVtZW50ZWQKAHN0bWlhIHIldSEsewBzdHIgciV1LFtyJXUsIzB4JVhdCgBzdHIgciV1LFtyJXUsciV1XQoAc3RyIHIldSxbU1AsIzB4JVhdCgBzdHJiIHIldSxbciV1LCMweCVYXQoAc3RyYiByJXUsW3IldSxyJXVdCgBzdHJoIHIldSxbciV1LCMweCVYXQoAc3RyaCByJXUsW3IldSxyJXVdCgBzdWJzIHIldSxyJXUsIzB4JVgKAHN1YnMgciV1LCMweCUwMlgKAHN1YnMgciV1LHIldSxyJXUKAHN1YiBTUCwjMHglMDJYCgBzd2kgMHglMDJYCgAKCnN3aSAweCUwMlgKAHN4dGIgciV1LHIldQoAc3h0aCByJXUsciV1CgB0c3QgciV1LHIldQoAdXh0YiByJXUsciV1CgB1eHRoIHIldSxyJXUKAGludmFsaWQgaW5zdHJ1Y3Rpb24gMHglMDhYIDB4JTA0WAoALSsgICAwWDB4AChudWxsKQAtMFgrMFggMFgtMHgrMHggMHgAaW5mAElORgBuYW4ATkFOAC4=";var ht=3664;function lt(t){return t}function ft(t){return t.replace(/\b__Z[\w\d_]+/g,(function(t){return t==t?t:t+" ["+t+"]"}))}function dt(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function pt(){var e=dt();return t.extraStackTrace&&(e+="\n"+t.extraStackTrace()),ft(e)}var _t={buffers:[null,[],[]],printChar:function(t,e){var r=_t.buffers[t];0===e||10===e?((1===t?b:v)(M(r,0)),r.length=0):r.push(e)},varargs:0,get:function(t){return _t.varargs+=4,O[_t.varargs-4>>2]},getStr:function(){return D(_t.get())},get64:function(){var t=_t.get();return _t.get(),t},getZero:function(){_t.get()}};function gt(t,e){_t.varargs=e;try{return _t.getStreamFromFD(),_t.get(),_t.get(),_t.get(),_t.get(),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Gt(t),-t.errno}}function bt(t,e){_t.varargs=e;try{return _t.getStreamFromFD(),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Gt(t),-t.errno}}function vt(){var e=t._fflush;e&&e(0);var r=_t.buffers;r[1].length&&_t.printChar(1,10),r[2].length&&_t.printChar(2,10)}function mt(t,e,r,n){try{for(var i=0,s=0;s<r;s++){for(var a=O[e+8*s>>2],o=O[e+(8*s+4)>>2],u=0;u<o;u++)_t.printChar(t,I[a+u]);i+=o}return O[n>>2]=i,0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Gt(t),-t.errno}}function yt(){return mt.apply(null,arguments)}function wt(){return R.length}function At(t){qt(t)}function kt(t,e,r){I.set(I.subarray(e,e+r),t)}function Et(e){return t.___errno_location&&(O[t.___errno_location()>>2]=e),e}function xt(t){Gt("OOM")}function Tt(t){xt()}function Ct(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n>255&&(n&=255),e.push(String.fromCharCode(n))}return e.join("")}var St="function"==typeof atob?atob:function(t){var e,r,n,i,s,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=o.indexOf(t.charAt(c++))<<2|(i=o.indexOf(t.charAt(c++)))>>4,r=(15&i)<<4|(s=o.indexOf(t.charAt(c++)))>>2,n=(3&s)<<6|(a=o.indexOf(t.charAt(c++))),u+=String.fromCharCode(e),64!==s&&(u+=String.fromCharCode(r)),64!==a&&(u+=String.fromCharCode(n))}while(c<t.length);return u};function Rt(t){if("boolean"==typeof o&&o){var e;try{e=me.from(t,"base64")}catch(r){e=new me(t,"base64")}return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}try{for(var r=St(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n}catch(t){throw new Error("Converting base64 string to bytes failed.")}}function It(t){if(at(t))return Rt(t.slice(st.length))}var Bt,Ot={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Float32Array:Float32Array,Float64Array:Float64Array},Pt={a:Gt,b:w,c:A,d:Et,e:gt,f:bt,g:yt,h:ct,i:ut,j:wt,k:kt,l:Tt,m:At,n:mt,o:xt,p:lt,q:ft,r:vt,s:dt,t:pt,u:ht,v:z},Mt=function(t,e,r){"use asm";var n=new t.Int8Array(r),i=new t.Int16Array(r),s=new t.Int32Array(r),a=new t.Uint8Array(r),o=new t.Uint16Array(r),u=new t.Float32Array(r),c=new t.Float64Array(r),h=e.u|0,l=e.v|0,f=0,d=0,p=0,_=0,g=0,b=0,v=0,m=0.0,y=t.Math.imul,w=t.Math.clz32,A=e.a,k=e.b,E=e.c,x=e.d,T=e.e,C=e.f,S=e.g,R=e.h,I=e.i,B=e.j,O=e.k,P=e.l,M=e.m,D=e.n,F=e.o,L=e.p,j=e.q,N=e.r,U=e.s,z=e.t,$=3680,H=13920,W=0.0;function q(t){t=t|0;var e=0;e=$;$=$+t|0;$=$+15&-16;return e|0}function G(){return $|0}function V(t){t=t|0;$=t}function X(t,e){t=t|0;e=e|0;$=t;H=e}function K(t){t=t|0;s[712]=t;return}function Y(){return 888}function J(t){t=t|0;var e=0,r=0,n=0,i=0,a=0;s[713]=0;if(!t){i=0;return i|0}e=0;r=0;while(1){a=nt()|0;n=(s[713]|0)!=0;r=(a|0)==0?r:a;e=e+1|0;if(n|(a|0)==0^1)break;if(e>>>0>=t>>>0){e=0;i=6;break}}if((i|0)==6)return e|0;a=n?10:r;return a|0}function Q(){s[713]=1;return}function Z(t){t=t|0;n[3440]=t;return}function tt(t){t=t|0;var e=0,r=0;r=$;$=$+16|0;e=s[2784+((t&15)<<2)>>2]|0;if((t&15|0)!=15){$=r;return e|0}if(e&1|0){t=s[160]|0;s[r>>2]=e;mt(t,1028,r)|0}e=e&-2;$=r;return e|0}function et(t,e){t=t|0;e=e|0;s[2784+((t&15)<<2)>>2]=(t&15|0)==15?e&-2:e;return}function rt(){s[714]=4;s[715]=0;s[716]=0;s[717]=0;s[718]=0;return 0}function nt(){var t=0,e=0,r=0,i=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0,d=0,p=0;p=$;$=$+1232|0;e=s[711]|0;if(e&1|0){d=s[160]|0;s[p>>2]=e;mt(d,1028,p)|0}t=s[712]|0;if(!t){t=R(0,(e&-2)+-2|0)|0;if(t|0){d=t;$=p;return d|0}}else if(((e&-2)+-2|0)==(t|0)){d=20;$=p;return d|0}if((e&-2)>>>0>4026531839&(s[717]|0)!=0){s[717]=0;d=s[709]|0;s[696]=R(1,d|0)|0;s[697]=R(1,d+4|0)|0;s[698]=R(1,d+8|0)|0;s[699]=R(1,d+12|0)|0;s[708]=R(1,d+16|0)|0;s[710]=R(1,d+20|0)|0;r=R(1,d+24|0)|0;s[718]=R(1,d+28|0)|0;s[709]=d+32}else r=e&-2;t=s[714]|0;do{if(t&1){e=s[716]|0;if(!e){s[716]=s[715];s[714]=t|65536;t=t|65536;break}else{s[716]=e+-1;break}}}while(0);if((t&3|0)==3?(t&65536|0)!=0&(s[717]|0)==0:0){i=s[709]|0;e=s[718]|0;t:do{if((i+-4&-268435456|0)==-536870912)switch((i+536813548|0)>>>2|i+536813548<<30|0){case 0:{s[714]=e&65543;if((t&1|0)!=0|(e&1|0)==0)break t;s[716]=s[715];break t}case 1:{s[715]=e&16777215;break t}case 2:{s[716]=e&16777215;break t}case 3:break t;default:break t}else I(2,i+-4|0,e|0)|0}while(0);t:do{if((i+-8&-268435456|0)==-536870912)switch((i+536813544|0)>>>2|i+536813544<<30|0){case 0:{d=s[714]|0;s[714]=r&65543;if((r&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=r&16777215;break t}case 2:{s[716]=r&16777215;break t}case 3:break t;default:break t}else I(2,i+-8|0,r|0)|0}while(0);t=s[710]|0;t:do{if((i+-12&-268435456|0)==-536870912)switch((i+536813540|0)>>>2|i+536813540<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-12|0,t|0)|0}while(0);t=s[708]|0;t:do{if((i+-16&-268435456|0)==-536870912)switch((i+536813536|0)>>>2|i+536813536<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-16|0,t|0)|0}while(0);t=s[699]|0;t:do{if((i+-20&-268435456|0)==-536870912)switch((i+536813532|0)>>>2|i+536813532<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-20|0,t|0)|0}while(0);t=s[698]|0;t:do{if((i+-24&-268435456|0)==-536870912)switch((i+536813528|0)>>>2|i+536813528<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-24|0,t|0)|0}while(0);t=s[697]|0;t:do{if((i+-28&-268435456|0)==-536870912)switch((i+536813524|0)>>>2|i+536813524<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-28|0,t|0)|0}while(0);t=s[696]|0;t:do{if((i+-32&-268435456|0)==-536870912)switch((i+536813520|0)>>>2|i+536813520<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}else I(2,i+-32|0,t|0)|0}while(0);s[709]=i+-32;r=(R(1,60)|0)+2|0;s[710]=-7;s[717]=1}a=r+-2|0;d=R(3,a|0)|0;f=r+2|0;s[711]=f&-2;if(n[3440]|0){l=s[160]|0;s[p+8>>2]=a;s[p+8+4>>2]=d;mt(l,1099,p+8|0)|0}if((d&65472|0)==16704){if(n[3440]|0){f=s[160]|0;s[p+16>>2]=d&7;s[p+16+4>>2]=d>>>3&7;mt(f,1119,p+16|0)|0}e=s[2784+((d&7)<<2)>>2]|0;r=s[2784+((d>>>3&7)<<2)>>2]|0;f=s[718]|0;s[2784+((d&7)<<2)>>2]=r+e+(f>>>29&1);t=(r+e+(f>>>29&1)|0)<0?f|-2147483648:f&2147483647;t=(r+e+(f>>>29&1)|0)==0?t|1073741824:t&-1073741825;s[718]=t;if(!(t&536870912)){d=((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)|0)>>>31)&2|0)==0?t&-536870913:t|536870912;s[718]=(((r&2147483647)+(e&2147483647)|0)>>>31|0)==(((r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)|0)>>>31)|0)>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}else{f=(r>>>31)+(e>>>31)+(((r&2147483647)+(e&2147483647)+1|0)>>>31)|0;d=(f&2|0)==0?t&-536870913:t|536870912;s[718]=(((r&2147483647)+(e&2147483647)+1|0)>>>31|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}}if((d&65024|0)==7168?d>>>6&7|0:0){if(n[3440]|0){f=s[160]|0;s[p+24>>2]=d&7;s[p+24+4>>2]=d>>>3&7;s[p+24+8>>2]=d>>>6&7;mt(f,1132,p+24|0)|0}l=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=l+(d>>>6&7);f=s[718]|0;f=(l+(d>>>6&7)|0)<0?f|-2147483648:f&2147483647;f=(l+(d>>>6&7)|0)==0?f|1073741824:f&-1073741825;f=((((l&2147483647)+(d>>>6&7)|0)>>>31)+(l>>>31)&2|0)==0?f&-536870913:f|536870912;s[718]=(((l&2147483647)+(d>>>6&7)|0)>>>31|0)==(((((l&2147483647)+(d>>>6&7)|0)>>>31)+(l>>>31)|0)>>>1|0)?f&-268435457:f|268435456;d=0;$=p;return d|0}if((d&63488|0)==12288){if(n[3440]|0){f=s[160]|0;s[p+40>>2]=d>>>8&7;s[p+40+4>>2]=d&255;mt(f,1152,p+40|0)|0}l=s[2784+((d>>>8&7)<<2)>>2]|0;s[2784+((d>>>8&7)<<2)>>2]=l+(d&255);f=s[718]|0;f=(l+(d&255)|0)<0?f|-2147483648:f&2147483647;f=(l+(d&255)|0)==0?f|1073741824:f&-1073741825;f=((((l&2147483647)+(d&255)|0)>>>31)+(l>>>31)&2|0)==0?f&-536870913:f|536870912;s[718]=(((l&2147483647)+(d&255)|0)>>>31|0)==(((((l&2147483647)+(d&255)|0)>>>31)+(l>>>31)|0)>>>1|0)?f&-268435457:f|268435456;d=0;$=p;return d|0}if((d&65024|0)==6144){if(n[3440]|0){f=s[160]|0;s[p+48>>2]=d&7;s[p+48+4>>2]=d>>>3&7;s[p+48+8>>2]=d>>>6&7;mt(f,1170,p+48|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;l=s[2784+((d>>>6&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=l+f;d=s[718]|0;d=(l+f|0)<0?d|-2147483648:d&2147483647;d=(l+f|0)==0?d|1073741824:d&-1073741825;d=((l>>>31)+(f>>>31)+(((l&2147483647)+(f&2147483647)|0)>>>31)&2|0)==0?d&-536870913:d|536870912;s[718]=(((l&2147483647)+(f&2147483647)|0)>>>31|0)==(((l>>>31)+(f>>>31)+(((l&2147483647)+(f&2147483647)|0)>>>31)|0)>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}if((d&65280|0)==17408){if(n[3440]|0){l=s[160]|0;s[p+64>>2]=d>>>4&8|d&7;s[p+64+4>>2]=d>>>3&15;mt(l,1188,p+64|0)|0}t=s[2784+((d>>>4&8|d&7)<<2)>>2]|0;if((d>>>4&8|d&7|0)==15){if(t&1|0){l=s[160]|0;s[p+72>>2]=t;mt(l,1028,p+72|0)|0}t=t&-2}e=s[2784+((d>>>3&15)<<2)>>2]|0;if((d>>>3&15|0)==15){if(e&1|0){l=s[160]|0;s[p+80>>2]=e;mt(l,1028,p+80|0)|0}e=e&-2}t=e+t|0;if((d>>>4&8|d&7|0)!=15){s[2784+((d>>>4&8|d&7)<<2)>>2]=t;d=0;$=p;return d|0}if(!(t&1)){d=s[160]|0;s[p+88>>2]=f;s[p+88+4>>2]=t;mt(d,1201,p+88|0)|0;M(1)}s[711]=t+2&-2;d=0;$=p;return d|0}e=d&63488;switch(e<<16>>16){case-24576:{if(n[3440]|0){f=s[160]|0;s[p+96>>2]=d>>>8&7;s[p+96+4>>2]=d<<2&1020;mt(f,1251,p+96|0)|0}t=s[711]|0;if(t&1|0){f=s[160]|0;s[p+104>>2]=t;mt(f,1028,p+104|0)|0}s[2784+((d>>>8&7)<<2)>>2]=(t&-4)+(d<<2&1020);d=0;$=p;return d|0}case-22528:{if(n[3440]|0){f=s[160]|0;s[p+112>>2]=d>>>8&7;s[p+112+4>>2]=d<<2&1020;mt(f,1271,p+112|0)|0}s[2784+((d>>>8&7)<<2)>>2]=(s[709]|0)+(d<<2&1020);d=0;$=p;return d|0}default:{if((d&65408|0)==45056){if(n[3440]|0){f=s[160]|0;s[p+120>>2]=d<<2&508;mt(f,1291,p+120|0)|0}s[709]=(s[709]|0)+(d<<2&508);d=0;$=p;return d|0}if((d&65472|0)==16384){if(n[3440]|0){f=s[160]|0;s[p+128>>2]=d&7;s[p+128+4>>2]=d>>>3&7;mt(f,1307,p+128|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]&s[2784+((d&7)<<2)>>2];s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}if((d&63488|0)==4096){if(n[3440]|0){f=s[160]|0;s[p+136>>2]=d&7;s[p+136+4>>2]=d>>>3&7;s[p+136+8>>2]=d>>>6&31;mt(f,1321,p+136|0)|0}e=s[2784+((d>>>3&7)<<2)>>2]|0;do{if(!(d>>>6&31)){t=s[718]|0;if((e|0)<0){s[718]=t|536870912;s[2784+((d&7)<<2)>>2]=-1;t=t|536870912;o=141;break}else{s[718]=t&-536870913;s[2784+((d&7)<<2)>>2]=0;t=t&1610612735;o=143;break}}else{t=s[718]|0;t=(e&1<<(d>>>6&31)+-1|0)==0?t&-536870913:t|536870912;s[718]=t;e=((e|0)<0?-1<<32-(d>>>6&31):0)|e>>>(d>>>6&31);s[2784+((d&7)<<2)>>2]=e;if((e|0)>=0)if(!e){t=t&1073741823;o=143}else t=t&1073741823;else o=141}}while(0);if((o|0)==141)t=t&1073741823|-2147483648;else if((o|0)==143)t=t|1073741824;s[718]=t;d=0;$=p;return d|0}if((d&65472|0)==16640){if(n[3440]|0){f=s[160]|0;s[p+152>>2]=d&7;s[p+152+4>>2]=d>>>3&7;mt(f,1341,p+152|0)|0}e=s[2784+((d&7)<<2)>>2]|0;t=s[2784+((d>>>3&7)<<2)>>2]&255;do{if(t){if(t>>>0<32){o=s[718]|0;o=(1<<t+-1&e|0)==0?o&-536870913:o|536870912;s[718]=o;t=((e|0)<0?-1<<32-t:0)|e>>>t;e=o;o=155;break}t=s[718]|0;if((e|0)<0){s[718]=t|536870912;s[2784+((d&7)<<2)>>2]=-1;t=t|-1610612736;o=156;break}else{s[718]=t&-536870913;s[2784+((d&7)<<2)>>2]=0;t=t&536870911;o=158;break}}else{t=e;e=s[718]|0;o=155}}while(0);do{if((o|0)==155){s[2784+((d&7)<<2)>>2]=t;if((t|0)<0){t=e|-2147483648;o=156;break}if(!t){t=e&2147483647;o=158}else t=e&1073741823}}while(0);if((o|0)==156)t=t&-1073741825;else if((o|0)==158)t=t|1073741824;s[718]=t;d=0;$=p;return d|0}t:do{if((d&61440|0)==53248){i=(((d&128|0)==0?d&255:d|-256)<<1)+f|0;do{switch(d>>>8&15){case 0:{if(n[3440]|0){d=s[160]|0;s[p+160>>2]=i+-1;mt(d,1355,p+160|0)|0}if(!(s[718]&1073741824)){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 1:{if(n[3440]|0){d=s[160]|0;s[p+168>>2]=i+-1;mt(d,1367,p+168|0)|0}if(s[718]&1073741824|0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 2:{if(n[3440]|0){d=s[160]|0;s[p+176>>2]=i+-1;mt(d,1379,p+176|0)|0}if(!(s[718]&536870912)){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 3:{if(n[3440]|0){d=s[160]|0;s[p+184>>2]=i+-1;mt(d,1391,p+184|0)|0}if(s[718]&536870912|0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 4:{if(n[3440]|0){d=s[160]|0;s[p+192>>2]=i+-1;mt(d,1403,p+192|0)|0}if((s[718]|0)>=0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 5:{if(n[3440]|0){d=s[160]|0;s[p+200>>2]=i+-1;mt(d,1415,p+200|0)|0}if((s[718]|0)<0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 6:{if(n[3440]|0){d=s[160]|0;s[p+208>>2]=i+-1;mt(d,1427,p+208|0)|0}if(!(s[718]&268435456)){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 7:{if(n[3440]|0){d=s[160]|0;s[p+216>>2]=i+-1;mt(d,1439,p+216|0)|0}if(s[718]&268435456|0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 8:{if(n[3440]|0){d=s[160]|0;s[p+224>>2]=i+-1;mt(d,1451,p+224|0)|0}if((s[718]&1610612736|0)!=536870912){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 9:{if(n[3440]|0){d=s[160]|0;s[p+232>>2]=i+-1;mt(d,1463,p+232|0)|0}if((s[718]&1610612736|0)==536870912){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 10:{if(n[3440]|0){d=s[160]|0;s[p+240>>2]=i+-1;mt(d,1475,p+240|0)|0}t=s[718]&-1879048192;e:do{if((t|0)<0){switch(t|0){case-1879048192:break e;default:t=0}$=p;return t|0}else{switch(t|0){case 0:break e;default:t=0}$=p;return t|0}}while(0);s[711]=i+2&-2;d=0;$=p;return d|0}case 11:{if(n[3440]|0){d=s[160]|0;s[p+248>>2]=i+-1;mt(d,1487,p+248|0)|0}t=s[718]&-1879048192;e:do{if((t|0)<268435456){switch(t|0){case-2147483648:break e;default:t=0}$=p;return t|0}else{switch(t|0){case 268435456:break e;default:t=0}$=p;return t|0}}while(0);s[711]=i+2&-2;d=0;$=p;return d|0}case 12:{if(n[3440]|0){d=s[160]|0;s[p+256>>2]=i+-1;mt(d,1499,p+256|0)|0}d=s[718]|0;if(d&1073741824|0?1:(((d&-1879048192|0)==0?(d&-1879048192|0)==-1879048192?2:1:(d&-1879048192|0)==-1879048192&1)|0)==0){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}case 13:{if(n[3440]|0){d=s[160]|0;s[p+264>>2]=i+-1;mt(d,1511,p+264|0)|0}d=s[718]|0;if((((d&-1879048192|0)==-2147483648?(d&-1879048192|0)==268435456?2:1:(d&-1879048192|0)==268435456&1)|0)==(0-(d>>>30&1)|0)){d=0;$=p;return d|0}s[711]=i+2&-2;d=0;$=p;return d|0}default:break t}}while(0)}}while(0);if((d&63488|0)==57344){t=(((d&1024|0)==0?d&2047:d|-2048)<<1)+f|0;if(n[3440]|0){d=s[160]|0;s[p+272>>2]=t+-1;mt(d,1523,p+272|0)|0}s[711]=t+2&-2;d=0;$=p;return d|0}if((d&65472|0)==17280){if(n[3440]|0){f=s[160]|0;s[p+280>>2]=d&7;s[p+280+4>>2]=d>>>3&7;mt(f,1533,p+280|0)|0}f=s[2784+((d&7)<<2)>>2]&~s[2784+((d>>>3&7)<<2)>>2];s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}if((d&65280|0)==48640){f=s[160]|0;s[p+288>>2]=d&255;mt(f,1547,p+288|0)|0;d=1;$=p;return d|0}t:do{if((d&57344|0)==57344){if((d&6144)<4096){switch(d&6144){case 2048:break;default:break t}t=(s[710]|0)+(d<<1&4094)&-4|2;if(n[3440]|0){d=s[160]|0;s[p+304>>2]=t+-3;mt(d,1560,p+304|0)|0}s[710]=r|1;s[711]=t;d=0;$=p;return d|0}switch(d&6144){case 4096:{if(n[3440]|0)Lt(10,s[160]|0)|0;s[710]=(((d&1024|0)==0?d&2047:d|1046528)<<12)+f;d=0;$=p;return d|0}case 6144:{t=(s[710]|0)+(d<<1&4094)|0;if(n[3440]|0){d=s[160]|0;s[p+296>>2]=t+-1;mt(d,1560,p+296|0)|0}s[710]=r|1;s[711]=t+2&-2;d=0;$=p;return d|0}default:break t}}}while(0);switch((d&65415)<<16>>16){case 18304:{if(n[3440]|0){l=s[160]|0;s[p+312>>2]=d>>>3&15;mt(l,1571,p+312|0)|0}t=s[2784+((d>>>3&15)<<2)>>2]|0;if((d>>>3&15|0)==15){if(t&1|0){l=s[160]|0;s[p+320>>2]=t;mt(l,1028,p+320|0)|0}t=t&-2}t=t+2|0;if(!(t&1)){l=s[160]|0;s[p+328>>2]=f;s[p+328+4>>2]=d;mt(l,1580,p+328|0)|0;d=2;$=p;return d|0}else{s[710]=r|1;s[711]=t&-2;d=0;$=p;return d|0}}case 18176:{if(n[3440]|0){f=s[160]|0;s[p+336>>2]=d>>>3&15;mt(f,1616,p+336|0)|0}t=s[2784+((d>>>3&15)<<2)>>2]|0;if((d>>>3&15|0)==15){if(t&1|0){d=s[160]|0;s[p+344>>2]=t;mt(d,1028,p+344|0)|0}t=t&-2}t=t+2|0;if(t&1|0){s[711]=t&-2;d=0;$=p;return d|0}t=I(4,a|0,t|0)|0;if(t|0){d=t;$=p;return d|0}s[711]=(s[710]|0)+2&-2;d=0;$=p;return d|0}default:{if((d&65472|0)==17088){if(n[3440]|0){f=s[160]|0;s[p+352>>2]=d&7;s[p+352+4>>2]=d>>>3&7;mt(f,1662,p+352|0)|0}f=s[2784+((d&7)<<2)>>2]|0;l=s[2784+((d>>>3&7)<<2)>>2]|0;d=s[718]|0;d=(l+f|0)<0?d|-2147483648:d&2147483647;d=(l+f|0)==0?d|1073741824:d&-1073741825;d=((l>>>31)+(f>>>31)+(((l&2147483647)+(f&2147483647)|0)>>>31)&2|0)==0?d&-536870913:d|536870912;s[718]=(((l&2147483647)+(f&2147483647)|0)>>>31|0)==(((l>>>31)+(f>>>31)+(((l&2147483647)+(f&2147483647)|0)>>>31)|0)>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}if((d&63488|0)==10240){if(n[3440]|0){f=s[160]|0;s[p+360>>2]=d>>>8&7;s[p+360+4>>2]=d&255;mt(f,1676,p+360|0)|0}h=s[2784+((d>>>8&7)<<2)>>2]|0;f=s[718]|0;f=(h-(d&255)|0)<0?f|-2147483648:f&2147483647;f=(h-(d&255)|0)==0?f|1073741824:f&-1073741825;l=(h>>>31)+1+((-2147483648-(d&255)+(h&2147483647)|0)>>>31)|0;f=(l&2|0)==0?f&-536870913:f|536870912;s[718]=((-2147483648-(d&255)+(h&2147483647)|0)>>>31|0)==(l>>>1&1|0)?f&-268435457:f|268435456;d=0;$=p;return d|0}if((d&65472|0)==17024){if(n[3440]|0){f=s[160]|0;s[p+368>>2]=d&7;s[p+368+4>>2]=d>>>3&7;mt(f,1693,p+368|0)|0}h=s[2784+((d&7)<<2)>>2]|0;l=s[2784+((d>>>3&7)<<2)>>2]|0;d=s[718]|0;d=(h-l|0)<0?d|-2147483648:d&2147483647;d=(h-l|0)==0?d|1073741824:d&-1073741825;f=(~l>>>31)+(h>>>31)+(((h&2147483647)+1+(~l&2147483647)|0)>>>31)|0;d=(f&2|0)==0?d&-536870913:d|536870912;s[718]=(((h&2147483647)+1+(~l&2147483647)|0)>>>31|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}if((d&65280|0)==17664){if(n[3440]|0){f=s[160]|0;s[p+376>>2]=d>>>4&8|d&7;s[p+376+4>>2]=d>>>3&15;mt(f,1693,p+376|0)|0}t=s[2784+((d>>>4&8|d&7)<<2)>>2]|0;if((d>>>4&8|d&7|0)==15){if(t&1|0){f=s[160]|0;s[p+384>>2]=t;mt(f,1028,p+384|0)|0}e=t&-2}else e=t;t=s[2784+((d>>>3&15)<<2)>>2]|0;if((d>>>3&15|0)==15){if(t&1|0){d=s[160]|0;s[p+392>>2]=t;mt(d,1028,p+392|0)|0}t=t&-2}f=e-t|0;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;d=(f|0)==0?d|1073741824:d&-1073741825;f=~t;l=((e&2147483647)+1+(f&2147483647)|0)>>>31;f=(f>>>31)+(e>>>31)+l|0;d=(f&2|0)==0?d&-536870913:d|536870912;s[718]=(l|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}if((d&65512|0)==46688&(n[3440]|0)!=0)ft(1707,9,1,s[160]|0)|0;t=d&65472;switch(t<<16>>16){case 17920:{if(n[3440]|0){f=s[160]|0;s[p+400>>2]=d&7;s[p+400+4>>2]=d>>>3&7;mt(f,1717,p+400|0)|0}s[2784+((d&7)<<2)>>2]=s[2784+((d>>>3&7)<<2)>>2];d=0;$=p;return d|0}case 16448:{if(n[3440]|0){f=s[160]|0;s[p+408>>2]=d&7;s[p+408+4>>2]=d>>>3&7;mt(f,1730,p+408|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]^s[2784+((d&7)<<2)>>2];s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}default:{t:do{if(e<<16>>16<26624){switch(e<<16>>16){case-14336:break;default:break t}if(!(n[3440]|0))e=d&1;else{e=s[160]|0;s[p+416>>2]=d>>>8&7;mt(e,1744,p+416|0)|0;if(!(d&1))t=0;else{s[p+424>>2]=0;mt(e,1757,p+424|0)|0;t=1}if(d&2){if(t|0)Lt(44,e)|0;s[p+1168>>2]=1;mt(e,1757,p+1168|0)|0;t=t+1|0}if(d&4){if(t|0)Lt(44,e)|0;s[p+1176>>2]=2;mt(e,1757,p+1176|0)|0;t=t+1|0}if(d&8){if(t|0)Lt(44,e)|0;s[p+1184>>2]=3;mt(e,1757,p+1184|0)|0;t=t+1|0}if(d&16){if(t|0)Lt(44,e)|0;s[p+1192>>2]=4;mt(e,1757,p+1192|0)|0;t=t+1|0}if(d&32){if(t|0)Lt(44,e)|0;s[p+1200>>2]=5;mt(e,1757,p+1200|0)|0;t=t+1|0}if(d&64){if(t|0)Lt(44,e)|0;s[p+1208>>2]=6;mt(e,1757,p+1208|0)|0;t=t+1|0}if(d&128|0){if(t|0)Lt(44,e)|0;s[p+1216>>2]=7;mt(e,1757,p+1216|0)|0}ft(1761,2,1,e)|0;e=d&1}t=s[2784+((d>>>8&7)<<2)>>2]|0;if(e){s[696]=R(1,t|0)|0;t=t+4|0}if(d&2){s[697]=R(1,t|0)|0;t=t+4|0}if(d&4){s[698]=R(1,t|0)|0;t=t+4|0}if(d&8){s[699]=R(1,t|0)|0;t=t+4|0}if(d&16){s[700]=R(1,t|0)|0;t=t+4|0}if(d&32){s[701]=R(1,t|0)|0;t=t+4|0}if(d&64){s[702]=R(1,t|0)|0;t=t+4|0}if(d&128){s[703]=R(1,t|0)|0;t=t+4|0}if(1<<(d>>>8&7)&d|0){d=0;$=p;return d|0}s[2784+((d>>>8&7)<<2)>>2]=t;d=0;$=p;return d|0}else{switch(e<<16>>16){case 26624:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+432>>2]=d&7;s[p+432+4>>2]=d>>>3&7;s[p+432+8>>2]=d>>>4&124;mt(f,1764,p+432|0)|0}s[2784+((d&7)<<2)>>2]=R(1,(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>4&124)|0)|0;d=0;$=p;return d|0}}while(0);if((d&65024|0)==22528){if(n[3440]|0){f=s[160]|0;s[p+448>>2]=d&7;s[p+448+4>>2]=d>>>3&7;s[p+448+8>>2]=d>>>6&7;mt(f,1785,p+448|0)|0}s[2784+((d&7)<<2)>>2]=R(1,(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0)|0;d=0;$=p;return d|0}t:do{if(e<<16>>16<18432){switch(e<<16>>16){case-26624:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+480>>2]=d>>>8&7;s[p+480+4>>2]=d<<2&1020;mt(f,1824,p+480|0)|0}s[2784+((d>>>8&7)<<2)>>2]=R(1,(s[709]|0)+(d<<2&1020)|0)|0;d=0;$=p;return d|0}else{if(e<<16>>16>=30720){switch(e<<16>>16){case 30720:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+488>>2]=d&7;s[p+488+4>>2]=d>>>3&7;s[p+488+8>>2]=d>>>6&31;mt(f,1844,p+488|0)|0}l=(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>6&31)|0;f=R(3,l&-2|0)|0;s[2784+((d&7)<<2)>>2]=((l&1|0)==0?f:f>>>8)&255;d=0;$=p;return d|0}switch(e<<16>>16){case 18432:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+464>>2]=d>>>8&7;s[p+464+4>>2]=d<<2&1020;mt(f,1804,p+464|0)|0}t=s[711]|0;if(t&1|0){f=s[160]|0;s[p+472>>2]=t;mt(f,1028,p+472|0)|0}s[2784+((d>>>8&7)<<2)>>2]=R(1,(t&-4)+(d<<2&1020)|0)|0;d=0;$=p;return d|0}}while(0);if((d&65024|0)==23552){if(n[3440]|0){f=s[160]|0;s[p+504>>2]=d&7;s[p+504+4>>2]=d>>>3&7;s[p+504+8>>2]=d>>>6&7;mt(f,1866,p+504|0)|0}l=(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0;f=R(3,l&-2|0)|0;s[2784+((d&7)<<2)>>2]=((l&1|0)==0?f:f>>>8)&255;d=0;$=p;return d|0}if((d&63488|0)==34816){if(n[3440]|0){f=s[160]|0;s[p+520>>2]=d&7;s[p+520+4>>2]=d>>>3&7;s[p+520+8>>2]=d>>>5&62;mt(f,1886,p+520|0)|0}s[2784+((d&7)<<2)>>2]=(R(3,(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>5&62)|0)|0)&65535;d=0;$=p;return d|0}switch((d&65024)<<16>>16){case 23040:{if(n[3440]|0){f=s[160]|0;s[p+536>>2]=d&7;s[p+536+4>>2]=d>>>3&7;s[p+536+8>>2]=d>>>6&7;mt(f,1908,p+536|0)|0}s[2784+((d&7)<<2)>>2]=(R(3,(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0)|0)&65535;d=0;$=p;return d|0}case 22016:{if(n[3440]|0){f=s[160]|0;s[p+552>>2]=d&7;s[p+552+4>>2]=d>>>3&7;s[p+552+8>>2]=d>>>6&7;mt(f,1928,p+552|0)|0}l=(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0;f=R(3,l&-2|0)|0;f=(l&1|0)==0?f:f>>>8;s[2784+((d&7)<<2)>>2]=(f&128|0)==0?f&255:f|-256;d=0;$=p;return d|0}case 24064:{if(n[3440]|0){f=s[160]|0;s[p+568>>2]=d&7;s[p+568+4>>2]=d>>>3&7;s[p+568+8>>2]=d>>>6&7;mt(f,1949,p+568|0)|0}f=R(3,(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0)|0;s[2784+((d&7)<<2)>>2]=(f&32768|0)==0?f&65535:f|-65536;d=0;$=p;return d|0}default:{if(!(d&63488)){if(n[3440]|0){f=s[160]|0;s[p+584>>2]=d&7;s[p+584+4>>2]=d>>>3&7;s[p+584+8>>2]=d>>>6&31;mt(f,1970,p+584|0)|0}t=s[2784+((d>>>3&7)<<2)>>2]|0;if(!(d>>>6&31))e=s[718]|0;else{e=s[718]|0;e=(t&1<<32-(d>>>6&31)|0)==0?e&-536870913:e|536870912;s[718]=e;t=t<<(d>>>6&31)}s[2784+((d&7)<<2)>>2]=t;d=(t|0)<0?e|-2147483648:e&2147483647;s[718]=(t|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}if((d&65472|0)==16512){if(n[3440]|0){f=s[160]|0;s[p+600>>2]=d&7;s[p+600+4>>2]=d>>>3&7;mt(f,1990,p+600|0)|0}t=s[2784+((d&7)<<2)>>2]|0;e=s[2784+((d>>>3&7)<<2)>>2]&255;do{if(!e){e=s[718]|0;o=357}else{if(e>>>0<32){o=s[718]|0;o=(1<<32-e&t|0)==0?o&-536870913:o|536870912;s[718]=o;t=t<<e;e=o;o=357;break}if((e|0)==32){f=s[718]|0;t=(t&1|0)==0?f&-536870913:f|536870912}else t=s[718]&-536870913;s[718]=t;s[2784+((d&7)<<2)>>2]=0;t=t&1073741823;o=360}}while(0);do{if((o|0)==357){s[2784+((d&7)<<2)>>2]=t;if((t|0)>=0)if(!t){t=e&2147483647;o=360;break}else{t=e&1073741823;break}else{t=e&1073741823|-2147483648;break}}}while(0);if((o|0)==360)t=t|1073741824;s[718]=t;d=0;$=p;return d|0}if((d&63488|0)==2048){if(n[3440]|0){f=s[160]|0;s[p+608>>2]=d&7;s[p+608+4>>2]=d>>>3&7;s[p+608+8>>2]=d>>>6&31;mt(f,2004,p+608|0)|0}t=s[2784+((d>>>3&7)<<2)>>2]|0;do{if(d>>>6&31){e=s[718]|0;e=(t&1<<(d>>>6&31)+-1|0)==0?e&-536870913:e|536870912;s[718]=e;s[2784+((d&7)<<2)>>2]=t>>>(d>>>6&31);if((t>>>(d>>>6&31)|0)>=0)if(!(t>>>(d>>>6&31))){t=e&1073741823;o=370;break}else{t=e&1073741823;break}else{t=e&1073741823|-2147483648;break}}else{o=s[718]|0;t=(t|0)>-1?o&-536870913:o|536870912;s[718]=t;s[2784+((d&7)<<2)>>2]=0;t=t&2147483647;o=370}}while(0);if((o|0)==370)t=t|1073741824;s[718]=t;d=0;$=p;return d|0}if((d&65472|0)==16576){if(n[3440]|0){f=s[160]|0;s[p+624>>2]=d&7;s[p+624+4>>2]=d>>>3&7;mt(f,2024,p+624|0)|0}t=s[2784+((d&7)<<2)>>2]|0;e=s[2784+((d>>>3&7)<<2)>>2]&255;do{if(!e){e=s[718]|0;o=383}else{if(e>>>0<32){o=s[718]|0;o=(1<<e+-1&t|0)==0?o&-536870913:o|536870912;s[718]=o;t=t>>>e;e=o;o=383;break}if((e|0)==32){f=s[718]|0;t=(t|0)>-1?f&-536870913:f|536870912}else t=s[718]&-536870913;s[718]=t;s[2784+((d&7)<<2)>>2]=0;t=t&1073741823;o=386}}while(0);do{if((o|0)==383){s[2784+((d&7)<<2)>>2]=t;if((t|0)>=0)if(!t){t=e&2147483647;o=386;break}else{t=e&1073741823;break}else{t=e&1073741823|-2147483648;break}}}while(0);if((o|0)==386)t=t|1073741824;s[718]=t;d=0;$=p;return d|0}if((d&63488|0)==8192){if(n[3440]|0){f=s[160]|0;s[p+632>>2]=d>>>8&7;s[p+632+4>>2]=d&255;mt(f,2038,p+632|0)|0}s[2784+((d>>>8&7)<<2)>>2]=d&255;f=s[718]&1073741823;s[718]=(d&255|0)==0?f|1073741824:f;d=0;$=p;return d|0}if((d&65472|0)==7168){if(n[3440]|0){f=s[160]|0;s[p+640>>2]=d&7;s[p+640+4>>2]=d>>>3&7;mt(f,2056,p+640|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=((f|0)==0?d|1073741824:d&-1879048193)&-805306369;d=0;$=p;return d|0}if((d&65280|0)==17920){if(n[3440]|0){f=s[160]|0;s[p+648>>2]=d>>>4&8|d&7;s[p+648+4>>2]=d>>>3&15;mt(f,2070,p+648|0)|0}t=s[2784+((d>>>3&15)<<2)>>2]|0;if((d>>>3&15|0)==15){if(t&1|0){f=s[160]|0;s[p+656>>2]=t;mt(f,1028,p+656|0)|0}t=t&-2}if((d>>>4&8|d&7|0)==15){s[711]=t+2&-2;d=0;$=p;return d|0}else{s[2784+((d>>>4&8|d&7)<<2)>>2]=t;d=0;$=p;return d|0}}switch(((d&65472)+-16960|0)>>>6&67108863|0){case 4:{if(n[3440]|0){f=s[160]|0;s[p+664>>2]=d&7;s[p+664+4>>2]=d>>>3&7;mt(f,2083,p+664|0)|0}f=y(s[2784+((d>>>3&7)<<2)>>2]|0,s[2784+((d&7)<<2)>>2]|0)|0;s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}case 6:{if(n[3440]|0){f=s[160]|0;s[p+672>>2]=d&7;s[p+672+4>>2]=d>>>3&7;mt(f,2097,p+672|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=~f;d=s[718]|0;d=(f|0)>-1?d|-2147483648:d&2147483647;s[718]=(f|0)==-1?d|1073741824:d&-1073741825;d=0;$=p;return d|0}case 0:{if(n[3440]|0){f=s[160]|0;s[p+680>>2]=d&7;s[p+680+4>>2]=d>>>3&7;mt(f,2111,p+680|0)|0}l=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=0-l;d=s[718]|0;d=(0-l|0)<0?d|-2147483648:d&2147483647;d=(l|0)==0?d|1073741824:d&-1073741825;f=(((~l&2147483647)+1|0)>>>31)+(~l>>>31)|0;d=(f&2|0)==0?d&-536870913:d|536870912;s[718]=(((~l&2147483647)+1|0)>>>31|0)==(f>>>1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}case 3:{if(n[3440]|0){f=s[160]|0;s[p+688>>2]=d&7;s[p+688+4>>2]=d>>>3&7;mt(f,2125,p+688|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|s[2784+((d&7)<<2)>>2];s[2784+((d&7)<<2)>>2]=f;d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}default:switch((d&65024)<<16>>16){case-17408:{if(!(n[3440]|0))e=d&1;else{e=s[160]|0;ft(2139,5,1,e)|0;if(!(d&1))t=0;else{s[p+696>>2]=0;mt(e,1757,p+696|0)|0;t=1}if(d&2){if(t|0)Lt(44,e)|0;s[p+1056>>2]=1;mt(e,1757,p+1056|0)|0;t=t+1|0}if(d&4){if(t|0)Lt(44,e)|0;s[p+1064>>2]=2;mt(e,1757,p+1064|0)|0;t=t+1|0}if(d&8){if(t|0)Lt(44,e)|0;s[p+1072>>2]=3;mt(e,1757,p+1072|0)|0;t=t+1|0}if(d&16){if(t|0)Lt(44,e)|0;s[p+1080>>2]=4;mt(e,1757,p+1080|0)|0;t=t+1|0}if(d&32){if(t|0)Lt(44,e)|0;s[p+1088>>2]=5;mt(e,1757,p+1088|0)|0;t=t+1|0}if(d&64){if(t|0)Lt(44,e)|0;s[p+1096>>2]=6;mt(e,1757,p+1096|0)|0;t=t+1|0}if(d&128){if(t|0)Lt(44,e)|0;s[p+1104>>2]=7;mt(e,1757,p+1104|0)|0;t=t+1|0}if(d&256|0){if(t|0)Lt(44,e)|0;ft(2145,2,1,e)|0}ft(1761,2,1,e)|0;e=d&1}t=s[709]|0;if(e){s[696]=R(1,t|0)|0;t=t+4|0}if(d&2){s[697]=R(1,t|0)|0;t=t+4|0}if(d&4){s[698]=R(1,t|0)|0;t=t+4|0}if(d&8){s[699]=R(1,t|0)|0;t=t+4|0}if(d&16){s[700]=R(1,t|0)|0;t=t+4|0}if(d&32){s[701]=R(1,t|0)|0;t=t+4|0}if(d&64){s[702]=R(1,t|0)|0;t=t+4|0}if(d&128){s[703]=R(1,t|0)|0;t=t+4|0}if(d&256){e=R(1,t|0)|0;if(!(e&1)){d=s[160]|0;s[p+704>>2]=f;s[p+704+4>>2]=e;mt(d,2148,p+704|0)|0;e=e&-2}s[711]=e+2&-2;t=t+4|0}s[709]=t;d=0;$=p;return d|0}case-19456:{l=s[160]|0;if(!(n[3440]|0)){t=d&2;e=d&4;r=d&8;i=d&16;a=d&32;o=d&64;u=d&128;h=d&256;c=d&1}else{ft(2202,6,1,l)|0;if(!(d&1))t=0;else{s[p+712>>2]=0;mt(l,1757,p+712|0)|0;t=1}if(d&2){if(t|0)Lt(44,l)|0;s[p+1112>>2]=1;mt(l,1757,p+1112|0)|0;t=t+1|0}if(d&4){if(t|0)Lt(44,l)|0;s[p+1120>>2]=2;mt(l,1757,p+1120|0)|0;t=t+1|0}if(d&8){if(t|0)Lt(44,l)|0;s[p+1128>>2]=3;mt(l,1757,p+1128|0)|0;t=t+1|0}if(d&16){if(t|0)Lt(44,l)|0;s[p+1136>>2]=4;mt(l,1757,p+1136|0)|0;t=t+1|0}if(d&32){if(t|0)Lt(44,l)|0;s[p+1144>>2]=5;mt(l,1757,p+1144|0)|0;t=t+1|0}if(d&64){if(t|0)Lt(44,l)|0;s[p+1152>>2]=6;mt(l,1757,p+1152|0)|0;t=t+1|0}if(d&128){if(t|0)Lt(44,l)|0;s[p+1160>>2]=7;mt(l,1757,p+1160|0)|0;t=t+1|0}if(d&256|0){if(t|0)Lt(44,l)|0;ft(2209,2,1,l)|0}ft(1761,2,1,l)|0;t=d&2;e=d&4;r=d&8;i=d&16;a=d&32;o=d&64;u=d&128;h=d&256;c=d&1}a=(s[709]|0)-(c+(t>>>1)+(e>>>2)+(r>>>3)+(i>>>4)+(a>>>5)+(o>>>6)+(u>>>7)+(h>>>8)<<2)|0;t=a;r=0;i=1;while(1){if(!(i&d))e=t;else{e=s[2784+(r<<2)>>2]|0;t:do{if((t&-268435456|0)==-536870912){c=t+536813552|0;switch(c>>>2|c<<30|0){case 0:{c=s[714]|0;s[714]=e&65543;if((e&1|0)==0|(c&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=e&16777215;break t}case 2:{s[716]=e&16777215;break t}case 3:break t;default:break t}}else I(2,t|0,e|0)|0}while(0);e=t+4|0}r=r+1|0;if((r|0)==8)break;else{t=e;i=i<<1&254}}do{if(h|0){t=s[710]|0;t:do{if((e&-268435456|0)==-536870912){d=e+536813552|0;switch(d>>>2|d<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0)break t;s[716]=s[715];break t}case 1:{s[715]=t&16777215;break t}case 2:{s[716]=t&16777215;break t}case 3:break t;default:break t}}else I(2,e|0,t|0)|0}while(0);if(t&1|0)break;s[p+720>>2]=f;s[p+720+4>>2]=t;mt(l,2212,p+720|0)|0}}while(0);s[709]=a;d=0;$=p;return d|0}default:{t:do{if(t<<16>>16<-17728)switch(t<<16>>16){case-17920:{if(n[3440]|0){f=s[160]|0;s[p+728>>2]=d&7;s[p+728+4>>2]=d>>>3&7;mt(f,2267,p+728|0)|0}s[2784+((d&7)<<2)>>2]=Kt(s[2784+((d>>>3&7)<<2)>>2]|0)|0;d=0;$=p;return d|0}case-17856:{if(n[3440]|0){f=s[160]|0;s[p+736>>2]=d&7;s[p+736+4>>2]=d>>>3&7;mt(f,2280,p+736|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=f<<8&65280|f>>>8&255|f>>>16<<24|f>>>24<<16;d=0;$=p;return d|0}default:break t}else{if(t<<16>>16<16768){switch(t<<16>>16){case-17728:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+744>>2]=d&7;s[p+744+4>>2]=d>>>3&7;mt(f,2295,p+744|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=(f&128|0)==0?f<<8&65280|f>>>8&255:f<<8&65280|f>>>8&255|-65536;d=0;$=p;return d|0}switch(t<<16>>16){case 16832:break;case 16768:{if(n[3440]|0){f=s[160]|0;s[p+760>>2]=d&7;s[p+760+4>>2]=d>>>3&7;mt(f,2324,p+760|0)|0}e=s[2784+((d&7)<<2)>>2]|0;r=s[2784+((d>>>3&7)<<2)>>2]|0;f=s[718]|0;s[2784+((d&7)<<2)>>2]=e-r+-1+(f>>>29&1);t=(e-r+-1+(f>>>29&1)|0)<0?f|-2147483648:f&2147483647;t=(e-r+-1+(f>>>29&1)|0)==0?t|1073741824:t&-1073741825;s[718]=t;if(!(t&536870912)){f=(~r>>>31)+(e>>>31)+(((~r&2147483647)+(e&2147483647)|0)>>>31)|0;d=(f&2|0)==0?t&-536870913:t|536870912;s[718]=(((~r&2147483647)+(e&2147483647)|0)>>>31|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}else{f=(~r>>>31)+(e>>>31)+(((~r&2147483647)+(e&2147483647)+1|0)>>>31)|0;d=(f&2|0)==0?t&-536870913:t|536870912;s[718]=(((~r&2147483647)+(e&2147483647)+1|0)>>>31|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}}default:break t}if(n[3440]|0){f=s[160]|0;s[p+752>>2]=d&7;s[p+752+4>>2]=d>>>3&7;mt(f,2310,p+752|0)|0}t=s[2784+((d&7)<<2)>>2]|0;e=s[2784+((d>>>3&7)<<2)>>2]|0;do{if(e&255)if(!(e&31)){e=s[718]|0;e=(t|0)>-1?e&-536870913:e|536870912;s[718]=e;break}else{f=s[718]|0;f=(1<<(e&31)+-1&t|0)==0?f&-536870913:f|536870912;s[718]=f;t=t<<32-(e&31)|t>>>(e&31);e=f;break}else e=s[718]|0}while(0);s[2784+((d&7)<<2)>>2]=t;d=(t|0)<0?e|-2147483648:e&2147483647;s[718]=(t|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}}while(0);if((d&65527|0)==46672){ft(2337,23,1,s[160]|0)|0;d=1;$=p;return d|0}t:do{if(e<<16>>16<24576){switch(e<<16>>16){case-16384:break;default:break t}if(n[3440]|0){e=s[160]|0;s[p+768>>2]=d>>>8&7;mt(e,2361,p+768|0)|0;if(!(d&1))t=0;else{s[p+776>>2]=0;mt(e,1757,p+776|0)|0;t=1}if(d&2){if(t|0)Lt(44,e)|0;s[p+1e3>>2]=1;mt(e,1757,p+1e3|0)|0;t=t+1|0}if(d&4){if(t|0)Lt(44,e)|0;s[p+1008>>2]=2;mt(e,1757,p+1008|0)|0;t=t+1|0}if(d&8){if(t|0)Lt(44,e)|0;s[p+1016>>2]=3;mt(e,1757,p+1016|0)|0;t=t+1|0}if(d&16){if(t|0)Lt(44,e)|0;s[p+1024>>2]=4;mt(e,1757,p+1024|0)|0;t=t+1|0}if(d&32){if(t|0)Lt(44,e)|0;s[p+1032>>2]=5;mt(e,1757,p+1032|0)|0;t=t+1|0}if(d&64){if(t|0)Lt(44,e)|0;s[p+1040>>2]=6;mt(e,1757,p+1040|0)|0;t=t+1|0}if(d&128|0){if(t|0)Lt(44,e)|0;s[p+1048>>2]=7;mt(e,1757,p+1048|0)|0}ft(1761,2,1,e)|0}r=1;i=0;t=s[2784+((d>>>8&7)<<2)>>2]|0;while(1){if(r&d){e=s[2784+(i<<2)>>2]|0;e:do{if((t&-268435456|0)==-536870912){f=t+536813552|0;switch(f>>>2|f<<30|0){case 0:{f=s[714]|0;s[714]=e&65543;if((e&1|0)==0|(f&1|0)!=0)break e;s[716]=s[715];break e}case 1:{s[715]=e&16777215;break e}case 2:{s[716]=e&16777215;break e}case 3:break e;default:break e}}else I(2,t|0,e|0)|0}while(0);t=t+4|0}i=i+1|0;if((i|0)==8)break;else r=r<<1&254}s[2784+((d>>>8&7)<<2)>>2]=t;d=0;$=p;return d|0}else{switch(e<<16>>16){case 24576:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+784>>2]=d&7;s[p+784+4>>2]=d>>>3&7;s[p+784+8>>2]=d>>>4&124;mt(f,2374,p+784|0)|0}e=(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>4&124)|0;t=s[2784+((d&7)<<2)>>2]|0;if((e&-268435456|0)!=-536870912){I(2,e|0,t|0)|0;d=0;$=p;return d|0}switch((e+536813552|0)>>>2|e+536813552<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0){d=0;$=p;return d|0}s[716]=s[715];d=0;$=p;return d|0}case 1:{s[715]=t&16777215;d=0;$=p;return d|0}case 2:{s[716]=t&16777215;d=0;$=p;return d|0}case 3:{d=0;$=p;return d|0}default:{d=0;$=p;return d|0}}}}while(0);if((d&65024|0)==20480){if(n[3440]|0){f=s[160]|0;s[p+800>>2]=d&7;s[p+800+4>>2]=d>>>3&7;s[p+800+8>>2]=d>>>6&7;mt(f,2395,p+800|0)|0}e=(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0;t=s[2784+((d&7)<<2)>>2]|0;if((e&-268435456|0)!=-536870912){I(2,e|0,t|0)|0;d=0;$=p;return d|0}switch((e+536813552|0)>>>2|e+536813552<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0){d=0;$=p;return d|0}s[716]=s[715];d=0;$=p;return d|0}case 1:{s[715]=t&16777215;d=0;$=p;return d|0}case 2:{s[716]=t&16777215;d=0;$=p;return d|0}case 3:{d=0;$=p;return d|0}default:{d=0;$=p;return d|0}}}t:do{if(e<<16>>16<28672){switch(e<<16>>16){case-28672:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+816>>2]=d>>>8&7;s[p+816+4>>2]=d<<2&1020;mt(f,2414,p+816|0)|0}e=(s[709]|0)+(d<<2&1020)|0;t=s[2784+((d>>>8&7)<<2)>>2]|0;if((e&-268435456|0)!=-536870912){I(2,e|0,t|0)|0;d=0;$=p;return d|0}switch((e+536813552|0)>>>2|e+536813552<<30|0){case 0:{d=s[714]|0;s[714]=t&65543;if((t&1|0)==0|(d&1|0)!=0){d=0;$=p;return d|0}s[716]=s[715];d=0;$=p;return d|0}case 1:{s[715]=t&16777215;d=0;$=p;return d|0}case 2:{s[716]=t&16777215;d=0;$=p;return d|0}case 3:{d=0;$=p;return d|0}default:{d=0;$=p;return d|0}}}else{switch(e<<16>>16){case 28672:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+824>>2]=d&7;s[p+824+4>>2]=d>>>3&7;s[p+824+8>>2]=d>>>6&31;mt(f,2434,p+824|0)|0}r=(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>6&31)|0;t=s[2784+((d&7)<<2)>>2]|0;e=R(3,r&-2|0)|0;if(!(r&1))t=e&65280|t&255;else t=e&255|t<<8;I(5,r&-2|0,t&65535|0)|0;d=0;$=p;return d|0}}while(0);if((d&65024|0)==21504){if(n[3440]|0){f=s[160]|0;s[p+840>>2]=d&7;s[p+840+4>>2]=d>>>3&7;s[p+840+8>>2]=d>>>6&7;mt(f,2456,p+840|0)|0}r=(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0;t=s[2784+((d&7)<<2)>>2]|0;e=R(3,r&-2|0)|0;if(!(r&1))t=e&65280|t&255;else t=e&255|t<<8;I(5,r&-2|0,t&65535|0)|0;d=0;$=p;return d|0}if((d&63488|0)==32768){if(n[3440]|0){f=s[160]|0;s[p+856>>2]=d&7;s[p+856+4>>2]=d>>>3&7;s[p+856+8>>2]=d>>>5&62;mt(f,2476,p+856|0)|0}I(5,(s[2784+((d>>>3&7)<<2)>>2]|0)+(d>>>5&62)|0,s[2784+((d&7)<<2)>>2]&65535|0)|0;d=0;$=p;return d|0}t:do{if((d&65024)<<16>>16<20992){switch((d&65024)<<16>>16){case 7680:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+888>>2]=d&7;s[p+888+4>>2]=d>>>3&7;s[p+888+8>>2]=d>>>6&7;mt(f,2518,p+888|0)|0}h=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=h-(d>>>6&7);f=s[718]|0;f=(h-(d>>>6&7)|0)<0?f|-2147483648:f&2147483647;f=(h-(d>>>6&7)|0)==0?f|1073741824:f&-1073741825;l=(h>>>31)+1+((-2147483648-(d>>>6&7)+(h&2147483647)|0)>>>31)|0;f=(l&2|0)==0?f&-536870913:f|536870912;s[718]=((-2147483648-(d>>>6&7)+(h&2147483647)|0)>>>31|0)==(l>>>1&1|0)?f&-268435457:f|268435456;d=0;$=p;return d|0}else{switch((d&65024)<<16>>16){case 20992:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+872>>2]=d&7;s[p+872+4>>2]=d>>>3&7;s[p+872+8>>2]=d>>>6&7;mt(f,2498,p+872|0)|0}I(5,(s[2784+((d>>>6&7)<<2)>>2]|0)+(s[2784+((d>>>3&7)<<2)>>2]|0)|0,s[2784+((d&7)<<2)>>2]&65535|0)|0;d=0;$=p;return d|0}}while(0);if((d&63488|0)==14336){if(n[3440]|0){f=s[160]|0;s[p+904>>2]=d>>>8&7;s[p+904+4>>2]=d&255;mt(f,2538,p+904|0)|0}h=s[2784+((d>>>8&7)<<2)>>2]|0;s[2784+((d>>>8&7)<<2)>>2]=h-(d&255);f=s[718]|0;f=(h-(d&255)|0)<0?f|-2147483648:f&2147483647;f=(h-(d&255)|0)==0?f|1073741824:f&-1073741825;l=(h>>>31)+1+((-2147483648-(d&255)+(h&2147483647)|0)>>>31)|0;f=(l&2|0)==0?f&-536870913:f|536870912;s[718]=((-2147483648-(d&255)+(h&2147483647)|0)>>>31|0)==(l>>>1&1|0)?f&-268435457:f|268435456;d=0;$=p;return d|0}if((d&65024|0)==6656){if(n[3440]|0){f=s[160]|0;s[p+912>>2]=d&7;s[p+912+4>>2]=d>>>3&7;s[p+912+8>>2]=d>>>6&7;mt(f,2556,p+912|0)|0}h=s[2784+((d>>>3&7)<<2)>>2]|0;l=s[2784+((d>>>6&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=h-l;d=s[718]|0;d=(h-l|0)<0?d|-2147483648:d&2147483647;d=(h-l|0)==0?d|1073741824:d&-1073741825;f=(~l>>>31)+(h>>>31)+(((h&2147483647)+1+(~l&2147483647)|0)>>>31)|0;d=(f&2|0)==0?d&-536870913:d|536870912;s[718]=(((h&2147483647)+1+(~l&2147483647)|0)>>>31|0)==(f>>>1&1|0)?d&-268435457:d|268435456;d=0;$=p;return d|0}if((d&65408|0)==45184){if(n[3440]|0){f=s[160]|0;s[p+928>>2]=d<<2&508;mt(f,2574,p+928|0)|0}s[709]=(s[709]|0)-(d<<2&508);d=0;$=p;return d|0}if((d&65280|0)==57088){if(n[3440]|0){f=s[160]|0;s[p+936>>2]=d&255;mt(f,2590,p+936|0)|0}if((d&255|0)==204){s[696]=s[718];d=0;$=p;return d|0}else{f=s[160]|0;s[p+944>>2]=d&255;mt(f,2602,p+944|0)|0;d=1;$=p;return d|0}}t:do{if(t<<16>>16>=-19840){if(t<<16>>16<-19776){switch(t<<16>>16){case-19840:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+984>>2]=d&7;s[p+984+4>>2]=d>>>3&7;mt(f,2671,p+984|0)|0}s[2784+((d&7)<<2)>>2]=s[2784+((d>>>3&7)<<2)>>2]&65535;d=0;$=p;return d|0}if(t<<16>>16<16896){switch(t<<16>>16){case-19776:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+976>>2]=d&7;s[p+976+4>>2]=d>>>3&7;mt(f,2657,p+976|0)|0}s[2784+((d&7)<<2)>>2]=s[2784+((d>>>3&7)<<2)>>2]&255;d=0;$=p;return d|0}else{switch(t<<16>>16){case 16896:break;default:break t}if(n[3440]|0){f=s[160]|0;s[p+968>>2]=d&7;s[p+968+4>>2]=d>>>3&7;mt(f,2644,p+968|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]&s[2784+((d&7)<<2)>>2];d=s[718]|0;d=(f|0)<0?d|-2147483648:d&2147483647;s[718]=(f|0)==0?d|1073741824:d&-1073741825;d=0;$=p;return d|0}}else switch(t<<16>>16){case-19904:{if(n[3440]|0){f=s[160]|0;s[p+952>>2]=d&7;s[p+952+4>>2]=d>>>3&7;mt(f,2616,p+952|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=(f&128|0)==0?f&255:f|-256;d=0;$=p;return d|0}case-19968:{if(n[3440]|0){f=s[160]|0;s[p+960>>2]=d&7;s[p+960+4>>2]=d>>>3&7;mt(f,2630,p+960|0)|0}f=s[2784+((d>>>3&7)<<2)>>2]|0;s[2784+((d&7)<<2)>>2]=(f&32768|0)==0?f&65535:f|-65536;d=0;$=p;return d|0}default:break t}}while(0);f=s[160]|0;s[p+992>>2]=a;s[p+992+4>>2]=d;mt(f,2685,p+992|0)|0;d=1;$=p;return d|0}}}}}}}}}}}return 0}function it(t){t=t|0;var e=0;e=$;$=$+16|0;s[e>>2]=ct(s[t+60>>2]|0)|0;t=ot(C(6,e|0)|0)|0;$=e;return t|0}function st(t,e,r){t=t|0;e=e|0;r=r|0;var n=0,i=0,a=0,o=0,u=0,c=0,h=0;o=$;$=$+32|0;a=s[t+28>>2]|0;s[o>>2]=a;a=(s[t+20>>2]|0)-a|0;s[o+4>>2]=a;s[o+8>>2]=e;s[o+12>>2]=r;i=2;e=a+r|0;a=o;while(1){if(!((S(s[t+60>>2]|0,a|0,i|0,o+16|0)|0)<<16>>16))n=s[o+16>>2]|0;else{s[o+16>>2]=-1;n=-1}if((e|0)==(n|0)){e=6;break}if((n|0)<0){e=8;break}h=s[a+4>>2]|0;c=n>>>0>h>>>0;u=c?a+8|0:a;h=n-(c?h:0)|0;s[u>>2]=(s[u>>2]|0)+h;s[u+4>>2]=(s[u+4>>2]|0)-h;i=i+(c<<31>>31)|0;e=e-n|0;a=u}if((e|0)==6){h=s[t+44>>2]|0;s[t+16>>2]=h+(s[t+48>>2]|0);s[t+28>>2]=h;s[t+20>>2]=h}else if((e|0)==8){s[t+16>>2]=0;s[t+28>>2]=0;s[t+20>>2]=0;s[t>>2]=s[t>>2]|32;if((i|0)==2)r=0;else r=r-(s[a+4>>2]|0)|0}$=o;return r|0}function at(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var i=0;i=$;$=$+32|0;s[i+8>>2]=s[t+60>>2];s[i+8+4>>2]=r;s[i+8+8>>2]=e;s[i+8+12>>2]=i;s[i+8+16>>2]=n;if((ot(T(140,i+8|0)|0)|0)<0){s[i>>2]=-1;s[i+4>>2]=-1;t=-1;e=-1}else{t=s[i+4>>2]|0;e=s[i>>2]|0}k(t|0);$=i;return e|0}function ot(t){t=t|0;if(t>>>0>4294963200){s[(ut()|0)>>2]=0-t;t=-1}return t|0}function ut(){return 2940}function ct(t){t=t|0;return t|0}function ht(t){t=t|0;return(t+-48|0)>>>0<10|0}function lt(){return 644}function ft(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var i=0,a=0;i=y(r,e)|0;r=(e|0)==0?0:r;if((s[n+76>>2]|0)>-1){a=(pt(n)|0)==0;t=bt(t,i,n)|0;if(!a)dt(n)}else t=bt(t,i,n)|0;if((t|0)!=(i|0))r=(t>>>0)/(e>>>0)|0;return r|0}function dt(t){t=t|0;return}function pt(t){t=t|0;return 1}function _t(t,e){t=t|0;e=e|0;var r=0,i=0,o=0,u=0;u=$;$=$+16|0;n[u>>0]=e;r=s[t+16>>2]|0;if(!r)if(!(gt(t)|0)){i=s[t+16>>2]|0;o=4}else r=-1;else{i=r;o=4}do{if((o|0)==4){r=s[t+20>>2]|0;if(r>>>0<i>>>0?(e&255|0)!=(n[t+75>>0]|0):0){s[t+20>>2]=r+1;n[r>>0]=e;r=e&255;break}if((le[s[t+36>>2]&1](t,u,1)|0)==1)r=a[u>>0]|0;else r=-1}}while(0);$=u;return r|0}function gt(t){t=t|0;var e=0;e=n[t+74>>0]|0;n[t+74>>0]=e+255|e;e=s[t>>2]|0;if(!(e&8)){s[t+8>>2]=0;s[t+4>>2]=0;e=s[t+44>>2]|0;s[t+28>>2]=e;s[t+20>>2]=e;s[t+16>>2]=e+(s[t+48>>2]|0);t=0}else{s[t>>2]=e|32;t=-1}return t|0}function bt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,a=0,o=0,u=0;i=s[r+16>>2]|0;if(!i)if(!(gt(r)|0)){a=s[r+16>>2]|0;o=5}else i=0;else{a=i;o=5}t:do{if((o|0)==5){i=s[r+20>>2]|0;if((a-i|0)>>>0<e>>>0){i=le[s[r+36>>2]&1](r,t,e)|0;break}e:do{if((n[r+75>>0]|0)<0|(e|0)==0){u=0;a=t}else{o=e;while(1){a=o+-1|0;if((n[t+a>>0]|0)==10)break;if(!a){u=0;a=t;break e}else o=a}i=le[s[r+36>>2]&1](r,t,o)|0;if(i>>>0<o>>>0)break t;u=o;a=t+o|0;e=e-o|0;i=s[r+20>>2]|0}}while(0);Yt(i|0,a|0,e|0)|0;s[r+20>>2]=(s[r+20>>2]|0)+e;i=u+e|0}}while(0);return i|0}function vt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,a=0,o=0;t:do{if((r|0)!=0&(t&3|0)!=0){i=r;while(1){if((n[t>>0]|0)==(e&255)<<24>>24){a=6;break t}t=t+1|0;r=i+-1|0;if((r|0)!=0&(t&3|0)!=0)i=r;else{i=r;r=(r|0)!=0;a=5;break}}}else{i=r;r=(r|0)!=0;a=5}}while(0);if((a|0)==5)if(r)a=6;else a=16;t:do{if((a|0)==6){if((n[t>>0]|0)==(e&255)<<24>>24)if(!i){a=16;break}else break;r=y(e&255,16843009)|0;e:do{if(i>>>0>3)while(1){o=s[t>>2]^r;if((o&-2139062144^-2139062144)&o+-16843009|0)break e;t=t+4|0;i=i+-4|0;if(i>>>0<=3){a=11;break}}else a=11}while(0);if((a|0)==11)if(!i){a=16;break}while(1){if((n[t>>0]|0)==(e&255)<<24>>24)break t;i=i+-1|0;if(!i){a=16;break}else t=t+1|0}}}while(0);if((a|0)==16)t=0;return t|0}function mt(t,e,r){t=t|0;e=e|0;r=r|0;var n=0;n=$;$=$+16|0;s[n>>2]=r;r=yt(t,e,n)|0;$=n;return r|0}function yt(t,e,r){t=t|0;e=e|0;r=r|0;return kt(t,e,r,1,1)|0}function wt(t,e,r,i,o,u){t=t|0;e=+e;r=r|0;i=i|0;o=o|0;u=u|0;var c=0,h=0,l=0,f=0,d=0.0,p=0,_=0,g=0,b=0,v=0,m=0,w=0,A=0,k=0,x=0,T=0,C=0;C=$;$=$+560|0;s[C+536>>2]=0;T=C+540+12|0;Dt(e)|0;c=E()|0;if((c|0)<0){Dt(-e)|0;e=-e;x=1;A=2737;c=E()|0}else{x=(o&2049|0)!=0&1;A=(o&2048|0)==0?(o&1|0)==0?2738:2743:2740}do{if(0==0&(c&2146435072|0)==2146435072){c=x+3|0;Bt(t,32,r,c,o&-65537);xt(t,A,x);xt(t,e!=e|0.0!=0.0?u&32|0?2764:2768:u&32|0?2756:2760,3);Bt(t,32,r,c,o^8192)}else{d=+Ft(e,C+536|0)*2.0;if(d!=0.0)s[C+536>>2]=(s[C+536>>2]|0)+-1;if((u|32|0)==97){_=(u&32|0)==0?A:A+9|0;p=x|2;do{if(!(i>>>0>11|(12-i|0)==0)){e=8.0;c=12-i|0;do{c=c+-1|0;e=e*16.0}while((c|0)!=0);if((n[_>>0]|0)==45){e=-(e+(-d-e));break}else{e=d+e-e;break}}else e=d}while(0);h=s[C+536>>2]|0;c=(h|0)<0?0-h|0:h;c=It(c,((c|0)<0)<<31>>31,T)|0;if((c|0)==(T|0)){n[C+540+11>>0]=48;c=C+540+11|0}n[c+-1>>0]=(h>>31&2)+43;f=c+-2|0;n[f>>0]=u+15;c=C;do{x=~~e;h=c+1|0;n[c>>0]=u&32|a[480+x>>0];e=(e-+(x|0))*16.0;if((h-C|0)==1?!((o&8|0)==0&((i|0)<1&e==0.0)):0){n[h>>0]=46;c=c+2|0}else c=h}while(e!=0.0);l=c;if((i|0)!=0?(-2-C+l|0)<(i|0):0){i=i+2+T-f|0;c=T;h=f}else{i=T-C-f+l|0;c=T;h=f}T=i+p|0;Bt(t,32,r,T,o);xt(t,_,p);Bt(t,48,r,T,o^65536);xt(t,C,l-C|0);c=c-h|0;Bt(t,48,i-(l-C+c)|0,0,0);xt(t,f,c);Bt(t,32,r,T,o^8192);c=T;break}h=(i|0)<0?6:i;if(d!=0.0){c=(s[C+536>>2]|0)+-28|0;s[C+536>>2]=c;e=d*268435456.0}else{e=d;c=s[C+536>>2]|0}k=(c|0)<0?C+32|0:C+32+288|0;i=k;do{m=~~e>>>0;s[i>>2]=m;i=i+4|0;e=(e-+(m>>>0))*1.0e9}while(e!=0.0);if((c|0)>0){p=k;while(1){f=(c|0)<29?c:29;c=i+-4|0;if(c>>>0>=p>>>0){l=0;do{b=Xt(s[c>>2]|0,0,f|0)|0;b=$t(b|0,E()|0,l|0,0)|0;v=E()|0;l=Gt(b|0,v|0,1e9,0)|0;m=zt(l|0,E()|0,1e9,0)|0;m=Ht(b|0,v|0,m|0,E()|0)|0;E()|0;s[c>>2]=m;c=c+-4|0}while(c>>>0>=p>>>0);if(l){m=p+-4|0;s[m>>2]=l;l=m}else l=p}else l=p;t:do{if(i>>>0>l>>>0){c=i;while(1){i=c+-4|0;if(s[i>>2]|0){i=c;break t}if(i>>>0>l>>>0)c=i;else break}}}while(0);c=(s[C+536>>2]|0)-f|0;s[C+536>>2]=c;if((c|0)>0)p=l;else break}}else l=k;if((c|0)<0){do{p=0-c|0;p=(p|0)<9?p:9;if(l>>>0<i>>>0){f=0;c=l;do{m=s[c>>2]|0;s[c>>2]=(m>>>p)+f;f=y(m&(1<<p)+-1,1e9>>>p)|0;c=c+4|0}while(c>>>0<i>>>0);c=(s[l>>2]|0)==0?l+4|0:l;if(!f)l=c;else{s[i>>2]=f;i=i+4|0;l=c}}else l=(s[l>>2]|0)==0?l+4|0:l;c=(u|32|0)==102?k:l;i=(i-c>>2|0)>(((h+25|0)/9|0)+1|0)?c+(((h+25|0)/9|0)+1<<2)|0:i;c=(s[C+536>>2]|0)+p|0;s[C+536>>2]=c}while((c|0)<0);c=l}else c=l;if(c>>>0<i>>>0){l=(k-c>>2)*9|0;p=s[c>>2]|0;if(p>>>0>=10){f=10;do{f=f*10|0;l=l+1|0}while(p>>>0>=f>>>0)}}else l=0;f=h-((u|32|0)==102?0:l)+(((h|0)!=0&(u|32|0)==103)<<31>>31)|0;if((f|0)<(((i-k>>2)*9|0)+-9|0)){_=k+4+(((f+9216|0)/9|0)+-1024<<2)|0;f=f+9216-(((f+9216|0)/9|0)*9|0)|0;if((f|0)<8){p=10;while(1){p=p*10|0;if((f|0)<7)f=f+1|0;else break}}else p=10;b=s[_>>2]|0;f=(b>>>0)/(p>>>0)|0;v=b-(y(f,p)|0)|0;g=(_+4|0)==(i|0);if(!(g&(v|0)==0)){e=(f&1|0)==0?9007199254740992.0:9007199254740994.0;m=p>>>1;d=v>>>0<m>>>0?.5:g&(v|0)==(m|0)?1.0:1.5;if(x){m=(n[A>>0]|0)==45;d=m?-d:d;e=m?-e:e}s[_>>2]=b-v;if(e+d!=e){m=b-v+p|0;s[_>>2]=m;if(m>>>0>999999999){f=_;while(1){l=f+-4|0;s[f>>2]=0;if(l>>>0<c>>>0){c=c+-4|0;s[c>>2]=0}m=(s[l>>2]|0)+1|0;s[l>>2]=m;if(m>>>0>999999999)f=l;else{_=l;break}}}l=(k-c>>2)*9|0;p=s[c>>2]|0;if(p>>>0<10)f=_;else{f=10;do{f=f*10|0;l=l+1|0}while(p>>>0>=f>>>0);f=_}}else f=_}else f=_;v=f+4|0;i=i>>>0>v>>>0?v:i;v=c}else v=c;_=0-l|0;t:do{if(i>>>0>v>>>0)while(1){c=i+-4|0;if(s[c>>2]|0){m=i;b=1;break t}if(c>>>0>v>>>0)i=c;else{m=c;b=0;break}}else{m=i;b=0}}while(0);do{if((u|32|0)==103){if((l|0)>-5?(h+(((h|0)!=0^1)&1)|0)>(l|0):0){f=u+-1|0;h=h+(((h|0)!=0^1)&1)+-1-l|0}else{f=u+-2|0;h=h+(((h|0)!=0^1)&1)+-1|0}if(!(o&8)){if(b?(w=s[m+-4>>2]|0,(w|0)!=0):0)if(!((w>>>0)%10|0)){c=0;i=10;do{i=i*10|0;c=c+1|0}while(!((w>>>0)%(i>>>0)|0|0))}else c=0;else c=9;i=((m-k>>2)*9|0)+-9|0;if((f|32|0)==102){u=i-c|0;u=(u|0)>0?u:0;h=(h|0)<(u|0)?h:u;break}else{u=i+l-c|0;u=(u|0)>0?u:0;h=(h|0)<(u|0)?h:u;break}}}else f=u}while(0);g=(h|0)!=0;i=g?1:o>>>3&1;p=(f|32|0)==102;if(p){_=0;c=(l|0)>0?l:0}else{c=(l|0)<0?_:l;c=It(c,((c|0)<0)<<31>>31,T)|0;if((T-c|0)<2)do{c=c+-1|0;n[c>>0]=48}while((T-c|0)<2);n[c+-1>>0]=(l>>31&2)+43;c=c+-2|0;n[c>>0]=f;_=c;c=T-c|0}c=x+1+h+i+c|0;Bt(t,32,r,c,o);xt(t,A,x);Bt(t,48,r,c,o^65536);if(p){f=v>>>0>k>>>0?k:v;l=f;do{i=It(s[l>>2]|0,0,C+9|0)|0;if((l|0)==(f|0)){if((i|0)==(C+9|0)){n[C+8>>0]=48;i=C+8|0}}else if(i>>>0>C>>>0){Jt(C|0,48,i-C|0)|0;do{i=i+-1|0}while(i>>>0>C>>>0)}xt(t,i,C+9-i|0);l=l+4|0}while(l>>>0<=k>>>0);if(!((o&8|0)==0&(g^1)))xt(t,2772,1);if(l>>>0<m>>>0&(h|0)>0)while(1){i=It(s[l>>2]|0,0,C+9|0)|0;if(i>>>0>C>>>0){Jt(C|0,48,i-C|0)|0;do{i=i+-1|0}while(i>>>0>C>>>0)}xt(t,i,(h|0)<9?h:9);l=l+4|0;i=h+-9|0;if(!(l>>>0<m>>>0&(h|0)>9)){h=i;break}else h=i}Bt(t,48,h+9|0,9,0)}else{p=b?m:v+4|0;if(v>>>0<p>>>0&(h|0)>-1){f=v;do{i=It(s[f>>2]|0,0,C+9|0)|0;if((i|0)==(C+9|0)){n[C+8>>0]=48;i=C+8|0}do{if((f|0)==(v|0)){l=i+1|0;xt(t,i,1);if((o&8|0)==0&(h|0)<1){i=l;break}xt(t,2772,1);i=l}else{if(i>>>0<=C>>>0)break;Jt(C|0,48,i+(0-C)|0)|0;do{i=i+-1|0}while(i>>>0>C>>>0)}}while(0);x=C+9-i|0;xt(t,i,(h|0)>(x|0)?x:h);h=h-x|0;f=f+4|0}while(f>>>0<p>>>0&(h|0)>-1)}Bt(t,48,h+18|0,18,0);xt(t,_,T-_|0)}Bt(t,32,r,c,o^8192)}}while(0);$=C;return((c|0)<(r|0)?r:c)|0}function At(t,e){t=t|0;e=e|0;var r=0.0,n=0;n=(s[e>>2]|0)+(8-1)&~(8-1);r=+c[n>>3];s[e>>2]=n+8;c[t>>3]=r;return}function kt(t,e,r,i,a){t=t|0;e=e|0;r=r|0;i=i|0;a=a|0;var o=0,u=0,c=0,h=0;h=$;$=$+224|0;o=h+160|0;u=o+40|0;do{s[o>>2]=0;o=o+4|0}while((o|0)<(u|0));s[h+208>>2]=s[r>>2];if((Et(0,e,h+208|0,h+80|0,h+160|0,i,a)|0)<0)r=-1;else{if((s[t+76>>2]|0)>-1)c=pt(t)|0;else c=0;u=s[t>>2]|0;if((n[t+74>>0]|0)<1)s[t>>2]=u&-33;if(!(s[t+48>>2]|0)){o=s[t+44>>2]|0;s[t+44>>2]=h;s[t+28>>2]=h;s[t+20>>2]=h;s[t+48>>2]=80;s[t+16>>2]=h+80;r=Et(t,e,h+208|0,h+80|0,h+160|0,i,a)|0;if(o){le[s[t+36>>2]&1](t,0,0)|0;r=(s[t+20>>2]|0)==0?-1:r;s[t+44>>2]=o;s[t+48>>2]=0;s[t+16>>2]=0;s[t+28>>2]=0;s[t+20>>2]=0}}else r=Et(t,e,h+208|0,h+80|0,h+160|0,i,a)|0;o=s[t>>2]|0;s[t>>2]=o|u&32;if(c|0)dt(t);r=(o&32|0)==0?r:-1}$=h;return r|0}function Et(t,e,r,a,o,u,h){t=t|0;e=e|0;r=r|0;a=a|0;o=o|0;u=u|0;h=h|0;var l=0,f=0,d=0,p=0,_=0,g=0,b=0,v=0,m=0,y=0,w=0,A=0,k=0,x=0,T=0,C=0;T=$;$=$+64|0;s[T+56>>2]=e;A=T+40|0;l=0;e=0;d=0;t:while(1){do{do{if((e|0)>-1)if((l|0)>(2147483647-e|0)){s[(ut()|0)>>2]=75;e=-1;break}else{e=l+e|0;break}}while(0);b=s[T+56>>2]|0;l=n[b>>0]|0;if(!(l<<24>>24)){w=92;break t}f=b;e:while(1){switch(l<<24>>24){case 37:{w=10;break e}case 0:{l=f;break e}default:{}}y=f+1|0;s[T+56>>2]=y;l=n[y>>0]|0;f=y}e:do{if((w|0)==10){w=0;l=f;do{if((n[f+1>>0]|0)!=37)break e;l=l+1|0;f=f+2|0;s[T+56>>2]=f}while((n[f>>0]|0)==37)}}while(0);l=l-b|0;if(t|0)xt(t,b,l)}while((l|0)!=0);y=(ht(n[(s[T+56>>2]|0)+1>>0]|0)|0)==0;f=s[T+56>>2]|0;if(!y?(n[f+2>>0]|0)==36:0){v=(n[f+1>>0]|0)+-48|0;_=1;l=3}else{v=-1;_=d;l=1}l=f+l|0;s[T+56>>2]=l;f=n[l>>0]|0;if(((f<<24>>24)+-32|0)>>>0>31|(1<<(f<<24>>24)+-32&75913|0)==0)p=0;else{d=0;p=(f<<24>>24)+-32|0;do{d=1<<p|d;l=l+1|0;s[T+56>>2]=l;f=n[l>>0]|0;p=(f<<24>>24)+-32|0}while(!(p>>>0>31|(1<<p&75913|0)==0));p=d}if(f<<24>>24==42){if((ht(n[l+1>>0]|0)|0)!=0?(x=s[T+56>>2]|0,(n[x+2>>0]|0)==36):0){s[o+((n[x+1>>0]|0)+-48<<2)>>2]=10;l=s[a+((n[x+1>>0]|0)+-48<<3)>>2]|0;d=1;f=x+3|0}else{if(_|0){e=-1;break}if(t|0){y=(s[r>>2]|0)+(4-1)&~(4-1);l=s[y>>2]|0;s[r>>2]=y+4}else l=0;d=0;f=(s[T+56>>2]|0)+1|0}s[T+56>>2]=f;g=(l|0)<0;m=g?0-l|0:l;g=g?p|8192:p;y=d}else{l=Tt(T+56|0)|0;if((l|0)<0){e=-1;break}m=l;g=p;y=_;f=s[T+56>>2]|0}do{if((n[f>>0]|0)==46){l=f+1|0;if((n[l>>0]|0)!=42){s[T+56>>2]=l;l=Tt(T+56|0)|0;f=s[T+56>>2]|0;break}if(ht(n[f+2>>0]|0)|0?(k=s[T+56>>2]|0,(n[k+3>>0]|0)==36):0){s[o+((n[k+2>>0]|0)+-48<<2)>>2]=10;l=s[a+((n[k+2>>0]|0)+-48<<3)>>2]|0;s[T+56>>2]=k+4;f=k+4|0;break}if(y|0){e=-1;break t}if(t|0){_=(s[r>>2]|0)+(4-1)&~(4-1);l=s[_>>2]|0;s[r>>2]=_+4}else l=0;f=(s[T+56>>2]|0)+2|0;s[T+56>>2]=f}else l=-1}while(0);_=0;while(1){if(((n[f>>0]|0)+-65|0)>>>0>57){e=-1;break t}d=f;f=f+1|0;s[T+56>>2]=f;d=n[(n[d>>0]|0)+-65+(16+(_*58|0))>>0]|0;if(((d&255)+-1|0)>>>0>=8)break;else _=d&255}if(!(d<<24>>24)){e=-1;break}p=(v|0)>-1;do{if(d<<24>>24==19)if(p){e=-1;break t}else w=54;else{if(p){s[o+(v<<2)>>2]=d&255;v=a+(v<<3)|0;w=s[v+4>>2]|0;s[T+40>>2]=s[v>>2];s[T+40+4>>2]=w;w=54;break}if(!t){e=0;break t}Ct(T+40|0,d&255,r,h);f=s[T+56>>2]|0;w=55}}while(0);if((w|0)==54){w=0;if(t|0)w=55;else l=0}e:do{if((w|0)==55){w=0;f=n[f+-1>>0]|0;f=(_|0)!=0&(f&15|0)==3?f&-33:f;d=g&-65537;v=(g&8192|0)==0?g:d;r:do{switch(f|0){case 110:switch((_&255)<<24>>24){case 0:{s[s[T+40>>2]>>2]=e;l=0;break e}case 1:{s[s[T+40>>2]>>2]=e;l=0;break e}case 2:{l=s[T+40>>2]|0;s[l>>2]=e;s[l+4>>2]=((e|0)<0)<<31>>31;l=0;break e}case 3:{i[s[T+40>>2]>>1]=e;l=0;break e}case 4:{n[s[T+40>>2]>>0]=e;l=0;break e}case 6:{s[s[T+40>>2]>>2]=e;l=0;break e}case 7:{l=s[T+40>>2]|0;s[l>>2]=e;s[l+4>>2]=((e|0)<0)<<31>>31;l=0;break e}default:{l=0;break e}}case 112:{f=120;l=l>>>0>8?l:8;d=v|8;w=67;break}case 88:case 120:{d=v;w=67;break}case 111:{d=Rt(s[T+40>>2]|0,s[T+40+4>>2]|0,T+40|0)|0;g=d;p=0;_=2720;l=(v&8|0)==0|(l|0)>(A-d|0)?l:A-d+1|0;d=v;w=73;break}case 105:case 100:{f=s[T+40>>2]|0;d=s[T+40+4>>2]|0;if((d|0)<0){f=Ht(0,0,f|0,d|0)|0;d=E()|0;s[T+40>>2]=f;s[T+40+4>>2]=d;p=1;_=2720;w=72;break r}else{p=(v&2049|0)!=0&1;_=(v&2048|0)==0?(v&1|0)==0?2720:2722:2721;w=72;break r}}case 117:{p=0;_=2720;f=s[T+40>>2]|0;d=s[T+40+4>>2]|0;w=72;break}case 99:{n[T+39>>0]=s[T+40>>2];b=T+39|0;p=0;_=2720;g=1;f=d;l=A;break}case 115:{C=s[T+40>>2]|0;C=(C|0)==0?2730:C;v=vt(C,0,l)|0;b=C;p=0;_=2720;g=(v|0)==0?l:v-C|0;f=d;l=(v|0)==0?C+l|0:v;break}case 67:{s[T+48>>2]=s[T+40>>2];s[T+48+4>>2]=0;s[T+40>>2]=T+48;p=-1;w=79;break}case 83:{if(!l){Bt(t,32,m,0,v);l=0;w=89}else{p=l;w=79}break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{l=he[u&1](t,+c[T+40>>3],m,l,v,f)|0;break e}default:{p=0;_=2720;g=l;f=v;l=A}}}while(0);r:do{if((w|0)==67){g=St(s[T+40>>2]|0,s[T+40+4>>2]|0,T+40|0,f&32)|0;_=(d&8|0)==0|((s[T+40>>2]|0)==0?(s[T+40+4>>2]|0)==0:0);p=_?0:2;_=_?2720:2720+(f>>>4)|0;w=73}else if((w|0)==72){g=It(f,d,T+40|0)|0;d=v;w=73}else if((w|0)==79){w=0;d=s[T+40>>2]|0;l=0;while(1){f=s[d>>2]|0;if(!f)break;f=Ot(T+60|0,f)|0;if((f|0)<0|f>>>0>(p-l|0)>>>0){w=83;break}l=f+l|0;if(p>>>0>l>>>0)d=d+4|0;else break}if((w|0)==83){w=0;if((f|0)<0){e=-1;break t}}Bt(t,32,m,l,v);if(!l){l=0;w=89}else{d=s[T+40>>2]|0;p=0;while(1){f=s[d>>2]|0;if(!f){w=89;break r}f=Ot(T+60|0,f)|0;p=f+p|0;if((p|0)>(l|0)){w=89;break r}xt(t,T+60|0,f);if(p>>>0>=l>>>0){w=89;break}else d=d+4|0}}}}while(0);if((w|0)==73){w=0;f=s[T+40>>2]|0?1:(s[T+40+4>>2]|0)!=0;C=(l|0)!=0|f;f=A-g+((f^1)&1)|0;b=C?g:T+40|0;g=C?(l|0)>(f|0)?l:f:0;f=(l|0)>-1?d&-65537:d;l=A}else if((w|0)==89){w=0;Bt(t,32,m,l,v^8192);l=(m|0)>(l|0)?m:l;break}v=l-b|0;g=(g|0)<(v|0)?v:g;C=g+p|0;l=(m|0)<(C|0)?C:m;Bt(t,32,l,C,f);xt(t,_,p);Bt(t,48,l,C,f^65536);Bt(t,48,g,v,0);xt(t,b,v);Bt(t,32,l,C,f^8192)}}while(0);d=y}t:do{if((w|0)==92)if(!t)if(!d)e=0;else{e=1;while(1){l=s[o+(e<<2)>>2]|0;if(!l)break;Ct(a+(e<<3)|0,l,r,h);e=e+1|0;if(e>>>0>=10){e=1;break t}}while(1){if(s[o+(e<<2)>>2]|0){e=-1;break t}e=e+1|0;if(e>>>0>=10){e=1;break}}}}while(0);$=T;return e|0}function xt(t,e,r){t=t|0;e=e|0;r=r|0;if(!(s[t>>2]&32))bt(e,r,t)|0;return}function Tt(t){t=t|0;var e=0,r=0;if(!(ht(n[s[t>>2]>>0]|0)|0))e=0;else{e=0;do{r=s[t>>2]|0;e=(e*10|0)+-48+(n[r>>0]|0)|0;s[t>>2]=r+1}while((ht(n[r+1>>0]|0)|0)!=0)}return e|0}function Ct(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var i=0,a=0.0;t:do{if(e>>>0<=20)do{switch(e|0){case 9:{e=(s[r>>2]|0)+(4-1)&~(4-1);n=s[e>>2]|0;s[r>>2]=e+4;s[t>>2]=n;break t}case 10:{e=(s[r>>2]|0)+(4-1)&~(4-1);n=s[e>>2]|0;s[r>>2]=e+4;s[t>>2]=n;s[t+4>>2]=((n|0)<0)<<31>>31;break t}case 11:{e=(s[r>>2]|0)+(4-1)&~(4-1);n=s[e>>2]|0;s[r>>2]=e+4;s[t>>2]=n;s[t+4>>2]=0;break t}case 12:{i=(s[r>>2]|0)+(8-1)&~(8-1);e=s[i>>2]|0;n=s[i+4>>2]|0;s[r>>2]=i+8;s[t>>2]=e;s[t+4>>2]=n;break t}case 13:{n=(s[r>>2]|0)+(4-1)&~(4-1);i=s[n>>2]|0;s[r>>2]=n+4;s[t>>2]=(i&65535)<<16>>16;s[t+4>>2]=(((i&65535)<<16>>16|0)<0)<<31>>31;break t}case 14:{n=(s[r>>2]|0)+(4-1)&~(4-1);i=s[n>>2]|0;s[r>>2]=n+4;s[t>>2]=i&65535;s[t+4>>2]=0;break t}case 15:{n=(s[r>>2]|0)+(4-1)&~(4-1);i=s[n>>2]|0;s[r>>2]=n+4;s[t>>2]=(i&255)<<24>>24;s[t+4>>2]=(((i&255)<<24>>24|0)<0)<<31>>31;break t}case 16:{n=(s[r>>2]|0)+(4-1)&~(4-1);i=s[n>>2]|0;s[r>>2]=n+4;s[t>>2]=i&255;s[t+4>>2]=0;break t}case 17:{i=(s[r>>2]|0)+(8-1)&~(8-1);a=+c[i>>3];s[r>>2]=i+8;c[t>>3]=a;break t}case 18:{de[n&1](t,r);break t}default:break t}}while(0)}while(0);return}function St(t,e,r,i){t=t|0;e=e|0;r=r|0;i=i|0;if(!((t|0)==0&(e|0)==0))do{r=r+-1|0;n[r>>0]=a[480+(t&15)>>0]|0|i;t=Vt(t|0,e|0,4)|0;e=E()|0}while(!((t|0)==0&(e|0)==0));return r|0}function Rt(t,e,r){t=t|0;e=e|0;r=r|0;if(!((t|0)==0&(e|0)==0))do{r=r+-1|0;n[r>>0]=t&7|48;t=Vt(t|0,e|0,3)|0;e=E()|0}while(!((t|0)==0&(e|0)==0));return r|0}function It(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,s=0,a=0;if(e>>>0>0|(e|0)==0&t>>>0>4294967295){do{i=t;t=Gt(t|0,e|0,10,0)|0;s=e;e=E()|0;a=zt(t|0,e|0,10,0)|0;a=Ht(i|0,s|0,a|0,E()|0)|0;E()|0;r=r+-1|0;n[r>>0]=a&255|48}while(s>>>0>9|(s|0)==9&i>>>0>4294967295);e=t}else e=t;if(e)do{a=e;e=(e>>>0)/10|0;r=r+-1|0;n[r>>0]=a-(e*10|0)|48}while(a>>>0>=10);return r|0}function Bt(t,e,r,n,i){t=t|0;e=e|0;r=r|0;n=n|0;i=i|0;var s=0;s=$;$=$+256|0;if((r|0)>(n|0)&(i&73728|0)==0){Jt(s|0,e<<24>>24|0,((r-n|0)>>>0<256?r-n|0:256)|0)|0;if((r-n|0)>>>0>255){e=r-n|0;do{xt(t,s,256);e=e+-256|0}while(e>>>0>255);e=r-n&255}else e=r-n|0;xt(t,s,e)}$=s;return}function Ot(t,e){t=t|0;e=e|0;if(!t)t=0;else t=Pt(t,e,0)|0;return t|0}function Pt(t,e,r){t=t|0;e=e|0;r=r|0;do{if(t){if(e>>>0<128){n[t>>0]=e;t=1;break}if(!(s[s[(Mt()|0)+188>>2]>>2]|0))if((e&-128|0)==57216){n[t>>0]=e;t=1;break}else{s[(ut()|0)>>2]=84;t=-1;break}if(e>>>0<2048){n[t>>0]=e>>>6|192;n[t+1>>0]=e&63|128;t=2;break}if(e>>>0<55296|(e&-8192|0)==57344){n[t>>0]=e>>>12|224;n[t+1>>0]=e>>>6&63|128;n[t+2>>0]=e&63|128;t=3;break}if((e+-65536|0)>>>0<1048576){n[t>>0]=e>>>18|240;n[t+1>>0]=e>>>12&63|128;n[t+2>>0]=e>>>6&63|128;n[t+3>>0]=e&63|128;t=4;break}else{s[(ut()|0)>>2]=84;t=-1;break}}else t=1}while(0);return t|0}function Mt(){return lt()|0}function Dt(t){t=+t;var e=0;c[h>>3]=t;e=s[h>>2]|0;k(s[h+4>>2]|0);return e|0}function Ft(t,e){t=+t;e=e|0;var r=0,n=0,i=0;c[h>>3]=t;r=s[h>>2]|0;n=s[h+4>>2]|0;i=Vt(r|0,n|0,52)|0;E()|0;switch(i&2047){case 0:{if(t!=0.0){t=+Ft(t*18446744073709551616.0,e);r=(s[e>>2]|0)+-64|0}else r=0;s[e>>2]=r;break}case 2047:break;default:{s[e>>2]=(i&2047)+-1022;s[h>>2]=r;s[h+4>>2]=n&-2146435073|1071644672;t=+c[h>>3]}}return+t}function Lt(t,e){t=t|0;e=e|0;var r=0,i=0,a=0;if((s[e+76>>2]|0)>=0?(pt(e)|0)!=0:0){if((t&255|0)!=(n[e+75>>0]|0)?(i=s[e+20>>2]|0,i>>>0<(s[e+16>>2]|0)>>>0):0){s[e+20>>2]=i+1;n[i>>0]=t;t=t&255}else t=_t(e,t)|0;dt(e)}else a=3;do{if((a|0)==3){if((t&255|0)!=(n[e+75>>0]|0)?(r=s[e+20>>2]|0,r>>>0<(s[e+16>>2]|0)>>>0):0){s[e+20>>2]=r+1;n[r>>0]=t;t=t&255;break}t=_t(e,t)|0}}while(0);return t|0}function jt(t){t=t|0;var e=0,r=0,n=0,i=0,a=0,o=0,u=0,c=0,h=0,l=0,f=0,d=0,p=0,_=0,g=0,b=0,v=0,m=0,y=0,w=0;w=$;$=$+16|0;do{if(t>>>0<245){f=t>>>0<11?16:t+11&-8;h=s[736]|0;if(h>>>(f>>>3)&3|0){t=2984+((h>>>(f>>>3)&1^1)+(f>>>3)<<1<<2)|0;e=s[t+8>>2]|0;r=s[e+8>>2]|0;if((r|0)==(t|0))s[736]=h&~(1<<(h>>>(f>>>3)&1^1)+(f>>>3));else{s[r+12>>2]=t;s[t+8>>2]=r}y=(h>>>(f>>>3)&1^1)+(f>>>3)<<3;s[e+4>>2]=y|3;s[e+y+4>>2]=s[e+y+4>>2]|1;y=e+8|0;$=w;return y|0}l=s[738]|0;if(f>>>0>l>>>0){if(h>>>(f>>>3)|0){t=h>>>(f>>>3)<<(f>>>3)&(2<<(f>>>3)|0-(2<<(f>>>3)));i=((t&0-t)+-1|0)>>>(((t&0-t)+-1|0)>>>12&16);n=i>>>(i>>>5&8)>>>(i>>>(i>>>5&8)>>>2&4);n=(i>>>5&8|((t&0-t)+-1|0)>>>12&16|i>>>(i>>>5&8)>>>2&4|n>>>1&2|n>>>(n>>>1&2)>>>1&1)+(n>>>(n>>>1&2)>>>(n>>>(n>>>1&2)>>>1&1))|0;i=s[2984+(n<<1<<2)+8>>2]|0;t=s[i+8>>2]|0;if((t|0)==(2984+(n<<1<<2)|0)){s[736]=h&~(1<<n);t=h&~(1<<n)}else{s[t+12>>2]=2984+(n<<1<<2);s[2984+(n<<1<<2)+8>>2]=t;t=h}s[i+4>>2]=f|3;s[i+f+4>>2]=(n<<3)-f|1;s[i+(n<<3)>>2]=(n<<3)-f;if(l|0){r=s[741]|0;if(!(t&1<<(l>>>3))){s[736]=t|1<<(l>>>3);t=2984+(l>>>3<<1<<2)|0;e=2984+(l>>>3<<1<<2)+8|0}else{t=s[2984+(l>>>3<<1<<2)+8>>2]|0;e=2984+(l>>>3<<1<<2)+8|0}s[e>>2]=r;s[t+12>>2]=r;s[r+8>>2]=t;s[r+12>>2]=2984+(l>>>3<<1<<2)}s[738]=(n<<3)-f;s[741]=i+f;y=i+8|0;$=w;return y|0}a=s[737]|0;if(a){e=((a&0-a)+-1|0)>>>(((a&0-a)+-1|0)>>>12&16);c=e>>>(e>>>5&8)>>>(e>>>(e>>>5&8)>>>2&4);c=s[3248+((e>>>5&8|((a&0-a)+-1|0)>>>12&16|e>>>(e>>>5&8)>>>2&4|c>>>1&2|c>>>(c>>>1&2)>>>1&1)+(c>>>(c>>>1&2)>>>(c>>>(c>>>1&2)>>>1&1))<<2)>>2]|0;e=c;u=c;c=(s[c+4>>2]&-8)-f|0;while(1){t=s[e+16>>2]|0;if(!t){t=s[e+20>>2]|0;if(!t)break}o=(s[t+4>>2]&-8)-f|0;i=o>>>0<c>>>0;e=t;u=i?t:u;c=i?o:c}o=u+f|0;if(o>>>0>u>>>0){i=s[u+24>>2]|0;t=s[u+12>>2]|0;do{if((t|0)==(u|0)){e=u+20|0;t=s[e>>2]|0;if(!t){e=u+16|0;t=s[e>>2]|0;if(!t){e=0;break}}while(1){n=t+20|0;r=s[n>>2]|0;if(!r){n=t+16|0;r=s[n>>2]|0;if(!r)break;else{t=r;e=n}}else{t=r;e=n}}s[e>>2]=0;e=t}else{e=s[u+8>>2]|0;s[e+12>>2]=t;s[t+8>>2]=e;e=t}}while(0);do{if(i|0){t=s[u+28>>2]|0;if((u|0)==(s[3248+(t<<2)>>2]|0)){s[3248+(t<<2)>>2]=e;if(!e){s[737]=a&~(1<<t);break}}else{s[((s[i+16>>2]|0)==(u|0)?i+16|0:i+20|0)>>2]=e;if(!e)break}s[e+24>>2]=i;t=s[u+16>>2]|0;if(t|0){s[e+16>>2]=t;s[t+24>>2]=e}t=s[u+20>>2]|0;if(t|0){s[e+20>>2]=t;s[t+24>>2]=e}}}while(0);if(c>>>0<16){y=c+f|0;s[u+4>>2]=y|3;y=u+y+4|0;s[y>>2]=s[y>>2]|1}else{s[u+4>>2]=f|3;s[o+4>>2]=c|1;s[o+c>>2]=c;if(l|0){r=s[741]|0;if(!(1<<(l>>>3)&h)){s[736]=1<<(l>>>3)|h;t=2984+(l>>>3<<1<<2)|0;e=2984+(l>>>3<<1<<2)+8|0}else{t=s[2984+(l>>>3<<1<<2)+8>>2]|0;e=2984+(l>>>3<<1<<2)+8|0}s[e>>2]=r;s[t+12>>2]=r;s[r+8>>2]=t;s[r+12>>2]=2984+(l>>>3<<1<<2)}s[738]=c;s[741]=o}y=u+8|0;$=w;return y|0}}}}else if(t>>>0<=4294967231){f=t+11&-8;n=s[737]|0;if(n){if((t+11|0)>>>8)if(f>>>0>16777215)u=31;else{u=(t+11|0)>>>8<<((((t+11|0)>>>8)+1048320|0)>>>16&8);u=14-((u+520192|0)>>>16&4|(((t+11|0)>>>8)+1048320|0)>>>16&8|((u<<((u+520192|0)>>>16&4))+245760|0)>>>16&2)+(u<<((u+520192|0)>>>16&4)<<(((u<<((u+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;u=f>>>(u+7|0)&1|u<<1}else u=0;t=s[3248+(u<<2)>>2]|0;t:do{if(!t){r=0;t=0;e=0-f|0;_=61}else{a=0;e=0-f|0;o=f<<((u|0)==31?0:25-(u>>>1)|0);r=0;while(1){i=(s[t+4>>2]&-8)-f|0;if(i>>>0<e>>>0)if(!i){i=t;e=0;r=t;_=65;break t}else{a=t;e=i}_=s[t+20>>2]|0;t=s[t+16+(o>>>31<<2)>>2]|0;r=(_|0)==0|(_|0)==(t|0)?r:_;if(!t){t=a;_=61;break}else o=o<<1}}}while(0);if((_|0)==61){if((r|0)==0&(t|0)==0){t=2<<u;if(!((t|0-t)&n))break;h=((t|0-t)&n&0-((t|0-t)&n))+-1|0;l=h>>>(h>>>12&16)>>>(h>>>(h>>>12&16)>>>5&8);r=l>>>(l>>>2&4)>>>(l>>>(l>>>2&4)>>>1&2);t=0;r=s[3248+((h>>>(h>>>12&16)>>>5&8|h>>>12&16|l>>>2&4|l>>>(l>>>2&4)>>>1&2|r>>>1&1)+(r>>>(r>>>1&1))<<2)>>2]|0}if(!r){u=t;o=e}else{i=t;_=65}}if((_|0)==65)while(1){l=(s[r+4>>2]&-8)-f|0;t=l>>>0<e>>>0;e=t?l:e;i=t?r:i;t=s[r+16>>2]|0;if(!t)t=s[r+20>>2]|0;if(!t){u=i;o=e;break}else r=t}if(((u|0)!=0?o>>>0<((s[738]|0)-f|0)>>>0:0)?(c=u+f|0,c>>>0>u>>>0):0){a=s[u+24>>2]|0;t=s[u+12>>2]|0;do{if((t|0)==(u|0)){e=u+20|0;t=s[e>>2]|0;if(!t){e=u+16|0;t=s[e>>2]|0;if(!t){t=0;break}}while(1){i=t+20|0;r=s[i>>2]|0;if(!r){i=t+16|0;r=s[i>>2]|0;if(!r)break;else{t=r;e=i}}else{t=r;e=i}}s[e>>2]=0}else{y=s[u+8>>2]|0;s[y+12>>2]=t;s[t+8>>2]=y}}while(0);do{if(a){e=s[u+28>>2]|0;if((u|0)==(s[3248+(e<<2)>>2]|0)){s[3248+(e<<2)>>2]=t;if(!t){s[737]=n&~(1<<e);n=n&~(1<<e);break}}else{s[((s[a+16>>2]|0)==(u|0)?a+16|0:a+20|0)>>2]=t;if(!t)break}s[t+24>>2]=a;e=s[u+16>>2]|0;if(e|0){s[t+16>>2]=e;s[e+24>>2]=t}e=s[u+20>>2]|0;if(e){s[t+20>>2]=e;s[e+24>>2]=t}}}while(0);t:do{if(o>>>0<16){y=o+f|0;s[u+4>>2]=y|3;y=u+y+4|0;s[y>>2]=s[y>>2]|1}else{s[u+4>>2]=f|3;s[c+4>>2]=o|1;s[c+o>>2]=o;r=o>>>3;if(o>>>0<256){t=s[736]|0;if(!(t&1<<r)){s[736]=t|1<<r;t=2984+(r<<1<<2)|0;e=2984+(r<<1<<2)+8|0}else{t=s[2984+(r<<1<<2)+8>>2]|0;e=2984+(r<<1<<2)+8|0}s[e>>2]=c;s[t+12>>2]=c;s[c+8>>2]=t;s[c+12>>2]=2984+(r<<1<<2);break}t=o>>>8;if(t)if(o>>>0>16777215)r=31;else{r=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);r=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(r+245760|0)>>>16&2)+(r<<((r+245760|0)>>>16&2)>>>15)|0;r=o>>>(r+7|0)&1|r<<1}else r=0;t=3248+(r<<2)|0;s[c+28>>2]=r;s[c+16+4>>2]=0;s[c+16>>2]=0;e=1<<r;if(!(n&e)){s[737]=n|e;s[t>>2]=c;s[c+24>>2]=t;s[c+12>>2]=c;s[c+8>>2]=c;break}t=s[t>>2]|0;e:do{if((s[t+4>>2]&-8|0)!=(o|0)){n=o<<((r|0)==31?0:25-(r>>>1)|0);while(1){r=t+16+(n>>>31<<2)|0;e=s[r>>2]|0;if(!e)break;if((s[e+4>>2]&-8|0)==(o|0)){t=e;break e}else{n=n<<1;t=e}}s[r>>2]=c;s[c+24>>2]=t;s[c+12>>2]=c;s[c+8>>2]=c;break t}}while(0);m=t+8|0;y=s[m>>2]|0;s[y+12>>2]=c;s[m>>2]=c;s[c+8>>2]=y;s[c+12>>2]=t;s[c+24>>2]=0}}while(0);y=u+8|0;$=w;return y|0}}}else f=-1}while(0);r=s[738]|0;if(r>>>0>=f>>>0){t=r-f|0;e=s[741]|0;if(t>>>0>15){y=e+f|0;s[741]=y;s[738]=t;s[y+4>>2]=t|1;s[e+r>>2]=t;s[e+4>>2]=f|3}else{s[738]=0;s[741]=0;s[e+4>>2]=r|3;s[e+r+4>>2]=s[e+r+4>>2]|1}y=e+8|0;$=w;return y|0}i=s[739]|0;if(i>>>0>f>>>0){v=i-f|0;s[739]=v;y=s[742]|0;m=y+f|0;s[742]=m;s[m+4>>2]=v|1;s[y+4>>2]=f|3;y=y+8|0;$=w;return y|0}if(!(s[854]|0)){s[856]=4096;s[855]=4096;s[857]=-1;s[858]=-1;s[859]=0;s[847]=0;s[854]=w&-16^1431655768;t=4096}else t=s[856]|0;a=f+48|0;o=f+47|0;c=t+o|0;u=0-t|0;if((c&u)>>>0<=f>>>0){y=0;$=w;return y|0}t=s[846]|0;if(t|0?(l=s[844]|0,(l+(c&u)|0)>>>0<=l>>>0?1:(l+(c&u)|0)>>>0>t>>>0):0){y=0;$=w;return y|0}t:do{if(!(s[847]&4)){r=s[742]|0;e:do{if(r){e=3392;while(1){l=s[e>>2]|0;if(l>>>0<=r>>>0?(l+(s[e+4>>2]|0)|0)>>>0>r>>>0:0)break;t=s[e+8>>2]|0;if(!t){_=128;break e}else e=t}if((c-i&u)>>>0<2147483647){t=Qt(c-i&u|0)|0;if((t|0)==((s[e>>2]|0)+(s[e+4>>2]|0)|0))if((t|0)==(-1|0))t=c-i&u;else{o=c-i&u;i=t;_=145;break t}else{n=t;r=c-i&u;_=136}}else t=0}else _=128}while(0);do{if((_|0)==128){e=Qt(0)|0;if((e|0)!=(-1|0)?(p=s[855]|0,p=((p+-1&e|0)==0?0:(p+-1+e&0-p)-e|0)+(c&u)|0,d=s[844]|0,p>>>0>f>>>0&p>>>0<2147483647):0){l=s[846]|0;if(l|0?(p+d|0)>>>0<=d>>>0|(p+d|0)>>>0>l>>>0:0){t=0;break}t=Qt(p|0)|0;if((t|0)==(e|0)){o=p;i=e;_=145;break t}else{n=t;r=p;_=136}}else t=0}}while(0);do{if((_|0)==136){e=0-r|0;if(!(a>>>0>r>>>0&(r>>>0<2147483647&(n|0)!=(-1|0))))if((n|0)==(-1|0)){t=0;break}else{o=r;i=n;_=145;break t}t=s[856]|0;t=o-r+t&0-t;if(t>>>0>=2147483647){o=r;i=n;_=145;break t}if((Qt(t|0)|0)==(-1|0)){Qt(e|0)|0;t=0;break}else{o=t+r|0;i=n;_=145;break t}}}while(0);s[847]=s[847]|4;_=143}else{t=0;_=143}}while(0);if(((_|0)==143?(c&u)>>>0<2147483647:0)?(v=Qt(c&u|0)|0,g=Qt(0)|0,b=(g-v|0)>>>0>(f+40|0)>>>0,!((v|0)==(-1|0)|b^1|v>>>0<g>>>0&((v|0)!=(-1|0)&(g|0)!=(-1|0))^1)):0){o=b?g-v|0:t;i=v;_=145}if((_|0)==145){t=(s[844]|0)+o|0;s[844]=t;if(t>>>0>(s[845]|0)>>>0)s[845]=t;c=s[742]|0;t:do{if(c){t=3392;while(1){e=s[t>>2]|0;r=s[t+4>>2]|0;if((i|0)==(e+r|0)){_=154;break}n=s[t+8>>2]|0;if(!n)break;else t=n}if(((_|0)==154?(m=t+4|0,(s[t+12>>2]&8|0)==0):0)?i>>>0>c>>>0&e>>>0<=c>>>0:0){s[m>>2]=r+o;y=(s[739]|0)+o|0;m=(c+8&7|0)==0?0:0-(c+8)&7;s[742]=c+m;s[739]=y-m;s[c+m+4>>2]=y-m|1;s[c+y+4>>2]=40;s[743]=s[858];break}if(i>>>0<(s[740]|0)>>>0)s[740]=i;r=i+o|0;t=3392;while(1){if((s[t>>2]|0)==(r|0)){_=162;break}e=s[t+8>>2]|0;if(!e)break;else t=e}if((_|0)==162?(s[t+12>>2]&8|0)==0:0){s[t>>2]=i;l=t+4|0;s[l>>2]=(s[l>>2]|0)+o;l=i+8|0;l=i+((l&7|0)==0?0:0-l&7)|0;t=r+((r+8&7|0)==0?0:0-(r+8)&7)|0;h=l+f|0;u=t-l-f|0;s[l+4>>2]=f|3;e:do{if((c|0)==(t|0)){y=(s[739]|0)+u|0;s[739]=y;s[742]=h;s[h+4>>2]=y|1}else{if((s[741]|0)==(t|0)){y=(s[738]|0)+u|0;s[738]=y;s[741]=h;s[h+4>>2]=y|1;s[h+y>>2]=y;break}o=s[t+4>>2]|0;if((o&3|0)==1){r:do{if(o>>>0<256){e=s[t+8>>2]|0;r=s[t+12>>2]|0;if((r|0)==(e|0)){s[736]=s[736]&~(1<<(o>>>3));break}else{s[e+12>>2]=r;s[r+8>>2]=e;break}}else{a=s[t+24>>2]|0;e=s[t+12>>2]|0;do{if((e|0)==(t|0)){e=s[t+16+4>>2]|0;if(!e){e=s[t+16>>2]|0;if(!e){e=0;break}else r=t+16|0}else r=t+16+4|0;while(1){i=e+20|0;n=s[i>>2]|0;if(!n){i=e+16|0;n=s[i>>2]|0;if(!n)break;else{e=n;r=i}}else{e=n;r=i}}s[r>>2]=0}else{y=s[t+8>>2]|0;s[y+12>>2]=e;s[e+8>>2]=y}}while(0);if(!a)break;r=s[t+28>>2]|0;do{if((s[3248+(r<<2)>>2]|0)!=(t|0)){s[((s[a+16>>2]|0)==(t|0)?a+16|0:a+20|0)>>2]=e;if(!e)break r}else{s[3248+(r<<2)>>2]=e;if(e|0)break;s[737]=s[737]&~(1<<r);break r}}while(0);s[e+24>>2]=a;r=s[t+16>>2]|0;if(r|0){s[e+16>>2]=r;s[r+24>>2]=e}r=s[t+16+4>>2]|0;if(!r)break;s[e+20>>2]=r;s[r+24>>2]=e}}while(0);t=t+(o&-8)|0;i=(o&-8)+u|0}else i=u;r=t+4|0;s[r>>2]=s[r>>2]&-2;s[h+4>>2]=i|1;s[h+i>>2]=i;r=i>>>3;if(i>>>0<256){t=s[736]|0;if(!(t&1<<r)){s[736]=t|1<<r;t=2984+(r<<1<<2)|0;e=2984+(r<<1<<2)+8|0}else{t=s[2984+(r<<1<<2)+8>>2]|0;e=2984+(r<<1<<2)+8|0}s[e>>2]=h;s[t+12>>2]=h;s[h+8>>2]=t;s[h+12>>2]=2984+(r<<1<<2);break}t=i>>>8;do{if(!t)n=0;else{if(i>>>0>16777215){n=31;break}n=t<<((t+1048320|0)>>>16&8)<<(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4);n=14-(((t<<((t+1048320|0)>>>16&8))+520192|0)>>>16&4|(t+1048320|0)>>>16&8|(n+245760|0)>>>16&2)+(n<<((n+245760|0)>>>16&2)>>>15)|0;n=i>>>(n+7|0)&1|n<<1}}while(0);t=3248+(n<<2)|0;s[h+28>>2]=n;s[h+16+4>>2]=0;s[h+16>>2]=0;e=s[737]|0;r=1<<n;if(!(e&r)){s[737]=e|r;s[t>>2]=h;s[h+24>>2]=t;s[h+12>>2]=h;s[h+8>>2]=h;break}t=s[t>>2]|0;r:do{if((s[t+4>>2]&-8|0)!=(i|0)){n=i<<((n|0)==31?0:25-(n>>>1)|0);while(1){r=t+16+(n>>>31<<2)|0;e=s[r>>2]|0;if(!e)break;if((s[e+4>>2]&-8|0)==(i|0)){t=e;break r}else{n=n<<1;t=e}}s[r>>2]=h;s[h+24>>2]=t;s[h+12>>2]=h;s[h+8>>2]=h;break e}}while(0);m=t+8|0;y=s[m>>2]|0;s[y+12>>2]=h;s[m>>2]=h;s[h+8>>2]=y;s[h+12>>2]=t;s[h+24>>2]=0}}while(0);y=l+8|0;$=w;return y|0}t=3392;while(1){e=s[t>>2]|0;if(e>>>0<=c>>>0?(y=e+(s[t+4>>2]|0)|0,y>>>0>c>>>0):0)break;t=s[t+8>>2]|0}a=y+-47+((y+-47+8&7|0)==0?0:0-(y+-47+8)&7)|0;a=a>>>0<(c+16|0)>>>0?c:a;t=o+-40|0;v=i+8|0;v=(v&7|0)==0?0:0-v&7;m=i+v|0;s[742]=m;s[739]=t-v;s[m+4>>2]=t-v|1;s[i+t+4>>2]=40;s[743]=s[858];s[a+4>>2]=27;s[a+8>>2]=s[848];s[a+8+4>>2]=s[849];s[a+8+8>>2]=s[850];s[a+8+12>>2]=s[851];s[848]=i;s[849]=o;s[851]=0;s[850]=a+8;t=a+24|0;do{m=t;t=t+4|0;s[t>>2]=7}while((m+8|0)>>>0<y>>>0);if((a|0)!=(c|0)){s[a+4>>2]=s[a+4>>2]&-2;s[c+4>>2]=a-c|1;s[a>>2]=a-c;if((a-c|0)>>>0<256){r=2984+((a-c|0)>>>3<<1<<2)|0;t=s[736]|0;if(!(t&1<<((a-c|0)>>>3))){s[736]=t|1<<((a-c|0)>>>3);t=r;e=r+8|0}else{t=s[r+8>>2]|0;e=r+8|0}s[e>>2]=c;s[t+12>>2]=c;s[c+8>>2]=t;s[c+12>>2]=r;break}if((a-c|0)>>>8)if((a-c|0)>>>0>16777215)n=31;else{n=(a-c|0)>>>8<<((((a-c|0)>>>8)+1048320|0)>>>16&8);n=14-((n+520192|0)>>>16&4|(((a-c|0)>>>8)+1048320|0)>>>16&8|((n<<((n+520192|0)>>>16&4))+245760|0)>>>16&2)+(n<<((n+520192|0)>>>16&4)<<(((n<<((n+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;n=(a-c|0)>>>(n+7|0)&1|n<<1}else n=0;t=3248+(n<<2)|0;s[c+28>>2]=n;s[c+20>>2]=0;s[c+16>>2]=0;e=s[737]|0;r=1<<n;if(!(e&r)){s[737]=e|r;s[t>>2]=c;s[c+24>>2]=t;s[c+12>>2]=c;s[c+8>>2]=c;break}t=s[t>>2]|0;e:do{if((s[t+4>>2]&-8|0)!=(a-c|0)){n=a-c<<((n|0)==31?0:25-(n>>>1)|0);while(1){r=t+16+(n>>>31<<2)|0;e=s[r>>2]|0;if(!e)break;if((s[e+4>>2]&-8|0)==(a-c|0)){t=e;break e}else{n=n<<1;t=e}}s[r>>2]=c;s[c+24>>2]=t;s[c+12>>2]=c;s[c+8>>2]=c;break t}}while(0);m=t+8|0;y=s[m>>2]|0;s[y+12>>2]=c;s[m>>2]=c;s[c+8>>2]=y;s[c+12>>2]=t;s[c+24>>2]=0}}else{y=s[740]|0;if((y|0)==0|i>>>0<y>>>0)s[740]=i;s[848]=i;s[849]=o;s[851]=0;s[745]=s[854];s[744]=-1;s[749]=2984;s[748]=2984;s[751]=2992;s[750]=2992;s[753]=3e3;s[752]=3e3;s[755]=3008;s[754]=3008;s[757]=3016;s[756]=3016;s[759]=3024;s[758]=3024;s[761]=3032;s[760]=3032;s[763]=3040;s[762]=3040;s[765]=3048;s[764]=3048;s[767]=3056;s[766]=3056;s[769]=3064;s[768]=3064;s[771]=3072;s[770]=3072;s[773]=3080;s[772]=3080;s[775]=3088;s[774]=3088;s[777]=3096;s[776]=3096;s[779]=3104;s[778]=3104;s[781]=3112;s[780]=3112;s[783]=3120;s[782]=3120;s[785]=3128;s[784]=3128;s[787]=3136;s[786]=3136;s[789]=3144;s[788]=3144;s[791]=3152;s[790]=3152;s[793]=3160;s[792]=3160;s[795]=3168;s[794]=3168;s[797]=3176;s[796]=3176;s[799]=3184;s[798]=3184;s[801]=3192;s[800]=3192;s[803]=3200;s[802]=3200;s[805]=3208;s[804]=3208;s[807]=3216;s[806]=3216;s[809]=3224;s[808]=3224;s[811]=3232;s[810]=3232;y=o+-40|0;v=i+8|0;v=(v&7|0)==0?0:0-v&7;m=i+v|0;s[742]=m;s[739]=y-v;s[m+4>>2]=y-v|1;s[i+y+4>>2]=40;s[743]=s[858]}}while(0);t=s[739]|0;if(t>>>0>f>>>0){v=t-f|0;s[739]=v;y=s[742]|0;m=y+f|0;s[742]=m;s[m+4>>2]=v|1;s[y+4>>2]=f|3;y=y+8|0;$=w;return y|0}}s[(ut()|0)>>2]=12;y=0;$=w;return y|0}function Nt(t){t=t|0;var e=0,r=0,n=0,i=0,a=0,o=0,u=0,c=0;if(!t)return;e=s[740]|0;r=s[t+-4>>2]|0;c=t+-8+(r&-8)|0;do{if(!(r&1)){n=s[t+-8>>2]|0;if(!(r&3))return;o=t+-8+(0-n)|0;a=n+(r&-8)|0;if(o>>>0<e>>>0)return;if((s[741]|0)==(o|0)){e=s[c+4>>2]|0;if((e&3|0)!=3){u=o;e=a;break}s[738]=a;s[c+4>>2]=e&-2;s[o+4>>2]=a|1;s[o+a>>2]=a;return}if(n>>>0<256){e=s[o+8>>2]|0;t=s[o+12>>2]|0;if((t|0)==(e|0)){s[736]=s[736]&~(1<<(n>>>3));u=o;e=a;break}else{s[e+12>>2]=t;s[t+8>>2]=e;u=o;e=a;break}}i=s[o+24>>2]|0;e=s[o+12>>2]|0;do{if((e|0)==(o|0)){e=s[o+16+4>>2]|0;if(!e){e=s[o+16>>2]|0;if(!e){e=0;break}else t=o+16|0}else t=o+16+4|0;while(1){n=e+20|0;r=s[n>>2]|0;if(!r){n=e+16|0;r=s[n>>2]|0;if(!r)break;else{e=r;t=n}}else{e=r;t=n}}s[t>>2]=0}else{u=s[o+8>>2]|0;s[u+12>>2]=e;s[e+8>>2]=u}}while(0);if(i){t=s[o+28>>2]|0;if((s[3248+(t<<2)>>2]|0)==(o|0)){s[3248+(t<<2)>>2]=e;if(!e){s[737]=s[737]&~(1<<t);u=o;e=a;break}}else{s[((s[i+16>>2]|0)==(o|0)?i+16|0:i+20|0)>>2]=e;if(!e){u=o;e=a;break}}s[e+24>>2]=i;t=s[o+16>>2]|0;if(t|0){s[e+16>>2]=t;s[t+24>>2]=e}t=s[o+16+4>>2]|0;if(t){s[e+20>>2]=t;s[t+24>>2]=e;u=o;e=a}else{u=o;e=a}}else{u=o;e=a}}else{u=t+-8|0;e=r&-8;o=t+-8|0}}while(0);if(o>>>0>=c>>>0)return;r=s[c+4>>2]|0;if(!(r&1))return;if(!(r&2)){if((s[742]|0)==(c|0)){c=(s[739]|0)+e|0;s[739]=c;s[742]=u;s[u+4>>2]=c|1;if((u|0)!=(s[741]|0))return;s[741]=0;s[738]=0;return}if((s[741]|0)==(c|0)){c=(s[738]|0)+e|0;s[738]=c;s[741]=o;s[u+4>>2]=c|1;s[o+c>>2]=c;return}i=(r&-8)+e|0;do{if(r>>>0<256){t=s[c+8>>2]|0;e=s[c+12>>2]|0;if((e|0)==(t|0)){s[736]=s[736]&~(1<<(r>>>3));break}else{s[t+12>>2]=e;s[e+8>>2]=t;break}}else{a=s[c+24>>2]|0;e=s[c+12>>2]|0;do{if((e|0)==(c|0)){e=s[c+16+4>>2]|0;if(!e){e=s[c+16>>2]|0;if(!e){t=0;break}else t=c+16|0}else t=c+16+4|0;while(1){n=e+20|0;r=s[n>>2]|0;if(!r){n=e+16|0;r=s[n>>2]|0;if(!r)break;else{e=r;t=n}}else{e=r;t=n}}s[t>>2]=0;t=e}else{t=s[c+8>>2]|0;s[t+12>>2]=e;s[e+8>>2]=t;t=e}}while(0);if(a|0){e=s[c+28>>2]|0;if((s[3248+(e<<2)>>2]|0)==(c|0)){s[3248+(e<<2)>>2]=t;if(!t){s[737]=s[737]&~(1<<e);break}}else{s[((s[a+16>>2]|0)==(c|0)?a+16|0:a+20|0)>>2]=t;if(!t)break}s[t+24>>2]=a;e=s[c+16>>2]|0;if(e|0){s[t+16>>2]=e;s[e+24>>2]=t}e=s[c+16+4>>2]|0;if(e|0){s[t+20>>2]=e;s[e+24>>2]=t}}}}while(0);s[u+4>>2]=i|1;s[o+i>>2]=i;if((u|0)==(s[741]|0)){s[738]=i;return}}else{s[c+4>>2]=r&-2;s[u+4>>2]=e|1;s[o+e>>2]=e;i=e}r=i>>>3;if(i>>>0<256){e=s[736]|0;if(!(e&1<<r)){s[736]=e|1<<r;e=2984+(r<<1<<2)|0;t=2984+(r<<1<<2)+8|0}else{e=s[2984+(r<<1<<2)+8>>2]|0;t=2984+(r<<1<<2)+8|0}s[t>>2]=u;s[e+12>>2]=u;s[u+8>>2]=e;s[u+12>>2]=2984+(r<<1<<2);return}e=i>>>8;if(e)if(i>>>0>16777215)n=31;else{n=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);n=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(n+245760|0)>>>16&2)+(n<<((n+245760|0)>>>16&2)>>>15)|0;n=i>>>(n+7|0)&1|n<<1}else n=0;e=3248+(n<<2)|0;s[u+28>>2]=n;s[u+20>>2]=0;s[u+16>>2]=0;t=s[737]|0;r=1<<n;t:do{if(!(t&r)){s[737]=t|r;s[e>>2]=u;s[u+24>>2]=e;s[u+12>>2]=u;s[u+8>>2]=u}else{e=s[e>>2]|0;e:do{if((s[e+4>>2]&-8|0)!=(i|0)){n=i<<((n|0)==31?0:25-(n>>>1)|0);while(1){r=e+16+(n>>>31<<2)|0;t=s[r>>2]|0;if(!t)break;if((s[t+4>>2]&-8|0)==(i|0)){e=t;break e}else{n=n<<1;e=t}}s[r>>2]=u;s[u+24>>2]=e;s[u+12>>2]=u;s[u+8>>2]=u;break t}}while(0);o=e+8|0;c=s[o>>2]|0;s[c+12>>2]=u;s[o>>2]=u;s[u+8>>2]=c;s[u+12>>2]=e;s[u+24>>2]=0}}while(0);c=(s[744]|0)+-1|0;s[744]=c;if(c|0)return;e=3400;while(1){e=s[e>>2]|0;if(!e)break;else e=e+8|0}s[744]=-1;return}function Ut(t,e){t=t|0;e=e|0;var r=0,n=0,i=0;r=y(e&65535,t&65535)|0;i=(r>>>16)+(y(e&65535,t>>>16)|0)|0;n=y(e>>>16,t&65535)|0;return(k((i>>>16)+(y(e>>>16,t>>>16)|0)+(((i&65535)+n|0)>>>16)|0),i+n<<16|r&65535|0)|0}function zt(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var i=0,s=0;i=Ut(t,r)|0;s=E()|0;return(k((y(e,r)|0)+(y(n,t)|0)+s|s&0|0),i|0|0)|0}function $t(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;return(k(e+n+(t+r>>>0>>>0<t>>>0|0)>>>0|0),t+r>>>0|0)|0}function Ht(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;n=e-n-(r>>>0>t>>>0|0)>>>0;return(k(n|0),t-r>>>0|0)|0}function Wt(t){t=t|0;return(t?31-(w(t^t-1)|0)|0:32)|0}function qt(t,e,r,n,i){t=t|0;e=e|0;r=r|0;n=n|0;i=i|0;var a=0,o=0,u=0,c=0,h=0,l=0,f=0,d=0,p=0,_=0;if(!e)if(!n){if(i|0){s[i>>2]=(t>>>0)%(r>>>0);s[i+4>>2]=0}n=0;i=(t>>>0)/(r>>>0)>>>0;return(k(n|0),i)|0}else{if(!i){n=0;i=0;return(k(n|0),i)|0}s[i>>2]=t|0;s[i+4>>2]=e&0;n=0;i=0;return(k(n|0),i)|0}do{if(r){if(n|0){o=(w(n|0)|0)-(w(e|0)|0)|0;if(o>>>0<=31){d=o+1|0;u=t>>>((o+1|0)>>>0)&o-31>>31|e<<31-o;f=e>>>((o+1|0)>>>0)&o-31>>31;a=0;o=t<<31-o;break}if(!i){n=0;i=0;return(k(n|0),i)|0}s[i>>2]=t|0;s[i+4>>2]=e|e&0;n=0;i=0;return(k(n|0),i)|0}if(r-1&r|0){o=(w(r|0)|0)+33-(w(e|0)|0)|0;d=o;u=32-o-1>>31&e>>>((o-32|0)>>>0)|(e<<32-o|t>>>(o>>>0))&o-32>>31;f=o-32>>31&e>>>(o>>>0);a=t<<64-o&32-o>>31;o=(e<<64-o|t>>>((o-32|0)>>>0))&32-o>>31|t<<32-o&o-33>>31;break}if(i|0){s[i>>2]=r-1&t;s[i+4>>2]=0}if((r|0)==1){n=e|e&0;i=t|0|0;return(k(n|0),i)|0}else{i=Wt(r|0)|0;n=e>>>(i>>>0)|0;i=e<<32-i|t>>>(i>>>0)|0;return(k(n|0),i)|0}}else{if(!n){if(i|0){s[i>>2]=(e>>>0)%(r>>>0);s[i+4>>2]=0}n=0;i=(e>>>0)/(r>>>0)>>>0;return(k(n|0),i)|0}if(!t){if(i|0){s[i>>2]=0;s[i+4>>2]=(e>>>0)%(n>>>0)}r=0;i=(e>>>0)/(n>>>0)>>>0;return(k(r|0),i)|0}if(!(n-1&n)){if(i|0){s[i>>2]=t|0;s[i+4>>2]=n-1&e|e&0}r=0;i=e>>>((Wt(n|0)|0)>>>0);return(k(r|0),i)|0}o=(w(n|0)|0)-(w(e|0)|0)|0;if(o>>>0<=30){d=o+1|0;u=e<<31-o|t>>>((o+1|0)>>>0);f=e>>>((o+1|0)>>>0);a=0;o=t<<31-o;break}if(!i){n=0;i=0;return(k(n|0),i)|0}s[i>>2]=t|0;s[i+4>>2]=e|e&0;n=0;i=0;return(k(n|0),i)|0}}while(0);if(!d){c=o;e=f;t=0;o=0}else{h=$t(r|0|0,n|n&0|0,-1,-1)|0;l=E()|0;c=o;e=f;t=d;o=0;do{_=c;c=a>>>31|c<<1;a=o|a<<1;_=u<<1|_>>>31|0;p=u>>>31|e<<1|0;Ht(h|0,l|0,_|0,p|0)|0;d=E()|0;f=d>>31|((d|0)<0?-1:0)<<1;o=f&1;u=Ht(_|0,p|0,f&(r|0)|0,(((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1)&(n|n&0)|0)|0;e=E()|0;t=t-1|0}while((t|0)!=0);t=0}if(i|0){s[i>>2]=u;s[i+4>>2]=e}p=(a|0)>>>31|c<<1|(0<<1|a>>>31)&0|t;_=(a<<1|0>>>31)&-2|o;return(k(p|0),_)|0}function Gt(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;return qt(t,e,r,n,0)|0}function Vt(t,e,r){t=t|0;e=e|0;r=r|0;if((r|0)<32){k(e>>>r|0);return t>>>r|(e&(1<<r)-1)<<32-r}k(0);return e>>>r-32|0}function Xt(t,e,r){t=t|0;e=e|0;r=r|0;if((r|0)<32){k(e<<r|(t&(1<<r)-1<<32-r)>>>32-r|0);return t<<r}k(t<<r-32|0);return 0}function Kt(t){t=t|0;return(t&255)<<24|(t>>8&255)<<16|(t>>16&255)<<8|t>>>24|0}function Yt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,a=0,o=0;if((r|0)>=8192){O(t|0,e|0,r|0)|0;return t|0}o=t|0;a=t+r|0;if((t&3)==(e&3)){while(t&3){if(!r)return o|0;n[t>>0]=n[e>>0]|0;t=t+1|0;e=e+1|0;r=r-1|0}r=a&-4|0;i=r-64|0;while((t|0)<=(i|0)){s[t>>2]=s[e>>2];s[t+4>>2]=s[e+4>>2];s[t+8>>2]=s[e+8>>2];s[t+12>>2]=s[e+12>>2];s[t+16>>2]=s[e+16>>2];s[t+20>>2]=s[e+20>>2];s[t+24>>2]=s[e+24>>2];s[t+28>>2]=s[e+28>>2];s[t+32>>2]=s[e+32>>2];s[t+36>>2]=s[e+36>>2];s[t+40>>2]=s[e+40>>2];s[t+44>>2]=s[e+44>>2];s[t+48>>2]=s[e+48>>2];s[t+52>>2]=s[e+52>>2];s[t+56>>2]=s[e+56>>2];s[t+60>>2]=s[e+60>>2];t=t+64|0;e=e+64|0}while((t|0)<(r|0)){s[t>>2]=s[e>>2];t=t+4|0;e=e+4|0}}else{r=a-4|0;while((t|0)<(r|0)){n[t>>0]=n[e>>0]|0;n[t+1>>0]=n[e+1>>0]|0;n[t+2>>0]=n[e+2>>0]|0;n[t+3>>0]=n[e+3>>0]|0;t=t+4|0;e=e+4|0}}while((t|0)<(a|0)){n[t>>0]=n[e>>0]|0;t=t+1|0;e=e+1|0}return o|0}function Jt(t,e,r){t=t|0;e=e|0;r=r|0;var i=0,a=0;i=t+r|0;e=e&255;if((r|0)>=67){while(t&3){n[t>>0]=e;t=t+1|0}a=e|e<<8|e<<16|e<<24;while((t|0)<=((i&-4)-64|0)){s[t>>2]=a;s[t+4>>2]=a;s[t+8>>2]=a;s[t+12>>2]=a;s[t+16>>2]=a;s[t+20>>2]=a;s[t+24>>2]=a;s[t+28>>2]=a;s[t+32>>2]=a;s[t+36>>2]=a;s[t+40>>2]=a;s[t+44>>2]=a;s[t+48>>2]=a;s[t+52>>2]=a;s[t+56>>2]=a;s[t+60>>2]=a;t=t+64|0}while((t|0)<(i&-4|0)){s[t>>2]=a;t=t+4|0}}while((t|0)<(i|0)){n[t>>0]=e;t=t+1|0}return i-r|0}function Qt(t){t=t|0;var e=0,r=0;r=B()|0;e=s[l>>2]|0;if((t|0)>0&(e+t|0)<(e|0)|(e+t|0)<0){F(e+t|0)|0;x(12);return-1}if((e+t|0)>(r|0))if(!(P(e+t|0)|0)){x(12);return-1}s[l>>2]=e+t;return e|0}function Zt(t,e){t=t|0;e=e|0;return ce[t&1](e|0)|0}function te(t,e,r,n,i,s,a){t=t|0;e=e|0;r=+r;n=n|0;i=i|0;s=s|0;a=a|0;return he[t&1](e|0,+r,n|0,i|0,s|0,a|0)|0}function ee(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;return le[t&1](e|0,r|0,n|0)|0}function re(t,e,r,n,i){t=t|0;e=e|0;r=r|0;n=n|0;i=i|0;return fe[t&1](e|0,r|0,n|0,i|0)|0}function ne(t,e,r){t=t|0;e=e|0;r=r|0;de[t&1](e|0,r|0)}function ie(t){t=t|0;A(0);return 0}function se(t,e,r,n,i,s){t=t|0;e=+e;r=r|0;n=n|0;i=i|0;s=s|0;A(1);return 0}function ae(t,e,r){t=t|0;e=e|0;r=r|0;A(2);return 0}function oe(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;A(3);return 0}function ue(t,e){t=t|0;e=e|0;A(4)}var ce=[ie,it];var he=[se,wt];var le=[ae,st];var fe=[oe,at];var de=[ue,At];return{___errno_location:ut,___muldi3:zt,___udivdi3:Gt,_abort_run:Q,_bitshift64Lshr:Vt,_bitshift64Shl:Xt,_enable_debug:Z,_free:Nt,_i64Add:$t,_i64Subtract:Ht,_llvm_bswap_i32:Kt,_malloc:jt,_memcpy:Yt,_memset:Jt,_ping:Y,_read_register:tt,_reset:rt,_run:J,_sbrk:Qt,_set_stop_address:K,_write_register:et,dynCall_ii:Zt,dynCall_iidiiii:te,dynCall_iiii:ee,dynCall_iiiii:re,dynCall_vii:ne,establishStackSpace:X,stackAlloc:q,stackRestore:V,stackSave:G}}(Ot,Pt,S),Dt=(t.___errno_location=Mt.___errno_location,t.___muldi3=Mt.___muldi3,t.___udivdi3=Mt.___udivdi3,t._abort_run=Mt._abort_run,t._bitshift64Lshr=Mt._bitshift64Lshr,t._bitshift64Shl=Mt._bitshift64Shl,t._enable_debug=Mt._enable_debug,t._free=Mt._free,t._i64Add=Mt._i64Add,t._i64Subtract=Mt._i64Subtract,t._llvm_bswap_i32=Mt._llvm_bswap_i32,t._malloc=Mt._malloc,t._memcpy=Mt._memcpy,t._memset=Mt._memset,t._ping=Mt._ping,t._read_register=Mt._read_register,t._reset=Mt._reset,t._run=Mt._run,t._sbrk=Mt._sbrk,t._set_stop_address=Mt._set_stop_address,t._write_register=Mt._write_register,t.establishStackSpace=Mt.establishStackSpace,t.stackAlloc=Mt.stackAlloc),Ft=t.stackRestore=Mt.stackRestore,Lt=t.stackSave=Mt.stackSave;if(t.dynCall_ii=Mt.dynCall_ii,t.dynCall_iidiiii=Mt.dynCall_iidiiii,t.dynCall_iiii=Mt.dynCall_iiii,t.dynCall_iiiii=Mt.dynCall_iiiii,t.dynCall_vii=Mt.dynCall_vii,t.asm=Mt,t.ccall=C,it)if(at(it)||(it=g(it)),o||c){var jt=f(it);I.set(jt,k)}else{rt();var Nt=function(e){e.byteLength&&(e=new Uint8Array(e)),I.set(e,k),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,nt()},Ut=function(){l(it,Nt,(function(){throw"could not load memory initializer "+it}))},zt=It(it);if(zt)Nt(zt.buffer);else if(t.memoryInitializerRequest){var $t=function(){var e=t.memoryInitializerRequest,r=e.response;if(200!==e.status&&0!==e.status){var n=It(t.memoryInitializerRequestURL);if(!n)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+it),void Ut();r=n.buffer}Nt(r)};t.memoryInitializerRequest.response?setTimeout($t,0):t.memoryInitializerRequest.addEventListener("load",$t)}else Ut()}function Ht(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Wt(e){function r(){Bt||(Bt=!0,E||(K(),Y(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),J()))}tt>0||(X(),tt>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),r()}),1)):r()))}function qt(e,r){r&&m&&0===e||(m||(E=!0,t.onExit&&t.onExit(e)),i(e,new Ht(e)))}function Gt(e){throw t.onAbort&&t.onAbort(e),b(e+=""),v(e),E=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(t.then=function(e){if(Bt)e(t);else{var r=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){r&&r(),e(t)}}return t},et=function t(){Bt||Wt(),Bt||(et=t)},t.run=Wt,t.abort=Gt,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return m=!0,Wt(),t});t.exports=n,t.exports=n})),ku=D(ru),Eu=P(M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){void 0===e&&(e={}),this._module=null,this._options=null,this._options=ku.__assign({stopAddress:0},e),this._module=Au(this._getApi(t,this._options)),this.enableDebug(!1)}return t.prototype.init=function(){return ku.__awaiter(this,void 0,void 0,(function(){return ku.__generator(this,(function(t){return this._module._set_stop_address(this._options.stopAddress),[2]}))}))},t.prototype.ping=function(){return this._module.ccall("ping","string",[],[])},t.prototype.run=function(t){return this._module._run(t)},t.prototype.abort=function(){this._module._abort_run()},t.prototype.enableDebug=function(t){this._module._enable_debug(t?1:0)},t.prototype.reset=function(){this._module._reset()},t.prototype.readRegister=function(t){if(t<0||t>15)throw new Error("illegal thumb register "+t);return this._module._read_register(t)},t.prototype.writeRegister=function(t,e){if(t<0||t>15)throw new Error("illegal thumb register "+t);this._module._write_register(t,e)},t.prototype._getApi=function(t,e){var r=e.printer||function(t){return console.log("thumbulator: "+t)};return{print:r,printErr:r,trapOnInstructionFetch:e.trapOnInstructionFetch||function(){return 0},trapOnBx32:e.trapOnBx32||function(){return 3},busRead16:t.read16,busRead32:t.read32||function(e){return 65535&t.read16(e)|t.read16(e+2)<<16},busWrite16:t.write16,busWrite32:t.write32||function(e,r){return t.write16(e,65535&r),t.write16(e+2,r>>>16)}}},t}();e.default=r})));function xu(t,e,r=!0,n=""){if(!r&&t<0)return xu(t>>>16,e&&e>8?e-4:4,!1,n)+xu(65535&t,4);let i=Math.abs(t).toString(16).toUpperCase();if(void 0!==e)for(;i.length<e;)i="0"+i;return(t<0?"-":"")+n+i}function Tu(t,e,r=!0){return xu(t,e,r,"$")}class Cu{constructor(t=(()=>3)){this.trap=new No,this._thumbulatorBus={read16:t=>{if(1&t)return this._triggerTrap("unaligned 16 bit ARM read from "+Tu(t,8,!1)),0;const e=268435455&t;switch(t>>>28){case 0:if(e<32768)return this.getRom16(e);break;case 4:if(e<8192)return this.getRam16(e);break;case 14:switch(e){case 2080768:return this._armMamcr}}this._triggerTrap("invalid 16 bit ARM read from "+Tu(t,8,!1))},read32:t=>{if(3&t)return this._triggerTrap("unaligned 32 bit ARM read from "+Tu(t,8,!1)),0;const e=268435455&t;switch(t>>>28){case 0:if(e<32768)return this.getRom32(e);break;case 4:if(e<8192)return this.getRam32(e);break;case 14:switch(e){case 32772:case 32776:return 0}}this._triggerTrap("invalid 32 bit ARM read from "+Tu(t,8,!1))},write16:(t,e)=>{if(1&t)return void this._triggerTrap(`unaligned 16 bit ARM write: ${Tu(e,4)} -> ${Tu(t,8,!1)}`);const r=268435455&t;switch(t>>>28){case 4:if(r<8192)return void this.setRam16(r,65535&e);break;case 14:switch(r){case 2080768:return void(this._armMamcr=e)}}this._triggerTrap(`invalid 16 bit ARM write: ${Tu(e,4)} -> ${Tu(t,8,!1)}`)},write32:(t,e)=>{if(3&t)return void this._triggerTrap(`unaligned 32 bit ARM write: ${Tu(e,8,!1)} -> ${Tu(t,8,!1)}`);const r=268435455&t;switch(t>>>28){case 4:if(r<8192)return void this.setRam32(r,e);case 14:switch(r){case 32772:case 32776:return}}this._triggerTrap(`invalid 32 bit ARM write: ${Tu(e,8,!1)} -> ${Tu(t,8,!1)}`)}},this._romBuffer=new ArrayBuffer(32768),this._ramBuffer=new ArrayBuffer(8192),this._armMamcr=0,this._thumbulator=null,!function(){const t=new Uint8Array([1,2,3,4]);return 67305985===new Uint32Array(t.buffer)[0]}()?(this.getRom16=t=>this._rom8[t]|this._rom8[t+1]<<8,this.getRom32=t=>this._rom8[t]|this._rom8[t+1]<<8|this._rom8[t+2]<<16|this._rom8[t+3]<<24,this.getRam16=t=>this._ram8[t]|this._ram8[t+1]<<8,this.getRam32=t=>this._ram8[t]|this._ram8[t+1]<<8|this._ram8[t+2]<<16|this._ram8[t+3]<<24,this.setRam16=(t,e)=>{this._ram8[t]=255&e,this._ram8[t+1]=e>>>8&255},this.setRam32=(t,e)=>{this._ram8[t]=255&e,this._ram8[t+1]=e>>>8&255,this._ram8[t+2]=e>>>16&255,this._ram8[t+3]=e>>>24&255}):(this.getRom16=t=>this._rom16[t>>>1],this.getRom32=t=>this._rom32[t>>>2],this.getRam16=t=>this._ram16[t>>>1],this.getRam32=t=>this._ram32[t>>>2],this.setRam16=(t,e)=>this._ram16[t>>>1]=e,this.setRam32=(t,e)=>this._ram32[t>>>2]=e),this._rom8=new Uint8Array(this._romBuffer),this._rom16=new Uint16Array(this._romBuffer),this._rom32=new Uint32Array(this._romBuffer),this._ram8=new Uint8Array(this._ramBuffer),this._ram16=new Uint16Array(this._ramBuffer),this._ram32=new Uint32Array(this._ramBuffer),this._thumbulator=new Eu(this._thumbulatorBus,{stopAddress:32772,trapOnBx32:t}),this.reset()}init(){return this._thumbulator.init()}reset(){}getRom(){return this._rom8}getRam(){return this._ram8}run(t){this._thumbulator.reset(),this._thumbulator.enableDebug(!1);for(let t=0;t<=12;t++)this._thumbulator.writeRegister(t,0);this._thumbulator.writeRegister(13,1073749940),this._thumbulator.writeRegister(14,32773),this._thumbulator.writeRegister(15,t),this._armMamcr=0;const e=this._thumbulator.run(5e5);20!==e&&10!==e&&this._triggerTrap("ARM execution trapped: "+e)}getThumbulator(){return this._thumbulator}_triggerTrap(t){this._thumbulator.abort(),this.trap.dispatch(t)}}class Su extends Uo{constructor(t){if(super(),this._banks=new Array(6),this._fetchers=new Array(8),this._fractionalFetchers=new Array(8),this._musicFetchers=new Array(3),this._parameters=new Uint8Array(8),this._parameterIndex=0,this._rng=0,this._clockAccumulator=0,this._lastCpuTime=0,this._fastFetch=!1,this._ldaPending=!1,this._cpuTimeProvider=null,this._soc=new Cu,t.length<28672||t.length>32768)throw new Error("not a DPC+ image: invalid lenght "+t.length);this._rom=this._soc.getRom();for(let t=0;t<6;t++)this._banks[t]=new Uint8Array(this._rom.buffer,3072+4096*t,4096);this._ram=this._soc.getRam(),this._imageRam=new Uint8Array(this._ram.buffer,3072,4096);const e=32768-t.length;for(let r=0;r<t.length;r++)this._rom[e+r]=t[r];for(let t=0;t<8;t++)this._fetchers[t]=new Ru,this._fractionalFetchers[t]=new Iu;for(let t=0;t<3;t++)this._musicFetchers[t]=new Bu;this._soc.trap.addHandler(t=>this.triggerTrap(2,t)),this.reset()}static matchesBuffer(t){return 2===zo(t,["DPC+".split("").map(t=>t.charCodeAt(0))])[0]}init(){return this._soc.init()}reset(){this._soc.reset(),this._currentBank=this._banks[5];for(let t=0;t<768;t++)this._soc.setRam32(t<<2,this._soc.getRom32(t<<2));for(let t=6912;t<8192;t++)this._soc.setRam32(768+t-6912<<2,this._soc.getRom32(t<<2));this._currentBank=this._banks[5];for(let t=0;t<8;t++)this._parameters[t]=0;for(let t=0;t<8;t++)this._fetchers[t].reset(),this._fractionalFetchers[t].reset();for(let t=0;t<3;t++)this._musicFetchers[t].reset();this._parameterIndex=0,this._fastFetch=this._ldaPending=!1,this._rng=725831748,this._lastCpuTime=0,this._clockAccumulator=0}getType(){return ct.CartridgeType.bankswitch_dpc_plus}setBus(t){return this._bus=t,this}setCpuTimeProvider(t){return this._cpuTimeProvider=t,this}read(t){return this._access(t,this._bus.getLastDataBusValue())}peek(t){return this._currentBank[4095&t]}write(t,e){this._access(t,e)}triggerTrap(t,e){super.triggerTrap(t,e)}_access(t,e){t&=4095;const r=this._currentBank[t];if(this._fastFetch&&this._ldaPending&&t>127&&t<4086&&r<40&&(t=r),this._ldaPending=!1,t<40){const e=7&t,r=this._fetchers[e],n=this._fractionalFetchers[e];let i=0;switch(t>>>3&7){case 0:switch(e){case 0:return this._advanceRng(),255&this._rng;case 1:return this._rewindRng(),255&this._rng;case 2:return this._rng>>>8&255;case 3:return this._rng>>>16&255;case 4:return this._rng>>>24&255;case 5:{this._clockMusicFetchers();let t=0;for(let e=0;e<3;e++)t+=this._imageRam[(this._musicFetchers[e].waveform<<5)+this._musicFetchers[e].waveformSample()];return 255&t}}return 0;case 1:return i=this._imageRam[r.pointer],r.increment(),i;case 2:return i=this._imageRam[r.pointer]&r.mask(),r.increment(),i;case 3:return i=this._imageRam[n.pointer>>>8],n.increment(),i;case 4:return e<4?r.mask():0;default:return 0}}else if(t<128){const r=7&t,n=this._fetchers[r],i=this._fractionalFetchers[r];switch(t-40>>>3&15){case 0:i.setPointerLo(e);break;case 1:i.setPointerHi(e);break;case 2:i.setFraction(e);break;case 3:n.top=e;break;case 4:n.bottom=e;break;case 5:n.setPointerLo(e);break;case 6:switch(r){case 0:this._fastFetch=0===e;break;case 1:this._parameterIndex<8&&(this._parameters[this._parameterIndex++]=e);break;case 2:this._dispatchFunction(e);break;case 5:case 6:case 7:this._musicFetchers[r-5].waveform=127&e}break;case 7:n.decrement(),this._imageRam[n.pointer]=e;break;case 8:n.setPointerHi(e);break;case 9:switch(r){case 0:this._rng=725831748;break;case 1:this._rng=4294967040&this._rng|e;break;case 2:this._rng=4294902015&this._rng|e<<8;break;case 3:this._rng=4278255615&this._rng|e<<16;break;case 4:this._rng=16777215&this._rng|e<<24;break;case 5:case 6:case 7:this._musicFetchers[r-5].frequency=this._soc.getRam32(7168+(e<<2))}break;case 10:this._imageRam[n.pointer]=e,n.increment()}}else t>4085&&t<4092&&(this._currentBank=this._banks[t-4086]);return this._fastFetch&&t>127&&t<4086&&(this._ldaPending=169===r),r}_clockMusicFetchers(){const t=this._cpuTimeProvider();this._clockAccumulator+=2e4*(t-this._lastCpuTime),this._lastCpuTime=t;const e=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=e,0!==e)for(let t=0;t<3;t++)this._musicFetchers[t].increment(e)}_dispatchFunction(t){const e=this._parameters[0]+(this._parameters[1]<<8);switch(t){case 0:this._parameterIndex=0;break;case 1:for(let t=0;t<this._parameters[3];t++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+t&4095)]=this._rom[3072+(e+t)%29696];this._parameterIndex=0;break;case 2:for(let t=0;t<this._parameters[3];t++)this._ram[3072+(this._fetchers[7&this._parameters[2]].pointer+t&4095)]=this._parameters[0];this._parameterIndex=0;break;case 254:case 255:this._soc.run(3083)}}_advanceRng(){this._rng=(1024&this._rng?279816990:0)^(this._rng>>>11|this._rng<<21)}_rewindRng(){this._rng=this._rng&1<<31?(279816990^this._rng)<<11|(279816990^this._rng)>>>21:this._rng<<11|this._rng>>>21}}class Ru{constructor(){this.pointer=0,this.top=0,this.bottom=0}contructor(){this.reset()}reset(){this.pointer=this.top=this.bottom=0}setPointerHi(t){this.pointer=255&this.pointer|(15&t)<<8}setPointerLo(t){this.pointer=3840&this.pointer|255&t}increment(){this.pointer=this.pointer+1&4095}decrement(){this.pointer=this.pointer+4095&4095}mask(){return(this.top-(255&this.pointer)&255)>(this.top-this.bottom&255)?255:0}}class Iu{constructor(){this.pointer=0,this.fraction=0}contructor(){this.reset()}reset(){this.pointer=this.fraction=0}setPointerHi(t){this.pointer=65535&this.pointer|(15&t)<<16}setPointerLo(t){this.pointer=983295&this.pointer|(255&t)<<8}setFraction(t){this.fraction=t,this.pointer&=1048320}increment(){this.pointer=this.pointer+this.fraction&1048575}}class Bu{constructor(){this.frequency=-1,this.counter=-1,this.waveform=0,this.reset()}reset(){this.frequency=0,this.waveform=0,this.counter=0}increment(t){this.counter=this.counter+t*this.frequency|0}waveformSample(){return this.counter>>>27}}class Ou extends Uo{constructor(t){super(),this._handleBxCDF0=t=>{const e=this._soc.getThumbulator(),r=e.readRegister(2),n=e.readRegister(3);switch(t){case 1762:return this._musicStreams[r%3].frequency=n,0;case 1766:return this._musicStreams[r%3].counter=0,0;case 1770:return e.writeRegister(2,this._musicStreams[r%3].counter),0;case 1774:return this._musicStreams[r%3].waveformSize=n,0}return 3},this._handleBxCDF1=t=>{const e=this._soc.getThumbulator(),r=e.readRegister(2),n=e.readRegister(3);switch(t){case 1874:return this._musicStreams[r%3].frequency=n,0;case 1878:return this._musicStreams[r%3].counter=0,0;case 1882:return e.writeRegister(2,this._musicStreams[r%3].counter),0;case 1886:return this._musicStreams[r%3].waveformSize=n,0}return 3},this._banks=new Array(7),this._currentBank=null,this._rom=null,this._ram=null,this._displayRam=null,this._musicStreams=new Array(3),this._clockAccumulator=0,this._lastCpuTime=0,this._soc=null,this._fastFetch=!1,this._digitalAudio=!1,this._fastJumpCountdown=0,this._fastFetchPending=!1,this._jmpOperandAddress=0,this._ldaOperandAddress=0,this._datastreamBase=0,this._datastreamIncrementBase=0,this._waveformBase=0,this._jumpstream=0,this._jumpstreamMask=0,this._amplitudeStream=0,this._bus=null,this._cpuTimeProvider=null;const e=Ou.getVersion(t);switch(e){case 0:this._jumpstreamMask=255,this._amplitudeStream=34,this._datastreamBase=1760,this._datastreamIncrementBase=1896,this._waveformBase=2032;break;case 1:this._jumpstreamMask=255,this._amplitudeStream=34,this._datastreamBase=160,this._datastreamIncrementBase=296,this._waveformBase=432;break;case 2:this._jumpstreamMask=254,this._amplitudeStream=35,this._datastreamBase=152,this._datastreamIncrementBase=292,this._waveformBase=432;break;default:throw new Error("not a CDF image: missing signature")}if(32768!==t.length)throw new Error("not a CDF image: invalid lenght "+t.length);this._soc=new Cu(0===e?this._handleBxCDF0:this._handleBxCDF1),this._soc.trap.addHandler(t=>this.triggerTrap(2,t)),this._rom=this._soc.getRom();for(let e=0;e<32768;e++)this._rom[e]=t[e];for(let t=0;t<7;t++)this._banks[t]=new Uint8Array(this._rom.buffer,4096*(t+1),4096);this._ram=this._soc.getRam(),this._displayRam=new Uint8Array(this._soc.getRam().buffer,2048,4096);for(let t=0;t<3;t++)this._musicStreams[t]=new Pu;this.reset()}static getVersion(t){const e="CDF".split("").map(t=>t.charCodeAt(0)),r=function(t,e){for(let r=0;r<t.length;r++){let n;for(n=0;n<e.length&&(t[r+n]===e[n]||e[n]<0);n++);if(n===e.length)return r}return-1}(t,[...e,-1,...e,-1,...e]);if(r<0)return 3;switch(t[r+3]){case 0:return 0;case 1:return 1;case"J".charCodeAt(0):return 2;default:return 3}}static matchesBuffer(t){return 3!==Ou.getVersion(t)}init(){return this._soc.init()}reset(){for(let t=0;t<512;t++)this._soc.setRam32(t<<2,this._soc.getRom32(t<<2));this._fastFetch=!1,this._digitalAudio=!1,this._fastJumpCountdown=0,this._fastFetchPending=!1,this._jmpOperandAddress=0,this._ldaOperandAddress=0,this._currentBank=this._banks[6];for(let t=0;t<3;t++)this._musicStreams[t].reset();this._lastCpuTime=0,this._clockAccumulator=0}getType(){return ct.CartridgeType.bankswitch_cdf}setBus(t){return this._bus=t,this}setCpuTimeProvider(t){return this._cpuTimeProvider=t,this}read(t){return this._access(t,this._bus.getLastDataBusValue())}peek(t){return this._currentBank[4095&t]}write(t,e){this._access(t,e)}_access(t,e){t&=4095;const r=this._currentBank[t];if(this._fastJumpCountdown-- >0&&t===this._jmpOperandAddress)return this._jmpOperandAddress++,this._datastreamReadWithIncrement(this._jumpstream,256);if(this._fastFetch&&76===r&&0==(this._currentBank[t+1&4095]&this._jumpstreamMask)&&0===this._currentBank[t+2&4095])return this._fastJumpCountdown=2,this._jmpOperandAddress=t+1&4095,this._jumpstream=33+this._currentBank[t+1&4095],r;if(this._fastJumpCountdown=0,this._fastFetch&&this._fastFetchPending&&this._ldaOperandAddress===t&&r<=this._amplitudeStream){if(this._fastFetchPending=!1,r===this._amplitudeStream){if(this._clockMusicStreams(),this._digitalAudio){const t=this._musicStreams[0].counter,e=this._soc.getRam32(this._waveformBase)+(t>>>21);let r=0;return e<32768&&(r=this._rom[e]),e>1073741824&&e<1073750016&&(r=this._ram[e-1073741824]),0==(1048576&t)&&(r>>>=4),15&r}{let t=0;for(let e=0;e<3;e++)t+=this._displayRam[this._getWaveform(e)+(this._musicStreams[e].counter>>>this._musicStreams[e].waveformSize)&4095];return t}}return this._datastreamRead(r)}if(this._fastFetchPending=!1,t>=4080){switch(t){case 4080:this._datastreamWriteWithIncrement(32,e,256);break;case 4081:{let t=this._getDatastreamPointer(32);t<<=8,t&=4026531840,t|=e<<20,this._setDatastreamPointer(32,t);break}case 4082:this._fastFetch=0==(15&e),this._digitalAudio=0==(240&e);break;case 4083:switch(e){case 254:case 255:this._soc.run(2059)}}t>4084&&t<4092&&(this._currentBank=this._banks[t-4085])}return this._fastFetch&&169===r&&(this._fastFetchPending=!0,this._ldaOperandAddress=t+1&4095),r}_clockMusicStreams(){const t=this._cpuTimeProvider();this._clockAccumulator+=2e4*(t-this._lastCpuTime),this._lastCpuTime=t;const e=Math.floor(this._clockAccumulator);if(this._clockAccumulator-=e,0!==e)for(let t=0;t<3;t++)this._musicStreams[t].increment(e)}_getDatastreamPointer(t){return this._soc.getRam32(this._datastreamBase+4*t)}_setDatastreamPointer(t,e){this._soc.setRam32(this._datastreamBase+4*t,e)}_getDatastreamIncrement(t){return this._soc.getRam32(this._datastreamIncrementBase+4*t)}_datastreamRead(t){const e=this._getDatastreamPointer(t),r=this._displayRam[e>>>20];return this._setDatastreamPointer(t,e+(this._getDatastreamIncrement(t)<<12)|0),r}_datastreamReadWithIncrement(t,e){const r=this._getDatastreamPointer(t),n=this._displayRam[r>>>20];return this._setDatastreamPointer(t,r+(e<<12)|0),n}_datastreamWriteWithIncrement(t,e,r){const n=this._getDatastreamPointer(t);this._displayRam[n>>>20]=e,this._setDatastreamPointer(t,n+(r<<12)|0)}_getWaveform(t){return this._soc.getRam32(this._waveformBase+4*t)-1073741824-2048&4095}}class Pu{constructor(){this.counter=0,this.frequency=0,this.waveformSize=27}reset(){this.counter=this.frequency=0,this.waveformSize=27}increment(t){this.counter=this.counter+t*this.frequency|0}}class Mu extends Uo{constructor(t){if(super(),this._bank=null,this._bank0=new Uint8Array(4096),this._bank1=new Uint8Array(4096),this._bus=null,8192!==t.length)throw new Error("buffer is not an 8k cartridge image: wrong length "+t.length);for(let e=0;e<4096;e++)this._bank0[e]=t[e],this._bank1[e]=t[4096+e];this.reset()}static matchesBuffer(t){const e=zo(t,[[173,0,8],[173,64,8],[44,0,8],[12,0,8,76],[12,255,15,76]]);for(const t of e)if(t>=2)return!0;return!1}reset(){this._bank=this._bank0}read(t){return this.peek(t)}peek(t){return t&=4095,this._bank[t]}getType(){return ct.CartridgeType.bankswitch_8k_econobanking}setBus(t){return this._bus=t,this._bus.event.read.addHandler(this._onBusAccess,this),this._bus.event.write.addHandler(this._onBusAccess,this),this}_onBusAccess(t,e){switch(6208&e._bus.getLastAddresBusValue()){case 2048:e._bank=e._bank0;break;case 2112:e._bank=e._bank1}}}class Du extends Uo{constructor(t){if(super(),this._rom=new Uint8Array(2048),this._ram=new Uint8Array(1024),2048!==t.length)throw new Error("buffer is not a 2k cartridge image: wrong length "+t.length);for(let e=0;e<2048;e++)this._rom[e]=t[e]}static matchesBuffer(t){const e=zo(t,[[157,255,243],[153,0,244]]);return e[0]>0||e[1]>0}setBus(t){return this._bus=t,this}randomize(t){for(let e=0;e<1024;e++)this._ram[e]=t.int(255)}read(t){return(t&=4095)<1024?this._ram[t]:t<2048?this._ram[1023&t]=this._bus.getLastDataBusValue():this._rom[2047&t]}write(t,e){(t&=4095)>=1024&&t<2048&&(this._ram[1023&t]=e)}peek(t){return(t&=4095)<1024?this._ram[t]:t<2048?0:this._rom[2047&t]}getType(){return ct.CartridgeType.bankswitch_2k_cv}}class Fu{detectCartridgeType(t){if(t.length%8448==0)return ct.CartridgeType.bankswitch_supercharger;if(t.length<2048)return ct.CartridgeType.vanilla_2k;if(t.length>=10240&&t.length<=10496)return ct.CartridgeType.bankswitch_8k_DPC;switch(t.length){case 2048:return this._detect2k(t);case 4096:return ct.CartridgeType.vanilla_4k;case 8192:return this._detect8k(t);case 8195:return ct.CartridgeType.bankswitch_8k_pp;case 12288:return ct.CartridgeType.bankswitch_12k_FA;case 16384:return this._detect16k(t);case 28672:return ct.CartridgeType.bankswitch_FA2;case 29696:return this._detect29k(t);case 32768:return this._detect32k(t);case 65536:return this._detect64k(t);default:return ct.CartridgeType.unknown}}_detect2k(t){return Du.matchesBuffer(t)?ct.CartridgeType.bankswitch_2k_cv:ct.CartridgeType.vanilla_2k}_detect8k(t){const e=$o.matchesBuffer(t);return Ho.matchesBuffer(t)?ct.CartridgeType.bankswitch_8k_E0:Wo.matchesBuffer(t)?ct.CartridgeType.bankswitch_8k_3F:Vo.matchesBuffer(t)?ct.CartridgeType.bankswitch_8k_UA:!e&&Go.matchesBuffer(t)?ct.CartridgeType.bankswitch_8k_FE:Mu.matchesBuffer(t)?ct.CartridgeType.bankswitch_8k_econobanking:ct.CartridgeType.bankswitch_8k_F8}_detect16k(t){return Xo.matchesBuffer(t)?ct.CartridgeType.bankswitch_16k_E7:ct.CartridgeType.bankswitch_16k_F6}_detect29k(t){return Ko.matchesBuffer(t)?ct.CartridgeType.bankswitch_FA2:ct.CartridgeType.bankswitch_dpc_plus}_detect32k(t){return qo.matchesBuffer(t)?ct.CartridgeType.bankswitch_3E:Su.matchesBuffer(t)?ct.CartridgeType.bankswitch_dpc_plus:Ou.matchesBuffer(t)?ct.CartridgeType.bankswitch_cdf:ct.CartridgeType.bankswitch_32k_F4}_detect64k(t){return Yo.matchesBuffer(t)?ct.CartridgeType.bankswitch_64k_EF:ct.CartridgeType.bankswitch_64k_F0}}var Lu=function(){return(Lu=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function ju(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}var Nu=Object.keys,Uu=Array.isArray,zu="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function $u(t,e){return"object"!=typeof e||Nu(e).forEach((function(r){t[r]=e[r]})),t}"undefined"==typeof Promise||zu.Promise||(zu.Promise=Promise);var Hu=Object.getPrototypeOf,Wu={}.hasOwnProperty;function qu(t,e){return Wu.call(t,e)}function Gu(t,e){"function"==typeof e&&(e=e(Hu(t))),Nu(e).forEach((function(r){Xu(t,r,e[r])}))}var Vu=Object.defineProperty;function Xu(t,e,r,n){Vu(t,e,$u(r&&qu(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Ku(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Xu(t.prototype,"constructor",t),{extend:Gu.bind(null,t.prototype)}}}}var Yu=Object.getOwnPropertyDescriptor;function Ju(t,e){var r;return Yu(t,e)||(r=Hu(t))&&Ju(r,e)}var Qu=[].slice;function Zu(t,e,r){return Qu.call(t,e,r)}function tc(t,e){return e(t)}function ec(t){if(!t)throw new Error("Assertion Failed")}function rc(t){zu.setImmediate?setImmediate(t):setTimeout(t,0)}function nc(t,e){return t.reduce((function(t,r,n){var i=e(r,n);return i&&(t[i[0]]=i[1]),t}),{})}function ic(t,e){if(qu(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var r=[],n=0,i=e.length;n<i;++n){var s=ic(t,e[n]);r.push(s)}return r}var a=e.indexOf(".");if(-1!==a){var o=t[e.substr(0,a)];return void 0===o?void 0:ic(o,e.substr(a+1))}}function sc(t,e,r){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){ec("string"!=typeof r&&"length"in r);for(var n=0,i=e.length;n<i;++n)sc(t,e[n],r[n])}else{var s=e.indexOf(".");if(-1!==s){var a=e.substr(0,s),o=e.substr(s+1);if(""===o)void 0===r?Uu(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=r;else{var u=t[a];u||(u=t[a]={}),sc(u,o,r)}}else void 0===r?Uu(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function ac(t){var e={};for(var r in t)qu(t,r)&&(e[r]=t[r]);return e}var oc=[].concat;function uc(t){return oc.apply([],t)}var cc="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(uc([8,16,32,64].map((function(t){return["Int","Uint","Float"].map((function(e){return e+t+"Array"}))})))).filter((function(t){return zu[t]})),hc=cc.map((function(t){return zu[t]})),lc=nc(cc,(function(t){return[t,!0]}));function fc(t){if(!t||"object"!=typeof t)return t;var e;if(Uu(t)){e=[];for(var r=0,n=t.length;r<n;++r)e.push(fc(t[r]))}else if(hc.indexOf(t.constructor)>=0)e=t;else for(var i in e=t.constructor?Object.create(t.constructor.prototype):{},t)qu(t,i)&&(e[i]=fc(t[i]));return e}var dc={}.toString;function pc(t){return dc.call(t).slice(8,-1)}var _c=function(t,e){return"Array"===e?""+t.map((function(t){return _c(t,pc(t))})):"ArrayBuffer"===e?""+new Uint8Array(t):"Date"===e?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function gc(t,e,r,n){return r=r||{},n=n||"",Nu(t).forEach((function(i){if(qu(e,i)){var s=t[i],a=e[i];if("object"==typeof s&&"object"==typeof a&&s&&a){var o=pc(s),u=pc(a);o===u?lc[o]?_c(s,o)!==_c(a,u)&&(r[n+i]=e[i]):gc(s,a,r,n+i+"."):r[n+i]=e[i]}else s!==a&&(r[n+i]=e[i])}else r[n+i]=void 0})),Nu(e).forEach((function(i){qu(t,i)||(r[n+i]=e[i])})),r}var bc="undefined"!=typeof Symbol&&Symbol.iterator,vc=bc?function(t){var e;return null!=t&&(e=t[bc])&&e.apply(t)}:function(){return null},mc={};function yc(t){var e,r,n,i;if(1===arguments.length){if(Uu(t))return t.slice();if(this===mc&&"string"==typeof t)return[t];if(i=vc(t)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==t)return[t];if("number"==typeof(e=t.length)){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var wc="undefined"!=typeof Symbol?function(t){return"AsyncFunction"===t[Symbol.toStringTag]}:function(){return!1},Ac="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kc(t,e){Ac=t,Ec=e}var Ec=function(){return!0},xc=!new Error("").stack;function Tc(){if(xc)try{throw new Error}catch(t){return t}return new Error}function Cc(t,e){var r=t.stack;return r?(e=e||0,0===r.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),r.split("\n").slice(e).filter(Ec).map((function(t){return"\n"+t})).join("")):""}var Sc=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Rc=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Sc),Ic={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Bc(t,e){this._e=Tc(),this.name=t,this.message=e}function Oc(t,e){return t+". Errors: "+Object.keys(e).map((function(t){return e[t].toString()})).filter((function(t,e,r){return r.indexOf(t)===e})).join("\n")}function Pc(t,e,r,n){this._e=Tc(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=Oc(t,e)}function Mc(t,e){this._e=Tc(),this.name="BulkError",this.failures=e,this.message=Oc(t,e)}Ku(Bc).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Cc(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Ku(Pc).from(Bc),Ku(Mc).from(Bc);var Dc=Rc.reduce((function(t,e){return t[e]=e+"Error",t}),{}),Fc=Bc,Lc=Rc.reduce((function(t,e){var r=e+"Error";function n(t,n){this._e=Tc(),this.name=r,t?"string"==typeof t?(this.message=t+(n?"\n "+n:""),this.inner=n||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=Ic[e]||r,this.inner=null)}return Ku(n).from(Fc),t[e]=n,t}),{});Lc.Syntax=SyntaxError,Lc.Type=TypeError,Lc.Range=RangeError;var jc=Sc.reduce((function(t,e){return t[e+"Error"]=Lc[e],t}),{});var Nc=Rc.reduce((function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=Lc[e]),t}),{});function Uc(){}function zc(t){return t}function $c(t,e){return null==t||t===zc?e:function(r){return e(t(r))}}function Hc(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Wc(t,e){return t===Uc?e:function(){var r=t.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Hc(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Hc(i,this.onerror):i),void 0!==s?s:r}}function qc(t,e){return t===Uc?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Hc(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Hc(n,this.onerror):n)}}function Gc(t,e){return t===Uc?e:function(r){var n=t.apply(this,arguments);$u(r,n);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Hc(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Hc(s,this.onerror):s),void 0===n?void 0===a?void 0:a:$u(n,a)}}function Vc(t,e){return t===Uc?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function Xc(t,e){return t===Uc?e:function(){var r=t.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return r.then((function(){return e.apply(n,s)}))}return e.apply(this,arguments)}}Nc.ModifyError=Pc,Nc.DexieError=Bc,Nc.BulkError=Mc;var Kc={},Yc="undefined"==typeof Promise?[]:function(){var t=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[t,t.__proto__,t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,e.__proto__,t]}(),Jc=Yc[0],Qc=Yc[1],Zc=Yc[2],th=Qc&&Qc.then,eh=Jc&&Jc.constructor,rh=!!Zc,nh=!1,ih=Zc?function(){Zc.then(Ch)}:zu.setImmediate?setImmediate.bind(null,Ch):zu.MutationObserver?function(){var t=document.createElement("div");new MutationObserver((function(){Ch(),t=null})).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Ch,0)},sh=function(t,e){ph.push([t,e]),oh&&(ih(),oh=!1)},ah=!0,oh=!0,uh=[],ch=[],hh=null,lh=zc,fh={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Jh,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(t){try{Jh(t[0],t[1])}catch(t){}}))}},dh=fh,ph=[],_h=0,gh=[];function bh(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Uc,this._lib=!1;var e=this._PSD=dh;if(Ac&&(this._stackHolder=Tc(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==Kc)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&wh(this,this._value))}this._state=null,this._value=null,++e.ref,yh(this,t)}var vh={get:function(){var t=dh,e=Lh;function r(r,n){var i=this,s=!t.global&&(t!==dh||e!==Lh);s&&zh();var a=new bh((function(e,a){kh(i,new mh(Xh(r,t,s),Xh(n,t,s),e,a,t))}));return Ac&&Th(a,this),a}return r.prototype=Kc,r},set:function(t){Xu(this,"then",t&&t.prototype===Kc?vh:{get:function(){return t},set:vh.set})}};function mh(t,e,r,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=r,this.reject=n,this.psd=i}function yh(t,e){try{e((function(e){if(null===t._state){if(e===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Sh();e&&"function"==typeof e.then?yh(t,(function(t,r){e instanceof bh?e._then(t,r):e.then(t,r)})):(t._state=!0,t._value=e,Ah(t)),r&&Rh()}}),wh.bind(null,t))}catch(e){wh(t,e)}}function wh(t,e){if(ch.push(e),null===t._state){var r=t._lib&&Sh();e=lh(e),t._state=!1,t._value=e,Ac&&null!==e&&"object"==typeof e&&!e._promise&&function(t,e,r){try{t.apply(null,r)}catch(t){e&&e(t)}}((function(){var r=Ju(e,"stack");e._promise=t,Xu(e,"stack",{get:function(){return nh?r&&(r.get?r.get.apply(e):r.value):t.stack}})})),function(t){uh.some((function(e){return e._value===t._value}))||uh.push(t)}(t),Ah(t),r&&Rh()}}function Ah(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)kh(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),0===_h&&(++_h,sh((function(){0==--_h&&Ih()}),[]))}function kh(t,e){if(null!==t._state){var r=t._state?e.onFulfilled:e.onRejected;if(null===r)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++_h,sh(Eh,[r,t,e])}else t._listeners.push(e)}function Eh(t,e,r){try{hh=e;var n,i=e._value;e._state?n=t(i):(ch.length&&(ch=[]),n=t(i),-1===ch.indexOf(i)&&function(t){var e=uh.length;for(;e;)if(uh[--e]._value===t._value)return void uh.splice(e,1)}(e)),r.resolve(n)}catch(t){r.reject(t)}finally{hh=null,0==--_h&&Ih(),--r.psd.ref||r.psd.finalize()}}function xh(t,e,r){if(e.length===r)return e;var n="";if(!1===t._state){var i,s,a=t._value;null!=a?(i=a.name||"Error",s=a.message||a,n=Cc(a,0)):(i=a,s=""),e.push(i+(s?": "+s:"")+n)}return Ac&&((n=Cc(t._stackHolder,2))&&-1===e.indexOf(n)&&e.push(n),t._prev&&xh(t._prev,e,r)),e}function Th(t,e){var r=e?e._numPrev+1:0;r<100&&(t._prev=e,t._numPrev=r)}function Ch(){Sh()&&Rh()}function Sh(){var t=ah;return ah=!1,oh=!1,t}function Rh(){var t,e,r;do{for(;ph.length>0;)for(t=ph,ph=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}}while(ph.length>0);ah=!0,oh=!0}function Ih(){var t=uh;uh=[],t.forEach((function(t){t._PSD.onunhandled.call(null,t._value,t)}));for(var e=gh.slice(0),r=e.length;r;)e[--r]()}function Bh(t){return new bh(Kc,!1,t)}function Oh(t,e){var r=dh;return function(){var n=Sh(),i=dh;try{return qh(r,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{qh(i,!1),n&&Rh()}}}Gu(bh.prototype,{then:vh,_then:function(t,e){kh(this,new mh(null,null,t,e,dh))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],r=arguments[1];return"function"==typeof e?this.then(null,(function(t){return t instanceof e?r(t):Bh(t)})):this.then(null,(function(t){return t&&t.name===e?r(t):Bh(t)}))},finally:function(t){return this.then((function(e){return t(),e}),(function(e){return t(),Bh(e)}))},stack:{get:function(){if(this._stack)return this._stack;try{nh=!0;var t=xh(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{nh=!1}}},timeout:function(t,e){var r=this;return t<1/0?new bh((function(n,i){var s=setTimeout((function(){return i(new Lc.Timeout(e))}),t);r.then(n,i).finally(clearTimeout.bind(null,s))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Xu(bh.prototype,Symbol.toStringTag,"Dexie.Promise"),fh.env=Gh(),Gu(bh,{all:function(){var t=yc.apply(null,arguments).map($h);return new bh((function(e,r){0===t.length&&e([]);var n=t.length;t.forEach((function(i,s){return bh.resolve(i).then((function(r){t[s]=r,--n||e(t)}),r)}))}))},resolve:function(t){if(t instanceof bh)return t;if(t&&"function"==typeof t.then)return new bh((function(e,r){t.then(e,r)}));var e=new bh(Kc,!0,t);return Th(e,hh),e},reject:Bh,race:function(){var t=yc.apply(null,arguments).map($h);return new bh((function(e,r){t.map((function(t){return bh.resolve(t).then(e,r)}))}))},PSD:{get:function(){return dh},set:function(t){return dh=t}},newPSD:Nh,usePSD:Vh,scheduler:{get:function(){return sh},set:function(t){sh=t}},rejectionMapper:{get:function(){return lh},set:function(t){lh=t}},follow:function(t,e){return new bh((function(r,n){return Nh((function(e,r){var n=dh;n.unhandleds=[],n.onunhandled=r,n.finalize=Hc((function(){var t=this;!function(t){function e(){t(),gh.splice(gh.indexOf(e),1)}gh.push(e),++_h,sh((function(){0==--_h&&Ih()}),[])}((function(){0===t.unhandleds.length?e():r(t.unhandleds[0])}))}),n.finalize),t()}),e,r,n)}))}}),eh&&(eh.allSettled&&Xu(bh,"allSettled",(function(){var t=yc.apply(null,arguments).map($h);return new bh((function(e){0===t.length&&e([]);var r=t.length,n=new Array(r);t.forEach((function(t,i){return bh.resolve(t).then((function(t){return n[i]={status:"fulfilled",value:t}}),(function(t){return n[i]={status:"rejected",reason:t}})).then((function(){return--r||e(n)}))}))}))})),eh.any&&"undefined"!=typeof AggregateError&&Xu(bh,"any",(function(){var t=yc.apply(null,arguments).map($h);return new bh((function(e,r){0===t.length&&r(new AggregateError([]));var n=t.length,i=new Array(n);t.forEach((function(t,s){return bh.resolve(t).then((function(t){return e(t)}),(function(t){i[s]=t,--n||r(new AggregateError(i))}))}))}))})));var Ph={awaits:0,echoes:0,id:0},Mh=0,Dh=[],Fh=0,Lh=0,jh=0;function Nh(t,e,r,n){var i=dh,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++jh;var a=fh.env;s.env=rh?{Promise:bh,PromiseProp:{value:bh,configurable:!0,writable:!0},all:bh.all,race:bh.race,allSettled:bh.allSettled,any:bh.any,resolve:bh.resolve,reject:bh.reject,nthen:Kh(a.nthen,s),gthen:Kh(a.gthen,s)}:{},e&&$u(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Vh(s,t,r,n);return 0===s.ref&&s.finalize(),o}function Uh(){return Ph.id||(Ph.id=++Mh),++Ph.awaits,Ph.echoes+=100,Ph.id}function zh(t){!Ph.awaits||t&&t!==Ph.id||(0==--Ph.awaits&&(Ph.id=0),Ph.echoes=100*Ph.awaits)}function $h(t){return Ph.echoes&&t&&t.constructor===eh?(Uh(),t.then((function(t){return zh(),t}),(function(t){return zh(),Qh(t)}))):t}function Hh(t){++Lh,Ph.echoes&&0!=--Ph.echoes||(Ph.echoes=Ph.id=0),Dh.push(dh),qh(t,!0)}function Wh(){var t=Dh[Dh.length-1];Dh.pop(),qh(t,!1)}function qh(t,e){var r,n=dh;if((e?!Ph.echoes||Fh++&&t===dh:!Fh||--Fh&&t===dh)||(r=e?Hh.bind(null,t):Wh,th.call(Jc,r)),t!==dh&&(dh=t,n===fh&&(fh.env=Gh()),rh)){var i=fh.env.Promise,s=t.env;Qc.then=s.nthen,i.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(zu,"Promise",s.PromiseProp),i.all=s.all,i.race=s.race,i.resolve=s.resolve,i.reject=s.reject,s.allSettled&&(i.allSettled=s.allSettled),s.any&&(i.any=s.any))}}function Gh(){var t=zu.Promise;return rh?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(zu,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Qc.then,gthen:t.prototype.then}:{}}function Vh(t,e,r,n,i){var s=dh;try{return qh(t,!0),e(r,n,i)}finally{qh(s,!1)}}function Xh(t,e,r){return"function"!=typeof t?t:function(){var n=dh;r&&Uh(),qh(e,!0);try{return t.apply(this,arguments)}finally{qh(n,!1)}}}function Kh(t,e){return function(r,n){return t.call(this,Xh(r,e,!1),Xh(n,e,!1))}}-1===(""+th).indexOf("[native code]")&&(Uh=zh=Uc);var Yh="unhandledrejection";function Jh(t,e){var r;try{r=e.onuncatched(t)}catch(t){}if(!1!==r)try{var n,i={promise:e,reason:t};if(zu.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(Yh,!0,!0),$u(n,i)):zu.CustomEvent&&$u(n=new CustomEvent(Yh,{detail:i}),i),n&&zu.dispatchEvent&&(dispatchEvent(n),!zu.PromiseRejectionEvent&&zu.onunhandledrejection))try{zu.onunhandledrejection(n)}catch(t){}Ac&&n&&!n.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var Qh=bh.reject;function Zh(t,e,r,n){if(t._state.openComplete||dh.letThrough){var i=t._createTransaction(e,r,t._dbSchema);try{i.create()}catch(t){return Qh(t)}return i._promise(e,(function(t,e){return Nh((function(){return dh.trans=i,n(t,e,i)}))})).then((function(t){return i._completion.then((function(){return t}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Qh(new Lc.DatabaseClosed);t.open().catch(Uc)}return t._state.dbReadyPromise.then((function(){return Zh(t,e,r,n)}))}var tl="3.0.2",el=String.fromCharCode(65535),rl=-1/0,nl="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",il="String expected.",sl=[],al="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ol=al,ul=al,cl=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},hl="__dbnames",ll="readonly",fl="readwrite";function dl(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var pl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},_l=function(){function t(){}return t.prototype._trans=function(t,e,r){var n=this._tx||dh.trans,i=this.name;function s(t,r,n){if(!n.schema[i])throw new Lc.NotFound("Table "+i+" not part of transaction");return e(n.idbtrans,n)}var a=Sh();try{return n&&n.db===this.db?n===dh.trans?n._promise(t,s,r):Nh((function(){return n._promise(t,s,r)}),{trans:n,transless:dh.transless||dh}):Zh(this.db,t,[this.name],s)}finally{a&&Rh()}},t.prototype.get=function(t,e){var r=this;return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",(function(e){return r.core.get({trans:e,key:t}).then((function(t){return r.hook.reading.fire(t)}))})).then(e)},t.prototype.where=function(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if(Uu(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var e=Nu(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter((function(t){return t.compound&&e.every((function(e){return t.keyPath.indexOf(e)>=0}))&&t.keyPath.every((function(t){return e.indexOf(t)>=0}))}))[0];if(r&&this.db._maxKey!==el)return this.where(r.name).equals(r.keyPath.map((function(e){return t[e]})));!r&&Ac&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var n=this.schema.idxByName,i=this.db._deps.indexedDB;function s(t,e){try{return 0===i.cmp(t,e)}catch(t){return!1}}var a=e.reduce((function(e,r){var i=e[0],a=e[1],o=n[r],u=t[r];return[i||o,i||!o?dl(a,o&&o.multi?function(t){var e=ic(t,r);return Uu(e)&&e.some((function(t){return s(u,t)}))}:function(t){return s(u,ic(t,r))}):a]}),[null,null]),o=a[0],u=a[1];return o?this.where(o.name).equals(t[o.keyPath]).filter(u):r?this.filter(u):this.where(e).equals("")},t.prototype.filter=function(t){return this.toCollection().and(t)},t.prototype.count=function(t){return this.toCollection().count(t)},t.prototype.offset=function(t){return this.toCollection().offset(t)},t.prototype.limit=function(t){return this.toCollection().limit(t)},t.prototype.each=function(t){return this.toCollection().each(t)},t.prototype.toArray=function(t){return this.toCollection().toArray(t)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,Uu(t)?"["+t.join("+")+"]":t))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){this.schema.mappedClass=t;var e=function(e){if(!e)return e;var r=Object.create(t.prototype);for(var n in e)if(qu(e,n))try{r[n]=e[n]}catch(t){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t},t.prototype.defineClass=function(){return this.mapToClass((function(t){$u(this,t)}))},t.prototype.add=function(t,e){var r=this;return this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"add",keys:null!=e?[e]:null,values:[t]})})).then((function(t){return t.numFailures?bh.reject(t.failures[0]):t.lastResult})).then((function(e){if(!r.core.schema.primaryKey.outbound)try{sc(t,r.core.schema.primaryKey.keyPath,e)}catch(t){}return e}))},t.prototype.update=function(t,e){if("object"!=typeof e||Uu(e))throw new Lc.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||Uu(t))return this.where(":id").equals(t).modify(e);Nu(e).forEach((function(r){sc(t,r,e[r])}));var r=ic(t,this.schema.primKey.keyPath);return void 0===r?Qh(new Lc.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(e)},t.prototype.put=function(t,e){var r=this;return this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"put",values:[t],keys:null!=e?[e]:null})})).then((function(t){return t.numFailures?bh.reject(t.failures[0]):t.lastResult})).then((function(e){if(!r.core.schema.primaryKey.outbound)try{sc(t,r.core.schema.primaryKey.keyPath,e)}catch(t){}return e}))},t.prototype.delete=function(t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:[t]})})).then((function(t){return t.numFailures?bh.reject(t.failures[0]):void 0}))},t.prototype.clear=function(){var t=this;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"deleteRange",range:pl})})).then((function(t){return t.numFailures?bh.reject(t.failures[0]):void 0}))},t.prototype.bulkGet=function(t){var e=this;return this._trans("readonly",(function(r){return e.core.getMany({keys:t,trans:r}).then((function(t){return t.map((function(t){return e.hook.reading.fire(t)}))}))}))},t.prototype.bulkAdd=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,s=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){if(!n.core.schema.primaryKey.outbound&&i)throw new Lc.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new Lc.InvalidArgument("Arguments objects and keys must have the same length");var r=t.length;return n.core.mutate({trans:e,type:"add",keys:i,values:t,wantResults:s}).then((function(t){var e=t.numFailures,i=t.results,a=t.lastResult,o=t.failures;if(0===e)return s?i:a;throw new Mc(n.name+".bulkAdd(): "+e+" of "+r+" operations failed",Object.keys(o).map((function(t){return o[t]})))}))}))},t.prototype.bulkPut=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,s=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){if(!n.core.schema.primaryKey.outbound&&i)throw new Lc.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new Lc.InvalidArgument("Arguments objects and keys must have the same length");var r=t.length;return n.core.mutate({trans:e,type:"put",keys:i,values:t,wantResults:s}).then((function(t){var e=t.numFailures,i=t.results,a=t.lastResult,o=t.failures;if(0===e)return s?i:a;throw new Mc(n.name+".bulkPut(): "+e+" of "+r+" operations failed",Object.keys(o).map((function(t){return o[t]})))}))}))},t.prototype.bulkDelete=function(t){var e=this,r=t.length;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:t})})).then((function(t){var n=t.numFailures,i=t.lastResult,s=t.failures;if(0===n)return i;throw new Mc(e.name+".bulkDelete(): "+n+" of "+r+" operations failed",s)}))},t}();function gl(t){var e={},r=function(r,n){if(n){for(var i=arguments.length,s=new Array(i-1);--i;)s[i-1]=arguments[i];return e[r].subscribe.apply(null,s),t}if("string"==typeof r)return e[r]};r.addEventType=s;for(var n=1,i=arguments.length;n<i;++n)s(arguments[n]);return r;function s(t,n,i){if("object"==typeof t)return a(t);n||(n=Vc),i||(i=Uc);var s={subscribers:[],fire:i,subscribe:function(t){-1===s.subscribers.indexOf(t)&&(s.subscribers.push(t),s.fire=n(s.fire,t))},unsubscribe:function(t){s.subscribers=s.subscribers.filter((function(e){return e!==t})),s.fire=s.subscribers.reduce(n,i)}};return e[t]=r[t]=s,s}function a(t){Nu(t).forEach((function(e){var r=t[e];if(Uu(r))s(e,t[e][0],t[e][1]);else{if("asap"!==r)throw new Lc.InvalidArgument("Invalid event config");var n=s(e,zc,(function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach((function(t){rc((function(){t.apply(null,e)}))}))}))}}))}}function bl(t,e){return Ku(e).from({prototype:t}),e}function vl(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function ml(t,e){t.filter=dl(t.filter,e)}function yl(t,e,r){var n=t.replayFilter;t.replayFilter=n?function(){return dl(n(),e())}:e,t.justLimit=r&&!n}function wl(t,e){if(t.isPrimKey)return e.primaryKey;var r=e.getIndexByKeyPath(t.index);if(!r)throw new Lc.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function Al(t,e,r){var n=wl(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:n,range:t.range}})}function kl(t,e,r,n){var i=t.replayFilter?dl(t.filter,t.replayFilter()):t.filter;if(t.or){var s={},a=function(t,r,n){if(!i||i(r,n,(function(t){return r.stop(t)}),(function(t){return r.fail(t)}))){var a=r.primaryKey,o=""+a;"[object ArrayBuffer]"===o&&(o=""+new Uint8Array(a)),qu(s,o)||(s[o]=!0,e(t,r,n))}};return Promise.all([t.or._iterate(a,r),El(Al(t,n,r),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return El(Al(t,n,r),dl(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function El(t,e,r,n){var i=Oh(n?function(t,e,i){return r(n(t),e,i)}:r);return t.then((function(t){if(t)return t.start((function(){var r=function(){return t.continue()};e&&!e(t,(function(t){return r=t}),(function(e){t.stop(e),r=Uc}),(function(e){t.fail(e),r=Uc}))||i(t.value,t,(function(t){return r=t})),r()}))}))}var xl=function(){function t(){}return t.prototype._read=function(t,e){var r=this._ctx;return r.error?r.table._trans(null,Qh.bind(null,r.error)):r.table._trans("readonly",t).then(e)},t.prototype._write=function(t){var e=this._ctx;return e.error?e.table._trans(null,Qh.bind(null,e.error)):e.table._trans("readwrite",t,"locked")},t.prototype._addAlgorithm=function(t){var e=this._ctx;e.algorithm=dl(e.algorithm,t)},t.prototype._iterate=function(t,e){return kl(this._ctx,t,e,this._ctx.table.core)},t.prototype.clone=function(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&$u(r,t),e._ctx=r,e},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(t){var e=this._ctx;return this._read((function(r){return kl(e,t,r,e.table.core)}))},t.prototype.count=function(t){var e=this;return this._read((function(t){var r=e._ctx,n=r.table.core;if(vl(r,!0))return n.count({trans:t,query:{index:wl(r,n.schema),range:r.range}}).then((function(t){return Math.min(t,r.limit)}));var i=0;return kl(r,(function(){return++i,!1}),t,n).then((function(){return i}))})).then(t)},t.prototype.sortBy=function(t,e){var r=t.split(".").reverse(),n=r[0],i=r.length-1;function s(t,e){return e?s(t[r[e]],e-1):t[n]}var a="next"===this._ctx.dir?1:-1;function o(t,e){var r=s(t,i),n=s(e,i);return r<n?-a:r>n?a:0}return this.toArray((function(t){return t.sort(o)})).then(e)},t.prototype.toArray=function(t){var e=this;return this._read((function(t){var r=e._ctx;if("next"===r.dir&&vl(r,!0)&&r.limit>0){var n=r.valueMapper,i=wl(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then((function(t){var e=t.result;return n?e.map(n):e}))}var s=[];return kl(r,(function(t){return s.push(t)}),t,r.table.core).then((function(){return s}))}),t)},t.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,vl(e)?yl(e,(function(){var e=t;return function(t,r){return 0===e||(1===e?(--e,!1):(r((function(){t.advance(e),e=0})),!1))}})):yl(e,(function(){var e=t;return function(){return--e<0}}))),this},t.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),yl(this._ctx,(function(){var e=t;return function(t,r,n){return--e<=0&&r(n),e>=0}}),!0),this},t.prototype.until=function(t,e){return ml(this._ctx,(function(r,n,i){return!t(r.value)||(n(i),e)})),this},t.prototype.first=function(t){return this.limit(1).toArray((function(t){return t[0]})).then(t)},t.prototype.last=function(t){return this.reverse().first(t)},t.prototype.filter=function(t){var e,r;return ml(this._ctx,(function(e){return t(e.value)})),e=this._ctx,r=t,e.isMatch=dl(e.isMatch,r),this},t.prototype.and=function(t){return this.filter(t)},t.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},t.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.key,r)}))},t.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},t.prototype.eachPrimaryKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.primaryKey,r)}))},t.prototype.keys=function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.key)})).then((function(){return r})).then(t)},t.prototype.primaryKeys=function(t){var e=this._ctx;if("next"===e.dir&&vl(e,!0)&&e.limit>0)return this._read((function(t){var r=wl(e,e.table.core.schema);return e.table.core.query({trans:t,values:!1,limit:e.limit,query:{index:r,range:e.range}})})).then((function(t){return t.result})).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.primaryKey)})).then((function(){return r})).then(t)},t.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},t.prototype.firstKey=function(t){return this.limit(1).keys((function(t){return t[0]})).then(t)},t.prototype.lastKey=function(t){return this.reverse().firstKey(t)},t.prototype.distinct=function(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var r={};return ml(this._ctx,(function(t){var e=t.primaryKey.toString(),n=qu(r,e);return r[e]=!0,!n})),this},t.prototype.modify=function(t){var e=this,r=this._ctx;return this._write((function(n){var i;if("function"==typeof t)i=t;else{var s=Nu(t),a=s.length;i=function(e){for(var r=!1,n=0;n<a;++n){var i=s[n],o=t[i];ic(e,i)!==o&&(sc(e,i,o),r=!0)}return r}}var o=r.table.core,u=o.schema.primaryKey,c=u.outbound,h=u.extractKey,l="testmode"in gf?1:2e3,f=e.db.core.cmp,d=[],p=0,_=[],g=function(t,e){var r=e.failures,n=e.numFailures;p+=t-n;for(var i=0,s=Nu(r);i<s.length;i++){var a=s[i];d.push(r[a])}};return e.clone().primaryKeys().then((function(t){var e=function(r){var s=Math.min(l,t.length-r);return o.getMany({trans:n,keys:t.slice(r,r+s)}).then((function(a){for(var u=[],d=[],p=c?[]:null,_=[],b=0;b<s;++b){var v=a[b],m={value:fc(v),primKey:t[r+b]};!1!==i.call(m,m.value,m)&&(null==m.value?_.push(t[r+b]):c||0===f(h(v),h(m.value))?(d.push(m.value),c&&p.push(t[r+b])):(_.push(t[r+b]),u.push(m.value)))}return Promise.resolve(u.length>0&&o.mutate({trans:n,type:"add",values:u}).then((function(t){for(var e in t.failures)_.splice(parseInt(e),1);g(u.length,t)}))).then((function(t){return d.length>0&&o.mutate({trans:n,type:"put",keys:p,values:d}).then((function(t){return g(d.length,t)}))})).then((function(){return _.length>0&&o.mutate({trans:n,type:"delete",keys:_}).then((function(t){return g(_.length,t)}))})).then((function(){return t.length>r+s&&e(r+l)}))}))};return e(0).then((function(){if(d.length>0)throw new Pc("Error modifying one or more objects",d,p,_);return t.length}))}))}))},t.prototype.delete=function(){var t=this._ctx,e=t.range;return vl(t)&&(t.isPrimKey&&!ul||3===e.type)?this._write((function(r){var n=t.table.core.schema.primaryKey,i=e;return t.table.core.count({trans:r,query:{index:n,range:i}}).then((function(e){return t.table.core.mutate({trans:r,type:"deleteRange",range:i}).then((function(t){var r=t.failures,n=(t.lastResult,t.results,t.numFailures);if(n)throw new Pc("Could not delete some values",Object.keys(r).map((function(t){return r[t]})),e-n);return e-n}))}))})):this.modify((function(t,e){return e.value=null}))},t}();function Tl(t,e){return t<e?-1:t===e?0:1}function Cl(t,e){return t>e?-1:t===e?0:1}function Sl(t,e,r){var n=t instanceof Ml?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function Rl(t){return new t.Collection(t,(function(){return Pl("")})).limit(0)}function Il(t,e,r,n,i,s){for(var a=Math.min(t.length,n.length),o=-1,u=0;u<a;++u){var c=e[u];if(c!==n[u])return i(t[u],r[u])<0?t.substr(0,u)+r[u]+r.substr(u+1):i(t[u],n[u])<0?t.substr(0,u)+n[u]+r.substr(u+1):o>=0?t.substr(0,o)+e[o]+r.substr(o+1):null;i(t[u],c)<0&&(o=u)}return a<n.length&&"next"===s?t+r.substr(t.length):a<t.length&&"prev"===s?t.substr(0,r.length):o<0?null:t.substr(0,o)+n[o]+r.substr(o+1)}function Bl(t,e,r,n){var i,s,a,o,u,c,h,l=r.length;if(!r.every((function(t){return"string"==typeof t})))return Sl(t,il);function f(t){i=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),s=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),a="next"===t?Tl:Cl;var e=r.map((function(t){return{lower:s(t),upper:i(t)}})).sort((function(t,e){return a(t.lower,e.lower)}));o=e.map((function(t){return t.upper})),u=e.map((function(t){return t.lower})),c=t,h="next"===t?"":n}f("next");var d=new t.Collection(t,(function(){return Ol(o[0],u[l-1]+n)}));d._ondirectionchange=function(t){f(t)};var p=0;return d._addAlgorithm((function(t,r,n){var i=t.key;if("string"!=typeof i)return!1;var f=s(i);if(e(f,u,p))return!0;for(var d=null,_=p;_<l;++_){var g=Il(i,f,o[_],u[_],a,c);null===g&&null===d?p=_+1:(null===d||a(d,g)>0)&&(d=g)}return r(null!==d?function(){t.continue(d+h)}:n),!1})),d}function Ol(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function Pl(t){return{type:1,lower:t,upper:t}}var Ml=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),t.prototype.between=function(t,e,r,n){r=!1!==r,n=!0===n;try{return this._cmp(t,e)>0||0===this._cmp(t,e)&&(r||n)&&(!r||!n)?Rl(this):new this.Collection(this,(function(){return Ol(t,e,!r,!n)}))}catch(t){return Sl(this,nl)}},t.prototype.equals=function(t){return new this.Collection(this,(function(){return Pl(t)}))},t.prototype.above=function(t){return null==t?Sl(this,nl):new this.Collection(this,(function(){return Ol(t,void 0,!0)}))},t.prototype.aboveOrEqual=function(t){return null==t?Sl(this,nl):new this.Collection(this,(function(){return Ol(t,void 0,!1)}))},t.prototype.below=function(t){return null==t?Sl(this,nl):new this.Collection(this,(function(){return Ol(void 0,t,!1,!0)}))},t.prototype.belowOrEqual=function(t){return null==t?Sl(this,nl):new this.Collection(this,(function(){return Ol(void 0,t)}))},t.prototype.startsWith=function(t){return"string"!=typeof t?Sl(this,il):this.between(t,t+el,!0,!0)},t.prototype.startsWithIgnoreCase=function(t){return""===t?this.startsWith(t):Bl(this,(function(t,e){return 0===t.indexOf(e[0])}),[t],el)},t.prototype.equalsIgnoreCase=function(t){return Bl(this,(function(t,e){return t===e[0]}),[t],"")},t.prototype.anyOfIgnoreCase=function(){var t=yc.apply(mc,arguments);return 0===t.length?Rl(this):Bl(this,(function(t,e){return-1!==e.indexOf(t)}),t,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var t=yc.apply(mc,arguments);return 0===t.length?Rl(this):Bl(this,(function(t,e){return e.some((function(e){return 0===t.indexOf(e)}))}),t,el)},t.prototype.anyOf=function(){var t=this,e=yc.apply(mc,arguments),r=this._cmp;try{e.sort(r)}catch(t){return Sl(this,nl)}if(0===e.length)return Rl(this);var n=new this.Collection(this,(function(){return Ol(e[0],e[e.length-1])}));n._ondirectionchange=function(n){r="next"===n?t._ascending:t._descending,e.sort(r)};var i=0;return n._addAlgorithm((function(t,n,s){for(var a=t.key;r(a,e[i])>0;)if(++i===e.length)return n(s),!1;return 0===r(a,e[i])||(n((function(){t.continue(e[i])})),!1)})),n},t.prototype.notEqual=function(t){return this.inAnyRange([[rl,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var t=yc.apply(mc,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(t){return Sl(this,nl)}var e=t.reduce((function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[rl,e]]}),null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(t,e){var r=this,n=this._cmp,i=this._ascending,s=this._descending,a=this._min,o=this._max;if(0===t.length)return Rl(this);if(!t.every((function(t){return void 0!==t[0]&&void 0!==t[1]&&i(t[0],t[1])<=0})))return Sl(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Lc.InvalidArgument);var u=!e||!1!==e.includeLowers,c=e&&!0===e.includeUppers;var h,l=i;function f(t,e){return l(t[0],e[0])}try{(h=t.reduce((function(t,e){for(var r=0,i=t.length;r<i;++r){var s=t[r];if(n(e[0],s[1])<0&&n(e[1],s[0])>0){s[0]=a(s[0],e[0]),s[1]=o(s[1],e[1]);break}}return r===i&&t.push(e),t}),[])).sort(f)}catch(t){return Sl(this,nl)}var d=0,p=c?function(t){return i(t,h[d][1])>0}:function(t){return i(t,h[d][1])>=0},_=u?function(t){return s(t,h[d][0])>0}:function(t){return s(t,h[d][0])>=0};var g=p,b=new this.Collection(this,(function(){return Ol(h[0][0],h[h.length-1][1],!u,!c)}));return b._ondirectionchange=function(t){"next"===t?(g=p,l=i):(g=_,l=s),h.sort(f)},b._addAlgorithm((function(t,e,n){for(var s=t.key;g(s);)if(++d===h.length)return e(n),!1;return!!function(t){return!p(t)&&!_(t)}(s)||(0===r._cmp(s,h[d][1])||0===r._cmp(s,h[d][0])||e((function(){l===i?t.continue(h[d][0]):t.continue(h[d][1])})),!1)})),b},t.prototype.startsWithAnyOf=function(){var t=yc.apply(mc,arguments);return t.every((function(t){return"string"==typeof t}))?0===t.length?Rl(this):this.inAnyRange(t.map((function(t){return[t,t+el]}))):Sl(this,"startsWithAnyOf() only works with strings")},t}();function Dl(t){return 1===t.length?t[0]:t}function Fl(t){try{return t.only([[]]),[[]]}catch(t){return el}}function Ll(t){return Oh((function(e){return jl(e),t(e.target.error),!1}))}function jl(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var Nl=function(){function t(){}return t.prototype._lock=function(){return ec(!dh.global),++this._reculock,1!==this._reculock||dh.global||(dh.lockOwnerFor=this),this},t.prototype._unlock=function(){if(ec(!dh.global),0==--this._reculock)for(dh.global||(dh.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Vh(t[1],t[0])}catch(t){}}return this},t.prototype._locked=function(){return this._reculock&&dh.lockOwnerFor!==this},t.prototype.create=function(t){var e=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(ec(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new Lc.DatabaseClosed(n);case"MissingAPIError":throw new Lc.MissingAPI(n.message,n);default:throw new Lc.OpenFailed(n)}if(!this.active)throw new Lc.TransactionInactive;return ec(null===this._completion._state),(t=this.idbtrans=t||r.transaction(Dl(this.storeNames),this.mode)).onerror=Oh((function(r){jl(r),e._reject(t.error)})),t.onabort=Oh((function(r){jl(r),e.active&&e._reject(new Lc.Abort(t.error)),e.active=!1,e.on("abort").fire(r)})),t.oncomplete=Oh((function(){e.active=!1,e._resolve()})),this},t.prototype._promise=function(t,e,r){var n=this;if("readwrite"===t&&"readwrite"!==this.mode)return Qh(new Lc.ReadOnly("Transaction is readonly"));if(!this.active)return Qh(new Lc.TransactionInactive);if(this._locked())return new bh((function(i,s){n._blockedFuncs.push([function(){n._promise(t,e,r).then(i,s)},dh])}));if(r)return Nh((function(){var t=new bh((function(t,r){n._lock();var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return t.finally((function(){return n._unlock()})),t._lib=!0,t}));var i=new bh((function(t,r){var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return i._lib=!0,i},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(t){var e=this._root(),r=bh.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then((function(){return r}));else{e._waitingFor=r,e._waitingQueue=[];var n=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(n.get(-1/0).onsuccess=t)}()}var i=e._waitingFor;return new bh((function(t,n){r.then((function(r){return e._waitingQueue.push(Oh(t.bind(null,r)))}),(function(t){return e._waitingQueue.push(Oh(n.bind(null,t)))})).finally((function(){e._waitingFor===i&&(e._waitingFor=null)}))}))},t.prototype.abort=function(){this.active&&this._reject(new Lc.Abort),this.active=!1},t.prototype.table=function(t){var e=this._memoizedTables||(this._memoizedTables={});if(qu(e,t))return e[t];var r=this.schema[t];if(!r)throw new Lc.NotFound("Table "+t+" not part of transaction");var n=new this.db.Table(t,r,this);return n.core=this.db.core.table(t),e[t]=n,n},t}();function Ul(t,e,r,n,i,s,a){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:s,src:(r&&!a?"&":"")+(n?"*":"")+(i?"++":"")+zl(e)}}function zl(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function $l(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:nc(r,(function(t){return[t.name,t]}))}}function Hl(t){return null==t?function(){}:"string"==typeof t?function(t){return 1===t.split(".").length?function(e){return e[t]}:function(e){return ic(e,t)}}(t):function(e){return ic(e,t)}}function Wl(t,e){return"delete"===e.type?e.keys:e.keys||e.values.map(t.extractKey)}function ql(t){return[].slice.call(t)}var Gl=0;function Vl(t){return null==t?":id":"string"==typeof t?t:"["+t.join("+")+"]"}function Xl(t,e,r,n){var i=e.cmp.bind(e);function s(t){if(3===t.type)return null;if(4===t.type)throw new Error("Cannot convert never type to IDBKeyRange");var e=t.lower,n=t.upper,i=t.lowerOpen,s=t.upperOpen;return void 0===e?void 0===n?null:r.upperBound(n,!!s):void 0===n?r.lowerBound(e,!!i):r.bound(e,n,!!i,!!s)}var a=function(t,e){var r=ql(t.objectStoreNames);return{schema:{name:t.name,tables:r.map((function(t){return e.objectStore(t)})).map((function(t){var e=t.keyPath,r=t.autoIncrement,n=Uu(e),i=null==e,s={},a={name:t.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:n,keyPath:e,autoIncrement:r,unique:!0,extractKey:Hl(e)},indexes:ql(t.indexNames).map((function(e){return t.index(e)})).map((function(t){var e=t.name,r=t.unique,n=t.multiEntry,i=t.keyPath,a={name:e,compound:Uu(i),keyPath:i,unique:r,multiEntry:n,extractKey:Hl(i)};return s[Vl(i)]=a,a})),getIndexByKeyPath:function(t){return s[Vl(t)]}};return s[":id"]=a.primaryKey,null!=e&&(s[Vl(e)]=a.primaryKey),a}))},hasGetAll:r.length>0&&"getAll"in e.objectStore(r[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),o=a.schema,u=a.hasGetAll,c=o.tables.map((function(t){return function(t){var e=t.name;return{name:e,schema:t,mutate:function(r){var n=r.trans,i=r.type,a=r.keys,o=r.values,u=r.range,c=r.wantResults;return new Promise((function(r,h){r=Oh(r);var l=n.objectStore(e),f=null==l.keyPath,d="put"===i||"add"===i;if(!d&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var p=(a||o||{length:1}).length;if(a&&o&&a.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return r({numFailures:0,failures:{},results:[],lastResult:void 0});var _,g=c&&ju(a||Wl(t.primaryKey,{type:i,keys:a,values:o})),b=[],v=0,m=function(t){++v,jl(t),g&&(g[t.target._reqno]=void 0),b[t.target._reqno]=t.target.error},y=function(t){var e=t.target;g[e._reqno]=e.result};if("deleteRange"===i){if(4===u.type)return r({numFailures:v,failures:b,results:g,lastResult:void 0});_=3===u.type?l.clear():l.delete(s(u))}else{var w=d?f?[o,a]:[o,null]:[a,null],A=w[0],k=w[1];if(d)for(var E=0;E<p;++E)(_=k&&void 0!==k[E]?l[i](A[E],k[E]):l[i](A[E]))._reqno=E,g&&void 0===g[E]&&(_.onsuccess=y),_.onerror=m;else for(E=0;E<p;++E)(_=l[i](A[E]))._reqno=E,_.onerror=m}var x=function(t){var e=t.target.result;g&&(g[p-1]=e),r({numFailures:v,failures:b,results:g,lastResult:e})};_.onerror=function(t){m(t),x(t)},_.onsuccess=x}))},getMany:function(t){var r=t.trans,n=t.keys;return new Promise((function(t,i){t=Oh(t);for(var s,a=r.objectStore(e),o=n.length,u=new Array(o),c=0,h=0,l=function(e){var r=e.target;u[r._pos]=r.result,++h===c&&t(u)},f=Ll(i),d=0;d<o;++d)null!=n[d]&&((s=a.get(n[d]))._pos=d,s.onsuccess=l,s.onerror=f,++c);0===c&&t(u)}))},get:function(t){var r=t.trans,n=t.key;return new Promise((function(t,i){t=Oh(t);var s=r.objectStore(e).get(n);s.onsuccess=function(e){return t(e.target.result)},s.onerror=Ll(i)}))},query:function(t){return function(r){return new Promise((function(n,i){n=Oh(n);var a=r.trans,o=r.values,u=r.limit,c=r.query,h=u===1/0?void 0:u,l=c.index,f=c.range,d=a.objectStore(e),p=l.isPrimaryKey?d:d.index(l.name),_=s(f);if(0===u)return n({result:[]});if(t){var g=o?p.getAll(_,h):p.getAllKeys(_,h);g.onsuccess=function(t){return n({result:t.target.result})},g.onerror=Ll(i)}else{var b=0,v=o||!("openKeyCursor"in p)?p.openCursor(_):p.openKeyCursor(_),m=[];v.onsuccess=function(t){var e=v.result;return e?(m.push(o?e.value:e.primaryKey),++b===u?n({result:m}):void e.continue()):n({result:m})},v.onerror=Ll(i)}}))}}(u),openCursor:function(t){var r=t.trans,n=t.values,i=t.query,a=t.reverse,o=t.unique;return new Promise((function(t,u){t=Oh(t);var c=i.index,h=i.range,l=r.objectStore(e),f=c.isPrimaryKey?l:l.index(c.name),d=a?o?"prevunique":"prev":o?"nextunique":"next",p=n||!("openKeyCursor"in f)?f.openCursor(s(h),d):f.openKeyCursor(s(h),d);p.onerror=Ll(u),p.onsuccess=Oh((function(e){var n=p.result;if(n){n.___id=++Gl,n.done=!1;var i=n.continue.bind(n),s=n.continuePrimaryKey;s&&(s=s.bind(n));var a=n.advance.bind(n),o=function(){throw new Error("Cursor not stopped")};n.trans=r,n.stop=n.continue=n.continuePrimaryKey=n.advance=function(){throw new Error("Cursor not started")},n.fail=Oh(u),n.next=function(){var t=this,e=1;return this.start((function(){return e--?t.continue():t.stop()})).then((function(){return t}))},n.start=function(t){var e=new Promise((function(t,e){t=Oh(t),p.onerror=Ll(e),n.fail=e,n.stop=function(e){n.stop=n.continue=n.continuePrimaryKey=n.advance=o,t(e)}})),r=function(){if(p.result)try{t()}catch(t){n.fail(t)}else n.done=!0,n.start=function(){throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=Oh((function(t){p.onsuccess=r,r()})),n.continue=i,n.continuePrimaryKey=s,n.advance=a,r(),e},t(n)}else t(null)}),u)}))},count:function(t){var r=t.query,n=t.trans,i=r.index,a=r.range;return new Promise((function(t,r){var o=n.objectStore(e),u=i.isPrimaryKey?o:o.index(i.name),c=s(a),h=c?u.count(c):u.count();h.onsuccess=Oh((function(e){return t(e.target.result)})),h.onerror=Ll(r)}))}}}(t)})),h={};return c.forEach((function(t){return h[t.name]=t})),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(t){if(!h[t])throw new Error("Table '"+t+"' not found");return h[t]},cmp:i,MIN_KEY:-1/0,MAX_KEY:Fl(r),schema:o}}function Kl(t,e,r,n){var i=r.IDBKeyRange;return{dbcore:function(t,e){return e.reduce((function(t,e){var r=e.create;return Lu(Lu({},t),r(t))}),t)}(Xl(e,r.indexedDB,i,n),t.dbcore)}}function Yl(t,e){var r=e.db,n=Kl(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach((function(e){var r=e.name;t.core.schema.tables.some((function(t){return t.name===r}))&&(e.core=t.core.table(r),t[r]instanceof t.Table&&(t[r].core=e.core))}))}function Jl(t,e,r,n){r.forEach((function(r){var i=n[r];e.forEach((function(e){r in e||(e===t.Transaction.prototype||e instanceof t.Transaction?Xu(e,r,{get:function(){return this.table(r)},set:function(t){Vu(this,r,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):e[r]=new t.Table(r,i))}))}))}function Ql(t,e){e.forEach((function(e){for(var r in e)e[r]instanceof t.Table&&delete e[r]}))}function Zl(t,e){return t._cfg.version-e._cfg.version}function tf(t,e,r,n){var i=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,i);s.create(r),s._completion.catch(n);var a=s._reject.bind(s),o=dh.transless||dh;Nh((function(){dh.trans=s,dh.transless=o,0===e?(Nu(i).forEach((function(t){ef(r,t,i[t].primKey,i[t].indexes)})),Yl(t,r),bh.follow((function(){return t.on.populate.fire(s)})).catch(a)):function(t,e,r,n){var i=[],s=t._versions,a=t._dbSchema=nf(t,t.idbdb,n),o=!1;function u(){return i.length?bh.resolve(i.shift()(r.idbtrans)).then(u):bh.resolve()}return s.filter((function(t){return t._cfg.version>=e})).forEach((function(s){i.push((function(){var i=a,u=s._cfg.dbschema;sf(t,i,n),sf(t,u,n),a=t._dbSchema=u;var c=function(t,e){var r,n={del:[],add:[],change:[]};for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],s=e[r];if(i){var a={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===s.primKey.src||al){var o=i.idxByName,u=s.idxByName,c=void 0;for(c in o)u[c]||a.del.push(c);for(c in u){var h=o[c],l=u[c];h?h.src!==l.src&&a.change.push(l):a.add.push(l)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}else a.recreate=!0,n.change.push(a)}else n.add.push([r,s])}return n}(i,u);c.add.forEach((function(t){ef(n,t[0],t[1].primKey,t[1].indexes)})),c.change.forEach((function(t){if(t.recreate)throw new Lc.Upgrade("Not yet support for changing primary key");var e=n.objectStore(t.name);t.add.forEach((function(t){return rf(e,t)})),t.change.forEach((function(t){e.deleteIndex(t.name),rf(e,t)})),t.del.forEach((function(t){return e.deleteIndex(t)}))}));var h=s._cfg.contentUpgrade;if(h&&s._cfg.version>e){Yl(t,n),o=!0;var l=ac(u);c.del.forEach((function(t){l[t]=i[t]})),Ql(t,[t.Transaction.prototype]),Jl(t,[t.Transaction.prototype],Nu(l),l),r.schema=l;var f,d=wc(h);d&&Uh();var p=bh.follow((function(){if((f=h(r))&&d){var t=zh.bind(null,null);f.then(t,t)}}));return f&&"function"==typeof f.then?bh.resolve(f):p.then((function(){return f}))}})),i.push((function(e){o&&ol||function(t,e){for(var r=0;r<e.db.objectStoreNames.length;++r){var n=e.db.objectStoreNames[r];null==t[n]&&e.db.deleteObjectStore(n)}}(s._cfg.dbschema,e);Ql(t,[t.Transaction.prototype]),Jl(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema}))})),u().then((function(){var t,e;e=n,Nu(t=a).forEach((function(r){e.db.objectStoreNames.contains(r)||ef(e,r,t[r].primKey,t[r].indexes)}))}))}(t,e,s,r).catch(a)}))}function ef(t,e,r,n){var i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach((function(t){return rf(i,t)})),i}function rf(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function nf(t,e,r){var n={};return Zu(e.objectStoreNames,0).forEach((function(t){for(var e=r.objectStore(t),i=e.keyPath,s=Ul(zl(i),i||"",!1,!1,!!e.autoIncrement,i&&"string"!=typeof i,!0),a=[],o=0;o<e.indexNames.length;++o){var u=e.index(e.indexNames[o]);i=u.keyPath;var c=Ul(u.name,i,!!u.unique,!!u.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}n[t]=$l(t,s,a)})),n}function sf(t,e,r){for(var n=r.db.objectStoreNames,i=0;i<n.length;++i){var s=n[i],a=r.objectStore(s);t._hasGetAll="getAll"in a;for(var o=0;o<a.indexNames.length;++o){var u=a.indexNames[o],c=a.index(u).keyPath,h="string"==typeof c?c:"["+Zu(c).join("+")+"]";if(e[s]){var l=e[s].idxByName[h];l&&(l.name=u,delete e[s].idxByName[h],e[s].idxByName[u]=l)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&zu.WorkerGlobalScope&&zu instanceof zu.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}var af,of=function(){function t(){}return t.prototype._parseStoresSpec=function(t,e){Nu(t).forEach((function(r){if(null!==t[r]){var n=t[r].split(",").map((function(t,e){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Ul(r,n||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),Uu(n),0===e)})),i=n.shift();if(i.multi)throw new Lc.Schema("Primary key cannot be multi-valued");n.forEach((function(t){if(t.auto)throw new Lc.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new Lc.Schema("Index must have a name and cannot be an empty string")})),e[r]=$l(r,i,n)}}))},t.prototype.stores=function(t){var e=this.db;this._cfg.storesSource=this._cfg.storesSource?$u(this._cfg.storesSource,t):t;var r=e._versions,n={},i={};return r.forEach((function(t){$u(n,t._cfg.storesSource),i=t._cfg.dbschema={},t._parseStoresSpec(n,i)})),e._dbSchema=i,Ql(e,[e._allTables,e,e.Transaction.prototype]),Jl(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],Nu(i),i),e._storeNames=Nu(i),this},t.prototype.upgrade=function(t){return this._cfg.contentUpgrade=t,this},t}();function uf(t){return Nh((function(){return dh.letThrough=!0,t()}))}function cf(t){var e=t._state,r=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then((function(){return e.dbOpenError?Qh(e.dbOpenError):t}));Ac&&(e.openCanceller._stackHolder=Tc()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var n=e.dbReadyResolve,i=null;return bh.race([e.openCanceller,new bh((function(n,s){if(!r)throw new Lc.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=t.name,o=e.autoSchema?r.open(a):r.open(a,Math.round(10*t.verno));if(!o)throw new Lc.MissingAPI("IndexedDB API not available");o.onerror=Ll(s),o.onblocked=Oh(t._fireOnBlocked),o.onupgradeneeded=Oh((function(n){if(i=o.transaction,e.autoSchema&&!t._options.allowEmptyDB){o.onerror=jl,i.abort(),o.result.close();var u=r.deleteDatabase(a);u.onsuccess=u.onerror=Oh((function(){s(new Lc.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{i.onerror=Ll(s);var c=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;t.idbdb=o.result,tf(t,c/10,i,s)}}),s),o.onsuccess=Oh((function(){i=null;var r=t.idbdb=o.result,s=Zu(r.objectStoreNames);if(s.length>0)try{var u=r.transaction(Dl(s),"readonly");e.autoSchema?function(t,e,r){t.verno=e.version/10;var n=t._dbSchema=nf(0,e,r);t._storeNames=Zu(e.objectStoreNames,0),Jl(t,[t._allTables],Nu(n),n)}(t,r,u):sf(t,t._dbSchema,u),Yl(t,u)}catch(t){}sl.push(t),r.onversionchange=Oh((function(r){e.vcFired=!0,t.on("versionchange").fire(r)})),af.add(a),n()}),s)}))]).then((function(){return e.onReadyBeingFired=[],bh.resolve(uf(t.on.ready.fire)).then((function t(){if(e.onReadyBeingFired.length>0){var r=e.onReadyBeingFired.reduce(Xc,Uc);return e.onReadyBeingFired=[],bh.resolve(uf(r)).then(t)}}))})).finally((function(){e.onReadyBeingFired=null})).then((function(){return e.isBeingOpened=!1,t})).catch((function(r){try{i&&i.abort()}catch(t){}return e.isBeingOpened=!1,t.close(),e.dbOpenError=r,Qh(e.dbOpenError)})).finally((function(){e.openComplete=!0,n()}))}function hf(t){var e=function(e){return t.next(e)},r=i(e),n=i((function(e){return t.throw(e)}));function i(t){return function(e){var i=t(e),s=i.value;return i.done?s:s&&"function"==typeof s.then?s.then(r,n):Uu(s)?Promise.all(s).then(r,n):r(s)}}return i(e)()}function lf(t,e,r){var n=arguments.length;if(n<2)throw new Lc.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var s=uc(i);return[t,s,r]}function ff(t,e,r,n,i){return bh.resolve().then((function(){var s=dh.transless||dh,a=t._createTransaction(e,r,t._dbSchema,n),o={trans:a,transless:s};n?a.idbtrans=n.idbtrans:a.create();var u,c=wc(i);c&&Uh();var h=bh.follow((function(){if(u=i.call(a,a))if(c){var t=zh.bind(null,null);u.then(t,t)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=hf(u))}),o);return(u&&"function"==typeof u.then?bh.resolve(u).then((function(t){return a.active?t:Qh(new Lc.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):h.then((function(){return u}))).then((function(t){return n&&a._resolve(),a._completion.then((function(){return t}))})).catch((function(t){return a._reject(t),Qh(t)}))}))}function df(t,e,r){for(var n=Uu(t)?t.slice():[t],i=0;i<r;++i)n.push(e);return n}var pf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return Lu(Lu({},t),{table:function(e){var r=t.table(e),n=r.schema,i={},s=[];function a(t,e,r){var n=Vl(t),o=i[n]=i[n]||[],u=null==t?0:"string"==typeof t?1:t.length,c=e>0,h=Lu(Lu({},r),{isVirtual:c,isPrimaryKey:!c&&r.isPrimaryKey,keyTail:e,keyLength:u,extractKey:Hl(t),unique:!c&&r.unique});(o.push(h),h.isPrimaryKey||s.push(h),u>1)&&a(2===u?t[0]:t.slice(0,u-1),e+1,r);return o.sort((function(t,e){return t.keyTail-e.keyTail})),h}var o=a(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[o];for(var u=0,c=n.indexes;u<c.length;u++){var h=c[u];a(h.keyPath,0,h)}function l(e){var r,n,i=e.query.index;return i.isVirtual?Lu(Lu({},e),{query:{index:i,range:(r=e.query.range,n=i.keyTail,{type:1===r.type?2:r.type,lower:df(r.lower,r.lowerOpen?t.MAX_KEY:t.MIN_KEY,n),lowerOpen:!0,upper:df(r.upper,r.upperOpen?t.MIN_KEY:t.MAX_KEY,n),upperOpen:!0})}}):e}return Lu(Lu({},r),{schema:Lu(Lu({},n),{primaryKey:o,indexes:s,getIndexByKeyPath:function(t){var e=i[Vl(t)];return e&&e[0]}}),count:function(t){return r.count(l(t))},query:function(t){return r.query(l(t))},openCursor:function(e){var n=e.query.index,i=n.keyTail,s=n.isVirtual,a=n.keyLength;if(!s)return r.openCursor(e);return r.openCursor(l(e)).then((function(r){return r&&function(r){return Object.create(r,{continue:{value:function(n){null!=n?r.continue(df(n,e.reverse?t.MAX_KEY:t.MIN_KEY,i)):e.unique?r.continue(df(r.key,e.reverse?t.MIN_KEY:t.MAX_KEY,i)):r.continue()}},continuePrimaryKey:{value:function(e,n){r.continuePrimaryKey(df(e,t.MAX_KEY,i),n)}},key:{get:function(){var t=r.key;return 1===a?t[0]:t.slice(0,a)}},value:{get:function(){return r.value}}})}(r)}))}})}})}},_f={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return Lu(Lu({},t),{table:function(e){var r=t.table(e),n=r.schema.primaryKey;return Lu(Lu({},r),{mutate:function(t){var i=dh.trans,s=i.table(e).hook,a=s.deleting,o=s.creating,u=s.updating;switch(t.type){case"add":if(o.fire===Uc)break;return i._promise("readwrite",(function(){return c(t)}),!0);case"put":if(o.fire===Uc&&u.fire===Uc)break;return i._promise("readwrite",(function(){return c(t)}),!0);case"delete":if(a.fire===Uc)break;return i._promise("readwrite",(function(){return c(t)}),!0);case"deleteRange":if(a.fire===Uc)break;return i._promise("readwrite",(function(){return function(t){return h(t.trans,t.range,1e4)}(t)}),!0)}return r.mutate(t);function c(t){var e=dh.trans,i=t.keys||Wl(n,t);if(!i)throw new Error("Keys missing");return"delete"!==(t="add"===t.type||"put"===t.type?Lu(Lu({},t),{keys:i,wantResults:!0}):Lu({},t)).type&&(t.values=ju(t.values)),t.keys&&(t.keys=ju(t.keys)),function(t,e,r){return"add"===e.type?Promise.resolve(new Array(e.values.length)):t.getMany({trans:e.trans,keys:r})}(r,t,i).then((function(s){var c=i.map((function(r,i){var c=s[i],h={onerror:null,onsuccess:null};if("delete"===t.type)a.fire.call(h,r,c,e);else if("add"===t.type||void 0===c){var l=o.fire.call(h,r,t.values[i],e);null==r&&null!=l&&(r=l,t.keys[i]=r,n.outbound||sc(t.values[i],n.keyPath,r))}else{var f=gc(c,t.values[i]),d=u.fire.call(h,f,r,c,e);if(d){var p=t.values[i];Object.keys(d).forEach((function(t){sc(p,t,d[t])}))}}return h}));return r.mutate(t).then((function(e){for(var r=e.failures,n=e.results,a=e.numFailures,o=e.lastResult,u=0;u<i.length;++u){var h=n?n[u]:i[u],l=c[u];null==h?l.onerror&&l.onerror(r[u]):l.onsuccess&&l.onsuccess("put"===t.type&&s[u]?t.values[u]:h)}return{failures:r,results:n,numFailures:a,lastResult:o}})).catch((function(t){return c.forEach((function(e){return e.onerror&&e.onerror(t)})),Promise.reject(t)}))}))}function h(t,e,i){return r.query({trans:t,values:!1,query:{index:n,range:e},limit:i}).then((function(r){var n=r.result;return c({type:"delete",keys:n,trans:t}).then((function(r){return r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:h(t,Lu(Lu({},e),{lower:n[n.length-1],lowerOpen:!0}),i)}))}))}}})}})}},gf=function(){function t(e,r){var n=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=r=Lu({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var s=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a,o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Uc,dbReadyPromise:null,cancelOpen:Uc,openCanceller:null,autoSchema:!0};o.dbReadyPromise=new bh((function(t){o.dbReadyResolve=t})),o.openCanceller=new bh((function(t,e){o.cancelOpen=e})),this._state=o,this.name=e,this.on=gl(this,"populate","blocked","versionchange",{ready:[Xc,Uc]}),this.on.ready.subscribe=tc(this.on.ready.subscribe,(function(e){return function(r,i){t.vip((function(){var t=n._state;if(t.openComplete)t.dbOpenError||bh.resolve().then(r),i&&e(r);else if(t.onReadyBeingFired)t.onReadyBeingFired.push(r),i&&e(r);else{e(r);var s=n;i||e((function t(){s.on.ready.unsubscribe(r),s.on.ready.unsubscribe(t)}))}}))}})),this.Collection=(a=this,bl(xl.prototype,(function(t,e){this.db=a;var r=pl,n=null;if(e)try{r=e()}catch(t){n=t}var i=t._ctx,s=i.table,o=s.hook.reading.fire;this._ctx={table:s,index:i.index,isPrimKey:!i.index||s.schema.primKey.keyPath&&i.index===s.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:o!==zc?o:null}}))),this.Table=function(t){return bl(_l.prototype,(function(e,r,n){this.db=t,this._tx=n,this.name=e,this.schema=r,this.hook=t._allTables[e]?t._allTables[e].hook:gl(null,{creating:[Wc,Uc],reading:[$c,zc],updating:[Gc,Uc],deleting:[qc,Uc]})}))}(this),this.Transaction=function(t){return bl(Nl.prototype,(function(e,r,n,i){var s=this;this.db=t,this.mode=e,this.storeNames=r,this.schema=n,this.idbtrans=null,this.on=gl(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new bh((function(t,e){s._resolve=t,s._reject=e})),this._completion.then((function(){s.active=!1,s.on.complete.fire()}),(function(t){var e=s.active;return s.active=!1,s.on.error.fire(t),s.parent?s.parent._reject(t):e&&s.idbtrans&&s.idbtrans.abort(),Qh(t)}))}))}(this),this.Version=function(t){return bl(of.prototype,(function(e){this.db=t,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(t){return bl(Ml.prototype,(function(e,r,n){this.db=t,this._ctx={table:e,index:":id"===r?null:r,or:n};var i=t._deps.indexedDB;if(!i)throw new Lc.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(t,e){return i.cmp(e,t)},this._max=function(t,e){return i.cmp(t,e)>0?t:e},this._min=function(t,e){return i.cmp(t,e)<0?t:e},this._IDBKeyRange=t._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+n.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+n.name+"'. Closing db now to resume the delete request."),n.close()})),this.on("blocked",(function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+n.name+"') was blocked"):console.warn("Upgrade '"+n.name+"' blocked by other connection holding version "+t.oldVersion/10)})),this._maxKey=Fl(r.IDBKeyRange),this._createTransaction=function(t,e,r,i){return new n.Transaction(t,e,r,i)},this._fireOnBlocked=function(t){n.on("blocked").fire(t),sl.filter((function(t){return t.name===n.name&&t!==n&&!t._state.vcFired})).map((function(e){return e.on("versionchange").fire(t)}))},this.use(pf),this.use(_f),s.forEach((function(t){return t(n)}))}return t.prototype.version=function(t){if(isNaN(t)||t<.1)throw new Lc.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Lc.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,r=e.filter((function(e){return e._cfg.version===t}))[0];return r||(r=new this.Version(t),e.push(r),e.sort(Zl),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(t){var e=this;return this._state.openComplete||dh.letThrough?t():new bh((function(t,r){if(!e._state.isBeingOpened){if(!e._options.autoOpen)return void r(new Lc.DatabaseClosed);e.open().catch(Uc)}e._state.dbReadyPromise.then(t,r)})).then(t)},t.prototype.use=function(t){var e=t.stack,r=t.create,n=t.level,i=t.name;i&&this.unuse({stack:e,name:i});var s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:r,level:null==n?10:n,name:i}),s.sort((function(t,e){return t.level-e.level})),this},t.prototype.unuse=function(t){var e=t.stack,r=t.name,n=t.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((function(t){return n?t.create!==n:!!r&&t.name!==r}))),this},t.prototype.open=function(){return cf(this)},t.prototype.close=function(){var t=sl.indexOf(this),e=this._state;if(t>=0&&sl.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}this._options.autoOpen=!1,e.dbOpenError=new Lc.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError),e.dbReadyPromise=new bh((function(t){e.dbReadyResolve=t})),e.openCanceller=new bh((function(t,r){e.cancelOpen=r}))},t.prototype.delete=function(){var t=this,e=arguments.length>0,r=this._state;return new bh((function(n,i){var s=function(){t.close();var e=t._deps.indexedDB.deleteDatabase(t.name);e.onsuccess=Oh((function(){af.remove(t.name),n()})),e.onerror=Ll(i),e.onblocked=t._fireOnBlocked};if(e)throw new Lc.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()}))},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var t=this;return Nu(this._allTables).map((function(e){return t._allTables[e]}))},enumerable:!0,configurable:!0}),t.prototype.transaction=function(){var t=lf.apply(this,arguments);return this._transaction.apply(this,t)},t.prototype._transaction=function(t,e,r){var n=this,i=dh.trans;i&&i.db===this&&-1===t.indexOf("!")||(i=null);var s,a,o=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{if(a=e.map((function(t){var e=t instanceof n.Table?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==t||t===ll)s=ll;else{if("rw"!=t&&t!=fl)throw new Lc.InvalidArgument("Invalid transaction mode: "+t);s=fl}if(i){if(i.mode===ll&&s===fl){if(!o)throw new Lc.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(t){if(i&&-1===i.storeNames.indexOf(t)){if(!o)throw new Lc.SubTransaction("Table "+t+" not included in parent transaction.");i=null}})),o&&i&&!i.active&&(i=null)}}catch(t){return i?i._promise(null,(function(e,r){r(t)})):Qh(t)}var u=ff.bind(null,this,s,a,i,r);return i?i._promise(s,u,"lock"):dh.trans?Vh(dh.transless,(function(){return n._whenReady(u)})):this._whenReady(u)},t.prototype.table=function(t){if(!qu(this._allTables,t))throw new Lc.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},t}(),bf=gf;Gu(bf,Lu(Lu({},Nc),{delete:function(t){return new bf(t).delete()},exists:function(t){return new bf(t,{addons:[]}).open().then((function(t){return t.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(t){return af?af.getDatabaseNames().then(t):bh.resolve([])},defineClass:function(){return function(t){$u(this,t)}},ignoreTransaction:function(t){return dh.trans?Vh(dh.transless,t):t()},vip:uf,async:function(t){return function(){try{var e=hf(t.apply(this,arguments));return e&&"function"==typeof e.then?e:bh.resolve(e)}catch(t){return Qh(t)}}},spawn:function(t,e,r){try{var n=hf(t.apply(r,e||[]));return n&&"function"==typeof n.then?n:bh.resolve(n)}catch(t){return Qh(t)}},currentTransaction:{get:function(){return dh.trans||null}},waitFor:function(t,e){var r=bh.resolve("function"==typeof t?bf.ignoreTransaction(t):t).timeout(e||6e4);return dh.trans?dh.trans.waitFor(r):r},Promise:bh,debug:{get:function(){return Ac},set:function(t){kc(t,"dexie"===t?function(){return!0}:cl)}},derive:Ku,extend:$u,props:Gu,override:tc,Events:gl,getByKeyPath:ic,setByKeyPath:sc,delByKeyPath:function(t,e){"string"==typeof e?sc(t,e,void 0):"length"in e&&[].map.call(e,(function(e){sc(t,e,void 0)}))},shallowClone:ac,deepClone:fc,getObjectDiff:gc,asap:rc,minKey:rl,addons:[],connections:sl,errnames:Dc,dependencies:function(){try{return{indexedDB:zu.indexedDB||zu.mozIndexedDB||zu.webkitIndexedDB||zu.msIndexedDB,IDBKeyRange:zu.IDBKeyRange||zu.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:tl,version:tl.split(".").map((function(t){return parseInt(t)})).reduce((function(t,e,r){return t+e/Math.pow(10,2*r)})),default:bf,Dexie:bf})),bf.maxKey=Fl(bf.dependencies.IDBKeyRange),function(t){try{af=function(t){var e,r=t&&"function"==typeof t.databases;if(!r){var n=new gf(hl,{addons:[]});n.version(1).stores({dbnames:"name"}),e=n.table("dbnames")}return{getDatabaseNames:function(){return r?bh.resolve(t.databases()).then((function(t){return t.map((function(t){return t.name})).filter((function(t){return t!==hl}))})):e.toCollection().primaryKeys()},add:function(t){return!r&&t!==hl&&e.put({name:t}).catch(Uc)},remove:function(t){return!r&&t!==hl&&e.delete(t).catch(Uc)}}}(t)}catch(t){}}(gf.dependencies.indexedDB),bh.rejectionMapper=function(t,e){if(!t||t instanceof Bc||t instanceof TypeError||t instanceof SyntaxError||!t.name||!jc[t.name])return t;var r=new jc[t.name](e||t.message,t);return"stack"in t&&Xu(r,"stack",{get:function(){return this.inner.stack}}),r},kc(Ac,cl);const vf="stellerator-ng";class mf extends gf{constructor(){super(vf),this.version(1).stores({cartridges:"&hash",roms:"&hash",settings:"&id"}),this.version(2).stores({cartridges:"&hash",roms:"&hash",settings:"&id"}).upgrade(t=>{t.table("settings").toCollection().modify(t=>{const e=t;delete e.smoothScaling,delete e.phosphorEmulation,delete e.videoSync,t.tvEmulation="composite",t.scaling="qis",t.phosphorLevel=50,t.scanlineIntensity=20}),t.table("cartridges").toCollection().modify(t=>{delete t.phosphorEmulation})})}}let yf=class{constructor(){this._database=new mf,this._defaultSettings=null}setDefaults(t){this._defaultSettings=t}getAllCartridges(){return this._database.cartridges.toArray()}insertCartridges(t){return this._database.transaction("rw",[this._database.cartridges,this._database.roms],()=>n(this,void 0,void 0,(function*(){yield Promise.all([this._database.cartridges.bulkPut(t.map(t=>t.cartridge)),this._database.roms.bulkPut(t.map(t=>({hash:t.cartridge.hash,image:t.image})))])})))}updateCartridge(t){return n(this,void 0,void 0,(function*(){return this._database.transaction("rw",[this._database.cartridges],()=>n(this,void 0,void 0,(function*(){(yield this._database.cartridges.get(t.hash))&&(yield this._database.cartridges.put(t))})))}))}deleteCartridge(t){return this._database.transaction("rw",[this._database.cartridges,this._database.roms],()=>n(this,void 0,void 0,(function*(){yield Promise.all([this._database.cartridges.delete(t),this._database.roms.delete(t)])})))}deleteAllCartridges(){return this._database.cartridges.clear()}getCartridge(t){return this._database.cartridges.get(t)}getCartridgeImage(t){return n(this,void 0,void 0,(function*(){const e=yield this._database.roms.get(t);return e&&e.image}))}getSettings(){return n(this,void 0,void 0,(function*(){const t=yield this._database.settings.get(0);if(!t)return this._defaultSettings;return function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(t,["id"])}))}saveSettings(t){return n(this,void 0,void 0,(function*(){yield this._database.settings.put(Object.assign(Object.assign({},t),{id:0}))}))}dropDatabase(){return n(this,void 0,void 0,(function*(){this._database.close(),yield indexedDB.deleteDatabase(vf),this._database=new mf}))}};yf=t([Zt()],yf);var wf=yf;let Af=class{constructor(t){this._storage=t,this._addCartridge=()=>{this._input&&this._input.removeEventListener("change",this._onCartridgeAdded),this._input=document.createElement("input"),this._input.type="file",this._input.accept=".bin, .a26, .zip",this._input.multiple=!0,this._input.addEventListener("change",this._onCartridgeAdded),this._input.click()},this._onCartridgeAdded=t=>n(this,void 0,void 0,(function*(){const e=t.target,r=(yield Promise.all(Array.prototype.map.call(e.files,t=>this._processFile(t)))).reduce((t,e)=>t.concat(e),[]),n=Array.from(new Map(r.map(t=>[t.cartridge.hash,t])).values());yield this._storage.insertCartridges(n),this._ports.onNewCartridges_.send(Array.from(n.map(t=>t.cartridge)))})),this._input=null,this._detector=new Fu}init(t){this._ports=t,t.addCartridge_.subscribe(this._addCartridge)}_processFile(t){return n(this,void 0,void 0,(function*(){try{const e=yield new Promise((e,r)=>{const n=new FileReader;n.addEventListener("load",()=>e(new Uint8Array(n.result))),n.addEventListener("error",()=>r(n.error)),n.readAsArrayBuffer(t)});if(t.name.match(/.zip$/i)){const t=new Ro;return yield t.loadAsync(e),yield Promise.all(t.file(/\.(bin|a26)$/i).filter(t=>!t.dir).map(t=>t.async("uint8array").then(e=>this._createCartridge(t.name.replace(/.*\//,""),e))))}return[this._createCartridge(t.name,e)]}catch(t){return[]}}))}_createCartridge(t,e){const r=(n=e,Do(me.from(n)));var n;const i=t.replace(/\.[^\.]*$/,"");return{cartridge:{hash:r,name:i,tvMode:this._tvModeFromName(i),cartridgeType:this._detector.detectCartridgeType(e),emulatePaddles:!1,volume:100},image:e}}_tvModeFromName(t){return t.match(/[\W\-_]pal\d*[\W\-_]/i)?"pal":t.match(/[\W\-_]secam\d*[\W\-_]/i)?"secam":"ntsc"}};Af=t([Zt(),e(0,te(wf)),r("design:paramtypes",[wf])],Af);var kf,Ef=Af,xf=function(){function t(t){if(this._maxConcurrency=t,this._queue=[],t<=0)throw new Error("semaphore must be initialized to a positive value");this._value=t}return t.prototype.acquire=function(){var t=this,e=this.isLocked(),r=new Promise((function(e){return t._queue.push(e)}));return e||this._dispatch(),r},t.prototype.runExclusive=function(t){return n(this,void 0,void 0,(function(){var e,r,n;return i(this,(function(i){switch(i.label){case 0:return[4,this.acquire()];case 1:e=i.sent(),r=e[0],n=e[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,t(r)];case 3:return[2,i.sent()];case 4:return n(),[7];case 5:return[2]}}))}))},t.prototype.isLocked=function(){return this._value<=0},t.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead");this._currentReleaser&&(this._currentReleaser(),this._currentReleaser=void 0)},t.prototype._dispatch=function(){var t=this,e=this._queue.shift();if(e){var r=!1;this._currentReleaser=function(){r||(r=!0,t._value++,t._dispatch())},e([this._value--,this._currentReleaser])}},t}(),Tf=function(){function t(){this._semaphore=new xf(1)}return t.prototype.acquire=function(){return n(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return[4,this._semaphore.acquire()];case 1:return t=e.sent(),[2,t[1]]}}))}))},t.prototype.runExclusive=function(t){return this._semaphore.runExclusive((function(){return t()}))},t.prototype.isLocked=function(){return this._semaphore.isLocked()},t.prototype.release=function(){this._semaphore.release()},t}();!function(t){let e;!function(t){t.stopped="stopped",t.running="running",t.paused="paused",t.error="error"}(e=t.State||(t.State={}))}(kf||(kf={}));var Cf=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r="resolve_transaction",n="reject_transaction",i="error",s=function(){function t(t,e){void 0===e&&(e=0),this._dispatch=t,this._rpcTimeout=e,this.error=new Lo.Event,this._rpcHandlers={},this._signalHandlers={},this._pendingTransactions={},this._nextTransactionId=0}return t.prototype.dispatch=function(e){var r=e;switch(r.type){case t.MessageType.signal:return this._handleSignal(r);case t.MessageType.rpc:return this._handeRpc(r);case t.MessageType.internal:return this._handleInternal(r);default:this._raiseError("invalid message type "+r.type)}},t.prototype.rpc=function(e,r,n){var i=this,s=this._nextTransactionId++;return this._dispatch({type:t.MessageType.rpc,transactionId:s,id:e,payload:r},n||void 0),new Promise((function(t,e){var r=i._pendingTransactions[s]={id:s,resolve:t,reject:e};i._rpcTimeout>0&&(i._pendingTransactions[s].timeoutHandle=setTimeout((function(){return i._transactionTimeout(r)}),i._rpcTimeout))}))},t.prototype.signal=function(e,r,n){return this._dispatch({type:t.MessageType.signal,id:e,payload:r},n||void 0),this},t.prototype.registerRpcHandler=function(t,e){if(this._rpcHandlers[t])throw new Error("rpc handler for "+t+" already registered");return this._rpcHandlers[t]=e,this},t.prototype.registerSignalHandler=function(t,e){return this._signalHandlers[t]||(this._signalHandlers[t]=[]),this._signalHandlers[t].push(e),this},t.prototype.deregisterRpcHandler=function(t,e){return this._rpcHandlers[t]&&delete this._rpcHandlers[t],this},t.prototype.deregisterSignalHandler=function(t,e){return this._signalHandlers[t]&&(this._signalHandlers[t]=this._signalHandlers[t].filter((function(t){return e!==t}))),this},t.prototype._raiseError=function(e){this.error.dispatch(new Error(e)),this._dispatch({type:t.MessageType.internal,id:i,payload:e})},t.prototype._handleSignal=function(t){if(!this._signalHandlers[t.id])return this._raiseError("invalid signal "+t.id);this._signalHandlers[t.id].forEach((function(e){return e(t.payload)}))},t.prototype._handeRpc=function(e){var i=this;if(!this._rpcHandlers[e.id])return this._raiseError("invalid rpc "+e.id);Promise.resolve(this._rpcHandlers[e.id](e.payload)).then((function(n){return i._dispatch({type:t.MessageType.internal,id:r,transactionId:e.transactionId,payload:n})}),(function(r){return i._dispatch({type:t.MessageType.internal,id:n,transactionId:e.transactionId,payload:r})}))},t.prototype._handleInternal=function(t){var e=void 0!==t.transactionId?this._pendingTransactions[t.transactionId]:void 0;switch(t.id){case r:if(!e||void 0===t.transactionId)return this._raiseError("no pending transaction with id "+t.transactionId);e.resolve(t.payload),this._clearTransaction(this._pendingTransactions[t.transactionId]);break;case n:if(!e||void 0===t.transactionId)return this._raiseError("no pending transaction with id "+t.transactionId);this._pendingTransactions[t.transactionId].reject(t.payload),this._clearTransaction(this._pendingTransactions[t.transactionId]);break;case i:this.error.dispatch(new Error("remote error: "+t.payload));break;default:this._raiseError("unhandled internal message "+t.id)}},t.prototype._transactionTimeout=function(t){t.reject("transaction timed out"),this._raiseError("transaction "+t.id+" timed out"),delete this._pendingTransactions[t.id]},t.prototype._clearTransaction=function(t){void 0!==t.timeoutHandle&&clearTimeout(t.timeoutHandle),delete this._pendingTransactions[t.id]},t}();!function(t){!function(t){t[t.signal=0]="signal",t[t.rpc=1]="rpc",t[t.internal=2]="internal"}(t.MessageType||(t.MessageType={}))}(s||(s={})),e.default=s}));P(Cf);var Sf=M((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RpcProvider=Cf.default}));P(Sf);var Rf=Sf.RpcProvider;class If{constructor(t,e,r,n,i){if(this._videoProxy=t,this._controlProxy=e,this._waveformChannels=r,this._pcmChannel=n,this._asyncIOProxy=i,this._config=null,2!==this._waveformChannels.length)throw new Error("invalid channel count "+this._waveformChannels.length)}setConfig(t){this._config=t}getConfig(){return this._config}getVideo(){return this._videoProxy}getJoystick(t){return this._controlProxy.getJoystick(t)}getControlPanel(){return this._controlProxy.getControlPanel()}getPaddle(t){return this._controlProxy.getPaddle(t)}getWaveformChannels(){return this._waveformChannels}getPCMChannel(){return this._pcmChannel}getVideoProxy(){return this._videoProxy}getAsyncIO(){return this._asyncIOProxy}}class Bf{constructor(t,e,r){this._value=t,this._releaseCB=e,this._disposeCB=r,this._isAvailable=!1,this._isDisposed=!1}adopt(t){this._value=t}get(){return this._value}release(){this._releaseCB(this)}dispose(){this._disposeCB(this)}}class Of{constructor(t){this._factory=t,this.event={release:new No,dispose:new No},this._pool=[],this._poolSize=0}get(){let t;if(0===this._poolSize){const e=this._factory();t=new Bf(e,t=>this._releaseMember(t),t=>this._disposeMember(t))}else t=this._pool[--this._poolSize],t._isAvailable=!1;return t}_releaseMember(t){if(t._isAvailable)throw new Error("Trying to release an already released pool member");if(t._isDisposed)throw new Error("Trying to release an already disposed pool member");const e=this._poolSize++;this._pool[e]=t,t._isAvailable=!0,t._poolPosition=e,this.event.release.dispatch(t.get())}_disposeMember(t){if(t._isDisposed)throw new Error("Trying to dispose of an already disposed pool member");t._isAvailable&&(this._poolSize>1&&(this._pool[t._poolPosition]=this._pool[this._poolSize-1]),this._poolSize--),t._isDisposed=!0,this.event.dispose.dispatch(t.get())}}const Pf={emulationPause:"emulation/pause",emulationReset:"emulation/reset",emulationResume:"emulation/resume",emulationSetRateLimit:"emulation/setRateLimit",emulationStart:"emulation/start",emulationStop:"emulation/stop",emulationFetchLastError:"emulation/fetchLastError",getVideoParameters:"video/getParameters",getWaveformAudioParameters:t=>"audio/waveform/getParameters/"+t,getPCMAudioParameters:t=>"audio/pcm/getParameters/"+t,setup:"/setup"};Object.freeze(Pf);const Mf={emulationError:"emulation/error",emulationFrequencyUpdate:"emulation/frequencyUpdate",videoNewFrame:"video/newFrame",videoReturnSurface:"video/returnSurface",controlStateUpdate:"control/stateUpdate",waveformAudioVolumeChange:"audio/waveform/volumeChange",waveformAudioBufferChange:"audio/waveform/bufferChange",pcmAudioNewFrame:t=>"audio/pcm/newFrame/"+t,pcmAudioTogglePause:t=>"audio/pcm/togglePause/"+t,pcmAudioReturnFrame:t=>"audio/pcm/returnFrame/"+t,audioStop:"audio/stop",messageFromAsyncIO:"asyncIO/messageFrom",messageToAsyncIO:"asyncIO/messageTo"};Object.freeze(Mf);class Df{constructor(t){this._rpc=t,this.newFrame=new No,this._framePool=new Of(()=>null),this._frameMap=null,this._active=!1,this._width=0,this._height=0,this._framePool.event.release.addHandler(Df._onDisposeFrame,this)}init(){this._rpc.registerSignalHandler(Mf.videoNewFrame,this._onNewFrame.bind(this))}start(){return n(this,void 0,void 0,(function*(){this._active&&this.stop();const t=yield this._rpc.rpc(Pf.getVideoParameters);this._active=!0,this._width=t.width,this._height=t.height,this._frameMap=new WeakMap}))}stop(){this._active=!1}getWidth(){return this._width}getHeight(){return this._height}static _onDisposeFrame(t,e){if(!e._active)return;if(!e._frameMap.has(t))return void console.warn("unknown imageData returned to proxy");const r=e._frameMap.get(t);e._frameMap.delete(t),e._rpc.signal(Mf.videoReturnSurface,{id:r,buffer:t.data.buffer},[t.data.buffer])}_onNewFrame(t){if(!this._active)return void console.warn("video proxy deactivated: ignoring frame");if(this._width!==t.width||this._height!==t.height)return void console.warn("surface dimensions do not match; ignoring frame");const e=this._framePool.get(),r=new ImageData(new Uint8ClampedArray(t.buffer),t.width,t.height);e.adopt(r),this._frameMap.set(r,t.id),this.newFrame.dispatch(e)}}class Ff{constructor(t=!1){this._state=t,this.stateChanged=new No,this.beforeRead=new No}read(){return this.beforeRead.dispatch(this),this._state}peek(){return this._state}toggle(t){this._state!==t&&(this._state=t,this.stateChanged.dispatch(t))}}class Lf{constructor(){this._left=new Ff,this._right=new Ff,this._up=new Ff,this._down=new Ff,this._fire=new Ff}getLeft(){return this._left}getRight(){return this._right}getUp(){return this._up}getDown(){return this._down}getFire(){return this._fire}}class jf{constructor(){this._selectSwitch=new Ff,this._resetButton=new Ff,this._colorSwitch=new Ff,this._difficutlyP0=new Ff,this._difficutlyP1=new Ff}getSelectSwitch(){return this._selectSwitch}getResetButton(){return this._resetButton}getColorSwitch(){return this._colorSwitch}getDifficultySwitchP0(){return this._difficutlyP0}getDifficultySwitchP1(){return this._difficutlyP1}}class Nf{constructor(){this.valueChanged=new No,this._fireSwitch=new Ff,this._value=.5}setValue(t){this._value=t,this.valueChanged.dispatch(t)}getValue(){return this._value}getFire(){return this._fireSwitch}}class Uf{constructor(t){this._rpc=t,this._joysticks=new Array(2),this._paddles=new Array(4),this._controlPanel=new jf;for(let t=0;t<2;t++)this._joysticks[t]=new Lf;for(let t=0;t<4;t++)this._paddles[t]=new Nf}sendUpdate(){this._rpc.signal(Mf.controlStateUpdate,{joystickState:this._joysticks.map(Uf._joystickState),paddleState:this._paddles.map(Uf._paddleState),controlPanelState:Uf._controlPanelState(this._controlPanel)})}getJoystick(t){if(t<0||t>1)throw new Error("invalid joystick index "+t);return this._joysticks[t]}getControlPanel(){return this._controlPanel}getPaddle(t){if(t<0||t>3)throw new Error("invalid paddle index "+t);return this._paddles[t]}static _joystickState(t){return{up:t.getUp().read(),down:t.getDown().read(),left:t.getLeft().read(),right:t.getRight().read(),fire:t.getFire().read()}}static _paddleState(t){return{value:t.getValue(),fire:t.getFire().read()}}static _controlPanelState(t){return{difficulty0:t.getDifficultySwitchP0().read(),difficulty1:t.getDifficultySwitchP1().read(),select:t.getSelectSwitch().read(),reset:t.getResetButton().read(),color:t.getColorSwitch().read()}}}var zf;!function(t){t.State=class{constructor(){this.a=0,this.x=0,this.y=0,this.s=0,this.p=0,this.flags=0,this.irq=!1,this.nmi=!1}}}(zf||(zf={}));class $f{constructor(){this.cycleType=0,this.address=0,this.value=0,this.pollInterrupts=!1,this.nextStep=null}read(t,e){return this.cycleType=0,this.address=e,this.nextStep=t,this}write(t,e,r){return this.cycleType=1,this.address=e,this.value=r,this.nextStep=t,this}poll(t){return this.pollInterrupts=t,this}}const Hf=Symbol("immutable properties");function Wf(t){const e=t[Hf];if(e)for(const r of e)Object.defineProperty(t,r,{writable:!1,configurable:!1})}function qf(t,e){t[Hf]||Object.defineProperty(t,Hf,{value:[],writable:!1,enumerable:!1}),t[Hf].push(e)}class Gf{constructor(t){this.reset=()=>this._result.read(this._pre1Step,255),this._pre1Step=()=>this._result.read(this._pre2Step,255),this._pre2Step=()=>this._result.read(this._stack1Step,256),this._stack1Step=()=>this._result.read(this._stack2Step,511),this._stack2Step=()=>(this._state.s=253,this._result.read(this._stack3Step,510)),this._stack3Step=()=>this._result.read(this._readTargetLoStep,65532),this._readTargetLoStep=t=>(this._targetAddress=t,this._result.read(this._readTargetHiStep,65533)),this._readTargetHiStep=t=>(this._targetAddress|=t<<8,this._state.p=this._targetAddress,null),this._targetAddress=0,this._result=new $f,this._state=t,Wf(this)}}t([qf,r("design:type",Object)],Gf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_pre1Step",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_pre2Step",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_stack1Step",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_stack2Step",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_stack3Step",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_readTargetLoStep",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_readTargetHiStep",void 0),t([qf,r("design:type",Object)],Gf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Gf.prototype,"_state",void 0);class Vf{constructor(t,e,r){this.reset=()=>this._result.read(this._dummyRead,this._state.p),this._dummyRead=()=>(this._isBrk&&(this._state.p=this._state.p+1&65535),this._result.write(this._pushPch,256+this._state.s,this._state.p>>>8)),this._pushPch=()=>(this._state.s=this._state.s-1&255,this._result.write(this._pushPcl,256+this._state.s,255&this._state.p).poll(!0)),this._pushPcl=()=>(this._state.s=this._state.s-1&255,this._vector=this._state.nmi?65530:this._defaultVector,this._result.write(this._pushFlags,256+this._state.s,this._isBrk?16|this._state.flags:-17&this._state.flags)),this._pushFlags=()=>(this._state.s=this._state.s-1&255,this._result.read(this._fetchPcl,this._vector)),this._fetchPcl=t=>(this._state.flags|=4,this._state.p=t,this._result.read(this._fetchPch,++this._vector)),this._fetchPch=t=>(this._state.p=this._state.p|t<<8,this._state.nmi=this._state.irq=!1,null),this._vector=0,this._result=new $f,this._state=t,this._defaultVector=e,this._isBrk=r,Wf(this)}}t([qf,r("design:type",Object)],Vf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_dummyRead",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_pushPch",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_pushPcl",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_pushFlags",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_fetchPcl",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_fetchPch",void 0),t([qf,r("design:type",Object)],Vf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Vf.prototype,"_state",void 0),t([qf,r("design:type",Number)],Vf.prototype,"_defaultVector",void 0),t([qf,r("design:type",Boolean)],Vf.prototype,"_isBrk",void 0);class Xf{constructor(t,e,r=e){this.operation=t,this.addressingMode=e,this.effectiveAddressingMode=r}getSize(){switch(this.effectiveAddressingMode){case 1:case 2:case 6:case 9:case 8:case 11:case 5:return 2;case 3:case 7:case 10:case 4:return 3;default:return 1}}}!function(t){let e;!function(t){t[t.adc=0]="adc",t[t.and=1]="and",t[t.asl=2]="asl",t[t.bcc=3]="bcc",t[t.bcs=4]="bcs",t[t.beq=5]="beq",t[t.bit=6]="bit",t[t.bmi=7]="bmi",t[t.bne=8]="bne",t[t.bpl=9]="bpl",t[t.brk=10]="brk",t[t.bvc=11]="bvc",t[t.bvs=12]="bvs",t[t.clc=13]="clc",t[t.cld=14]="cld",t[t.cli=15]="cli",t[t.clv=16]="clv",t[t.cmp=17]="cmp",t[t.cpx=18]="cpx",t[t.cpy=19]="cpy",t[t.dec=20]="dec",t[t.dex=21]="dex",t[t.dey=22]="dey",t[t.eor=23]="eor",t[t.inc=24]="inc",t[t.inx=25]="inx",t[t.iny=26]="iny",t[t.jmp=27]="jmp",t[t.jsr=28]="jsr",t[t.lda=29]="lda",t[t.ldx=30]="ldx",t[t.ldy=31]="ldy",t[t.lsr=32]="lsr",t[t.nop=33]="nop",t[t.ora=34]="ora",t[t.pha=35]="pha",t[t.php=36]="php",t[t.pla=37]="pla",t[t.plp=38]="plp",t[t.rol=39]="rol",t[t.ror=40]="ror",t[t.rti=41]="rti",t[t.rts=42]="rts",t[t.sbc=43]="sbc",t[t.sec=44]="sec",t[t.sed=45]="sed",t[t.sei=46]="sei",t[t.sta=47]="sta",t[t.stx=48]="stx",t[t.sty=49]="sty",t[t.tax=50]="tax",t[t.tay=51]="tay",t[t.tsx=52]="tsx",t[t.txa=53]="txa",t[t.txs=54]="txs",t[t.tya=55]="tya",t[t.dop=56]="dop",t[t.top=57]="top",t[t.alr=58]="alr",t[t.axs=59]="axs",t[t.dcp=60]="dcp",t[t.lax=61]="lax",t[t.arr=62]="arr",t[t.slo=63]="slo",t[t.aax=64]="aax",t[t.lar=65]="lar",t[t.isc=66]="isc",t[t.aac=67]="aac",t[t.atx=68]="atx",t[t.rra=69]="rra",t[t.rla=70]="rla",t[t.invalid=71]="invalid"}(e=t.OperationMap||(t.OperationMap={})),t.opcodes=new Array(256)}(Xf||(Xf={})),function(t){let e;!function(e){for(let e=0;e<256;e++)t.opcodes[e]=new t(71,12);let r,n,i;for(let e=0;e<8;e++){switch(e){case 0:r=34;break;case 1:r=1;break;case 2:r=23;break;case 3:r=0;break;case 4:r=47;break;case 5:r=29;break;case 6:r=17;break;case 7:r=43}for(let s=0;s<8;s++){switch(s){case 0:n=8;break;case 1:n=2;break;case 2:n=1;break;case 3:n=3;break;case 4:n=11;break;case 5:n=6;break;case 6:n=10;break;case 7:n=7}47===r&&1===n&&(n=12),71!==r&&12!==n&&(i=e<<5|s<<2|1,t.opcodes[i]=new t(r,n))}}function s(e,r,n,i){if(71!==t.opcodes[e].operation)throw new Error("entry for opcode "+e+" already exists");t.opcodes[e]=new t(r,n,i)}s(6,2,2),s(10,2,0),s(14,2,3),s(22,2,6),s(30,2,7),s(38,39,2),s(42,39,0),s(46,39,3),s(54,39,6),s(62,39,7),s(70,32,2),s(74,32,0),s(78,32,3),s(86,32,6),s(94,32,7),s(102,40,2),s(106,40,0),s(110,40,3),s(118,40,6),s(126,40,7),s(134,48,2),s(142,48,3),s(150,48,9),s(162,30,1),s(166,30,2),s(174,30,3),s(182,30,9),s(190,30,10),s(198,20,2),s(206,20,3),s(214,20,6),s(222,20,7),s(230,24,2),s(238,24,3),s(246,24,6),s(254,24,7),s(36,6,2),s(44,6,3),s(76,27,3),s(108,27,4),s(132,49,2),s(140,49,3),s(148,49,6),s(160,31,1),s(164,31,2),s(172,31,3),s(180,31,6),s(188,31,7),s(192,19,1),s(196,19,2),s(204,19,3),s(224,18,1),s(228,18,2),s(236,18,3),s(16,9,5),s(48,7,5),s(80,11,5),s(112,12,5),s(144,3,5),s(176,4,5),s(208,8,5),s(240,5,5),s(0,10,0),s(32,28,0,3),s(64,41,0),s(96,42,0),s(8,36,0),s(40,38,0),s(72,35,0),s(104,37,0),s(136,22,0),s(168,51,0),s(200,26,0),s(232,25,0),s(24,13,0),s(56,44,0),s(88,15,0),s(120,46,0),s(152,55,0),s(184,16,0),s(216,14,0),s(248,45,0),s(138,53,0),s(154,54,0),s(170,50,0),s(186,52,0),s(202,21,0),s(234,33,0),s(26,33,0),s(58,33,0),s(90,33,0),s(122,33,0),s(218,33,0),s(250,33,0),s(4,56,2),s(20,56,6),s(52,56,6),s(68,56,2),s(84,56,6),s(100,56,2),s(116,56,6),s(128,56,1),s(130,56,1),s(137,56,1),s(194,56,1),s(212,56,6),s(226,56,1),s(244,56,6),s(12,57,3),s(28,57,7),s(60,57,7),s(92,57,7),s(124,57,7),s(220,57,7),s(252,57,7),s(235,43,1),s(75,58,1),s(203,59,1),s(199,60,2),s(215,60,6),s(207,60,3),s(223,60,7),s(219,60,10),s(195,60,8),s(211,60,11),s(167,61,2),s(183,61,9),s(175,61,3),s(191,61,10),s(163,61,8),s(179,61,11),s(107,62,1),s(7,63,2),s(23,63,6),s(15,63,3),s(31,63,7),s(27,63,10),s(3,63,8),s(19,63,11),s(135,64,2),s(151,64,9),s(131,64,8),s(143,64,3),s(187,65,10),s(231,66,2),s(247,66,6),s(239,66,3),s(255,66,7),s(251,66,10),s(227,66,8),s(243,66,11),s(11,67,1),s(43,67,1),s(171,68,1),s(103,69,2),s(119,69,6),s(111,69,3),s(127,69,7),s(123,69,10),s(99,69,8),s(115,69,11),s(39,70,2),s(55,70,6),s(47,70,3),s(63,70,7),s(59,70,10),s(35,70,8),s(51,70,11)}(e=t.__init||(t.__init={}))}(Xf||(Xf={}));class Kf{constructor(t,e=(()=>null)){this.reset=()=>this._result.read(this._fetchLo,this._state.p),this._fetchLo=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._result.read(this._fetchHi,this._state.p)),this._fetchHi=t=>(this._operand|=t<<8,this._state.p=this._state.p+1&65535,this._next(this._operand,this._state)),this._operand=0,this._result=new $f,this._state=t,this._next=e,Wf(this)}}t([qf,r("design:type",Object)],Kf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Kf.prototype,"_fetchLo",void 0),t([qf,r("design:type",Object)],Kf.prototype,"_fetchHi",void 0),t([qf,r("design:type",Object)],Kf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Kf.prototype,"_state",void 0),t([qf,r("design:type",Function)],Kf.prototype,"_next",void 0);class Yf{constructor(t,e,r=(()=>null),n=!1){this.reset=()=>this._result.read(this._fetchLo,this._state.p),this._fetchLo=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._result.read(this._fetchHi,this._state.p)),this._fetchHi=t=>{this._operand|=t<<8,this._state.p=this._state.p+1&65535;const e=this._indexExtractor(this._state);return this._carry=(255&this._operand)+e>255,this._operand=65280&this._operand|this._operand+e&255,this._carry||this._writeOp?this._result.read(this._dereferenceAndCarry,this._operand):this._next(this._operand,this._state)},this._dereferenceAndCarry=t=>(this._carry&&(this._operand=this._operand+256&65535),this._next(this._operand,this._state)),this._operand=0,this._carry=!1,this._result=new $f,this._state=t,this._indexExtractor=e,this._next=r,this._writeOp=n,Wf(this)}static absoluteX(t,e,r){return new Yf(t,t=>t.x,e,r)}static absoluteY(t,e,r){return new Yf(t,t=>t.y,e,r)}}t([qf,r("design:type",Object)],Yf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Yf.prototype,"_fetchLo",void 0),t([qf,r("design:type",Object)],Yf.prototype,"_fetchHi",void 0),t([qf,r("design:type",Object)],Yf.prototype,"_dereferenceAndCarry",void 0),t([qf,r("design:type",Object)],Yf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Yf.prototype,"_state",void 0),t([qf,r("design:type",Function)],Yf.prototype,"_indexExtractor",void 0),t([qf,r("design:type",Function)],Yf.prototype,"_next",void 0),t([qf,r("design:type",Boolean)],Yf.prototype,"_writeOp",void 0),t([qf,r("design:type",Function),r("design:paramtypes",[zf.State,Function,Boolean]),r("design:returntype",Yf)],Yf,"absoluteX",null),t([qf,r("design:type",Function),r("design:paramtypes",[zf.State,Function,Boolean]),r("design:returntype",Yf)],Yf,"absoluteY",null);class Jf{constructor(t,e=(()=>null)){this.reset=t=>this._result.read(this._dereference,t),this._dereference=t=>this._next(t,this._state),this._result=new $f,this._next=e,this._state=t,Wf(this)}}t([qf,r("design:type",Object)],Jf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Jf.prototype,"_dereference",void 0),t([qf,r("design:type",Object)],Jf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Jf.prototype,"_state",void 0),t([qf,r("design:type",Function)],Jf.prototype,"_next",void 0);class Qf{constructor(t,e=(()=>null)){this.reset=()=>this._result.read(this._fetchOperand,this._state.p),this._fetchOperand=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._next(this._operand,this._state)),this._operand=0,this._result=new $f,this._state=t,this._next=e,Wf(this)}}t([qf,r("design:type",Object)],Qf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Qf.prototype,"_fetchOperand",void 0),t([qf,r("design:type",Object)],Qf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Qf.prototype,"_state",void 0),t([qf,r("design:type",Function)],Qf.prototype,"_next",void 0);class Zf{constructor(t,e=(()=>null)){this.reset=()=>this._result.read(this._fetchAddress,this._state.p),this._fetchAddress=t=>(this._address=t,this._state.p=this._state.p+1&65535,this._result.read(this._addIndex,this._address)),this._addIndex=t=>(this._address=this._address+this._state.x&255,this._result.read(this._fetchLo,this._address)),this._fetchLo=t=>(this._operand=t,this._address=this._address+1&255,this._result.read(this._fetchHi,this._address)),this._fetchHi=t=>(this._operand|=t<<8,this._next(this._operand,this._state)),this._operand=0,this._address=0,this._result=new $f,this._state=t,this._next=e,Wf(this)}}t([qf,r("design:type",Object)],Zf.prototype,"reset",void 0),t([qf,r("design:type",Object)],Zf.prototype,"_fetchAddress",void 0),t([qf,r("design:type",Object)],Zf.prototype,"_addIndex",void 0),t([qf,r("design:type",Object)],Zf.prototype,"_fetchLo",void 0),t([qf,r("design:type",Object)],Zf.prototype,"_fetchHi",void 0),t([qf,r("design:type",Object)],Zf.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Zf.prototype,"_state",void 0),t([qf,r("design:type",Function)],Zf.prototype,"_next",void 0);class td{constructor(t,e=(()=>null),r){this.reset=()=>this._result.read(this._fetchAddress,this._state.p),this._fetchAddress=t=>(this._address=t,this._state.p=this._state.p+1&65535,this._result.read(this._fetchLo,this._address)),this._fetchLo=t=>(this._operand=t,this._address=this._address+1&255,this._result.read(this._fetchHi,this._address)),this._fetchHi=t=>(this._operand|=t<<8,this._carry=(255&this._operand)+this._state.y>255,this._operand=65280&this._operand|this._operand+this._state.y&255,this._carry||this._writeOp?this._result.read(this._dereferenceAndCarry,this._operand):this._next(this._operand,this._state)),this._dereferenceAndCarry=t=>(this._carry&&(this._operand=this._operand+256&65535),this._next(this._operand,this._state)),this._operand=0,this._address=0,this._carry=!1,this._result=new $f,this._state=t,this._next=e,this._writeOp=r,Wf(this)}}t([qf,r("design:type",Object)],td.prototype,"reset",void 0),t([qf,r("design:type",Object)],td.prototype,"_fetchAddress",void 0),t([qf,r("design:type",Object)],td.prototype,"_fetchLo",void 0),t([qf,r("design:type",Object)],td.prototype,"_fetchHi",void 0),t([qf,r("design:type",Object)],td.prototype,"_dereferenceAndCarry",void 0),t([qf,r("design:type",Object)],td.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],td.prototype,"_state",void 0),t([qf,r("design:type",Function)],td.prototype,"_next",void 0),t([qf,r("design:type",Boolean)],td.prototype,"_writeOp",void 0);class ed{constructor(t,e=(()=>null)){this.reset=()=>this._result.read(this._fetchAddress,this._state.p),this._fetchAddress=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._next(this._operand,this._state)),this._operand=0,this._result=new $f,this._state=t,this._next=e,Wf(this)}}t([qf,r("design:type",Object)],ed.prototype,"reset",void 0),t([qf,r("design:type",Object)],ed.prototype,"_fetchAddress",void 0),t([qf,r("design:type",Object)],ed.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],ed.prototype,"_state",void 0),t([qf,r("design:type",Function)],ed.prototype,"_next",void 0);class rd{constructor(t,e,r){this.reset=()=>this._result.read(this._fetchAddress,this._state.p),this._fetchAddress=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._result.read(this._addIndex,this._operand)),this._addIndex=t=>(this._operand=this._operand+this._indexExtractor(this._state)&255,this._next(this._operand,this._state)),this._operand=0,this._result=new $f,this._state=t,this._indexExtractor=e,this._next=r,Wf(this)}static zeroPageX(t,e=(()=>null)){return new rd(t,t=>t.x,e)}static zeroPageY(t,e=(()=>null)){return new rd(t,t=>t.y,e)}}t([qf,r("design:type",Object)],rd.prototype,"reset",void 0),t([qf,r("design:type",Object)],rd.prototype,"_fetchAddress",void 0),t([qf,r("design:type",Object)],rd.prototype,"_addIndex",void 0),t([qf,r("design:type",Object)],rd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],rd.prototype,"_state",void 0),t([qf,r("design:type",Function)],rd.prototype,"_next",void 0),t([qf,r("design:type",Function)],rd.prototype,"_indexExtractor",void 0);class nd{constructor(t,e){this.reset=()=>this._result.read(this._fetchTarget,this._state.p).poll(!0),this._fetchTarget=t=>(this._operand=t,this._state.p=this._state.p+1&65535,this._predicate(this._state.flags)?this._result.read(this._firstDummyRead,this._state.p):null),this._firstDummyRead=t=>(this._target=this._state.p+(128&this._operand?this._operand-256:this._operand)&65535,(65280&this._target)==(65280&this._state.p)?(this._state.p=this._target,null):this._result.read(this._secondDummyRead,65280&this._state.p|255&this._target).poll(!0)),this._secondDummyRead=t=>(this._state.p=this._target,null),this._target=0,this._operand=0,this._result=new $f,this._state=t,this._predicate=e,Wf(this)}}t([qf,r("design:type",Object)],nd.prototype,"reset",void 0),t([qf,r("design:type",Object)],nd.prototype,"_fetchTarget",void 0),t([qf,r("design:type",Object)],nd.prototype,"_firstDummyRead",void 0),t([qf,r("design:type",Object)],nd.prototype,"_secondDummyRead",void 0),t([qf,r("design:type",Object)],nd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],nd.prototype,"_state",void 0),t([qf,r("design:type",Function)],nd.prototype,"_predicate",void 0);const id=(t,e)=>new nd(t,e);class sd{constructor(t){this.reset=()=>this._result.read(this._fetchPcl,this._state.p),this._fetchPcl=t=>(this._addressLo=t,this._state.p=this._state.p+1&65535,this._result.read(this._dummyStackRead,256+this._state.s)),this._dummyStackRead=()=>this._result.write(this._pushPch,256+this._state.s,this._state.p>>>8),this._pushPch=()=>(this._state.s=this._state.s-1&255,this._result.write(this._pushPcl,256+this._state.s,255&this._state.p)),this._pushPcl=()=>(this._state.s=this._state.s-1&255,this._result.read(this._fetchPch,this._state.p)),this._fetchPch=t=>(this._state.p=this._addressLo|t<<8,null),this._addressLo=0,this._result=new $f,this._state=t,Wf(this)}}t([qf,r("design:type",Object)],sd.prototype,"_fetchPcl",void 0),t([qf,r("design:type",Object)],sd.prototype,"_dummyStackRead",void 0),t([qf,r("design:type",Object)],sd.prototype,"_pushPch",void 0),t([qf,r("design:type",Object)],sd.prototype,"_pushPcl",void 0),t([qf,r("design:type",Object)],sd.prototype,"_fetchPch",void 0),t([qf,r("design:type",Object)],sd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],sd.prototype,"_state",void 0);class ad{constructor(t,e){this.reset=t=>(this._address=t,this._result.read(this._read,t)),this._read=t=>(this._operand=t,this._result.write(this._dummyWrite,this._address,this._operand)),this._dummyWrite=t=>this._result.write(this._write,this._address,this._operation(this._operand,this._state)),this._write=()=>null,this._result=new $f,this._state=t,this._operation=e,Wf(this)}}t([qf,r("design:type",Object)],ad.prototype,"reset",void 0),t([qf,r("design:type",Object)],ad.prototype,"_read",void 0),t([qf,r("design:type",Object)],ad.prototype,"_dummyWrite",void 0),t([qf,r("design:type",Object)],ad.prototype,"_write",void 0),t([qf,r("design:type",Object)],ad.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],ad.prototype,"_state",void 0),t([qf,r("design:type",Function)],ad.prototype,"_operation",void 0);const od=(t,e)=>new ad(t,e);class ud{constructor(t){this.reset=()=>this._result.read(this._dummyOperandRead,this._state.p),this._dummyOperandRead=()=>this._result.read(this._dummyStackRead,256+this._state.s),this._dummyStackRead=()=>(this._state.s=this._state.s+1&255,this._result.read(this._popPcl,256+this._state.s)),this._popPcl=t=>(this._state.p=65280&this._state.p|t,this._state.s=this._state.s+1&255,this._result.read(this._popPch,256+this._state.s)),this._popPch=t=>(this._state.p=255&this._state.p|t<<8,this._result.read(this._incrementP,this._state.p)),this._incrementP=()=>(this._state.p=this._state.p+1&65535,null),this._result=new $f,this._state=t,Wf(this)}}t([qf,r("design:type",Object)],ud.prototype,"reset",void 0),t([qf,r("design:type",Object)],ud.prototype,"_dummyOperandRead",void 0),t([qf,r("design:type",Object)],ud.prototype,"_dummyStackRead",void 0),t([qf,r("design:type",Object)],ud.prototype,"_popPcl",void 0),t([qf,r("design:type",Object)],ud.prototype,"_popPch",void 0),t([qf,r("design:type",Object)],ud.prototype,"_incrementP",void 0),t([qf,r("design:type",Object)],ud.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],ud.prototype,"_state",void 0);class cd{constructor(t,e){this.reset=()=>this._result.read(this._executeOperation,this._state.p).poll(!0),this._executeOperation=()=>(this._operation(this._state),null),this._result=new $f,this._state=t,this._operation=e,Wf(this)}}t([qf,r("design:type",Object)],cd.prototype,"reset",void 0),t([qf,r("design:type",Object)],cd.prototype,"_executeOperation",void 0),t([qf,r("design:type",Object)],cd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],cd.prototype,"_state",void 0),t([qf,r("design:type",Function)],cd.prototype,"_operation",void 0);const hd=(t,e)=>new cd(t,e);class ld{constructor(t,e){this.reset=()=>this._result.read(this._dummyRead,this._state.p).poll(!0),this._dummyRead=()=>this._result.read(this._incrementS,256+this._state.s),this._incrementS=()=>(this._state.s=this._state.s+1&255,this._result.read(this._pull,256+this._state.s)),this._pull=t=>(this._operation(this._state,t),null),this._result=new $f,this._state=t,this._operation=e,Wf(this)}}t([qf,r("design:type",Object)],ld.prototype,"reset",void 0),t([qf,r("design:type",Object)],ld.prototype,"_dummyRead",void 0),t([qf,r("design:type",Object)],ld.prototype,"_incrementS",void 0),t([qf,r("design:type",Object)],ld.prototype,"_pull",void 0),t([qf,r("design:type",Object)],ld.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],ld.prototype,"_state",void 0),t([qf,r("design:type",Function)],ld.prototype,"_operation",void 0);const fd=(t,e)=>new ld(t,e);class dd{constructor(t,e){this.reset=()=>this._result.read(this._dummyRead,this._state.p),this._dummyRead=()=>this._result.write(this._push,256+this._state.s,this._operation(this._state)),this._push=()=>(this._state.s=this._state.s-1&255,null),this._result=new $f,this._state=t,this._operation=e,Wf(this)}}t([qf,r("design:type",Object)],dd.prototype,"reset",void 0),t([qf,r("design:type",Object)],dd.prototype,"_dummyRead",void 0),t([qf,r("design:type",Object)],dd.prototype,"_push",void 0),t([qf,r("design:type",Object)],dd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],dd.prototype,"_state",void 0),t([qf,r("design:type",Function)],dd.prototype,"_operation",void 0);const pd=(t,e)=>new dd(t,e);class _d{constructor(t){this.reset=()=>this._result.read(this._dummyOperandRead,this._state.p),this._dummyOperandRead=()=>this._result.read(this._dummyStackRead,256+this._state.s),this._dummyStackRead=()=>(this._state.s=this._state.s+1&255,this._result.read(this._popP,256+this._state.s)),this._popP=t=>(this._state.flags=-17&(32|t),this._state.s=this._state.s+1&255,this._result.read(this._popPcl,256+this._state.s)),this._popPcl=t=>(this._state.p=65280&this._state.p|t,this._state.s=this._state.s+1&255,this._result.read(this._popPch,256+this._state.s)),this._popPch=t=>(this._state.p=255&this._state.p|t<<8,null),this._result=new $f,this._state=t,Wf(this)}}t([qf,r("design:type",Object)],_d.prototype,"reset",void 0),t([qf,r("design:type",Object)],_d.prototype,"_dummyOperandRead",void 0),t([qf,r("design:type",Object)],_d.prototype,"_dummyStackRead",void 0),t([qf,r("design:type",Object)],_d.prototype,"_popP",void 0),t([qf,r("design:type",Object)],_d.prototype,"_popPcl",void 0),t([qf,r("design:type",Object)],_d.prototype,"_popPch",void 0),t([qf,r("design:type",Object)],_d.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],_d.prototype,"_state",void 0);class gd{constructor(t,e){this.reset=t=>this._result.write(()=>null,t,this._operation(this._state)),this._result=new $f,this._state=t,this._operation=e,Wf(this)}}t([qf,r("design:type",Object)],gd.prototype,"reset",void 0),t([qf,r("design:type",Object)],gd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],gd.prototype,"_state",void 0),t([qf,r("design:type",Function)],gd.prototype,"_operation",void 0);const bd=(t,e)=>new gd(t,e);function vd(t,e){e.flags=-131&e.flags|128&t|(t?0:2)}function md(t,e,r){const n=r(t);return vd(n,e),n}function yd(t,e){vd(e(t),t)}function wd(t,e,r){return vd(r(t,e),e),null}function Ad(t,e){if(8&e.flags){const r=(15&t)+(15&e.a)+(1&e.flags),n=(t>>>4)+(e.a>>>4)+(r>9?1:0);e.a=r%10|n%10<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(n>9?1:0)}else{const r=e.a+t+(1&e.flags),n=255&r;e.flags=-196&e.flags|128&n|(n?0:2)|r>>>8|(~(t^e.a)&(n^t)&128)>>>1,e.a=n}return null}function kd(t){const e=t.a;t.a=t.a<<1&255,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7}function Ed(t,e){const r=t<<1&255;return e.flags=-132&e.flags|128&r|(r?0:2)|t>>>7,r}function xd(t,e){return e.flags=-195&e.flags|192&t|(t&e.a?0:2),null}function Td(t,e,r){const n=r(e)+(255&~t)+1;e.flags=-132&e.flags|128&n|(255&n?0:2)|n>>>8}function Cd(t,e){if(8&e.flags){const r=(15&e.a)-(15&t)-(1&~e.flags),n=(e.a>>>4)-(t>>>4)-(r<0?1:0);e.a=(r<0?10+r:r)|(n<0?10+n:n)<<4,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|(n<0?0:1)}else{t=255&~t;const r=e.a+t+(1&e.flags),n=255&r;e.flags=-196&e.flags|128&n|(n?0:2)|r>>>8|(~(t^e.a)&(n^t)&128)>>>1,e.a=n}return null}function Sd(t){const e=t.a;t.a=t.a>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e}function Rd(t,e){const r=t>>>1;return e.flags=-132&e.flags|128&r|(r?0:2)|1&t,r}function Id(t){const e=t.a;t.a=t.a<<1&255|1&t.flags,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7}function Bd(t,e){const r=t<<1&255|1&e.flags;return e.flags=-132&e.flags|128&r|(r?0:2)|t>>>7,r}function Od(t){const e=t.a;t.a=t.a>>>1|(1&t.flags)<<7,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e}function Pd(t,e){const r=t>>>1|(1&e.flags)<<7;return e.flags=-132&e.flags|128&r|(r?0:2)|1&t,r}function Md(t,e){const r=e.a&t;return e.a=r>>>1,e.flags=-132&e.flags|128&e.a|(e.a?0:2)|1&r,null}function Dd(t,e){const r=t+255&255,n=e.a+(255&~r)+1;return e.flags=-132&e.flags|128&n|(255&n?0:2)|n>>>8,r}function Fd(t,e){const r=(e.a&e.x)+(255&~t)+1;return e.x=255&r,e.flags=-132&e.flags|128&e.x|(255&e.x?0:2)|r>>>8,null}function Ld(t,e){const r=t>>>1|(1&e.flags)<<7;return e.flags=-2&e.flags|1&t,Ad(r,e),r}function jd(t,e){const r=t<<1&255|1&e.flags;return e.flags=-2&e.flags|t>>>7,vd(e.a&=r,e),r}function Nd(t,e){e.flags=-2&e.flags|t>>>7;const r=t<<1&255;return e.a=e.a|r,vd(e.a,e),r}function Ud(t){const e=t.a&t.x;return vd(e,t),e}function zd(t,e){const r=t+1&255;return Cd(r,e),r}function $d(t,e){return e.a&=t,vd(e.a,e),e.flags=-2&e.flags|(128&e.a)>>>7,null}class Hd{constructor(t,e=(()=>null)){this.reset=()=>this._result.read(this._fetchAddressLo,this._state.p),this._fetchAddressLo=t=>(this._address=t,this._state.p=this._state.p+1&65535,this._result.read(this._fetchAddressHi,this._state.p)),this._fetchAddressHi=t=>(this._address|=t<<8,this._state.p=this._state.p+1&65535,this._result.read(this._fetchLo,this._address)),this._fetchLo=t=>(this._operand=t,255==(255&this._address)?this._address&=65280:this._address=this._address+1&65535,this._result.read(this._fetchHi,this._address)),this._fetchHi=t=>(this._operand|=t<<8,this._next(this._operand,this._state)),this._operand=0,this._address=0,this._result=new $f,this._state=t,this._next=e,Wf(this)}}t([qf,r("design:type",Object)],Hd.prototype,"reset",void 0),t([qf,r("design:type",Object)],Hd.prototype,"_fetchAddressLo",void 0),t([qf,r("design:type",Object)],Hd.prototype,"_fetchAddressHi",void 0),t([qf,r("design:type",Object)],Hd.prototype,"_fetchLo",void 0),t([qf,r("design:type",Object)],Hd.prototype,"_fetchHi",void 0),t([qf,r("design:type",Object)],Hd.prototype,"_result",void 0),t([qf,r("design:type",zf.State)],Hd.prototype,"_state",void 0),t([qf,r("design:type",Function)],Hd.prototype,"_next",void 0);class Wd{constructor(t){this._state=t}compile(t){const e=Xf.opcodes[t];switch(e.operation){case 0:return this._createAddressing(e.addressingMode,Ad,{deref:!0});case 1:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.a=e.a&t),{deref:!0});case 2:return 0===e.addressingMode?hd(this._state,kd):this._createAddressing(e.addressingMode,od(this._state,Ed).reset,{writeOp:!0});case 6:return this._createAddressing(e.addressingMode,xd,{deref:!0});case 10:return r=this._state,new Vf(r,65534,!0);case 17:return this._createAddressing(e.addressingMode,(t,e)=>(Td(t,e,t=>t.a),null),{deref:!0});case 18:return this._createAddressing(e.addressingMode,(t,e)=>(Td(t,e,t=>t.x),null),{deref:!0});case 19:return this._createAddressing(e.addressingMode,(t,e)=>(Td(t,e,t=>t.y),null),{deref:!0});case 20:return this._createAddressing(e.addressingMode,od(this._state,(t,e)=>md(t,e,t=>t-1&255)).reset,{writeOp:!0});case 21:return hd(this._state,t=>yd(t,t=>t.x=t.x-1&255));case 22:return hd(this._state,t=>yd(t,t=>t.y=t.y-1&255));case 24:return this._createAddressing(e.addressingMode,od(this._state,(t,e)=>md(t,e,t=>t+1&255)).reset,{writeOp:!0});case 25:return hd(this._state,t=>yd(t,t=>t.x=t.x+1&255));case 26:return hd(this._state,t=>yd(t,t=>t.y=t.y+1&255));case 23:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.a=e.a^t),{deref:!0});case 27:return this._createAddressing(e.addressingMode,(t,e)=>(e.p=t,null));case 28:return(t=>new sd(t))(this._state);case 29:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.a=t),{deref:!0});case 30:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.x=t),{deref:!0});case 31:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.y=t),{deref:!0});case 32:return 0===e.addressingMode?hd(this._state,Sd):this._createAddressing(e.addressingMode,od(this._state,Rd).reset,{writeOp:!0});case 33:return hd(this._state,()=>{});case 34:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.a|=t),{deref:!0});case 35:return pd(this._state,t=>t.a);case 36:return pd(this._state,t=>16|t.flags);case 37:return fd(this._state,(t,e)=>yd(t,t=>t.a=e));case 38:return fd(this._state,(t,e)=>t.flags=-17&(32|e));case 39:return 0===e.addressingMode?hd(this._state,Id):this._createAddressing(e.addressingMode,od(this._state,Bd).reset,{writeOp:!0});case 40:return 0===e.addressingMode?hd(this._state,Od):this._createAddressing(e.addressingMode,od(this._state,Pd).reset,{writeOp:!0});case 41:return(t=>new _d(t))(this._state);case 42:return(t=>new ud(t))(this._state);case 43:return this._createAddressing(e.addressingMode,Cd,{deref:!0});case 48:return this._createAddressing(e.addressingMode,bd(this._state,t=>t.x).reset,{writeOp:!0});case 49:return this._createAddressing(e.addressingMode,bd(this._state,t=>t.y).reset,{writeOp:!0});case 50:return hd(this._state,t=>yd(t,t=>t.x=t.a));case 51:return hd(this._state,t=>yd(t,t=>t.y=t.a));case 52:return hd(this._state,t=>yd(t,t=>t.x=t.s));case 53:return hd(this._state,t=>yd(t,t=>t.a=t.x));case 54:return hd(this._state,t=>t.s=t.x);case 55:return hd(this._state,t=>yd(t,t=>t.a=t.y));case 3:return id(this._state,t=>0==(1&t));case 4:return id(this._state,t=>(1&t)>0);case 8:return id(this._state,t=>0==(2&t));case 5:return id(this._state,t=>(2&t)>0);case 9:return id(this._state,t=>0==(128&t));case 7:return id(this._state,t=>(128&t)>0);case 11:return id(this._state,t=>0==(64&t));case 12:return id(this._state,t=>(64&t)>0);case 44:return hd(this._state,t=>t.flags|=1);case 45:return hd(this._state,t=>t.flags|=8);case 46:return hd(this._state,t=>t.flags|=4);case 47:return this._createAddressing(e.addressingMode,bd(this._state,t=>t.a).reset,{writeOp:!0});case 13:return hd(this._state,t=>t.flags&=-2);case 14:return hd(this._state,t=>t.flags&=-9);case 15:return hd(this._state,t=>t.flags&=-5);case 16:return hd(this._state,t=>t.flags&=-65);case 56:case 57:return this._createAddressing(e.addressingMode,()=>null,{deref:!0});case 67:return this._createAddressing(e.addressingMode,$d);case 64:return this._createAddressing(e.addressingMode,bd(this._state,Ud).reset,{writeOp:!0});case 58:return this._createAddressing(e.addressingMode,Md,{deref:!0});case 62:return this._createAddressing(e.addressingMode,(t,e)=>(function(t,e){e.a=(e.a&t)>>>1|(1&e.flags?128:0),e.flags=-196&e.flags|(64&e.a)>>>6|(e.a?0:2)|128&e.a|64&e.a^(32&e.a)<<1}(t,e),null),{deref:!0});case 59:return this._createAddressing(e.addressingMode,Fd,{deref:!0});case 68:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.x=e.a=e.a&t),{deref:!0});case 60:return this._createAddressing(e.addressingMode,od(this._state,Dd).reset,{writeOp:!0});case 66:return this._createAddressing(e.addressingMode,od(this._state,zd).reset,{writeOp:!0});case 61:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.a=e.x=t),{deref:!0});case 65:return this._createAddressing(e.addressingMode,(t,e)=>wd(t,e,(t,e)=>e.s=e.x=e.a=e.s&t),{deref:!0});case 70:return this._createAddressing(e.addressingMode,od(this._state,jd).reset,{writeOp:!0});case 69:return this._createAddressing(e.addressingMode,od(this._state,Ld).reset,{writeOp:!0});case 63:return this._createAddressing(e.addressingMode,od(this._state,Nd).reset,{writeOp:!0});default:return null}var r}_createAddressing(t,e,{deref:r=!1,writeOp:n=!1}={}){switch(r&&1!==t&&(e=((t,e)=>new Jf(t,e))(this._state,e).reset),t){case 1:return((t,e)=>new Qf(t,e))(this._state,e);case 2:return((t,e)=>new ed(t,e))(this._state,e);case 3:return((t,e)=>new Kf(t,e))(this._state,e);case 6:return((t,e)=>rd.zeroPageX(t,e))(this._state,e);case 9:return((t,e)=>rd.zeroPageY(t,e))(this._state,e);case 7:return((t,e,r)=>Yf.absoluteX(t,e,r))(this._state,e,n);case 10:return((t,e,r)=>Yf.absoluteY(t,e,r))(this._state,e,n);case 8:return((t,e)=>new Zf(t,e))(this._state,e);case 11:return((t,e,r)=>new td(t,e,r))(this._state,e,n);case 4:return((t,e)=>new Hd(t,e))(this._state,e);default:throw new Error("invalid addressing mode "+t)}}}class qd{constructor(t,e){var r;this._bus=t,this._rng=e,this.executionState=0,this.state=new zf.State,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._halt=!1,this._pollInterruptsAfterLastInstruction=!1,this._lastInstructionPointer=0,this._operations=new Array(255),this._opBoot=(r=this.state,new Gf(r)),this._opIrq=(t=>new Vf(t,65534,!1))(this.state),this._opNmi=(t=>new Vf(t,65530,!1))(this.state);const n=new Wd(this.state);for(let t=0;t<256;t++)this._operations[t]=n.compile(t);this.reset()}reset(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._interruptPending=!1,this._nmiPending=!1,this._halt=!1,this._lastResult=this._opBoot.reset(void 0),this._lastInstructionPointer=0,this}setInterrupt(t){return this._interruptPending=t,this}isInterrupt(){return this._interruptPending}nmi(){return this._nmiPending=!0,this}halt(){return this._halt=!0,this}resume(){return this._halt=!1,this}isHalt(){return this._halt}setInvalidInstructionCallback(t){return this._invalidInstructionCallback=t,this}getInvalidInstructionCallback(){return this._invalidInstructionCallback}getLastInstructionPointer(){return this._lastInstructionPointer}cycle(){if(this._halt&&(!this._lastResult||0===this._lastResult.cycleType))return this;if(1===this.executionState)return this._fetch(),this;let t;switch(this._lastResult.cycleType){case 0:t=this._bus.read(this._lastResult.address);break;case 1:t=this._lastResult.value,this._bus.write(this._lastResult.address,t);break;default:throw new Error("invalid cycle type")}return this._lastResult.pollInterrupts&&(this._pollInterrupts(),this._lastResult.pollInterrupts=!1,this._pollInterruptsAfterLastInstruction=!1),this._lastResult=this._lastResult.nextStep(t),null===this._lastResult&&(this.executionState=1),this}_fetch(){let t;this._pollInterruptsAfterLastInstruction&&this._pollInterrupts(),this._lastInstructionPointer=this.state.p;const e=this._bus.read(this.state.p);this.state.nmi?(t=this._opNmi,this._pollInterruptsAfterLastInstruction=!1):this.state.irq?(t=this._opIrq,this._pollInterruptsAfterLastInstruction=!1):(t=this._operations[e],this.state.p=this.state.p+1&65535,this._pollInterruptsAfterLastInstruction=!0),t?(this.executionState=2,this._lastResult=t.reset(void 0)):this._invalidInstructionCallback&&this._invalidInstructionCallback(this)}_pollInterrupts(){if(this.state.irq=!1,this._nmiPending)return this.state.nmi=!0,void(this._nmiPending=!1);!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)}}function Gd(t,e){t.s=t.s+1&255,t.flags=-17&(32|e.read(256+t.s))}function Vd(t,e){t.flags=-131&t.flags|128&e|(e?0:2)}function Xd(t,e,r){if(8&t.flags){const e=(15&r)+(15&t.a)+(1&t.flags),n=(r>>>4)+(t.a>>>4)+(e>9?1:0);t.a=e%10|n%10<<4,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|(n>9?1:0)}else{const e=t.a+r+(1&t.flags),n=255&e;t.flags=-196&t.flags|128&n|(n?0:2)|e>>>8|(~(r^t.a)&(n^r)&128)>>>1,t.a=n}}function Kd(t,e,r){t.a&=r,Vd(t,t.a)}function Yd(t){const e=t.a;t.a=t.a<<1&255,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7}function Jd(t,e,r){const n=e.read(r),i=n<<1&255;e.write(r,i),t.flags=-132&t.flags|128&i|(i?0:2)|n>>>7}function Qd(t,e,r){t.flags=-195&t.flags|192&r|(r&t.a?0:2)}function Zd(t,e){const r=t.p+1&65535;let n=65534;t.nmi&&(n=65530,t.nmi=!1),t.nmi=t.irq=!1,e.write(t.s+256,r>>>8&255),t.s=t.s+255&255,e.write(t.s+256,255&r),t.s=t.s+255&255,e.write(t.s+256,16|t.flags),t.s=t.s+255&255,t.flags|=4,t.p=e.readWord(n)}function tp(t){t.flags&=-2}function ep(t){t.flags&=-9}function rp(t){t.flags&=-5}function np(t){t.flags&=-65}function ip(t,e,r){const n=t.a+(255&~r)+1;t.flags=-132&t.flags|128&n|(255&n?0:2)|n>>>8}function sp(t,e,r){const n=t.x+(255&~r)+1;t.flags=-132&t.flags|128&n|(255&n?0:2)|n>>>8}function ap(t,e,r){const n=t.y+(255&~r)+1;t.flags=-132&t.flags|128&n|(255&n?0:2)|n>>>8}function op(t,e,r){const n=e.read(r)+255&255;e.write(r,n),Vd(t,n)}function up(t){t.x=t.x+255&255,Vd(t,t.x)}function cp(t,e,r){t.a=t.a^r,Vd(t,t.a)}function hp(t){t.y=t.y+255&255,Vd(t,t.y)}function lp(t,e,r){const n=e.read(r)+1&255;e.write(r,n),Vd(t,n)}function fp(t){t.x=t.x+1&255,Vd(t,t.x)}function dp(t){t.y=t.y+1&255,Vd(t,t.y)}function pp(t,e,r){t.p=r}function _p(t,e,r){const n=t.p+1&65535,i=e.read(t.p);e.read(256+t.s),e.write(256+t.s,n>>>8),t.s=t.s+255&255,e.write(256+t.s,255&n),t.s=t.s+255&255,t.p=i|e.read(t.p+1&65535)<<8}function gp(t,e,r,n){t.a=1===n?r:e.read(r),Vd(t,t.a)}function bp(t,e,r,n){t.x=1===n?r:e.read(r),Vd(t,t.x)}function vp(t,e,r,n){t.y=1===n?r:e.read(r),Vd(t,t.y)}function mp(t){const e=t.a;t.a=t.a>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e}function yp(t,e,r){const n=e.read(r),i=n>>>1;e.write(r,i),t.flags=-132&t.flags|128&i|(i?0:2)|1&n}function wp(){}function Ap(t,e,r){t.a|=r,Vd(t,t.a)}function kp(t,e){e.write(256+t.s,16|t.flags),t.s=t.s+255&255}function Ep(t,e){Gd(t,e)}function xp(t,e){e.write(256+t.s,t.a),t.s=t.s+255&255}function Tp(t,e){t.s=t.s+1&255,t.a=e.read(256+t.s),Vd(t,t.a)}function Cp(t){const e=t.a;t.a=t.a<<1&255|1&t.flags,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|e>>>7}function Sp(t,e,r){const n=e.read(r),i=n<<1&255|1&t.flags;e.write(r,i),t.flags=-132&t.flags|128&i|(i?0:2)|n>>>7}function Rp(t){const e=t.a;t.a=t.a>>>1|(1&t.flags)<<7,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&e}function Ip(t,e,r){const n=e.read(r),i=n>>>1|(1&t.flags)<<7;e.write(r,i),t.flags=-132&t.flags|128&i|(i?0:2)|1&n}function Bp(t,e){let r;Gd(t,e),t.s=t.s+1&255,r=e.read(256+t.s),t.s=t.s+1&255,r|=e.read(256+t.s)<<8,t.p=r}function Op(t,e){let r;e.read(256+t.s),t.s=t.s+1&255,r=e.read(256+t.s),t.s=t.s+1&255,r+=e.read(256+t.s)<<8,t.p=r+1&65535}function Pp(t,e,r){if(8&t.flags){const e=(15&t.a)-(15&r)-(1&~t.flags),n=(t.a>>>4)-(r>>>4)-(e<0?1:0);t.a=(e<0?10+e:e)|(n<0?10+n:n)<<4,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|(n<0?0:1)}else{r=255&~r;const e=t.a+r+(1&t.flags),n=255&e;t.flags=-196&t.flags|128&n|(n?0:2)|e>>>8|(~(r^t.a)&(n^r)&128)>>>1,t.a=n}}function Mp(t){t.flags|=1}function Dp(t){t.flags|=8}function Fp(t){t.flags|=4}function Lp(t,e,r){e.write(r,t.a)}function jp(t,e,r){e.write(r,t.x)}function Np(t,e,r){e.write(r,t.y)}function Up(t){t.x=t.a,Vd(t,t.a)}function zp(t){t.y=t.a,Vd(t,t.a)}function $p(t){t.x=t.s,Vd(t,t.x)}function Hp(t){t.a=t.x,Vd(t,t.a)}function Wp(t){t.s=t.x}function qp(t){t.a=t.y,Vd(t,t.a)}function Gp(t,e,r){const n=t.a&r;t.a=n>>>1,t.flags=-132&t.flags|128&t.a|(t.a?0:2)|1&n}function Vp(t,e,r){const n=(t.a&t.x)+(255&~r)+1;t.x=255&n,t.flags=-132&t.flags|128&t.x|(255&t.x?0:2)|n>>>8}function Xp(t,e,r){const n=e.read(r)+255&255;e.write(r,n);const i=t.a+(255&~n)+1;t.flags=-132&t.flags|128&i|(255&i?0:2)|i>>>8}function Kp(t,e,r){t.a=r,t.x=r,Vd(t,r)}function Yp(t,e,r){t.a=(t.a&r)>>>1|(1&t.flags?128:0),t.flags=-196&t.flags|(64&t.a)>>>6|(t.a?0:2)|128&t.a|64&t.a^(32&t.a)<<1}function Jp(t,e,r){let n=e.read(r);t.flags=-2&t.flags|n>>>7,n=n<<1&255,e.write(r,n),t.a=t.a|n,Vd(t,t.a)}function Qp(t,e,r){const n=t.x&t.a;e.write(r,n),Vd(t,n)}function Zp(t,e,r){t.s=t.a=t.x=t.s&r,Vd(t,t.a)}function t_(t,e,r){const n=e.read(r)+1&255;e.write(r,n),Pp(t,0,n)}function e_(t,e,r){t.a&=r,Vd(t,t.a),t.flags=-2&t.flags|(128&t.a)>>>7}function r_(t,e,r){t.a&=r,t.x=t.a,Vd(t,t.a)}function n_(t,e,r){const n=e.read(r),i=n>>>1|(1&t.flags)<<7;e.write(r,i),t.flags=-2&t.flags|1&n,Xd(t,0,i)}function i_(t,e,r){const n=e.read(r),i=n<<1&255|1&t.flags;e.write(r,i),t.flags=-2&t.flags|n>>>7,Kd(t,0,i)}function s_(t,e){t.p=e.readWord(65532)}function a_(t,e,r){const n=t.p;t.nmi&&(r=65530),t.nmi=t.irq=!1,e.write(t.s+256,n>>>8&255),t.s=t.s+255&255,e.write(t.s+256,255&n),t.s=t.s+255&255,e.write(t.s+256,-17&t.flags),t.s=t.s+255&255,t.flags|=4,t.p=e.readWord(r)}function o_(t,e){a_(t,e,65534)}function u_(t,e){a_(t,e,65530)}class c_{constructor(t,e){this._bus=t,this._rng=e,this.executionState=0,this.state=new zf.State,this._opCycles=0,this._instructionCallback=null,this._invalidInstructionCallback=null,this._interruptPending=!1,this._nmiPending=!1,this._interuptCheck=0,this._halted=!1,this._operand=0,this._lastInstructionPointer=0,this._currentAddressingMode=12,this._dereference=!1,this.reset()}setInterrupt(t){return this._interruptPending=t,this}isInterrupt(){return this._interruptPending}nmi(){return this._nmiPending=!0,this}halt(){return this._halted=!0,this}resume(){return this._halted=!1,this}isHalt(){return this._halted}setInvalidInstructionCallback(t){return this._invalidInstructionCallback=t,this}getInvalidInstructionCallback(){return this._invalidInstructionCallback}getLastInstructionPointer(){return this._lastInstructionPointer}reset(){return this.state.a=this._rng?this._rng.int(255):0,this.state.x=this._rng?this._rng.int(255):0,this.state.y=this._rng?this._rng.int(255):0,this.state.s=253,this.state.p=this._rng?this._rng.int(65535):0,this.state.flags=52|(this._rng?this._rng.int(255):0),this.state.irq=!1,this.state.nmi=!1,this.executionState=0,this._opCycles=7,this._interruptPending=!1,this._nmiPending=!1,this._instructionCallback=s_,this}cycle(){if(this._halted)return this;switch(this.executionState){case 0:case 2:0==--this._opCycles&&(this._dereference&&(this._operand=this._bus.read(this._operand)),1===this._interuptCheck&&this._checkForInterrupts(),this._instructionCallback(this.state,this._bus,this._operand,this._currentAddressingMode),this.executionState=1,0===this._interuptCheck&&this._checkForInterrupts());break;case 1:if(this.state.nmi)return this._instructionCallback=u_,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;if(this.state.irq)return this._instructionCallback=o_,this._opCycles=6,this.state.nmi=this.state.irq=!1,this._interuptCheck=1,this.executionState=2,this;this._fetch()}return this}_fetch(){const t=Xf.opcodes[this._bus.read(this.state.p)];let e,r,n=t.addressingMode,i=!1,s=!1;switch(this._lastInstructionPointer=this.state.p,this._currentAddressingMode=n,this._interuptCheck=0,t.operation){case 0:this._opCycles=0,this._instructionCallback=Xd,i=!0;break;case 1:this._opCycles=0,this._instructionCallback=Kd,i=!0;break;case 2:0===n?(this._opCycles=1,this._instructionCallback=Yd):(this._opCycles=3,this._instructionCallback=Jd,s=!0);break;case 3:1&this.state.flags?(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=pp,this._opCycles=0);break;case 4:1&this.state.flags?(this._instructionCallback=pp,this._opCycles=0):(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 5:2&this.state.flags?(this._instructionCallback=pp,this._opCycles=0):(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 6:this._opCycles=0,this._instructionCallback=Qd,i=!0;break;case 7:128&this.state.flags?(this._instructionCallback=pp,this._opCycles=0):(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 8:2&this.state.flags?(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=pp,this._opCycles=0);break;case 9:128&this.state.flags?(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=pp,this._opCycles=0);break;case 11:64&this.state.flags?(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1):(this._instructionCallback=pp,this._opCycles=0);break;case 12:64&this.state.flags?(this._instructionCallback=pp,this._opCycles=0):(n=0,this._instructionCallback=wp,this.state.p=this.state.p+1&65535,this._opCycles=1);break;case 10:this._opCycles=6,this._instructionCallback=Zd,this._interuptCheck=1;break;case 13:this._opCycles=1,this._instructionCallback=tp;break;case 14:this._opCycles=1,this._instructionCallback=ep;break;case 15:this._opCycles=1,this._instructionCallback=rp,this._interuptCheck=1;break;case 16:this._opCycles=1,this._instructionCallback=np;break;case 17:this._opCycles=0,this._instructionCallback=ip,i=!0;break;case 18:this._opCycles=0,this._instructionCallback=sp,i=!0;break;case 19:this._opCycles=0,this._instructionCallback=ap,i=!0;break;case 20:this._opCycles=3,this._instructionCallback=op,s=!0;break;case 21:this._opCycles=1,this._instructionCallback=up;break;case 22:this._opCycles=1,this._instructionCallback=hp;break;case 23:this._opCycles=0,this._instructionCallback=cp,i=!0;break;case 24:this._opCycles=3,this._instructionCallback=lp,s=!0;break;case 25:this._opCycles=1,this._instructionCallback=fp;break;case 26:this._opCycles=1,this._instructionCallback=dp;break;case 27:this._opCycles=0,this._instructionCallback=pp;break;case 28:this._opCycles=5,this._instructionCallback=_p;break;case 29:this._opCycles=1===n?0:1,this._instructionCallback=gp;break;case 30:this._opCycles=1===n?0:1,this._instructionCallback=bp;break;case 31:this._opCycles=1===n?0:1,this._instructionCallback=vp;break;case 32:0===n?(this._opCycles=1,this._instructionCallback=mp):(this._opCycles=3,this._instructionCallback=yp,s=!0);break;case 33:this._opCycles=1,this._instructionCallback=wp;break;case 56:case 57:this._opCycles=0,i=!0,this._instructionCallback=wp;break;case 34:this._opCycles=0,this._instructionCallback=Ap,i=!0;break;case 36:this._opCycles=2,this._instructionCallback=kp;break;case 35:this._opCycles=2,this._instructionCallback=xp;break;case 37:this._opCycles=3,this._instructionCallback=Tp;break;case 38:this._opCycles=3,this._instructionCallback=Ep,this._interuptCheck=1;break;case 39:0===n?(this._opCycles=1,this._instructionCallback=Cp):(this._opCycles=3,this._instructionCallback=Sp,s=!0);break;case 40:0===n?(this._opCycles=1,this._instructionCallback=Rp):(this._opCycles=3,this._instructionCallback=Ip,s=!0);break;case 41:this._opCycles=5,this._instructionCallback=Bp;break;case 42:this._opCycles=5,this._instructionCallback=Op;break;case 43:this._opCycles=0,this._instructionCallback=Pp,i=!0;break;case 44:this._opCycles=1,this._instructionCallback=Mp;break;case 45:this._opCycles=1,this._instructionCallback=Dp;break;case 46:this._opCycles=1,this._instructionCallback=Fp,this._interuptCheck=1;break;case 47:this._opCycles=1,this._instructionCallback=Lp,s=!0;break;case 48:this._opCycles=1,this._instructionCallback=jp,s=!0;break;case 49:this._opCycles=1,this._instructionCallback=Np,s=!0;break;case 50:this._opCycles=1,this._instructionCallback=Up;break;case 51:this._opCycles=1,this._instructionCallback=zp;break;case 52:this._opCycles=1,this._instructionCallback=$p;break;case 53:this._opCycles=1,this._instructionCallback=Hp;break;case 54:this._opCycles=1,this._instructionCallback=Wp;break;case 55:this._opCycles=1,this._instructionCallback=qp;break;case 62:this._opCycles=0,this._instructionCallback=Yp;break;case 58:this._opCycles=0,this._instructionCallback=Gp;break;case 59:this._opCycles=0,this._instructionCallback=Vp;break;case 60:this._opCycles=3,this._instructionCallback=Xp,s=!0;break;case 61:this._opCycles=0,this._instructionCallback=Kp,i=!0;break;case 63:this._opCycles=3,this._instructionCallback=Jp,s=!0,i=!1;break;case 64:this._opCycles=1,this._instructionCallback=Qp;break;case 65:this._opCycles=0,this._instructionCallback=Zp,i=!0;break;case 66:this._opCycles=3,this._instructionCallback=t_,s=!0;break;case 67:this._opCycles=0,this._instructionCallback=e_;break;case 68:this._opCycles=0,this._instructionCallback=r_;break;case 69:this._opCycles=3,i=!1,s=!0,this._instructionCallback=n_;break;case 70:this._opCycles=3,i=!1,s=!0,this._instructionCallback=i_;break;default:return void(this._invalidInstructionCallback&&this._invalidInstructionCallback(this))}switch(this.state.p=this.state.p+1&65535,n){case 1:this._operand=this._bus.read(this.state.p),i=!1,this.state.p=this.state.p+1&65535,this._opCycles++;break;case 2:this._operand=this._bus.read(this.state.p),this.state.p=this.state.p+1&65535,this._opCycles++;break;case 3:this._operand=this._bus.readWord(this.state.p),this.state.p=this.state.p+2&65535,this._opCycles+=2;break;case 4:e=this._bus.readWord(this.state.p),this._operand=255==(255&e)?this._bus.read(e)+(this._bus.read(65280&e)<<8):this._bus.readWord(e),this.state.p=this.state.p+2&65535,this._opCycles+=4;break;case 5:e=this._bus.read(this.state.p),e=128&e?-(255&~(e-1)):e,this._operand=this.state.p+e+65537&65535,this.state.p=this.state.p+1&65535,this._opCycles+=(65280&this._operand)!=(65280&this.state.p)?3:2;break;case 6:r=this._bus.read(this.state.p),this._bus.read(r),this._operand=r+this.state.x&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 7:e=this._bus.readWord(this.state.p),this._operand=e+this.state.x&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&e)?3:2,this.state.p=this.state.p+2&65535;break;case 9:r=this._bus.read(this.state.p),this._bus.read(r),this._operand=r+this.state.y&255,this.state.p=this.state.p+1&65535,this._opCycles+=2;break;case 10:e=this._bus.readWord(this.state.p),this._operand=e+this.state.y&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&this._operand)!=(65280&e)?3:2,this.state.p=this.state.p+2&65535;break;case 8:r=this._bus.read(this.state.p),this._bus.read(r),e=r+this.state.x&255,this._operand=255===e?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(e),this._opCycles+=4,this.state.p=this.state.p+1&65535;break;case 11:e=this._bus.read(this.state.p),e=255===e?this._bus.read(255)+(this._bus.read(0)<<8):this._bus.readWord(e),this._operand=e+this.state.y&65535,(65280&this._operand)!=(65280&e)&&this._bus.read(65280&e|255&this._operand),this._opCycles+=s||(65280&e)!=(65280&this._operand)?4:3,this.state.p=this.state.p+1&65535}this._dereference=i,i&&this._opCycles++,this.executionState=2}_checkForInterrupts(){this._nmiPending&&(this.state.irq=!1,this.state.nmi=!0,this._nmiPending=!1),!this._interruptPending||this.state.nmi||4&this.state.flags||(this.state.irq=!0)}}class h_{constructor(t){this._type=t}create(t,e){switch(this._type){case h_.Type.stateMachine:return new qd(t,e);case h_.Type.batchedAccess:return new c_(t,e);default:throw new Error("invalid CPU type")}}}!function(t){let e;!function(t){t[t.stateMachine=0]="stateMachine",t[t.batchedAccess=1]="batchedAccess"}(e=t.Type||(t.Type={}))}(h_||(h_={}));var l_,f_=h_;!function(t){t.create=function(t={}){return Object.assign({tvMode:0,enableAudio:!0,randomSeed:-1,emulatePaddles:!0,frameStart:-1,pcmAudio:!1,cpuType:f_.Type.stateMachine},t)},t.getClockHz=function(t){switch(t.tvMode){case 0:return 3584160;case 1:case 2:return 3556800}}}(l_||(l_={}));class d_{constructor(t,e){this._content=t,this._sampleRate=e}getLength(){return this._content.length}getContent(){return this._content}getSampleRate(){return this._sampleRate}replaceUnderlyingBuffer(t){this._content=t}}const p_=new Uint8Array(256);function __(t,e){const r=p_[t.charCodeAt(e)];if(r>63)throw new Error('invalid base64 character "'+t[e]+'" at index '+e);return r}function g_(t,e){return(__(t,e)<<18)+(__(t,e+1)<<12)+(__(t,e+2)<<6)+__(t,e+3)}function b_(t){if(t.length%4!=0)throw new Error("invalid base64 data --- char count mismatch");const e=t.length/4,r=3*e-function(t){let e=0,r=t.length-1;for(;r>=0&&"="===t[r--];)e++;return e}(t),n=new Uint8Array(r);let i=0;for(let s=0;s<e;s++){const e=g_(t,4*s);for(let t=0;t<3&&i<r;t++)n[i++]=e>>>8*(2-t)&255}return n}!function(t){let e;for(e=0;e<256;e++)p_[e]=255;for(e=0;e<64;e++)p_["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;p_["=".charCodeAt(0)]=0}();const v_=b_("AQEPAQEBAQEBAQEBAwMDAQ=="),m_=new Int8Array([1]),y_=new Int8Array([1,1]),w_=new Int8Array([16,15]),A_=b_("AQICAQEBBAM="),k_=b_("AQIBAQICBQQCAQMBAQEBBA=="),E_=b_("AQQBAwIEAQIDAgEBAQEBAQIEAgEEAQECAgEDAgEDAQEBBAEBAQECAQECBgECAgECAQIBAQIBBgIBAgIBAQEBAgICAgcCAwICAQEBAwIBAQIBAQcBAQMBAQIDAwEBAQICAQECAgQDBQEDAQEFAgEBAQIBAgEDAQIFAQECAQEBBQEBAQEBAQEBBgEBAQIBAQEBBAIBAQMBAwYDAgMBAQIBAgQBAQEDAQEBAQMBAgEEAgIDBAEBBAECAQICAgEBBAMBBAQJBQQBBQMBAQMCAgIBBQECAQEBAgMBAgEBAwQCBQICAQIDAQEBAQECAQMDAwIBAgEBAQEBAwMBAgIDAQMBCA=="),x_=b_("BQYEBQoFAwcECgYDBgQJBg=="),T_=[m_,A_,A_,b_("AgMCAQQBBgoCBAIBAQQFCQMDBAEBAQgFBQUEAQEBCAQCCAMDAQEHBAIHBQEDAQcEAQQIAgEDBAcBAwcDAgEGBgICBAUDAgYGAQMDAgUDBwMEAwICAgUJAwEFAwECAgsFAQUDAQECDAUBAgUCAQEMBgECBQECAQoGAwICBAECBgo="),y_,y_,w_,k_,E_,k_,w_,m_,y_,y_,w_,x_];class C_{constructor(t){this._config=t}setConfig(t){this._config=t}getKey(t,e){return T_[t]===y_&&v_[t]*(e+1)==1?0:t<<5|e}getBuffer(t){const e=t>>>5&15,r=31&t,n=T_[e];let i=0;for(let t=0;t<n.length;t++)i+=n[t];i=i*v_[e]*(r+1);const s=new Float32Array(i),a=l_.getClockHz(this._config)/114;let o=0,u=0,c=0,h=!0;for(let t=0;t<i;t++)o++,o===v_[e]*(r+1)&&(o=0,u++,u===n[c]&&(c++,u=0,n.length===c&&(c=0)),h=!(1&c)),s[t]=h?1:-1;return new d_(s,a)}}class S_{constructor(t,e){this._index=t,this._rpc=e,this.bufferChanged=new No,this.volumeChanged=new No,this.stop=new No,this._toneGenerator=new C_,this._volume=0}init(){return this._rpc.registerSignalHandler(Mf.waveformAudioBufferChange,this._onBufferChangeSignal.bind(this)).registerSignalHandler(Mf.waveformAudioVolumeChange,this._onVolumeChangeSignal.bind(this)).registerSignalHandler(Mf.audioStop,this._onStopSignal.bind(this)),this}start(t){return n(this,void 0,void 0,(function*(){const e=yield this._rpc.rpc(Pf.getWaveformAudioParameters(this._index));this._toneGenerator.setConfig(t),this.setVolume(e.volume)}))}setVolume(t){return this._volume=t,this}getVolume(){return this._volume}getBuffer(t){return this._toneGenerator.getBuffer(t)}_onVolumeChangeSignal(t){t.index===this._index&&(this._volume=t.value,this.volumeChanged.dispatch(this._volume))}_onBufferChangeSignal(t){t.index===this._index&&this.bufferChanged.dispatch(t.key)}_onStopSignal(t){t===this._index&&this.stop.dispatch(void 0)}}class R_{constructor(t,e){this._index=t,this._rpc=e,this.newFrame=new No,this.togglePause=new No,this._sampleRate=0,this._frameSize=0,this._paused=!1,this._framePool=new Of(()=>null),this._frameMap=new WeakMap,this._enabled=!1,this._signalReturnFrame="",this._framePool.event.release.addHandler(R_._onReleaseFragment,this),this._signalReturnFrame=Mf.pcmAudioReturnFrame(this._index)}init(){return this._rpc.registerSignalHandler(Mf.pcmAudioNewFrame(this._index),this._onNewFrame.bind(this)).registerSignalHandler(Mf.pcmAudioTogglePause(this._index),this._onTogglePause.bind(this)),this}start(){return n(this,void 0,void 0,(function*(){if(this._enabled)return;const t=yield this._rpc.rpc(Pf.getPCMAudioParameters(this._index));this._sampleRate=t.sampleRate,this._frameSize=t.frameSize,this._paused=t.paused,this._enabled=!0}))}stop(){this._enabled=!1}isPaused(){return this._paused}getSampleRate(){return this._sampleRate}getFrameSize(){return this._frameSize}static _onReleaseFragment(t,e){e._frameMap.has(t)&&e._rpc.signal(e._signalReturnFrame,{id:e._frameMap.get(t),buffer:t.buffer},[t.buffer])}_onNewFrame(t){if(!this._enabled)return;const e=this._framePool.get(),r=new Float32Array(t.buffer);e.adopt(r),this._frameMap.set(r,t.id),this.newFrame.dispatch(e)}_onTogglePause(t){t.paused!==this._paused&&(this._paused=t.paused,this.togglePause.dispatch(this._paused))}}class I_{constructor(t){this._rpc=t,this.message=new No}init(){this._rpc.registerSignalHandler(Mf.messageFromAsyncIO,t=>this.message.dispatch(t))}send(t){this._rpc.signal(Mf.messageToAsyncIO,Array.from(t))}}class B_{constructor(t){this._stellaWorkerUri=t,this.stateChanged=new No,this.frequencyUpdate=new No,this._rateLimitEnforced=!0,this._mutex=new Tf,this._worker=null,this._rpc=null,this._state=kf.State.stopped,this._lastError=null,this._emulationContext=null,this._frequency=0,this._waveformChannels=new Array(2),this._pcmChannel=null,this._controlProxy=null,this._controlProxyUpdateHandle=null,this._proxyState=0,this._savedConfig=null}init(){return n(this,void 0,void 0,(function*(){this._worker=new Worker(this._stellaWorkerUri),this._rpc=new Rf((t,e)=>this._worker.postMessage(t,e)),this._pcmChannel=new R_(0,this._rpc).init();for(let t=0;t<2;t++)this._waveformChannels[t]=new S_(t,this._rpc).init();const t=new Df(this._rpc),e=new Uf(this._rpc),r=new I_(this._rpc);r.init(),t.init(),this._emulationContext=new If(t,e,this._waveformChannels,this._pcmChannel,r),this._worker.onmessage=t=>this._rpc.dispatch(t.data),this._rpc.registerSignalHandler(Mf.emulationFrequencyUpdate,this._onFrequencyUpdate.bind(this)).registerSignalHandler(Mf.emulationError,this._onEmulationError.bind(this)),this._controlProxy=e}))}start(t,e,r){return n(this,void 0,void 0,(function*(){return yield this.stop(),this._mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){const n=yield this._rpc.rpc(Pf.emulationStart,{buffer:t,config:e,cartridgeType:r});return n===kf.State.paused?(this._savedConfig=e,this._emulationContext.setConfig(e),yield this._startProxies(e)):this._savedConfig=null,this._applyState(n)})))}))}pause(){return this._mutex.runExclusive(()=>this._rpc.rpc(Pf.emulationPause).then(t=>(this._pauseProxies(),this._applyState(t))))}stop(){return this._mutex.runExclusive(()=>this._rpc.rpc(Pf.emulationStop).then(t=>(this._stopProxies(),this._applyState(t))))}reset(){return this._mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){const t=yield this._rpc.rpc(Pf.emulationReset);return this._state!==kf.State.error||t!==kf.State.running&&t!==kf.State.paused||!this._savedConfig||(yield this._startProxies(this._savedConfig)),this._applyState(t)})))}resume(){return this._mutex.runExclusive(()=>this._rpc.rpc(Pf.emulationResume).then(t=>(this._resumeProxies(),this._applyState(t))))}setRateLimit(t){return this._rateLimitEnforced=t,this._rpc.rpc(Pf.emulationSetRateLimit,t)}getFrequency(){return this._frequency}getRateLimit(){return this._rateLimitEnforced}getState(){return this._state}getLastError(){return this._lastError}getEmulationContext(){switch(this._state){case kf.State.running:case kf.State.paused:return this._emulationContext;default:return null}}_fetchLastError(){return this._rpc.rpc(Pf.emulationFetchLastError).then(t=>t?new Error(t):null)}_applyState(t){return t===kf.State.error?this._fetchLastError().then(e=>(this._state=t,this._lastError=e,this._stopProxies(),this.stateChanged.dispatch(t),t)):(this._state=t,this.stateChanged.dispatch(t),t)}_onFrequencyUpdate(t){this._frequency=t,this.frequencyUpdate.dispatch(this._frequency)}_onEmulationError(t){this._lastError=new Error(t||""),this._stopProxies(),this._state=kf.State.error,this.stateChanged.dispatch(this._state)}_startProxies(t){return n(this,void 0,void 0,(function*(){yield this._emulationContext.getVideoProxy().start();for(let e=0;e<this._waveformChannels.length;e++)yield this._waveformChannels[e].start(t);yield this._pcmChannel.start(),this._startControlUpdates(),this._proxyState=1}))}_stopProxies(){0!==this._proxyState&&(this._emulationContext.getVideoProxy().stop(),this._pcmChannel.stop(),this._stopControlUpdates(),this._proxyState=0)}_pauseProxies(){1===this._proxyState&&(this._stopControlUpdates(),this._proxyState=2)}_resumeProxies(){2===this._proxyState&&(this._startControlUpdates(),this._proxyState=1)}_startControlUpdates(){null===this._controlProxyUpdateHandle&&(this._controlProxyUpdateHandle=setInterval(()=>this._controlProxy.sendUpdate(),25))}_stopControlUpdates(){null!==this._controlProxyUpdateHandle&&(clearInterval(this._controlProxyUpdateHandle),this._controlProxyUpdateHandle=null)}}class O_{constructor(){this._drivers=new Map,this._driversBound=!1}bind(t){return this._driversBound||(this._emulationService=t,this._shouldBindDrivers()&&this._bindDrivers(),this._emulationService.stateChanged.addHandler(O_._onEmuStateChange,this)),this}unbind(){return this._emulationService?(this._unbindDrivers(),this._emulationService.stateChanged.removeHandler(O_._onEmuStateChange,this),this._emulationService=null,this):this}addDriver(t,e){return this._drivers.set(t,new O_.DriverContext(t,e)),this._driversBound&&e(this._emulationService.getEmulationContext(),t),this}removeDriver(t){return this._drivers.get(t)?(t.unbind(),this._drivers.delete(t),this):this}static _onEmuStateChange(t,e){e._shouldBindDrivers(t)?e._bindDrivers():e._unbindDrivers()}_shouldBindDrivers(t=(this._emulationService?this._emulationService.getState():void 0)){return this._emulationService&&(t===kf.State.running||t===kf.State.paused)}_bindDrivers(){this._driversBound||(this._drivers.forEach(t=>t.binder(this._emulationService.getEmulationContext(),t.driver)),this._driversBound=!0)}_unbindDrivers(){this._driversBound&&(this._drivers.forEach(t=>t.driver.unbind()),this._driversBound=!1)}}function P_(t){return`precision ${t.highpInVsh?"highp":"mediump"} float;`}var M_,D_;function F_(t,e,r){const n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(`failed to compile shader:\n\n${t.getShaderInfoLog(n)}\n\n${r}`);return n}!function(t){t.DriverContext=class{constructor(t,e){this.driver=t,this.binder=e}}}(O_||(O_={})),function(t){let e;!function(t){t.source=t=>`\n            ${function(t){return`precision ${t.highpInVsh?"highp":"mediump"} float;`}(t)}\n\n            attribute vec2 a_VertexPosition;\n            attribute vec2 a_TextureCoordinate;\n\n            varying vec2 v_TextureCoordinate;\n\n            void main() {\n                v_TextureCoordinate = a_TextureCoordinate;\n                gl_Position = vec4(a_VertexPosition, 0, 1);\n            }\n        `}(e=t.plain||(t.plain={}))}(M_||(M_={})),function(t){let e,r,n,i,s,a;!function(t){t.source=t=>`\n            ${P_(t)}\n\n            varying vec2 v_TextureCoordinate;\n\n            uniform sampler2D u_Sampler0;\n\n            void main() {\n                gl_FragColor = vec4(texture2D(u_Sampler0, v_TextureCoordinate).rgb, 1.0);\n            }\n        `}(e=t.blit||(t.blit={})),function(t){t.source=t=>`\n            ${P_(t)}\n\n            varying vec2 v_TextureCoordinate;\n\n            uniform sampler2D u_Sampler0;\n            uniform float u_Gamma;\n\n            void main() {\n                vec4 texel = texture2D(u_Sampler0, v_TextureCoordinate);\n\n                gl_FragColor = vec4(pow(texel.rgb, vec3(u_Gamma)), 1.);\n            }\n        `}(r=t.blitWithGamma||(t.blitWithGamma={})),function(t){t.source=t=>`\n            ${P_(t)}\n\n            varying vec2 v_TextureCoordinate;\n\n            uniform float u_PhosphorLevel;\n            uniform sampler2D u_Sampler_NewImage;\n            uniform sampler2D u_Sampler_PreviousImage;\n\n            float applyPhosphor(float new, float previous) {\n                float decayed = previous * u_PhosphorLevel;\n                decayed = step(0.5, (previous - decayed) * 255.0) * decayed;\n\n                return max(new, decayed);\n            }\n\n            void main() {\n                vec4 new = texture2D(u_Sampler_NewImage, v_TextureCoordinate);\n                vec4 previous = texture2D(u_Sampler_PreviousImage, v_TextureCoordinate);\n\n                gl_FragColor = vec4(\n                    applyPhosphor(new.r, previous.r),\n                    applyPhosphor(new.g, previous.g),\n                    applyPhosphor(new.b, previous.b),\n                    1.0\n                );\n            }\n        `}(n=t.phosphor||(t.phosphor={})),function(t){t.source=t=>`\n            ${P_(t)}\n\n            #define PI 3.14159265\n\n            #define CHROMA_MOD_FREQ (PI / 3.0)\n\n            #define SATURATION 1.0\n            #define BRIGHTNESS 1.0\n\n            uniform sampler2D u_Sampler0;\n            uniform float u_Fringing;\n            uniform float u_Artifacting;\n\n            varying vec2 v_TextureCoordinate;\n\n            const mat3 yiq_mat = mat3(\n                0.2989, 0.5870, 0.1140,\n                0.5959, -0.2744, -0.3216,\n                0.2115, -0.5229, 0.3114\n            );\n\n            vec3 rgb2yiq(vec3 col) {\n                return col * yiq_mat;\n            }\n\n            ${t.floatTextures||t.halfFloatTextures?"":"\n                vec4 pack(vec3 yiq) {\n                    yiq += 1.2;\n                    yiq /= 3.4;\n\n                    int y_byte = int(yiq.r * 1024.0);\n                    int i_byte = int(yiq.g * 1024.0);\n                    int q_byte = int(yiq.b * 1024.0);\n\n                    int y_high = (y_byte / 4) * 4;\n                    int i_high = (i_byte / 4) * 4;\n                    int q_high = (q_byte / 4) * 4;\n                    int alpha = (q_byte - q_high) * 16 + (i_byte - i_high) * 4 + (y_byte - y_high);\n\n                    return vec4(\n                        float(y_high / 4) / 255.0,\n                        float(i_high / 4) / 255.0,\n                        float(q_high / 4) / 255.0,\n                        float(alpha) / 255.0\n                    );\n                }\n                "}\n\n            void main() {\n                mat3 mix_mat = mat3(\n                    BRIGHTNESS, u_Fringing, u_Fringing,\n                    u_Artifacting, 2.0 * SATURATION, 0.0,\n                    u_Artifacting, 0.0, 2.0 * SATURATION\n                );\n\n                vec3 col = texture2D(u_Sampler0, v_TextureCoordinate).rgb;\n                vec3 yiq = rgb2yiq(col);\n\n                float mod_phase = v_TextureCoordinate.x * 960.0 * CHROMA_MOD_FREQ;\n\n                float i_mod = cos(mod_phase);\n                float q_mod = sin(mod_phase);\n\n                yiq.yz *= vec2(i_mod, q_mod); // Modulate.\n                yiq *= mix_mat; // Cross-talk.\n                yiq.yz *= vec2(i_mod, q_mod); // Demodulate.\n\n                gl_FragColor = ${t.floatTextures||t.halfFloatTextures?"vec4(yiq, 1.0)":"pack(yiq)"};\n            }\n        `}(i=t.ntscPass1||(t.ntscPass1={})),function(t){const e=[1202e-8,22146e-9,13155e-9,1202e-8,49979e-9,11394e-8,12215e-8,5612e-9,170516e-9,237199e-9,16964e-8,285688e-9,984574e-9,.002018683,.002002275,-909882e-9,-.007049081,-.01322286,-.012606931,.00246086,.035868225,.084016453,.1355635,.175261268,.190176552],r=[118847e-9,271306e-9,502642e-9,930833e-9,.001451013,.002064744,.002700432,.003241276,.003524948,-.003350284,-.002491729,-721149e-9,.002164659,.006313635,.011789103,.01854566,.026414396,.03510071,.044196567,.053207202,.061590275,.068803602,.074356193,.077856564,.079052396];function n(t,e){return t.floatTextures||t.halfFloatTextures?e+".rgb":`unpack(${e})`}t.source=t=>`\n            ${P_(t)}\n\n            uniform sampler2D u_Sampler0;\n            varying vec2 v_TextureCoordinate;\n\n            const mat3 yiq2rgb_mat = mat3(\n                1.0, 0.956, 0.6210,\n                1.0, -0.2720, -0.6474,\n                1.0, -1.1060, 1.7046\n            );\n\n            vec3 yiq2rgb(vec3 yiq) {\n                return yiq * yiq2rgb_mat;\n            }\n\n            ${t.floatTextures||t.halfFloatTextures?"":"\n                vec3 unpack(vec4 yiqPacked) {\n                    int y_high = int(yiqPacked.r * 1024.0);\n                    int i_high = int(yiqPacked.g * 1024.0);\n                    int q_high = int(yiqPacked.b * 1024.0);\n                    int alpha = int(yiqPacked.a * 256.0);\n\n                    int y_low = alpha - (alpha / 4) * 4;\n                    int i_low = alpha - y_low - (alpha / 16) * 16;\n                    int q_low = alpha - i_low - y_low;\n\n                    return vec3(\n                        float(y_high + y_low) / 1023.0,\n                        float(i_high + i_low) / 1023.0,\n                        float(q_high + q_low) / 1023.0\n                    ) * 3.4 - 1.2;\n                }\n                "}\n\n            vec3 fetch_offset(int offset) {\n                float x = v_TextureCoordinate.x + float(offset) / 960.0;\n\n                return step(0.0, x) * step(-1.0, -x) *\n                    ${n(t,"texture2D(u_Sampler0, vec2(x, v_TextureCoordinate.y))")};\n            }\n\n            void main() {\n                float one_x = 1.0 / 960.0;\n                vec3 signal = vec3(0.0);\n\n                ${new Array(24).fill(0).map((t,n)=>`\n                signal +=\n                    (fetch_offset(${n-24}) + fetch_offset(${24-n})) *\n                        vec3(${e[n]}, ${r[n]}, ${r[n]});\n                `).join("\n")}\n\n                signal += ${n(t,"texture2D(u_Sampler0, v_TextureCoordinate)")} *\n                    vec3(${e[24]}, ${r[24]}, ${r[24]});\n\n                vec3 rgb = yiq2rgb(signal);\n                gl_FragColor = vec4(rgb, 1.0);\n            }\n        `}(s=t.ntscPass2||(t.ntscPass2={})),function(t){t.source=t=>`\n            ${P_(t)}\n\n            uniform sampler2D u_Sampler0;\n            uniform float u_Level;\n            uniform float u_Height;\n\n            varying vec2 v_TextureCoordinate;\n\n            void main() {\n                vec3 texel = texture2D(u_Sampler0, v_TextureCoordinate).rgb;\n\n                gl_FragColor = vec4(\n                    (step(1.0, mod(v_TextureCoordinate.y * u_Height, 2.0)) * (1.0 - u_Level) + u_Level) * texel, 1.0);\n            }\n        `}(a=t.scanlines||(t.scanlines={}))}(D_||(D_={}));class L_{constructor(t,e,r,n){this._gl=t,this._program=e,this._vsh=r,this._fsh=n,this._attributeLocations=new Map,this._uniformLocations=new Map}static compile(t,e,r,n={a_VertexPosition:0}){const i=F_(t,t.VERTEX_SHADER,e),s=F_(t,t.FRAGMENT_SHADER,r),a=t.createProgram();for(const e of Object.keys(n))t.bindAttribLocation(a,n[e],e);if(t.attachShader(a,i),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("failed to link program:\n\n"+t.getProgramInfoLog(a));return new L_(t,a,i,s)}delete(){const t=this._gl;t.deleteProgram(this._program),t.deleteShader(this._vsh),t.deleteShader(this._fsh)}use(){this._gl.useProgram(this._program)}getAttribLocation(t){if(!this._attributeLocations.has(t)){const e=this._gl.getAttribLocation(this._program,t);if(e<0)throw new Error("invalid attribute "+t);this._attributeLocations.set(t,e)}return this._attributeLocations.get(t)}getUniformLocation(t){if(!this._uniformLocations.has(t)){const e=this._gl.getUniformLocation(this._program,t);if(null===e)throw new Error("invalid uniform "+t);this._uniformLocations.set(t,e)}return this._uniformLocations.get(t)}bindVertexAttribArray(t,e,r,n,i,s,a){const o=this._gl;o.bindBuffer(o.ARRAY_BUFFER,e),o.vertexAttribPointer(this.getAttribLocation(t),r,n,i,s,a),o.enableVertexAttribArray(this.getAttribLocation(t))}uniform1i(t,e){this._gl.uniform1i(this.getUniformLocation(t),e)}uniform1f(t,e){this._gl.uniform1f(this.getUniformLocation(t),e)}}class j_{constructor(t,e){this._gl=t,this._capabilities=e,this._width=0,this._height=0,this._texture0=null,this._texture1=null,this._framebuffer=null,this._program=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._initialized=!1}init(){if(this._initialized)return;const t=this._gl;this._framebuffer=t.createFramebuffer(),this._program=L_.compile(t,M_.plain.source(this._capabilities),D_.phosphor.source(this._capabilities)),this._program.use(),this._program.uniform1i("u_Sampler_NewImage",0),this._program.uniform1i("u_Sampler_PreviousImage",1),this._vertexCoordinateBuffer=t.createBuffer(),this._textureCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._textureCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),t.STATIC_DRAW),this._initialized=!0}destroy(){if(!this._initialized)return;const t=this._gl;this._program.delete(),t.deleteFramebuffer(this._framebuffer),t.deleteBuffer(this._vertexCoordinateBuffer),t.deleteBuffer(this._textureCoordinateBuffer),this._texture0&&t.deleteTexture(this._texture0),this._texture1&&t.deleteTexture(this._texture1),this._initialized=!1}render(t){const e=this._gl;this._program.use(),this._program.bindVertexAttribArray("a_VertexPosition",this._vertexCoordinateBuffer,2,e.FLOAT,!1,0,0),this._program.bindVertexAttribArray("a_TextureCoordinate",this._textureCoordinateBuffer,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._texture0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture1,0),e.viewport(0,0,this._width,this._height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4);const r=this._texture1;this._texture1=this._texture0,this._texture0=r}getWidth(){return this._width}getHeight(){return this._height}getTexture(){return this._texture0}resize(t,e){if(!this._initialized)return;this._width=t,this._height=e;const r=this._gl;this._texture0&&r.deleteTexture(this._texture0),this._texture1&&r.deleteTexture(this._texture1),this._texture0=r.createTexture(),this._texture1=r.createTexture(),r.bindFramebuffer(r.FRAMEBUFFER,this._framebuffer),r.viewport(0,0,t,e),r.clearColor(0,0,0,1),r.activeTexture(r.TEXTURE0);for(const n of[this._texture0,this._texture1])r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.clear(r.COLOR_BUFFER_BIT)}configure(t){this._initialized&&(this._program.use(),this._program.uniform1f("u_PhosphorLevel",t))}}class N_{constructor(t,e){this._gl=t,this._capabilities=e,this._height=0,this._programPass1=null,this._programPass2=null,this._targetPass1=null,this._targetPass2=null,this._framebuffer=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._initialized=!1}init(){if(this._initialized)return;const t=this._gl;t.getExtension("WEBGL_color_buffer_float"),t.getExtension("OES_texture_float"),this._programPass1=L_.compile(t,M_.plain.source(this._capabilities),D_.ntscPass1.source(this._capabilities)),this._programPass2=L_.compile(t,M_.plain.source(this._capabilities),D_.ntscPass2.source(this._capabilities)),this._programPass1.use(),this._programPass1.uniform1i("u_Sampler0",0),this._programPass2.use(),this._programPass2.uniform1i("u_Sampler0",0),this._framebuffer=t.createFramebuffer(),this._vertexCoordinateBuffer=t.createBuffer(),this._textureCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._textureCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),t.STATIC_DRAW),this._initialized=!0}destroy(){if(!this._initialized)return;const t=this._gl;this._programPass1.delete(),this._programPass2.delete(),t.deleteFramebuffer(this._framebuffer),t.deleteTexture(this._targetPass1),t.deleteTexture(this._targetPass2),t.deleteBuffer(this._vertexCoordinateBuffer),t.deleteBuffer(this._textureCoordinateBuffer),this._initialized=!1}render(t){this._pass(t,this._targetPass1,this._programPass1,960),this._pass(this._targetPass1,this._targetPass2,this._programPass2,480)}getWidth(){return 480}getHeight(){return this._height}getTexture(){return this._targetPass2}resize(t,e){if(!this._initialized)return;if(160!==t)throw new Error("NTSC postprocessor supports only for width = 160");this._height=e;const r=this._gl;this._targetPass1&&r.deleteTexture(this._targetPass1),this._targetPass2&&r.deleteTexture(this._targetPass2),this._targetPass1=r.createTexture(),this._targetPass2=r.createTexture(),r.activeTexture(r.TEXTURE0);for(const t of[this._targetPass1,this._targetPass2])r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t===this._targetPass1?960:480,e,0,r.RGBA,t===this._targetPass1?this._textureType():r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR)}configure(t){this._initialized&&(this._programPass1.use(),"composite"===t?(this._programPass1.uniform1f("u_Artifacting",1),this._programPass1.uniform1f("u_Fringing",1)):(this._programPass1.uniform1f("u_Artifacting",0),this._programPass1.uniform1f("u_Fringing",0)))}_pass(t,e,r,n){const i=this._gl;r.use(),r.bindVertexAttribArray("a_VertexPosition",this._vertexCoordinateBuffer,2,i.FLOAT,!1,0,0),r.bindVertexAttribArray("a_TextureCoordinate",this._textureCoordinateBuffer,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,this._framebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),i.viewport(0,0,n,this._height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),i.drawArrays(i.TRIANGLE_STRIP,0,4)}_textureType(){const t=this._gl;return this._capabilities.floatTextures?t.FLOAT:this._capabilities.halfFloatTextures?t.getExtension("OES_texture_half_float").HALF_FLOAT_OES:t.UNSIGNED_BYTE}}class U_{constructor(t,e){this._gl=t,this._capabilities=e,this._width=0,this._height=0,this._texture=null,this._program=null,this._framebuffer=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._initialized=!1}init(){if(this._initialized)return;const t=this._gl;this._framebuffer=t.createFramebuffer(),this._program=L_.compile(t,M_.plain.source(this._capabilities),D_.scanlines.source(this._capabilities)),this._program.use(),this._program.uniform1i("u_Sampler0",0),this._vertexCoordinateBuffer=t.createBuffer(),this._textureCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._textureCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),t.STATIC_DRAW),this._initialized=!0}destroy(){if(!this._initialized)return;const t=this._gl;this._program.delete(),t.deleteFramebuffer(this._framebuffer),t.deleteBuffer(this._vertexCoordinateBuffer),t.deleteBuffer(this._textureCoordinateBuffer),this._texture&&t.deleteTexture(this._texture),this._initialized=!1}render(t){const e=this._gl;this._program.use(),this._program.bindVertexAttribArray("a_VertexPosition",this._vertexCoordinateBuffer,2,e.FLOAT,!1,0,0),this._program.bindVertexAttribArray("a_TextureCoordinate",this._textureCoordinateBuffer,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),e.viewport(0,0,this._width,2*this._height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}getWidth(){return this._width}getHeight(){return 2*this._height}getTexture(){return this._texture}resize(t,e){if(!this._initialized)return;this._width=t,this._height=e;const r=this._gl;this._texture&&r.deleteTexture(this._texture),this._texture=r.createTexture(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this._texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,2*e,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),this._program.use(),this._program.uniform1f("u_Height",2*this._height)}configure(t){this._initialized&&(this._program.use(),this._program.uniform1f("u_Level",1-t))}}class z_{constructor(t,e){this._gl=t,this._capabilities=e,this._width=0,this._height=0,this._widthFrom=0,this._heightFrom=0,this._widthTo=0,this._heightTo=0,this._texture=null,this._program=null,this._framebuffer=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._initialized=!1}init(){if(this._initialized)return;const t=this._gl;this._framebuffer=t.createFramebuffer(),this._program=L_.compile(t,M_.plain.source(this._capabilities),D_.blit.source(this._capabilities)),this._program.use(),this._program.uniform1i("u_Sampler0",0),this._vertexCoordinateBuffer=t.createBuffer(),this._textureCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._textureCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),t.STATIC_DRAW),this._initialized=!0}destroy(){if(!this._initialized)return;const t=this._gl;this._program.delete(),t.deleteFramebuffer(this._framebuffer),t.deleteBuffer(this._vertexCoordinateBuffer),t.deleteBuffer(this._textureCoordinateBuffer),this._texture&&t.deleteTexture(this._texture),this._initialized=!1}render(t){const e=this._gl;this._program.use(),this._program.bindVertexAttribArray("a_VertexPosition",this._vertexCoordinateBuffer,2,e.FLOAT,!1,0,0),this._program.bindVertexAttribArray("a_TextureCoordinate",this._textureCoordinateBuffer,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),e.viewport(0,0,this._width,this._height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}getWidth(){return this._width}getHeight(){return this._height}getTexture(){return this._texture}resize(t,e){this._widthFrom=t,this._heightFrom=e,this._reconfigure()}configure(t,e){this._widthTo=t,this._heightTo=e,this._reconfigure()}_reconfigure(){if(this._widthFrom<=0||this._heightFrom<=0||this._widthTo<=0||this._heightTo<=0||!this._initialized)return;this._width=this._widthTo>this._widthFrom?Math.floor(this._widthTo/this._widthFrom)*this._widthFrom:this._widthFrom,this._height=this._heightTo>this._heightFrom?Math.floor(this._heightTo/this._heightFrom)*this._heightFrom:this._heightFrom;const t=this._gl;this._texture&&t.deleteTexture(this._texture),this._texture=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._width,this._height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)}}class $_{constructor(t){this._capacity=t,this.evict=new No,this._size=0,this._index=0,this._buffer=new Array(this._capacity);for(let t=0;t<this._capacity;t++)this._buffer[t]=null}size(){return this._size}pop(){if(0===this._size)return;const t=this._buffer[this._index];return this._buffer[this._index]=null,this._index=(this._index+1)%this._capacity,this._size--,t}push(t){return this._size===this._capacity&&this.evict.dispatch(this.pop()),this._buffer[(this._index+this._size++)%this._capacity]=t,this}forEach(t){for(let e=0;e<this._size;e++)t(this._buffer[(this._index+e)%this._capacity]);return this}clear(){for(let t=0;t<this._capacity;t++)this._buffer[t]=null;return this._size=0,this._index=0,this}capacity(){return this._capacity}}function H_(t,e){const r=t.createTexture(),n=t.createFramebuffer();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,64,64,0,t.RGBA,e,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.deleteFramebuffer(n),t.deleteTexture(r),i===t.FRAMEBUFFER_COMPLETE}function W_(t){return t.getExtension("WEBGL_color_buffer_float"),!!t.getExtension("OES_texture_float")&&H_(t,t.FLOAT)}function q_(t){t.getExtension("EXT_color_buffer_half_float");const e=t.getExtension("OES_texture_half_float");return!!e&&H_(t,e.HALF_FLOAT_OES)}function G_(t,e,r){const n=t.getShaderPrecisionFormat(e,r);return!!n&&n.precision>0}function V_(t=null){if(!t){const e=document.createElement("canvas");e.width=64,e.height=64,t=e.getContext("webgl")||e.getContext("experimental-webgl")}return t?{floatTextures:W_(t),halfFloatTextures:q_(t),highpInFsh:G_(t,t.FRAGMENT_SHADER,t.HIGH_FLOAT),highpInVsh:G_(t,t.VERTEX_SHADER,t.HIGH_FLOAT)}:null}class X_{constructor(t,e={}){this._canvas=t,this._onContextLost=t=>{t.preventDefault(),this._gl=null,this._mainProgram=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._sourceTexture=null,this._phosphorProcessor=null,this._ntscProcessor=null,this._integerScalingProcessor=null,this._scanlineProcessor=null,this._processors=[]},this._onContextRestored=()=>{this._getRenderingContext(),this.init()},this._config=null,this._gl=null,this._video=null,this._capabilities=null,this._mainProgram=null,this._vertexCoordinateBuffer=null,this._textureCoordinateBuffer=null,this._sourceTexture=null,this._anmiationFrameHandle=0,this._phosphorProcessor=null,this._ntscProcessor=null,this._scanlineProcessor=null,this._integerScalingProcessor=null,this._processors=[],this._pendingFrames=new $_(3),this._consecutiveUnderflows=0,this._hasFrame=!1;this._config=Object.assign(Object.assign({},{gamma:1,scalingMode:"qis",phosphorLevel:.5,scanlineLevel:.2,tvEmulation:"composite"}),e),this._getRenderingContext(),this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._pendingFrames.evict.addHandler(t=>t.release())}init(){return this._gl?(this._phosphorProcessor=new j_(this._gl,this._capabilities),this._ntscProcessor=new N_(this._gl,this._capabilities),this._scanlineProcessor=new U_(this._gl,this._capabilities),this._integerScalingProcessor=new z_(this._gl,this._capabilities),this._updateCanvasSize(),this._mainProgram=L_.compile(this._gl,M_.plain.source(this._capabilities),D_.blitWithGamma.source(this._capabilities)),this._mainProgram.use(),this._mainProgram.uniform1i("u_Sampler0",0),this._createVertexCoordinateBuffer(),this._createTextureCoordinateBuffer(),this._configureSourceTexture(),this._applyConfiguration(),this):this}close(){const t=this._gl;if(this._cancelDraw(),this.unbind(),t)return this._mainProgram.delete(),t.deleteBuffer(this._vertexCoordinateBuffer),t.deleteBuffer(this._textureCoordinateBuffer),t.deleteTexture(this._sourceTexture),this._ntscProcessor.destroy(),this._phosphorProcessor.destroy(),this._scanlineProcessor.destroy(),this._integerScalingProcessor.destroy(),this;this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._pendingFrames.forEach(t=>t.release())}resize(t,e){return this._updateCanvasSize(t,e),this._updateVertexBuffer(),this._video&&(this._configureProcessors(),this._scheduleDraw()),this._hasFrame&&this._draw(),this}getCanvas(){return this._canvas}bind(t){return this._video||(this._video=t,this._video.newFrame.addHandler(X_._frameHandler,this),this._configureProcessors(),this._scheduleDraw()),this}unbind(){return this._video?(this._cancelDraw(),this._video.newFrame.removeHandler(X_._frameHandler,this),this._video=null,this._pendingFrames.forEach(t=>t.release()),this._pendingFrames.clear(),this):this}getConfig(){return this._config}updateConfig(t){return this}static _frameHandler(t,e){e._pendingFrames.size()===e._pendingFrames.capacity()&&(e._pendingFrames.forEach(t=>t.release()),e._pendingFrames.clear()),e._pendingFrames.push(t),e._scheduleDraw()}_getRenderingContext(){const t={alpha:!1,depth:!1,antialias:!1};if(this._gl=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t),!this._gl)throw new Error("unable to acquire webgl context");this._capabilities=V_(this._gl)}_scheduleDraw(){0===this._anmiationFrameHandle&&(this._anmiationFrameHandle=requestAnimationFrame(()=>this._onAnimationFrame()))}_cancelDraw(){0!==this._anmiationFrameHandle&&cancelAnimationFrame(this._anmiationFrameHandle),this._anmiationFrameHandle=0}_onAnimationFrame(){const t=this._gl;if(this._anmiationFrameHandle=0,0===this._pendingFrames.size())return void(this._consecutiveUnderflows++<=5&&this._scheduleDraw());this._consecutiveUnderflows=0,this._scheduleDraw();const e=this._pendingFrames.pop();t&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._sourceTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.get()),e.release(),this._hasFrame=!0,this._draw())}_draw(){if(!this._gl)return;const t=this._gl;let e=this._sourceTexture;for(const t of this._processors)t.render(e),e=t.getTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,"none"===this._config.scalingMode?t.NEAREST:t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,"none"===this._config.scalingMode?t.NEAREST:t.LINEAR),this._mainProgram.use(),this._mainProgram.bindVertexAttribArray("a_VertexPosition",this._vertexCoordinateBuffer,2,t.FLOAT,!1,0,0),this._mainProgram.bindVertexAttribArray("a_TextureCoordinate",this._textureCoordinateBuffer,2,t.FLOAT,!1,0,0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_STRIP,0,4)}_createVertexCoordinateBuffer(){if(!this._gl)return;const t=this._gl,e=t.drawingBufferWidth,r=t.drawingBufferHeight,n=e>0?2/e:1,i=r>0?2/r:1;let s,a,o,u;4/3*r<=e?(a=2,s=4/3*r*n,u=1,o=Math.floor(-4/3*r)/2*n):(a=e/(4/3)*i,s=2,u=Math.floor(e/(4/3))/2*i,o=-1);const c=[o+s,u,o,u,o+s,u-a,o,u-a];this._vertexCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(c),t.STATIC_DRAW)}_updateVertexBuffer(){this._gl&&(this._gl.deleteBuffer(this._vertexCoordinateBuffer),this._createVertexCoordinateBuffer())}_createTextureCoordinateBuffer(){if(!this._gl)return;const t=this._gl;this._textureCoordinateBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._textureCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),t.STATIC_DRAW)}_updateCanvasSize(t,e){void 0!==t&&void 0!==e||(t=this.getCanvas().clientWidth,e=this.getCanvas().clientHeight);const r=window.devicePixelRatio||1;this.getCanvas().width=t*r,this.getCanvas().height=e*r}_configureSourceTexture(){if(!this._gl)return;const t=this._gl;this._sourceTexture||(this._sourceTexture=t.createTexture()),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._sourceTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1)}_configureProcessors(){if(!this._video||!this._gl)return;switch(this._phosphorProcessor.configure(this._config.phosphorLevel),this._scanlineProcessor.configure(this._config.scanlineLevel),this._integerScalingProcessor.configure(this._gl.drawingBufferWidth,this._gl.drawingBufferHeight),this._config.tvEmulation){case"composite":this._ntscProcessor.configure("composite");break;case"svideo":this._ntscProcessor.configure("svideo")}let t=this._video.getWidth(),e=this._video.getHeight();for(const r of this._processors)r.resize(t,e),t=r.getWidth(),e=r.getHeight()}_applyConfiguration(){this._gl&&(this._mainProgram.use(),this._mainProgram.uniform1f("u_Gamma",this._config.gamma),this._processors=[],"none"!==this._config.tvEmulation&&(this._ntscProcessor.init(),this._processors.push(this._ntscProcessor)),this._config.phosphorLevel>0&&(this._phosphorProcessor.init(),this._processors.push(this._phosphorProcessor)),this._config.scanlineLevel>0&&(this._scanlineProcessor.init(),this._processors.push(this._scanlineProcessor)),"qis"===this._config.scalingMode&&(this._integerScalingProcessor.init(),this._processors.push(this._integerScalingProcessor)),this._configureProcessors())}}function K_(t){return{type:0,swtch:t}}function Y_(t){return{type:1,trigger:t}}class J_{constructor(t,e=J_.defaultMappings){this._target=t,this.toggleFullscreen=new No,this.hardReset=new No,this.togglePause=new No,this._keydownListener=null,this._keyupListener=null,this._joystick0=null,this._joystick1=null,this._controlPanel=null,this._dispatchTable={},this._compiledMappings=new Map,this._compileMappings(e)}bind(t,e,r){this._joystick0||(this._joystick0=t,this._joystick1=e,this._controlPanel=r,this._updateActionTable(),this._keydownListener=t=>{if(!this._compiledMappings.has(t.keyCode))return;const e=(t.shiftKey?4:0)|(t.ctrlKey?1:0)|(t.altKey?2:0);if(!this._compiledMappings.get(t.keyCode).has(e))return;const r=this._compiledMappings.get(t.keyCode).get(e);if(void 0!==r){t.preventDefault();const e=this._dispatchTable[r];switch(e.type){case 0:e.swtch.toggle(!0);break;case 1:e.trigger.dispatch(void 0)}}},this._keyupListener=t=>{if(this._compiledMappings.has(t.keyCode))for(const e of this._compiledMappings.get(t.keyCode).values()){t.preventDefault();const r=this._dispatchTable[e];switch(r.type){case 0:r.swtch.toggle(!1)}}},this._target.addEventListener("keydown",this._keydownListener),this._target.addEventListener("keyup",this._keyupListener))}unbind(){this._joystick0&&(this._target.removeEventListener("keydown",this._keydownListener),this._target.removeEventListener("keyup",this._keyupListener),this._joystick0=this._joystick1=this._controlPanel=null,this._keydownListener=this._keyupListener=null)}_updateActionTable(){this._dispatchTable[12]=Y_(this.toggleFullscreen),this._dispatchTable[13]=Y_(this.hardReset),this._dispatchTable[14]=Y_(this.togglePause),this._dispatchTable[0]=K_(this._controlPanel.getSelectSwitch()),this._dispatchTable[1]=K_(this._controlPanel.getResetButton()),this._dispatchTable[2]=K_(this._joystick0.getLeft()),this._dispatchTable[3]=K_(this._joystick0.getRight()),this._dispatchTable[4]=K_(this._joystick0.getUp()),this._dispatchTable[5]=K_(this._joystick0.getDown()),this._dispatchTable[10]=K_(this._joystick0.getFire()),this._dispatchTable[6]=K_(this._joystick1.getLeft()),this._dispatchTable[7]=K_(this._joystick1.getRight()),this._dispatchTable[8]=K_(this._joystick1.getUp()),this._dispatchTable[9]=K_(this._joystick1.getDown()),this._dispatchTable[11]=K_(this._joystick1.getFire())}_compileMappings(t){const e=(t,e,r)=>{if(0!=(-8&r))throw new Error("invalid modifier set "+r);this._compiledMappings.has(e)||this._compiledMappings.set(e,new Map),this._compiledMappings.get(e).set(r,t)};t.forEach(t=>{const r=t.action;(Array.isArray(t.spec)?t.spec:[t.spec]).forEach(t=>e(r,"object"==typeof t?t.keycode:t,"object"==typeof t?t.modifiers:0))})}}!function(t){t.defaultMappings=[{action:0,spec:{keycode:32,modifiers:4}},{action:1,spec:{keycode:13,modifiers:4}},{action:2,spec:[65,37]},{action:3,spec:[68,39]},{action:4,spec:[87,38]},{action:5,spec:[83,40]},{action:10,spec:[32,86]},{action:6,spec:74},{action:7,spec:76},{action:8,spec:73},{action:9,spec:75},{action:11,spec:66},{action:12,spec:13},{action:13,spec:{keycode:82,modifiers:4}},{action:14,spec:80}]}(J_||(J_={}));class Q_{constructor(t){this._cache=t,this._context=null,this._source=null,this._gain=null,this._audio=null,this._volume=0,this._masterVolume=1}init(t,e){this._context=t,this._gain=this._context.createGain(),this._gain.connect(e)}bind(t){this._audio||(this._audio=t,this._volume=this._audio.getVolume(),this._updateGain(),this._audio.volumeChanged.addHandler(Q_._onVolumeChanged,this),this._audio.bufferChanged.addHandler(Q_._onBufferChanged,this),this._audio.stop.addHandler(Q_._onStop,this))}unbind(){this._audio&&(this._audio.volumeChanged.removeHandler(Q_._onVolumeChanged,this),this._audio.bufferChanged.removeHandler(Q_._onBufferChanged,this),this._audio.stop.removeHandler(Q_._onStop,this),this._source&&(this._source.stop(),this._source=null),this._audio=null)}setMasterVolume(t){this._masterVolume=t,this._updateGain()}static _onVolumeChanged(t,e){e._volume=t,e._updateGain()}static _onBufferChanged(t,e){if(!e._cache.has(t)){const r=e._audio.getBuffer(t),n=e._context.createBuffer(1,r.getLength(),r.getSampleRate());n.getChannelData(0).set(r.getContent()),e._cache.set(t,n)}const r=e._cache.get(t),n=e._context.createBufferSource();e._source&&e._source.stop(),n.loop=!0,n.buffer=r,n.connect(e._gain),n.start(),e._source=n}static _onStop(t,e){e._source&&(e._source.stop(),e._source=null)}_updateGain(){this._gain.gain.value=this._volume*this._masterVolume}}class Z_{constructor(){this._buffer=new Float32Array(2),this._fractionalIndex=0,this._needsData=!1,this._ratio=0,this.reset(1,1)}reset(t,e){this._ratio=t/e,this._needsData=!1,this._fractionalIndex=0;for(let t=0;t<2;t++)this._buffer[t]=0}get(){const t=(1-this._fractionalIndex)*this._buffer[0]+this._fractionalIndex*this._buffer[1];return this._fractionalIndex+=this._ratio,this._fractionalIndex>1&&(this._fractionalIndex-=1,this._needsData=!0),t}push(t){this._buffer[0]=this._buffer[1],this._buffer[1]=t,this._needsData=!1}needsData(){return this._needsData}}class tg{constructor(t=1024){this._hostFragmentSize=t,this._outputSampleRate=0,this._bufferSize=0,this._volume=1,this._gain=null,this._processor=null,this._bufferUnderrun=!1,this._fragmentRing=null,this._fragmentSize=0,this._inputSampleRate=0,this._fragmentIndex=0,this._currentFragment=null,this._lastFragment=null,this._resampler=new Z_}init(t,e){this._outputSampleRate=t.sampleRate,this._gain=t.createGain(),this._gain.gain.value=this._volume,this._gain.connect(e),this._processor=t.createScriptProcessor(this._hostFragmentSize,1,1),this._bufferSize=this._processor.bufferSize,this._processor.connect(this._gain),this._processor.onaudioprocess=t=>this._processAudio(t);t.createBuffer(1,1,t.sampleRate).getChannelData(0).set([0])}bind(t){this.unbind(),this._audio=t,this._fragmentSize=t.getFrameSize(),this._inputSampleRate=t.getSampleRate(),this._fragmentIndex=0,this._lastFragment=null,this._bufferUnderrun=!0,this._fragmentRing=new $_(Math.ceil(4*this._bufferSize/this._outputSampleRate/this._fragmentSize*this._inputSampleRate)),this._fragmentRing.evict.addHandler(t=>t.release()),this._audio.newFrame.addHandler(tg._onNewFragment,this),this._resampler.reset(this._inputSampleRate,this._outputSampleRate)}unbind(){this._audio&&(this._audio.newFrame.removeHandler(tg._onNewFragment,this),this._lastFragment&&(this._lastFragment.release(),this._lastFragment=null),this._currentFragment&&(this._currentFragment.release(),this._currentFragment=null),this._fragmentRing&&(this._fragmentRing.forEach(t=>t.release()),this._fragmentRing.clear(),this._fragmentRing=null))}setMasterVolume(t){this._volume=t}static _onNewFragment(t,e){e._fragmentRing.push(t),e._currentFragment||(e._currentFragment=e._fragmentRing.pop(),e._fragmentIndex=0)}_processAudio(t){if(!this._audio)return;const e=t.outputBuffer.getChannelData(0);let r=0;const n=t=>{const n=this._lastFragment&&this._lastFragment.get();for(;r<t;)this._resampler.needsData()&&(this._resampler.push(this._audio&&this._audio.isPaused()||!n?0:n[this._fragmentIndex++]*this._volume),this._fragmentIndex>=this._fragmentSize&&(this._fragmentIndex=0)),e[r++]=this._resampler.get()};this._currentFragment&&this._bufferUnderrun&&(n(this._bufferSize>>>1),this._bufferUnderrun=!1);let i=this._currentFragment&&this._currentFragment.get();for(;r<this._bufferSize&&this._currentFragment;)this._resampler.needsData()&&(this._resampler.push(i[this._fragmentIndex++]*this._volume),this._fragmentIndex>=this._fragmentSize&&(this._fragmentIndex=0,this._lastFragment&&this._lastFragment.release(),this._lastFragment=this._currentFragment,this._currentFragment=this._fragmentRing.pop(),i=this._currentFragment&&this._currentFragment.get())),e[r++]=this._resampler.get();r<this._bufferSize&&(this._bufferUnderrun=!0),n(this._bufferSize)}}const eg="safari"in window,rg=!!navigator.platform.match(/iPhone|iPad|iPod/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,ng=rg||eg,ig=["touchstart","click","keydown"],sg=window.AudioContext||window.webkitAudioContext;function ag(t,e=500){return new Promise(r=>{t.then(()=>r()),setTimeout(r,e)})}class og{constructor(){if(this._interactionListener=()=>{const t=this.context;this.interactionRequired=!1,ig.forEach(t=>document.removeEventListener(t,this._interactionListener)),this.mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){return yield ag(t.resume()),new Promise(e=>setTimeout(()=>n(this,void 0,void 0,(function*(){yield ag(t.suspend()),e()})),100))})))},this.mutex=new Tf,this.context=null,this.interactionRequired=!0,sg){this.context=new sg;try{this.context.destination.channelCount=1}catch(t){console.warn("audio driver: failed to set channel count")}ig.forEach(t=>document.addEventListener(t,this._interactionListener))}}stopListening(){ig.forEach(t=>document.removeEventListener(t,this._interactionListener))}}let ug=ng?new og:null;class cg{constructor(t=0,e=0,r){this._touchListener=()=>{ig.forEach(t=>document.removeEventListener(t,this._touchListener,!0)),this._context&&(this._context.resume(),setTimeout(()=>{this._mutex.runExclusive(()=>this._suspended?this._context.suspend():this._context.resume())},10))},this._context=null,this._merger=null,this._waveformChannels=null,this._pcmChannels=null,this._channels=null,this._cache=new Map,this._mutex=new Tf,this._suspended=!0,this._isBound=!1,this._waveformChannels=new Array(t),this._pcmChannels=new Array(e);for(let e=0;e<t;e++)this._waveformChannels[e]=new Q_(this._cache);for(let t=0;t<e;t++)this._pcmChannels[t]=new tg(r);this._channels=[...this._waveformChannels,...this._pcmChannels]}init(){if(ug){const t=ug;ug=new og,this._context=t.context,t.stopListening(),this._mutex=t.mutex,t.interactionRequired&&ig.forEach(t=>document.addEventListener(t,this._touchListener,!0))}else{if(!sg)throw new Error("web audio is not supported by runtime");this._context=new sg;try{this._context.destination.channelCount=1}catch(t){console.warn("audio driver: failed to set channel count")}}this._merger=this._context.createChannelMerger(this._channels.length),this._merger.connect(this._context.destination),this._channels.forEach(t=>t.init(this._context,this._merger))}bind(t=[],e=[]){if(!this._isBound){if(t.length!==this._waveformChannels.length)throw new Error(`invalid number of waveform sources: expected ${this._waveformChannels.length}, got ${t.length}`);if(e.length!==this._pcmChannels.length)throw new Error(`invalid number of waveform sources: expected ${this._pcmChannels.length}, got ${e.length}`);this._waveformChannels.forEach((e,r)=>e.bind(t[r])),this._pcmChannels.forEach((t,r)=>t.bind(e[r])),this._isBound=!0,this.resume()}}unbind(){this._isBound&&(this._channels.forEach(t=>t.unbind()),this._isBound=!1,this.pause())}setMasterVolume(t,e){this._channels[t].setMasterVolume(e)}pause(){return this._mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){this._suspended||(this._suspended=!0,yield ag(this._context.suspend()))})))}resume(){return this._mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){this._suspended&&(this._suspended=!1,yield ag(this._context.resume()))})))}close(){this._mutex.runExclusive(()=>this._context.close())}}class hg{constructor(t){this._fragmentSize=t,this._pcmAudio=!1,this._volume=1}init(){}bind(t,e){if(!this._channels){this._channels=[...e],this._driver&&this._pcmAudio===t||(this._driver&&this._driver.close(),this._driver=t?new cg(0,this._channels.length,this._fragmentSize):new cg(this._channels.length,0,this._fragmentSize),this._driver.init()),t?this._driver.bind([],this._channels):this._driver.bind(this._channels,[]);for(let t=0;t<this._channels.length;t++)this._driver.setMasterVolume(t,this._volume);this._pcmAudio=t}}unbind(){this._channels&&(this._driver.unbind(),this._channels=null)}setMasterVolume(t){if(this._volume=t,this._channels)for(let t=0;t<this._channels.length;t++)this._driver.setMasterVolume(t,this._volume)}getMasterVolume(){return this._volume}pause(){return n(this,void 0,void 0,(function*(){this._driver&&(yield this._driver.pause())}))}resume(){return n(this,void 0,void 0,(function*(){this._driver&&(yield this._driver.resume())}))}}var lg=M((function(t){
/*!
    * screenfull
    * v5.0.2 - 2020-02-13
    * (c) Sindre Sorhus; MIT License
    */
!function(){var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},r=t.exports,n=function(){for(var t,r=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,i=r.length,s={};n<i;n++)if((t=r[n])&&t[1]in e){for(n=0;n<t.length;n++)s[r[0][n]]=t[n];return s}return!1}(),i={change:n.fullscreenchange,error:n.fullscreenerror},s={request:function(t){return new Promise(function(r,i){var s=function(){this.off("change",s),r()}.bind(this);this.on("change",s);var a=(t=t||e.documentElement)[n.requestFullscreen]();a instanceof Promise&&a.then(s).catch(i)}.bind(this))},exit:function(){return new Promise(function(t,r){if(this.isFullscreen){var i=function(){this.off("change",i),t()}.bind(this);this.on("change",i);var s=e[n.exitFullscreen]();s instanceof Promise&&s.then(i).catch(r)}else t()}.bind(this))},toggle:function(t){return this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,r){var n=i[t];n&&e.addEventListener(n,r,!1)},off:function(t,r){var n=i[t];n&&e.removeEventListener(n,r,!1)},raw:n};n?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(e[n.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[n.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(e[n.fullscreenEnabled])}}}),r?t.exports=s:window.screenfull=s):r?t.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}));lg.isEnabled;const fg=rg,dg=lg;class pg{constructor(t,e=1e5,r="stellerator-fullscreen"){this._videoDriver=t,this._zIndex=e,this._fullscreenClass=r,this._resizeListener=()=>{this._resizeHandle||(this._resizeHandle=setTimeout(()=>{this._resizeHandle=null,this._adjustSizeForFullscreen()},100))},this._resizeHandle=null,this._changeListener=this._onChange.bind(this),this._engaged=!1}engage(){this._engaged||(this._engaged=!0,fg||!dg?(this._adjustSizeForFullscreen(),window.addEventListener("resize",this._resizeListener),this._engaged=!0):(dg.on("change",this._changeListener),dg.request(this._videoDriver.getCanvas())))}disengage(){this._engaged&&(fg||!dg?(this._resetSize(),window.removeEventListener("resize",this._resizeListener),this._engaged=!1):dg.exit())}toggle(){this._engaged?this.disengage():this.engage()}isEngaged(){return this._engaged}_onChange(){dg&&(dg.isFullscreen?(window.addEventListener("resize",this._resizeListener),this._adjustSizeForFullscreen()):(this._resetSize(),window.removeEventListener("resize",this._resizeListener),dg.off("change",this._changeListener),this._engaged=!1))}_resetSize(){const t=this._videoDriver.getCanvas();this._resizeHandle&&(clearTimeout(this._resizeHandle),this._resizeHandle=null),t.style.width="",t.style.height="",t.style.maxWidth="",t.style.maxHeight="",fg&&(t.style.position="",t.style.top="",t.style.left="",t.style.zIndex=""),document.body.classList.remove(this._fullscreenClass),setTimeout(()=>this._videoDriver.resize(),0)}_adjustSizeForFullscreen(){const t=this._videoDriver.getCanvas();this._videoDriver.resize(window.innerWidth,window.innerHeight),t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",t.style.maxWidth=window.innerWidth+"px",t.style.maxHeight=window.innerHeight+"px",fg&&(t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.zIndex=""+this._zIndex),document.body.classList.add(this._fullscreenClass)}}class _g{constructor(t=500,e=200){this._maxTapLength=t,this._timeout=e,this.trigger=new No,this._dispatch=!1,this._touching=!1,this._lastTouchEligible=!1,this._lastTouchStart=0,this._lastTouchEnd=0}startTouch(){this._lastTouchStart=Date.now(),this._touching||(this._touching=!0,this._dispatch=this._lastTouchEligible&&this._lastTouchStart-this._lastTouchEnd<this._timeout)}endTouch(){this._lastTouchEnd=Date.now(),this._dispatch&&(this._dispatch=!1,this.trigger.dispatch(void 0)),this._touching&&(this._touching=!1,this._lastTouchEligible=this._lastTouchStart-this._lastTouchEnd<this._maxTapLength)}cancelTouch(){this.endTouch(),this._lastTouchEligible=!1}isDispatching(){return this._dispatch}}class gg{constructor(t,e=15,r=!1){this._canvas=t,this._joystickSensitivity=e,this._leftHanded=r,this._onTouchStart=t=>{for(let e=0;e<t.changedTouches.length;e++){const r=new bg(t.changedTouches.item(e),this._canvas),n=r.touch.identifier;if((this._leftHanded?r.x>.5:r.x<=.5)?r.y<=.5?r.type="alt":r.type=this._isAlt?"pause":"fire":r.y<=.5?r.type=this._isAlt?"select":"joystick":r.type=this._isAlt?"reset":"joystick",!this._pendingTouches.has(n)&&!this._pendingTouches.has(r.type))switch(this._pendingTouches.set(n,r),this._pendingTouches.set(r.type,r),r.type){case"alt":this._isAlt=!0,this._fullscreenDoubleTapDetector.startTouch();break;case"fire":this._joystick.getFire().toggle(!0);break;case"pause":this.togglePause.dispatch(void 0),this._fullscreenDoubleTapDetector.cancelTouch();break;case"select":this._select.toggle(!0),this._fullscreenDoubleTapDetector.cancelTouch();break;case"reset":this._reset.toggle(!0),this._fullscreenDoubleTapDetector.cancelTouch();break;case"joystick":break;default:throw new Error("invalid touch type")}}t.preventDefault()},this._onTouchEnd=t=>{for(let e=0;e<t.changedTouches.length;e++){const r=this._pendingTouches.get(t.changedTouches.item(e).identifier);if(r){switch(r.type){case"alt":this._isAlt=!1,this._fullscreenDoubleTapDetector.endTouch();break;case"fire":this._joystick.getFire().toggle(!1);break;case"select":this._select.toggle(!1);break;case"reset":this._reset.toggle(!1);break;case"joystick":this._joystick.getDown().toggle(!1),this._joystick.getUp().toggle(!1),this._joystick.getLeft().toggle(!1),this._joystick.getRight().toggle(!1);break;case"pause":break;default:throw new Error("invalid touch type")}this._pendingTouches.delete(r.type),this._pendingTouches.delete(r.touch.identifier)}}t.preventDefault()},this._onTouchMove=t=>{for(let e=0;e<t.changedTouches.length;e++){const r=t.changedTouches.item(e),n=this._pendingTouches.get(r.identifier);if(!n)continue;if("joystick"!==n.type)continue;const i=r.clientX-n.x0,s=r.clientY-n.y0,a=Math.sqrt(i*i+s*s),o=Math.abs(s/a),u=Math.abs(i/a),c=a>this._joystickSensitivity;this._joystick.getLeft().toggle(c&&i<0&&u>.5),this._joystick.getRight().toggle(c&&i>0&&u>.5),this._joystick.getUp().toggle(c&&s<0&&o>.5),this._joystick.getDown().toggle(c&&s>0&&o>.5),a>3*this._joystickSensitivity&&(n.x0+=i/a*(a-3*this._joystickSensitivity),n.y0+=s/a*(a-3*this._joystickSensitivity))}t.preventDefault()},this.togglePause=new No,this._fullscreenDoubleTapDetector=new _g,this._bound=!1,this._joystick=null,this._select=null,this._reset=null,this._isAlt=!1,this._pendingTouches=new Map,this.toggleFullscreen=this._fullscreenDoubleTapDetector.trigger}static isSupported(){return"ontouchstart"in window}bind(t,e){this._bound||(this._bound=!0,this._joystick=t,this._select=e.getSelectSwitch(),this._reset=e.getResetButton(),this._bindListeners())}unbind(){this._bound&&(this._unbindListeners(),this._bound=!1,this._joystick=this._reset=this._select=null)}_bindListeners(){this._canvas.addEventListener("touchstart",this._onTouchStart),this._canvas.addEventListener("touchend",this._onTouchEnd),this._canvas.addEventListener("touchmove",this._onTouchMove)}_unbindListeners(){this._canvas.removeEventListener("touchstart",this._onTouchStart),this._canvas.removeEventListener("touchend",this._onTouchEnd),this._canvas.removeEventListener("touchmove",this._onTouchMove)}}class bg{constructor(t,e){this.touch=t,this.type="unknown";const r=e.getBoundingClientRect();this.x=(t.clientX-r.left)/r.width,this.y=(t.clientY-r.top)/r.height,this.x0=t.clientX,this.y0=t.clientY}}class vg{constructor(){this._x=-1,this._listener=this._onDocumentMouseMove.bind(this)}bind(t){this._paddle||(this._paddle=t,this._x=-1,document.addEventListener("mousemove",this._listener))}unbind(){this._paddle&&(document.removeEventListener("mousemove",this._listener),this._paddle=null)}_onDocumentMouseMove(t){if(this._x>=0){const e=t.screenX-this._x;let r=this._paddle.getValue();r+=-e/window.innerWidth/.9,r<0&&(r=0),r>1&&(r=1),this._paddle.setValue(r)}this._x=t.screenX}}class mg{constructor(){this._state=!1,this._dirty=!1}toggle(t){t!==this._state&&(this._state=t,this._dirty=!0)}setState(t){this._state=t,this._dirty=!1}sync(t){this._dirty&&(t.toggle(this._state),this._dirty=!1)}}function yg(t,e){return{type:"button",index:t,target:e}}function wg(t,e,r){return{type:"axis",index:t,sign:e,target:r}}const Ag=[yg(12,"up"),yg(13,"down"),yg(14,"left"),yg(15,"right"),yg(8,"select"),yg(9,"start"),...[0,1,2,3,10,11].map(t=>yg(t,"fire")),...[4,5,6,7].map(t=>yg(t,"pause")),wg(0,"negative","left"),wg(0,"positive","right"),wg(1,"negative","up"),wg(1,"positive","down"),wg(2,"negative","left"),wg(2,"positive","right"),wg(3,"negative","up"),wg(3,"positive","down")];function kg(t){return"object"==typeof t?t.pressed:t>.5}class Eg{constructor(){this._onGamepadConnect=()=>this.probeGamepads(),this._onGamepadDisconnect=()=>this.probeGamepads(),this.gamepadCountChanged=new No,this._shadows=null,this._mappings=new Map,this._mappingStates=new WeakMap,this._mappingTargets=new WeakMap,this._bound=!1,this._joysticks=[],this._auxSwitches={},this._gamepadCount=0,this._lastPoll=0,this.setMapping(Ag)}static probeGamepadCount(){let t=0;const e=navigator.getGamepads();for(let r=0;r<e.length;r++)e[r]&&t++;return t}init(){if(!navigator.getGamepads)throw new Error("gamepad API not available");this.probeGamepads(),window.addEventListener("gamepadconnected",this._onGamepadConnect),window.addEventListener("gamepaddisconnected",this._onGamepadDisconnect)}deinit(){this.unbind(),window.removeEventListener("gamepadconnected",this._onGamepadConnect),window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnect)}bind(t=[],e={}){this._bound||(this._bound=!0,this._joysticks=t,this._auxSwitches=e,this._bound=!0,this._shadows=new WeakMap,this._controlledSwitches().forEach(t=>{const e=new mg;this._shadows.set(t,e),e.setState(t.read()),t.beforeRead.addHandler(Eg._onBeforeSwitchRead,this)}))}unbind(){this._bound&&(this._controlledSwitches().forEach(t=>t.beforeRead.removeHandler(Eg._onBeforeSwitchRead,this)),this._shadows=null,this._auxSwitches={},this._joysticks=[],this._bound=!1)}getGamepadCount(){return this._gamepadCount}setMapping(t,e){void 0!==e&&this._mappings.set(e,t);const r=new Map,n=[];for(const e of t)n.indexOf(e.target)&&(n.push(e.target),r.set(e.target,!1));this._mappingStates.set(t,r),this._mappingTargets.set(t,n)}clearMapping(t){this._mappings.delete(t)}poll(){this._readGamepads()}static _onBeforeSwitchRead(t,e){e.poll()}probeGamepads(){const t=Eg.probeGamepadCount();t!==this._gamepadCount&&(this._gamepadCount=t,this.gamepadCountChanged.dispatch(this._gamepadCount))}_getSwitchForTarget(t,e=null){if(this._auxSwitches[t])return this._auxSwitches[t];if(!e)return null;switch(t){case"up":return e.getUp();case"down":return e.getDown();case"left":return e.getLeft();case"right":return e.getRight();case"fire":return e.getFire();default:return null}}_controlledSwitches(){const t=[...Object.keys(this._auxSwitches).map(t=>this._auxSwitches[t])];for(const e of this._joysticks)t.push(e.getLeft(),e.getRight(),e.getUp(),e.getDown(),e.getFire());return t}_readGamepads(){const t=Date.now();if(0===this._gamepadCount||t-this._lastPoll<50)return;this._lastPoll=t;const e=navigator.getGamepads();let r=0;for(let t=0;t<e.length;t++){const n=e[t];if(!n)continue;const i=this._mappings.get(n.id)||Ag,s=this._mappingStates.get(i),a=this._mappingTargets.get(i);for(const t of a)s.set(t,!1);for(const t of i)switch(t.type){case"button":const e=n.buttons[t.index];void 0!==e&&kg(e)&&s.set(t.target,!0);break;case"axis":const r=n.axes[t.index];void 0!==r&&("positive"===t.sign?r>.5:r<-.5)&&s.set(t.target,!0)}for(const t of a){const e=this._getSwitchForTarget(t,this._joysticks[r]);if(!e)continue;const n=this._shadows.get(e);n.toggle(s.get(t)),n.sync(e)}r++}}}var xg;function Tg(t){return{state:"error",error:t}}function Cg(t,e){const r=t.cpuEmulation||e.cpuEmulation;switch(r){case"cycle":return f_.Type.stateMachine;case"instruction":return f_.Type.batchedAccess;default:throw new Error("cannot happen: invalid cpu emulation mod e"+r)}}function Sg(t){switch(t.tvMode){case"ntsc":return 0;case"pal":return 1;case"secam":return 2;default:throw new Error("cannot happen: invalid TV mode "+t.tvMode)}}function Rg(t,e){return{tvMode:Sg(t),enableAudio:t.volume*e.volume>0,randomSeed:void 0===t.rngSeed?-1:t.rngSeed,emulatePaddles:t.emulatePaddles,frameStart:void 0===t.firstVisibleLine?-1:t.firstVisibleLine,pcmAudio:"pcm"===(t.audioEmulation||e.audioEmulation),cpuType:Cg(t,e)}}function Ig(t){switch(t){case"composite":return"composite";case"svideo":return"svideo";case"none":return"none";default:throw new Error("invalid TV emulation setting: "+t)}}function Bg(t){switch(t){case"qis":return"qis";case"bilinear":return"bilinear";case"none":return"none";default:throw new Error("invalid scaling setting")}}function Og(t,e){var r;return{gamma:e.gammaCorrection,tvEmulation:Ig(e.tvEmulation),scalingMode:Bg(e.scaling),phosphorLevel:(null!==(r=null==t?void 0:t.phosphorLevel)&&void 0!==r?r:e.phosphorLevel)/100,scanlineLevel:e.scanlineIntensity/100}}let Pg=xg=class{constructor(t){this._storage=t,this._onEmulationStarted=({hash:t,switches:e})=>n(this,void 0,void 0,(function*(){try{yield this._emulationMutex.runExclusive(()=>this._startEmulation(t,e))}catch(t){this._ports.onEmulationStateChange_.send(Tg(t.message))}})),this._onEmulationStopped=()=>this._emulationMutex.runExclusive(()=>this._stopEmulation()),this._onEmulationPaused=()=>this._emulationMutex.runExclusive(()=>this._pauseEmulation()),this._onEmulationResumed=()=>this._emulationMutex.runExclusive(()=>this._resumeEmulation()),this._onEmulationReset=()=>this._emulationMutex.runExclusive(()=>this._resetEmulation()),this._onToggleFullscreen=()=>this._fullscreenDriver&&this._fullscreenDriver.toggle(),this._onSetLimitFramerate=t=>this._emulationService.setRateLimit(t),this._onInputTogglePause=()=>this._ports.onInputDriverEvent_.send("pause"),this._onInputReset=()=>this._ports.onInputDriverEvent_.send("reset"),this._onInputToggleFullscreen=()=>this._ports.onInputDriverEvent_.send("fullscreen"),this._onWindowResize=()=>this._videoDriver&&this._videoDriver.resize(),this._onUpdateConsoleSwitches=t=>this._emulationMutex.runExclusive(()=>this._updateConsoleSwitches(t)),this._onMutation=t=>{if(!t.some(t=>t.addedNodes))return;const e=document.getElementById("stellerator-canvas");e===this._canvas||this._handledCanvasElements.has(e)||(e&&this._handledCanvasElements.add(e),e&&this._canvas?this._canvasMutex.runExclusive(()=>this._rebindCanvas(e)):e?this._canvasMutex.runExclusive(()=>this._bindCanvas(e)):this._canvasMutex.runExclusive(()=>this._unbindCanvas()))},this._emulationMutex=new Tf,this._canvasMutex=new Tf,this._driverManager=new O_,this._currentCartridgeHash=null,this._canvas=null,this._videoDriver=null,this._fullscreenDriver=null,this._mutationObserver=new MutationObserver(this._onMutation),this._keyboardDriver=new J_(document),this._paddleDriver=new vg,this._audioDriver=new hg,this._gamepadDriver=new Eg,this._touchDriver=null,this._currentConfig=null,this._handledCanvasElements=new WeakSet,this._emulationService=new B_("worker/stellerator.min.js"),this._emulationServiceReady=this._emulationService.init(),this._driverManager.bind(this._emulationService),this._audioDriver.init(),this._keyboardDriver.hardReset.addHandler(this._onInputReset),this._keyboardDriver.togglePause.addHandler(this._onInputTogglePause),this._keyboardDriver.toggleFullscreen.addHandler(this._onInputToggleFullscreen),this._driverManager.addDriver(this._gamepadDriver,(t,e)=>e.bind([t.getJoystick(0),t.getJoystick(1)],{start:t.getControlPanel().getResetButton(),select:t.getControlPanel().getSelectSwitch()})),this._gamepadDriver.init(),window.addEventListener("resize",this._onWindowResize)}init(t){this._ports=t,t.startEmulation_.subscribe(this._onEmulationStarted),t.stopEmulation_.subscribe(this._onEmulationStopped),t.pauseEmulation_.subscribe(this._onEmulationPaused),t.resumeEmulation_.subscribe(this._onEmulationResumed),t.resetEmulation_.subscribe(this._onEmulationReset),t.toggleFullscreen_.subscribe(this._onToggleFullscreen),t.setLimitFramerate_.subscribe(this._onSetLimitFramerate),t.updateConsoleSwitches_.subscribe(this._onUpdateConsoleSwitches),this._emulationService.stateChanged.addHandler(xg._onEmulationStateChange,this),this._emulationService.frequencyUpdate.addHandler(xg._onFrequencyChange,this),this._gamepadDriver.gamepadCountChanged.addHandler(t=>{console.log(t),this._ports.onUpdateGamepadCount_.send(t)}),this._ports.onUpdateGamepadCount_.send(Eg.probeGamepadCount()),this._mutationObserver.observe(document.body,{attributes:!1,characterData:!1,childList:!0,subtree:!0})}updateCartridge(t){return n(this,void 0,void 0,(function*(){if(t.hash!==this._currentCartridgeHash)return;switch(this._emulationService.getState()){case kf.State.running:case kf.State.paused:break;default:return}const e=yield this._storage.getSettings();this._audioDriver.setMasterVolume(t.volume*e.volume/1e4),this._videoDriver&&this._videoDriver.updateConfig(Og(t,e))}))}updateSettings(t){return n(this,void 0,void 0,(function*(){switch(this._emulationService.getState()){case kf.State.running:case kf.State.paused:break;default:return}const e=yield this._storage.getCartridge(this._currentCartridgeHash);this._audioDriver.setMasterVolume(e.volume*t.volume/1e4),this._videoDriver&&this._videoDriver.updateConfig(Og(e,t))}))}static _onEmulationStateChange(t,e){e._ports.onEmulationStateChange_.send(e._emulationState(t)),t===kf.State.running?e._audioDriver.resume():e._audioDriver.pause()}static _onFrequencyChange(t,e){e._emulationService.getState()===kf.State.running&&e._ports.onEmulationStateChange_.send({state:"running",frequency:t})}_startEmulation(t,e){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,yield this._emulationService.stop();const[r,n,i]=yield Promise.all([this._storage.getCartridge(t),this._storage.getCartridgeImage(t),this._storage.getSettings()]);if(!r||!n)throw new Error("invalid cartridge hash "+t);this._currentCartridgeHash=t;const s=Rg(r,i);this._currentConfig&&this._currentConfig.pcmAudio===s.pcmAudio||(this._driverManager.removeDriver(this._audioDriver),this._driverManager.addDriver(this._audioDriver,(t,e)=>e.bind(s.pcmAudio,s.pcmAudio?[t.getPCMChannel()]:t.getWaveformChannels()))),this._audioDriver.setMasterVolume(r.volume*i.volume/1e4),this._videoDriver&&this._videoDriver.updateConfig(Og(r,i)),this._currentConfig=Rg(r,i),yield this._emulationService.start(n,this._currentConfig,r.cartridgeType),this._updateConsoleSwitches(e),yield this._emulationService.resume()}))}_stopEmulation(){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,yield this._emulationService.stop(),this._currentCartridgeHash=null}))}_pauseEmulation(){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,yield this._emulationService.pause()}))}_resumeEmulation(){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,this._emulationService.getState()===kf.State.paused&&(yield this._emulationService.resume())}))}_resetEmulation(){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,yield this._emulationService.reset()}))}_updateConsoleSwitches(t){const e=this._emulationService.getEmulationContext();if(!e)return;const r=e.getControlPanel();r.getDifficultySwitchP0().toggle("pro"===t.difficultyP0),r.getDifficultySwitchP1().toggle("pro"===t.difficultyP1),r.getColorSwitch().toggle("bw"===t.color)}_createAndBindVideoDriver(t){return n(this,void 0,void 0,(function*(){yield this._emulationServiceReady,this._removeVideoDriver();const[e,r]=yield this._emulationMutex.runExclusive(()=>Promise.all([this._storage.getSettings(),this._currentCartridgeHash&&this._storage.getCartridge(this._currentCartridgeHash)]));this._canvas=t,this._videoDriver=new X_(this._canvas,Og(r,e)),this._videoDriver.init(),this._driverManager.addDriver(this._videoDriver,(t,e)=>e.bind(t.getVideo())),this._fullscreenDriver=new pg(this._videoDriver)}))}_bindCanvas(t){var e;return n(this,void 0,void 0,(function*(){const r=yield this._storage.getSettings();yield this._createAndBindVideoDriver(t),(null!==(e=r.touchControls)&&void 0!==e?e:gg.isSupported())&&(this._touchDriver=new gg(t,r.virtualJoystickSensitivity,r.leftHanded),this._touchDriver.toggleFullscreen.addHandler(this._onInputToggleFullscreen),this._touchDriver.togglePause.addHandler(this._onInputTogglePause),this._driverManager.addDriver(this._touchDriver,(t,e)=>e.bind(t.getJoystick(0),t.getControlPanel()))),this._driverManager.addDriver(this._keyboardDriver,(t,e)=>e.bind(t.getJoystick(0),t.getJoystick(1),t.getControlPanel())).addDriver(this._paddleDriver,(t,e)=>e.bind(t.getPaddle(0)))}))}_rebindCanvas(t){return n(this,void 0,void 0,(function*(){yield this._createAndBindVideoDriver(t)}))}_unbindCanvas(){return n(this,void 0,void 0,(function*(){this._touchDriver&&(this._driverManager.removeDriver(this._touchDriver),this._touchDriver=null),this._driverManager.removeDriver(this._keyboardDriver).removeDriver(this._paddleDriver),yield this._removeVideoDriver(),this._handledCanvasElements.delete(this._canvas),this._canvas=null}))}_removeVideoDriver(){this._videoDriver&&(this._driverManager.removeDriver(this._videoDriver),this._videoDriver.close(),this._videoDriver=null,this._fullscreenDriver.disengage(),this._fullscreenDriver=null)}_emulationState(t){switch(t){case kf.State.error:return Tg(this._emulationService.getLastError().message);case kf.State.running:return{state:"running"};case kf.State.paused:return{state:"paused"};case kf.State.stopped:return{state:"stopped"};default:throw new Error("cannot happen: invalid emulation state "+t)}}};Pg=xg=t([Zt(),e(0,te(wf)),r("design:paramtypes",[wf])],Pg);var Mg=Pg,Dg=M((function(t,e){!function(){function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function r(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){a(n.response,e,r)},n.onerror=function(){console.error("could not download file")},n.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof O&&O.global===O?O:void 0,a=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype?function(t,e,a){var o=s.URL||s.webkitURL,u=document.createElement("a");e=e||t.name||"download",u.download=e,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?i(u):n(u.href)?r(t,e,a):i(u,u.target="_blank")):(u.href=o.createObjectURL(t),setTimeout((function(){o.revokeObjectURL(u.href)}),4e4),setTimeout((function(){i(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,s,a){if(s=s||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),s);else if(n(t))r(t,s,a);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){i(o)}))}}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return r(t,e,n);var a="application/octet-stream"===t.type,o=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&o)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var h=s.URL||s.webkitURL,l=h.createObjectURL(t);i?i.location=l:location.href=l,i=null,setTimeout((function(){h.revokeObjectURL(l)}),4e4)}});s.saveAs=a.saveAs=a,t.exports=a}()}));class Fg{constructor(t,e){this._interval=t,this._callback=e,this._handle=null,this._lastCall=Date.now()}run(t){if(this._data=t,null!==this._handle)return;const e=Date.now();e-this._lastCall>=this._interval?(this._lastCall=e,this._callback(this._data)):this._handle=window.setTimeout(()=>{this._handle=null,this._lastCall=e,this._callback(this._data)},this._interval-e+this._lastCall)}}let Lg=class{constructor(t,e){this._storage=t,this._emulation=e,this._onCartridgeDeleted=t=>this._storage.deleteCartridge(t),this._onDeleteAllCartridges=()=>this._storage.deleteAllCartridges(),this._onSaveCartridge=t=>n(this,void 0,void 0,(function*(){const[e,r]=yield Promise.all([this._storage.getCartridge(t),this._storage.getCartridgeImage(t)]);e&&r&&Dg.saveAs(new Blob([r],{type:"application/octet-stream"}),e.name+".bin",{autoBom:!1})})),this._updateCartridgeThrottle=new Fg(250,t=>this._mutex.runExclusive(()=>this._updateCartridge(t))),this._mutex=new Tf}init(t){t.updateCartridge_.subscribe(this._updateCartridgeThrottle.run.bind(this._updateCartridgeThrottle)),t.deleteCartridge_.subscribe(this._onCartridgeDeleted),t.deleteAllCartridges_.subscribe(this._onDeleteAllCartridges),t.saveCartridge_.subscribe(this._onSaveCartridge)}_updateCartridge(t){return n(this,void 0,void 0,(function*(){yield this._storage.updateCartridge(t),yield this._emulation.updateCartridge(t)}))}};Lg=t([Zt(),e(0,te(wf)),e(1,te(Mg)),r("design:paramtypes",[wf,Mg])],Lg);var jg=Lg;let Ng=class{constructor(t,e){this._storage=t,this._emulation=e,this._throttle=new Fg(250,this._applyUpdate.bind(this)),this._mutex=new Tf}init(t){t.updateSettings_.subscribe(this._throttle.run.bind(this._throttle))}_applyUpdate(t){this._mutex.runExclusive(()=>n(this,void 0,void 0,(function*(){yield this._storage.saveSettings(t),yield this._emulation.updateSettings(t)})))}};Ng=t([Zt(),e(0,te(wf)),e(1,te(Mg)),r("design:paramtypes",[wf,Mg])],Ng);var Ug=Ng;const zg="stellerator-ng-version";navigator.serviceWorker&&navigator.serviceWorker.register("./service-worker.js",{scope:"./"});const $g=t=>({cpuEmulation:"cycle",volume:80,audioEmulation:"pcm",gammaCorrection:1,tvEmulation:t?"none":"composite",scaling:t?"bilinear":"qis",phosphorLevel:50,scanlineIntensity:20,touchControls:void 0,leftHanded:!1,virtualJoystickSensitivity:10,uiMode:void 0,uiSize:100});window.addEventListener("load",(function(){return n(this,void 0,void 0,(function*(){ut||(ot(document.body),ut=new MutationObserver(t=>t.forEach(t=>t.addedNodes.forEach(ot))),ut.observe(document.body,{attributes:!1,characterData:!1,childList:!0,subtree:!0}));const t=ct.getAllTypes().map(t=>({key:t,description:ct.describeCartridgeType(t)})),e=new Qt({autoBindInjectable:!0,defaultScope:"Singleton"}),r=e.get(wf),n=V_(),i=!(n&&(n.floatTextures||n.halfFloatTextures)&&n.highpInFsh);r.setDefaults($g(i));const[s,a]=yield Promise.all([r.getAllCartridges(),r.getSettings()]),o="1.0.4-78577ab",u=localStorage.getItem(zg),c=!!u&&u!==o;localStorage.setItem(zg,o);const{ports:h}=L.Stellerator.Main.init({flags:{cartridges:s,cartridgeTypes:t,settings:a,defaultSettings:$g(i),touchSupport:gg.isSupported(),version:o,wasUpdated:c,gamepadCount:Eg.probeGamepadCount(),badGpu:i}});e.get(re).init(h),e.get(se).init(h),e.get(Ef).init(h),e.get(jg).init(h),e.get(Ug).init(h),e.get(Mg).init(h),h.scrollToTop_.subscribe(()=>window.scrollTo(0,0)),h.blurCurrentElement_.subscribe(()=>document.activeElement.blur())}))}))}();
//# sourceMappingURL=app.js.map
